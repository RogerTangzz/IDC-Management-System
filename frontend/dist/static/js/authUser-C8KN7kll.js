import{k as G,ap as H,g as J,r as m,P as Z,ac as s,ag as V,l as M,m as g,D as c,J as o,K as $,u as t,C as l,Z as x,G as _,B as b,h as W,q as X,H as Y}from"./vue-SR65qDCS.js";import ee from"./selectUser-Ms2pHztV.js";import{a as oe,b as te,c as le}from"./role-DYMgzd5G.js";import"./index-Cw83YE5u.js";import"./element-D8D5Bqo2.js";import"./vendor-C71Ev03J.js";const ne={class:"app-container"},ae=G({name:"AuthUser"}),_e=Object.assign(ae,{setup(re){const P=H(),{proxy:i}=J(),{sys_normal_disable:R}=i.useDict("sys_normal_disable"),S=m([]),w=m(!0),h=m(!0),k=m(!0),y=m(0),N=m([]),a=Z({pageNum:1,pageSize:10,roleId:P.params.roleId,userName:void 0,phonenumber:void 0});function p(){w.value=!0,oe(a).then(r=>{S.value=r.rows,y.value=r.total,w.value=!1})}function A(){const r={path:"/system/role"};i.$tab.closeOpenPage(r)}function f(){a.pageNum=1,p()}function B(){i.resetForm("queryRef"),f()}function D(r){N.value=r.map(e=>e.userId),k.value=!r.length}function T(){i.$refs.selectRef.show()}function q(r){i.$modal.confirm('确认要取消该用户"'+r.userName+'"角色吗？').then(function(){return le({userId:r.userId,roleId:a.roleId})}).then(()=>{p(),i.$modal.msgSuccess("取消授权成功")}).catch(()=>{})}function K(){const r=a.roleId,e=N.value.join(",");i.$modal.confirm("是否取消选中用户授权数据项?").then(function(){return te({roleId:r,userIds:e})}).then(()=>{p(),i.$modal.msgSuccess("取消授权成功")}).catch(()=>{})}return p(),(r,e)=>{const U=s("el-input"),v=s("el-form-item"),d=s("el-button"),j=s("el-form"),C=s("el-col"),z=s("right-toolbar"),L=s("el-row"),u=s("el-table-column"),O=s("dict-tag"),Q=s("el-table"),E=s("pagination"),I=V("hasPermi"),F=V("loading");return g(),M("div",ne,[c(o(j,{model:t(a),ref:"queryRef",inline:!0},{default:l(()=>[o(v,{label:"用户名称",prop:"userName"},{default:l(()=>[o(U,{modelValue:t(a).userName,"onUpdate:modelValue":e[0]||(e[0]=n=>t(a).userName=n),placeholder:"请输入用户名称",clearable:"",style:{width:"240px"},onKeyup:x(f,["enter"])},null,8,["modelValue"])]),_:1}),o(v,{label:"手机号码",prop:"phonenumber"},{default:l(()=>[o(U,{modelValue:t(a).phonenumber,"onUpdate:modelValue":e[1]||(e[1]=n=>t(a).phonenumber=n),placeholder:"请输入手机号码",clearable:"",style:{width:"240px"},onKeyup:x(f,["enter"])},null,8,["modelValue"])]),_:1}),o(v,null,{default:l(()=>[o(d,{type:"primary",icon:"Search",onClick:f},{default:l(()=>e[5]||(e[5]=[_("搜索")])),_:1,__:[5]}),o(d,{icon:"Refresh",onClick:B},{default:l(()=>e[6]||(e[6]=[_("重置")])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),[[$,t(h)]]),o(L,{gutter:10,class:"mb8"},{default:l(()=>[o(C,{span:1.5},{default:l(()=>[c((g(),b(d,{type:"primary",plain:"",icon:"Plus",onClick:T},{default:l(()=>e[7]||(e[7]=[_("添加用户")])),_:1,__:[7]})),[[I,["system:role:add"]]])]),_:1}),o(C,{span:1.5},{default:l(()=>[c((g(),b(d,{type:"danger",plain:"",icon:"CircleClose",disabled:t(k),onClick:K},{default:l(()=>e[8]||(e[8]=[_("批量取消授权")])),_:1,__:[8]},8,["disabled"])),[[I,["system:role:remove"]]])]),_:1}),o(C,{span:1.5},{default:l(()=>[o(d,{type:"warning",plain:"",icon:"Close",onClick:A},{default:l(()=>e[9]||(e[9]=[_("关闭")])),_:1,__:[9]})]),_:1}),o(z,{showSearch:t(h),"onUpdate:showSearch":e[2]||(e[2]=n=>W(h)?h.value=n:null),onQueryTable:p},null,8,["showSearch"])]),_:1}),c((g(),b(Q,{data:t(S),onSelectionChange:D},{default:l(()=>[o(u,{type:"selection",width:"55",align:"center"}),o(u,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),o(u,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),o(u,{label:"邮箱",prop:"email","show-overflow-tooltip":!0}),o(u,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),o(u,{label:"状态",align:"center",prop:"status"},{default:l(n=>[o(O,{options:t(R),value:n.row.status},null,8,["options","value"])]),_:1}),o(u,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:l(n=>[X("span",null,Y(r.parseTime(n.row.createTime)),1)]),_:1}),o(u,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(n=>[c((g(),b(d,{link:"",type:"primary",icon:"CircleClose",onClick:se=>q(n.row)},{default:l(()=>e[10]||(e[10]=[_("取消授权")])),_:2,__:[10]},1032,["onClick"])),[[I,["system:role:remove"]]])]),_:1})]),_:1},8,["data"])),[[F,t(w)]]),c(o(E,{total:t(y),page:t(a).pageNum,"onUpdate:page":e[3]||(e[3]=n=>t(a).pageNum=n),limit:t(a).pageSize,"onUpdate:limit":e[4]||(e[4]=n=>t(a).pageSize=n),onPagination:p},null,8,["total","page","limit"]),[[$,t(y)>0]]),o(t(ee),{ref:"selectRef",roleId:t(a).roleId,onOk:f},null,8,["roleId"])])}}});export{_e as default};
