import{k as Ce,g as xe,r as b,P as Se,a7 as Ne,ac as d,ag as Y,l as N,m as r,D as V,J as e,K as ee,C as a,Z as Ue,u as n,I as $,$ as D,B as f,G as u,H as y,q as le}from"./vue-SR65qDCS.js";import{f as ne,h as $e,k as oe,p as De,m as te}from"./index-Cw83YE5u.js";import"./element-D8D5Bqo2.js";import"./vendor-C71Ev03J.js";function qe(_){return ne("/business/ticket/template/list",_)}function ae(_){return ne(`/business/ticket/template/${_}`)}function Ie(_){return De("/business/ticket/template",_)}function Ee(_){return oe("/business/ticket/template",_)}function Pe(_){return $e(`/business/ticket/template/${_}`)}function Re(_,p){return oe(`/business/ticket/template/${_}/status`,{status:p})}const Ae={class:"app-container"},Be={class:"dialog-footer"},Fe={class:"dialog-footer"},ze=Ce({name:"TicketTemplate"}),je=Object.assign(ze,{setup(_){const{proxy:p}=xe(),G=b([]),h=b(!1),q=b(!1),A=b(!0),B=b(!0),F=b([]),H=b(!0),J=b(!0),z=b(0),K=b(""),c=b({}),{ticket_priority:L,equipment_specialty:I,fault_type:E}=p.useDict("ticket_priority","equipment_specialty","fault_type"),ue=Se({form:{},queryParams:{pageNum:1,pageSize:10,templateName:void 0,faultType:void 0,specialty:void 0},rules:{templateName:[{required:!0,message:"模板名称不能为空",trigger:"blur"},{min:2,max:50,message:"模板名称长度在 2 到 50 个字符",trigger:"blur"}],faultType:[{required:!0,message:"请选择故障类型",trigger:"change"}],priority:[{required:!0,message:"请选择默认优先级",trigger:"change"}],specialty:[{required:!0,message:"请选择设备专业",trigger:"change"}],defaultTitle:[{required:!0,message:"默认标题不能为空",trigger:"blur"}],defaultDescription:[{required:!0,message:"故障描述不能为空",trigger:"blur"}]}}),{queryParams:s,form:o,rules:ie}=Ne(ue);function C(){A.value=!0,qe(s.value).then(i=>{G.value=i.rows,z.value=i.total,A.value=!1})}function de(){h.value=!1,Q()}function Q(){o.value={templateId:void 0,templateNo:void 0,templateName:void 0,faultType:void 0,priority:"medium",specialty:void 0,defaultTitle:void 0,defaultDescription:void 0,defaultEmergencyAction:void 0,defaultSolution:void 0,useCount:0,status:"0",remark:void 0},p.resetForm("templateRef")}function O(){s.value.pageNum=1,C()}function re(){p.resetForm("queryRef"),O()}function se(i){F.value=i.map(l=>l.templateId),H.value=i.length!=1,J.value=!i.length}function pe(){Q(),h.value=!0,K.value="添加工单模板"}function me(i){ae(i.templateId).then(l=>{c.value=l.data,q.value=!0})}function Z(i){Q();const l=i.templateId||F.value[0];ae(l).then(k=>{o.value=k.data,h.value=!0,K.value="修改工单模板"})}function fe(){p.$refs.templateRef.validate(i=>{i&&(o.value.templateId!=null?Ee(o.value).then(l=>{p.$modal.msgSuccess("修改成功"),h.value=!1,C()}):Ie(o.value).then(l=>{p.$modal.msgSuccess("新增成功"),h.value=!1,C()}))})}function M(i){const l=i.templateId||F.value;p.$modal.confirm('是否确认删除工单模板编号为"'+l+'"的数据项？').then(function(){return Pe(l)}).then(()=>{C(),p.$modal.msgSuccess("删除成功")}).catch(()=>{})}function _e(i){let l=i.status==="0"?"启用":"停用";p.$modal.confirm('确认要"'+l+'""'+i.templateName+'"模板吗？').then(function(){return Re(i.templateId,i.status)}).then(()=>{p.$modal.msgSuccess(l+"成功")}).catch(function(){i.status=i.status==="0"?"1":"0"})}function ce(){p.download("business/ticket/template/export",{...s.value},`template_${new Date().getTime()}.xlsx`)}return C(),(i,l)=>{const k=d("el-input"),m=d("el-form-item"),P=d("el-option"),R=d("el-select"),v=d("el-button"),W=d("el-form"),T=d("el-col"),ve=d("right-toolbar"),j=d("el-row"),w=d("el-table-column"),S=d("dict-tag"),ge=d("el-tag"),be=d("el-switch"),ye=d("el-table"),we=d("pagination"),Ve=d("el-radio"),ke=d("el-radio-group"),X=d("el-dialog"),g=d("el-descriptions-item"),Te=d("el-descriptions"),x=Y("hasPermi"),he=Y("loading");return r(),N("div",Ae,[V(e(W,{model:n(s),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[e(m,{label:"模板名称",prop:"templateName"},{default:a(()=>[e(k,{modelValue:n(s).templateName,"onUpdate:modelValue":l[0]||(l[0]=t=>n(s).templateName=t),placeholder:"请输入模板名称",clearable:"",onKeyup:Ue(O,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"故障类型",prop:"faultType"},{default:a(()=>[e(R,{modelValue:n(s).faultType,"onUpdate:modelValue":l[1]||(l[1]=t=>n(s).faultType=t),placeholder:"请选择",clearable:""},{default:a(()=>[(r(!0),N($,null,D(n(E),t=>(r(),f(P,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"设备专业",prop:"specialty"},{default:a(()=>[e(R,{modelValue:n(s).specialty,"onUpdate:modelValue":l[2]||(l[2]=t=>n(s).specialty=t),placeholder:"请选择",clearable:""},{default:a(()=>[(r(!0),N($,null,D(n(I),t=>(r(),f(P,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:a(()=>[e(v,{type:"primary",icon:"Search",onClick:O},{default:a(()=>l[18]||(l[18]=[u("搜索")])),_:1,__:[18]}),e(v,{icon:"Refresh",onClick:re},{default:a(()=>l[19]||(l[19]=[u("重置")])),_:1,__:[19]})]),_:1})]),_:1},8,["model"]),[[ee,B.value]]),e(j,{gutter:10,class:"mb8"},{default:a(()=>[e(T,{span:1.5},{default:a(()=>[V((r(),f(v,{type:"primary",plain:"",icon:"Plus",onClick:pe},{default:a(()=>l[20]||(l[20]=[u("新增模板")])),_:1,__:[20]})),[[x,["business:ticket:template:add"]]])]),_:1}),e(T,{span:1.5},{default:a(()=>[V((r(),f(v,{type:"success",plain:"",icon:"Edit",disabled:H.value,onClick:Z},{default:a(()=>l[21]||(l[21]=[u("修改")])),_:1,__:[21]},8,["disabled"])),[[x,["business:ticket:template:edit"]]])]),_:1}),e(T,{span:1.5},{default:a(()=>[V((r(),f(v,{type:"danger",plain:"",icon:"Delete",disabled:J.value,onClick:M},{default:a(()=>l[22]||(l[22]=[u("删除")])),_:1,__:[22]},8,["disabled"])),[[x,["business:ticket:template:remove"]]])]),_:1}),e(T,{span:1.5},{default:a(()=>[V((r(),f(v,{type:"warning",plain:"",icon:"Download",onClick:ce},{default:a(()=>l[23]||(l[23]=[u("导出")])),_:1,__:[23]})),[[x,["business:ticket:template:export"]]])]),_:1}),e(ve,{showSearch:B.value,"onUpdate:showSearch":l[3]||(l[3]=t=>B.value=t),onQueryTable:C},null,8,["showSearch"])]),_:1}),V((r(),f(ye,{data:G.value,onSelectionChange:se},{default:a(()=>[e(w,{type:"selection",width:"55",align:"center"}),e(w,{label:"模板编号",align:"center",prop:"templateNo",width:"120"}),e(w,{label:"模板名称",align:"center",prop:"templateName","show-overflow-tooltip":!0}),e(w,{label:"故障类型",align:"center",prop:"faultType",width:"100"},{default:a(t=>[e(S,{options:n(E),value:t.row.faultType},null,8,["options","value"])]),_:1}),e(w,{label:"默认优先级",align:"center",prop:"priority",width:"100"},{default:a(t=>[e(S,{options:n(L),value:t.row.priority},null,8,["options","value"])]),_:1}),e(w,{label:"设备专业",align:"center",prop:"specialty",width:"100"},{default:a(t=>[e(S,{options:n(I),value:t.row.specialty},null,8,["options","value"])]),_:1}),e(w,{label:"使用次数",align:"center",prop:"useCount",width:"90"},{default:a(t=>[e(ge,null,{default:a(()=>[u(y(t.row.useCount)+"次",1)]),_:2},1024)]),_:1}),e(w,{label:"状态",align:"center",prop:"status",width:"80"},{default:a(t=>[e(be,{modelValue:t.row.status,"onUpdate:modelValue":U=>t.row.status=U,"active-value":"0","inactive-value":"1",onChange:U=>_e(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(w,{label:"创建时间",align:"center",prop:"createTime",width:"160"},{default:a(t=>[u(y(n(te)(t.row.createTime)),1)]),_:1}),e(w,{label:"操作",align:"center","class-name":"small-padding fixed-width",width:"180"},{default:a(t=>[V((r(),f(v,{link:"",type:"primary",icon:"View",onClick:U=>me(t.row)},{default:a(()=>l[24]||(l[24]=[u("查看")])),_:2,__:[24]},1032,["onClick"])),[[x,["business:ticket:template:query"]]]),V((r(),f(v,{link:"",type:"primary",icon:"Edit",onClick:U=>Z(t.row)},{default:a(()=>l[25]||(l[25]=[u("修改")])),_:2,__:[25]},1032,["onClick"])),[[x,["business:ticket:template:edit"]]]),V((r(),f(v,{link:"",type:"danger",icon:"Delete",onClick:U=>M(t.row)},{default:a(()=>l[26]||(l[26]=[u("删除")])),_:2,__:[26]},1032,["onClick"])),[[x,["business:ticket:template:remove"]]])]),_:1})]),_:1},8,["data"])),[[he,A.value]]),V(e(we,{total:z.value,page:n(s).pageNum,"onUpdate:page":l[4]||(l[4]=t=>n(s).pageNum=t),limit:n(s).pageSize,"onUpdate:limit":l[5]||(l[5]=t=>n(s).pageSize=t),onPagination:C},null,8,["total","page","limit"]),[[ee,z.value>0]]),e(X,{title:K.value,modelValue:h.value,"onUpdate:modelValue":l[15]||(l[15]=t=>h.value=t),width:"700px","append-to-body":""},{footer:a(()=>[le("div",Be,[e(v,{type:"primary",onClick:fe},{default:a(()=>l[27]||(l[27]=[u("确 定")])),_:1,__:[27]}),e(v,{onClick:de},{default:a(()=>l[28]||(l[28]=[u("取 消")])),_:1,__:[28]})])]),default:a(()=>[e(W,{ref:"templateRef",model:n(o),rules:n(ie),"label-width":"100px"},{default:a(()=>[e(j,null,{default:a(()=>[e(T,{span:12},{default:a(()=>[e(m,{label:"模板名称",prop:"templateName"},{default:a(()=>[e(k,{modelValue:n(o).templateName,"onUpdate:modelValue":l[6]||(l[6]=t=>n(o).templateName=t),placeholder:"请输入模板名称",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:a(()=>[e(m,{label:"故障类型",prop:"faultType"},{default:a(()=>[e(R,{modelValue:n(o).faultType,"onUpdate:modelValue":l[7]||(l[7]=t=>n(o).faultType=t),placeholder:"请选择故障类型"},{default:a(()=>[(r(!0),N($,null,D(n(E),t=>(r(),f(P,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(j,null,{default:a(()=>[e(T,{span:12},{default:a(()=>[e(m,{label:"默认优先级",prop:"priority"},{default:a(()=>[e(ke,{modelValue:n(o).priority,"onUpdate:modelValue":l[8]||(l[8]=t=>n(o).priority=t)},{default:a(()=>[(r(!0),N($,null,D(n(L),t=>(r(),f(Ve,{key:t.value,label:t.value},{default:a(()=>[u(y(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(T,{span:12},{default:a(()=>[e(m,{label:"设备专业",prop:"specialty"},{default:a(()=>[e(R,{modelValue:n(o).specialty,"onUpdate:modelValue":l[9]||(l[9]=t=>n(o).specialty=t),placeholder:"请选择"},{default:a(()=>[(r(!0),N($,null,D(n(I),t=>(r(),f(P,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(m,{label:"默认标题",prop:"defaultTitle"},{default:a(()=>[e(k,{modelValue:n(o).defaultTitle,"onUpdate:modelValue":l[10]||(l[10]=t=>n(o).defaultTitle=t),placeholder:"请输入默认标题"},null,8,["modelValue"])]),_:1}),e(m,{label:"故障描述",prop:"defaultDescription"},{default:a(()=>[e(k,{modelValue:n(o).defaultDescription,"onUpdate:modelValue":l[11]||(l[11]=t=>n(o).defaultDescription=t),type:"textarea",rows:4,placeholder:"请输入默认故障描述",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(m,{label:"应急处置",prop:"defaultEmergencyAction"},{default:a(()=>[e(k,{modelValue:n(o).defaultEmergencyAction,"onUpdate:modelValue":l[12]||(l[12]=t=>n(o).defaultEmergencyAction=t),type:"textarea",rows:3,placeholder:"请输入默认应急处置方法",maxlength:"300","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(m,{label:"处理方案",prop:"defaultSolution"},{default:a(()=>[e(k,{modelValue:n(o).defaultSolution,"onUpdate:modelValue":l[13]||(l[13]=t=>n(o).defaultSolution=t),type:"textarea",rows:4,placeholder:"请输入默认处理方案",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(m,{label:"备注",prop:"remark"},{default:a(()=>[e(k,{modelValue:n(o).remark,"onUpdate:modelValue":l[14]||(l[14]=t=>n(o).remark=t),type:"textarea",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(X,{title:"模板详情",modelValue:q.value,"onUpdate:modelValue":l[17]||(l[17]=t=>q.value=t),width:"700px","append-to-body":""},{footer:a(()=>[le("div",Fe,[e(v,{onClick:l[16]||(l[16]=t=>q.value=!1)},{default:a(()=>l[29]||(l[29]=[u("关 闭")])),_:1,__:[29]})])]),default:a(()=>[e(Te,{column:2,border:""},{default:a(()=>[e(g,{label:"模板编号"},{default:a(()=>[u(y(c.value.templateNo),1)]),_:1}),e(g,{label:"模板名称"},{default:a(()=>[u(y(c.value.templateName),1)]),_:1}),e(g,{label:"故障类型"},{default:a(()=>[e(S,{options:n(E),value:c.value.faultType},null,8,["options","value"])]),_:1}),e(g,{label:"默认优先级"},{default:a(()=>[e(S,{options:n(L),value:c.value.priority},null,8,["options","value"])]),_:1}),e(g,{label:"设备专业"},{default:a(()=>[e(S,{options:n(I),value:c.value.specialty},null,8,["options","value"])]),_:1}),e(g,{label:"使用次数"},{default:a(()=>[u(y(c.value.useCount)+"次",1)]),_:1}),e(g,{label:"默认标题",span:2},{default:a(()=>[u(y(c.value.defaultTitle),1)]),_:1}),e(g,{label:"故障描述",span:2},{default:a(()=>[u(y(c.value.defaultDescription),1)]),_:1}),e(g,{label:"应急处置",span:2},{default:a(()=>[u(y(c.value.defaultEmergencyAction),1)]),_:1}),e(g,{label:"处理方案",span:2},{default:a(()=>[u(y(c.value.defaultSolution),1)]),_:1}),e(g,{label:"创建时间",span:2},{default:a(()=>[u(y(n(te)(c.value.createTime)),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}});export{je as default};
