import{l as ne,n as se,a as I}from"./element-D8D5Bqo2.js";import{i as C,L as re}from"./echarts-8VjjxCB0.js";import{_ as ie,F as N}from"./index-Cw83YE5u.js";import{r as b,P as de,d as ue,n as me,O as pe,ac as s,l as U,m as k,J as t,C as a,I as ce,$ as fe,u as T,B as _e,G as r,q as n,H as v}from"./vue-SR65qDCS.js";import"./vendor-C71Ev03J.js";const ge={class:"inspection-statistics"},ve={class:"statistic-footer"},ye={class:"footer-item"},we={class:"green"},be={class:"statistic-footer"},he={class:"footer-item"},xe={class:"red"},Ce={class:"statistic-footer"},De={class:"footer-item"},Re={class:"green"},ke={class:"chart-header"},Te={__name:"statistics",setup(Le){const L=b([new Date(new Date().setDate(new Date().getDate()-30)),new Date]),S=b(""),h=b("day"),y=de({total:156,completionRate:95.6,anomalyCount:42,ticketCount:38,avgDuration:45.2}),M=b([{floor:"floor1",itemName:"地埋油罐及蓄冷罐是否正常",count:8,avgTime:2.5,priority:"high",suggestion:"建议增加日常维护频次，定期检查管道连接"},{floor:"floor2",itemName:"冷却塔是否正常",count:6,avgTime:4.2,priority:"medium",suggestion:"建议每月清洗冷却塔，检查风扇运行状态"},{floor:"floor3",itemName:"UPS设备运行状态",count:5,avgTime:1.8,priority:"high",suggestion:"建议定期进行UPS电池测试和维护"}]),$=b([{name:"张三",total:28,completed:28,completionRate:100,avgDuration:42,anomalyFoundRate:15},{name:"李四",total:25,completed:24,completionRate:96,avgDuration:48,anomalyFoundRate:12},{name:"王五",total:22,completed:20,completionRate:91,avgDuration:52,anomalyFoundRate:18},{name:"赵六",total:20,completed:17,completionRate:85,avgDuration:55,anomalyFoundRate:10}]);let u=null,c=null,f=null,_=null;const G=[{text:"最近一周",value:()=>{const o=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,o]}},{text:"最近一月",value:()=>{const o=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,o]}},{text:"最近三月",value:()=>{const o=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,o]}}],W=()=>{u=C(document.getElementById("trendChart"));const o={tooltip:{trigger:"axis"},legend:{data:["巡检次数","异常数量"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:z(h.value)},yAxis:{type:"value"},series:[{name:"巡检次数",type:"line",smooth:!0,data:[12,15,13,18,20,17,19],itemStyle:{color:"#409eff"}},{name:"异常数量",type:"line",smooth:!0,data:[2,3,1,4,2,3,2],itemStyle:{color:"#f56c6c"}}]};u.setOption(o)},q=()=>{c=C(document.getElementById("floorChart"));const o={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["巡检次数","异常次数","完成率"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:["1楼","2楼","3楼","4楼"]},yAxis:[{type:"value",name:"次数"},{type:"value",name:"完成率",max:100,axisLabel:{formatter:"{value}%"}}],series:[{name:"巡检次数",type:"bar",data:[45,38,32,28],itemStyle:{color:"#409eff"}},{name:"异常次数",type:"bar",data:[12,8,6,5],itemStyle:{color:"#f56c6c"}},{name:"完成率",type:"line",yAxisIndex:1,data:[95,92,88,90],itemStyle:{color:"#67c23a"}}]};c.setOption(o)},H=()=>{f=C(document.getElementById("anomalyChart"));const o={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:["机房温度超标","冷却塔故障","UPS告警","漏水检测","消防设备异常","油机故障","配电异常","湿度超标","门禁异常","照明故障"].reverse()},series:[{name:"异常次数",type:"bar",data:[2,3,3,4,5,6,7,8,10,12].reverse(),itemStyle:{color:new re(0,0,1,0,[{offset:0,color:"#fccb05"},{offset:1,color:"#f5804d"}])},label:{show:!0,position:"right"}}]};f.setOption(o)},J=()=>{_=C(document.getElementById("workloadChart"));const o={tooltip:{trigger:"item"},legend:{bottom:"5%",left:"center"},series:[{name:"巡检工作量",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:20,fontWeight:"bold"}},labelLine:{show:!1},data:[{value:28,name:"张三"},{value:25,name:"李四"},{value:22,name:"王五"},{value:20,name:"赵六"},{value:15,name:"其他"}]}]};_.setOption(o)},z=o=>{const e=[],w=o==="day"?7:o==="week"?4:12;for(let p=w-1;p>=0;p--){const d=new Date;o==="day"?(d.setDate(d.getDate()-p),e.push(`${d.getMonth()+1}/${d.getDate()}`)):o==="week"?(d.setDate(d.getDate()-p*7),e.push(`第${w-p}周`)):(d.setMonth(d.getMonth()-p),e.push(`${d.getMonth()+1}月`))}return e},j=()=>{D()},K=()=>{D()},Q=()=>{u&&u.setOption({xAxis:{data:z(h.value)}})},D=()=>{I.success("数据已刷新"),u&&u.resize(),c&&c.resize(),f&&f.resize(),_&&_.resize()},X=()=>{I.success("正在生成报表...")},Y=o=>{const e=N.find(w=>w.value===o);return e?e.label:o},Z=o=>({high:"danger",medium:"warning",low:"info"})[o]||"info",ee=o=>({high:"高",medium:"中",low:"低"})[o]||o,te=o=>o>=95?"success":o>=80?"":o>=60?"warning":"exception",F=()=>{u&&u.resize(),c&&c.resize(),f&&f.resize(),_&&_.resize()};return ue(async()=>{await me(),W(),q(),H(),J(),window.addEventListener("resize",F)}),pe(()=>{window.removeEventListener("resize",F),u&&(u.dispose(),u=null),c&&(c.dispose(),c=null),f&&(f.dispose(),f=null),_&&(_.dispose(),_=null)}),(o,e)=>{const w=s("el-date-picker"),p=s("el-form-item"),d=s("el-option"),ae=s("el-select"),V=s("el-button"),oe=s("el-form"),m=s("el-card"),x=s("el-statistic"),A=s("el-icon"),g=s("el-col"),B=s("el-progress"),O=s("el-row"),R=s("el-radio-button"),le=s("el-radio-group"),i=s("el-table-column"),P=s("el-tag"),E=s("el-table");return k(),U("div",ge,[t(m,{class:"filter-card"},{default:a(()=>[t(oe,{inline:!0},{default:a(()=>[t(p,{label:"统计时间"},{default:a(()=>[t(w,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=l=>L.value=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:G,onChange:j},null,8,["modelValue"])]),_:1}),t(p,{label:"楼层"},{default:a(()=>[t(ae,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=l=>S.value=l),placeholder:"全部楼层",clearable:"",onChange:K},{default:a(()=>[t(d,{label:"全部楼层",value:""}),(k(!0),U(ce,null,fe(T(N),l=>(k(),_e(d,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,null,{default:a(()=>[t(V,{type:"primary",icon:"Refresh",onClick:D},{default:a(()=>e[3]||(e[3]=[r("刷新数据")])),_:1,__:[3]}),t(V,{icon:"Download",onClick:X},{default:a(()=>e[4]||(e[4]=[r("导出报表")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1}),t(O,{gutter:20,class:"statistics-cards"},{default:a(()=>[t(g,{xs:24,sm:12,md:6},{default:a(()=>[t(m,null,{default:a(()=>[t(x,{title:"巡检总数",value:y.total},{suffix:a(()=>e[5]||(e[5]=[r("次")])),_:1},8,["value"]),n("div",ve,[n("div",ye,[e[7]||(e[7]=n("span",null,"较上期",-1)),n("span",we,[t(A,null,{default:a(()=>[t(T(ne))]),_:1}),e[6]||(e[6]=r(" 12% "))])])])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:6},{default:a(()=>[t(m,null,{default:a(()=>[t(x,{title:"完成率",value:y.completionRate,precision:1},{suffix:a(()=>e[8]||(e[8]=[r("%")])),_:1},8,["value"]),t(B,{percentage:y.completionRate,"show-text":!1},null,8,["percentage"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:6},{default:a(()=>[t(m,null,{default:a(()=>[t(x,{title:"异常发现数",value:y.anomalyCount,"value-style":"color: #cf1322"},{suffix:a(()=>e[9]||(e[9]=[r("项")])),_:1},8,["value"]),n("div",be,[n("div",he,[e[10]||(e[10]=n("span",null,"生成工单",-1)),n("span",xe,v(y.ticketCount),1)])])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:6},{default:a(()=>[t(m,null,{default:a(()=>[t(x,{title:"平均完成时长",value:y.avgDuration,precision:1},{suffix:a(()=>e[11]||(e[11]=[r("分钟")])),_:1},8,["value"]),n("div",Ce,[n("div",De,[e[13]||(e[13]=n("span",null,"较上期",-1)),n("span",Re,[t(A,null,{default:a(()=>[t(T(se))]),_:1}),e[12]||(e[12]=r(" 8% "))])])])]),_:1})]),_:1})]),_:1}),t(O,{gutter:20},{default:a(()=>[t(g,{xs:24,md:12},{default:a(()=>[t(m,{class:"chart-card"},{header:a(()=>[n("div",ke,[e[17]||(e[17]=n("span",null,"巡检完成趋势",-1)),t(le,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=l=>h.value=l),size:"small",onChange:Q},{default:a(()=>[t(R,{label:"day"},{default:a(()=>e[14]||(e[14]=[r("日")])),_:1,__:[14]}),t(R,{label:"week"},{default:a(()=>e[15]||(e[15]=[r("周")])),_:1,__:[15]}),t(R,{label:"month"},{default:a(()=>e[16]||(e[16]=[r("月")])),_:1,__:[16]})]),_:1},8,["modelValue"])])]),default:a(()=>[e[18]||(e[18]=n("div",{id:"trendChart",class:"chart-container"},null,-1))]),_:1,__:[18]})]),_:1}),t(g,{xs:24,md:12},{default:a(()=>[t(m,{class:"chart-card"},{header:a(()=>e[19]||(e[19]=[n("span",null,"各楼层巡检对比",-1)])),default:a(()=>[e[20]||(e[20]=n("div",{id:"floorChart",class:"chart-container"},null,-1))]),_:1,__:[20]})]),_:1}),t(g,{xs:24,md:12},{default:a(()=>[t(m,{class:"chart-card"},{header:a(()=>e[21]||(e[21]=[n("span",null,"异常项TOP10",-1)])),default:a(()=>[e[22]||(e[22]=n("div",{id:"anomalyChart",class:"chart-container"},null,-1))]),_:1,__:[22]})]),_:1}),t(g,{xs:24,md:12},{default:a(()=>[t(m,{class:"chart-card"},{header:a(()=>e[23]||(e[23]=[n("span",null,"巡检人员工作量",-1)])),default:a(()=>[e[24]||(e[24]=n("div",{id:"workloadChart",class:"chart-container"},null,-1))]),_:1,__:[24]})]),_:1})]),_:1}),t(m,{class:"table-card"},{header:a(()=>e[25]||(e[25]=[n("span",null,"异常处理时效分析",-1)])),default:a(()=>[t(E,{data:M.value,stripe:""},{default:a(()=>[t(i,{prop:"floor",label:"楼层",width:"80"},{default:a(l=>[r(v(Y(l.row.floor)),1)]),_:1}),t(i,{prop:"itemName",label:"检查项","show-overflow-tooltip":""}),t(i,{prop:"count",label:"异常次数",width:"90",align:"center"},{default:a(l=>[t(P,{type:"danger"},{default:a(()=>[r(v(l.row.count),1)]),_:2},1024)]),_:1}),t(i,{prop:"avgTime",label:"平均处理时长",width:"120",align:"center"},{default:a(l=>[r(v(l.row.avgTime)+"小时 ",1)]),_:1}),t(i,{prop:"priority",label:"优先级",width:"80",align:"center"},{default:a(l=>[t(P,{type:Z(l.row.priority)},{default:a(()=>[r(v(ee(l.row.priority)),1)]),_:2},1032,["type"])]),_:1}),t(i,{prop:"suggestion",label:"改进建议","show-overflow-tooltip":""})]),_:1},8,["data"])]),_:1}),t(m,{class:"table-card"},{header:a(()=>e[26]||(e[26]=[n("span",null,"巡检完成率排行",-1)])),default:a(()=>[t(E,{data:$.value,stripe:""},{default:a(()=>[t(i,{type:"index",label:"排名",width:"60",align:"center"}),t(i,{prop:"name",label:"巡检人员",width:"120"}),t(i,{prop:"total",label:"巡检次数",width:"90",align:"center"}),t(i,{prop:"completed",label:"完成次数",width:"90",align:"center"}),t(i,{prop:"completionRate",label:"完成率",width:"100",align:"center"},{default:a(l=>[t(B,{percentage:l.row.completionRate,"text-inside":!0,"stroke-width":18,status:te(l.row.completionRate)},null,8,["percentage","status"])]),_:1}),t(i,{prop:"avgDuration",label:"平均时长",width:"100",align:"center"},{default:a(l=>[r(v(l.row.avgDuration)+"分钟 ",1)]),_:1}),t(i,{prop:"anomalyFoundRate",label:"异常发现率",width:"110",align:"center"},{default:a(l=>[r(v(l.row.anomalyFoundRate)+"% ",1)]),_:1})]),_:1},8,["data"])]),_:1})])}}},Be=ie(Te,[["__scopeId","data-v-88b86135"]]);export{Be as default};
