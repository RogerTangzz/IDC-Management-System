[{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\App.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\business\\config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\business\\index.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'params' is assigned a value but never used. Allowed unused args must match /^_/u.","line":6,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 鏈€灏忓彲杩愯 API 妗╋細inspectionPlanApi\r\n * 鍚庣画鎺ュ悗绔椂锛屾妸 return 鎹㈡垚鐪熷疄 request 鍗冲彲\r\n */\r\nexport const inspectionPlanApi = {\r\n  async listDueReminders(params = {}) {\r\n    // TODO: 鎺ュ悗绔椂鏀逛负鐪熷疄璇锋眰锛歕r\n    // return request({ url: '/inspection/plan/due', method: 'get', params })\r\n    return { rows: [], total: 0 }\r\n  }\r\n}\r\n\r\n// 鍙€夛細鎶婂凡鏈夌殑 config.js 涓€骞?re-export 鍑哄幓\r\nexport * from './config.js'\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\business\\inspection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\business\\maintenance.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\business\\ticket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\business\\ticketTemplate.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\login.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\maintenance\\plan.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\menu.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\monitor\\cache.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\monitor\\job.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\monitor\\jobLog.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\monitor\\logininfor.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\monitor\\online.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\monitor\\operlog.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\monitor\\server.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\dept.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\dict\\data.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\dict\\type.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\menu.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\notice.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\post.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\role.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\system\\user.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\ticket.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\api\\tool\\gen.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Breadcrumb\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\day.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\hour.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'tabCheck' is defined but never used. Allowed unused vars must match /^_/u.","line":205,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":205,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'from' is defined but never used. Allowed unused args must match /^_/u.","line":209,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":209,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n    <div>\r\n        <el-tabs type=\"border-card\">\r\n            <el-tab-pane label=\"绉抃" v-if=\"shouldHide('second')\">\r\n                <CrontabSecond\r\n                    @update=\"updateCrontabValue\"\r\n                    :check=\"checkNumber\"\r\n                    :cron=\"crontabValueObj\"\r\n                    ref=\"cronsecond\"\r\n                />\r\n            </el-tab-pane>\r\n\r\n            <el-tab-pane label=\"鍒嗛挓\" v-if=\"shouldHide('min')\">\r\n                <CrontabMin\r\n                    @update=\"updateCrontabValue\"\r\n                    :check=\"checkNumber\"\r\n                    :cron=\"crontabValueObj\"\r\n                    ref=\"cronmin\"\r\n                />\r\n            </el-tab-pane>\r\n\r\n            <el-tab-pane label=\"灏忔椂\" v-if=\"shouldHide('hour')\">\r\n                <CrontabHour\r\n                    @update=\"updateCrontabValue\"\r\n                    :check=\"checkNumber\"\r\n                    :cron=\"crontabValueObj\"\r\n                    ref=\"cronhour\"\r\n                />\r\n            </el-tab-pane>\r\n\r\n            <el-tab-pane label=\"鏃" v-if=\"shouldHide('day')\">\r\n                <CrontabDay\r\n                    @update=\"updateCrontabValue\"\r\n                    :check=\"checkNumber\"\r\n                    :cron=\"crontabValueObj\"\r\n                    ref=\"cronday\"\r\n                />\r\n            </el-tab-pane>\r\n\r\n            <el-tab-pane label=\"鏈圽" v-if=\"shouldHide('month')\">\r\n                <CrontabMonth\r\n                    @update=\"updateCrontabValue\"\r\n                    :check=\"checkNumber\"\r\n                    :cron=\"crontabValueObj\"\r\n                    ref=\"cronmonth\"\r\n                />\r\n            </el-tab-pane>\r\n\r\n            <el-tab-pane label=\"鍛╘" v-if=\"shouldHide('week')\">\r\n                <CrontabWeek\r\n                    @update=\"updateCrontabValue\"\r\n                    :check=\"checkNumber\"\r\n                    :cron=\"crontabValueObj\"\r\n                    ref=\"cronweek\"\r\n                />\r\n            </el-tab-pane>\r\n\r\n            <el-tab-pane label=\"骞碶" v-if=\"shouldHide('year')\">\r\n                <CrontabYear\r\n                    @update=\"updateCrontabValue\"\r\n                    :check=\"checkNumber\"\r\n                    :cron=\"crontabValueObj\"\r\n                    ref=\"cronyear\"\r\n                />\r\n            </el-tab-pane>\r\n        </el-tabs>\r\n\r\n        <div class=\"popup-main\">\r\n            <div class=\"popup-result\">\r\n                <p class=\"title\">鏃堕棿琛ㄨ揪寮?/p>\r\n                <table>\r\n                    <thead>\r\n                        <tr>\r\n                            <th v-for=\"item of tabTitles\" :key=\"item\">{{item}}</th>\r\n                            <th>Cron 琛ㄨ揪寮?/th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>\r\n                                <span v-if=\"crontabValueObj.second.length < 10\">{{crontabValueObj.second}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueObj.second\" placement=\"top\"><span>{{crontabValueObj.second}}</span></el-tooltip>\r\n                            </td>\r\n                            <td>\r\n                                <span v-if=\"crontabValueObj.min.length < 10\">{{crontabValueObj.min}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueObj.min\" placement=\"top\"><span>{{crontabValueObj.min}}</span></el-tooltip>\r\n                            </td>\r\n                            <td>\r\n                                <span v-if=\"crontabValueObj.hour.length < 10\">{{crontabValueObj.hour}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueObj.hour\" placement=\"top\"><span>{{crontabValueObj.hour}}</span></el-tooltip>\r\n                            </td>\r\n                            <td>\r\n                                <span v-if=\"crontabValueObj.day.length < 10\">{{crontabValueObj.day}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueObj.day\" placement=\"top\"><span>{{crontabValueObj.day}}</span></el-tooltip>\r\n                            </td>\r\n                            <td>\r\n                                <span v-if=\"crontabValueObj.month.length < 10\">{{crontabValueObj.month}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueObj.month\" placement=\"top\"><span>{{crontabValueObj.month}}</span></el-tooltip>\r\n                            </td>\r\n                            <td>\r\n                                <span v-if=\"crontabValueObj.week.length < 10\">{{crontabValueObj.week}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueObj.week\" placement=\"top\"><span>{{crontabValueObj.week}}</span></el-tooltip>\r\n                            </td>\r\n                            <td>\r\n                                <span v-if=\"crontabValueObj.year.length < 10\">{{crontabValueObj.year}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueObj.year\" placement=\"top\"><span>{{crontabValueObj.year}}</span></el-tooltip>\r\n                            </td>\r\n                            <td class=\"result\">\r\n                                <span v-if=\"crontabValueString.length < 90\">{{crontabValueString}}</span>\r\n                                <el-tooltip v-else :content=\"crontabValueString\" placement=\"top\"><span>{{crontabValueString}}</span></el-tooltip>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n            <CrontabResult :ex=\"crontabValueString\"></CrontabResult>\r\n\r\n            <div class=\"pop_btn\">\r\n                <el-button type=\"primary\" @click=\"submitFill\">纭畾</el-button>\r\n                <el-button type=\"warning\" @click=\"clearCron\">閲嶇疆</el-button>\r\n                <el-button @click=\"hidePopup\">鍙栨秷</el-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport CrontabSecond from \"./second.vue\"\r\nimport CrontabMin from \"./min.vue\"\r\nimport CrontabHour from \"./hour.vue\"\r\nimport CrontabDay from \"./day.vue\"\r\nimport CrontabMonth from \"./month.vue\"\r\nimport CrontabWeek from \"./week.vue\"\r\nimport CrontabYear from \"./year.vue\"\r\nimport CrontabResult from \"./result.vue\"\r\nconst emit = defineEmits(['hide', 'fill'])\r\nconst props = defineProps({\r\n    hideComponent: {\r\n        type: Array,\r\n        default: () => [],\r\n    },\r\n    expression: {\r\n        type: String,\r\n        default: \"\"\r\n    }\r\n})\r\nconst tabTitles = ref([\"绉抃", \"鍒嗛挓\", \"灏忔椂\", \"鏃", \"鏈圽", \"鍛╘", \"骞碶"])\r\nconst tabActive = ref(0)\r\n// internal refs renamed to avoid shadowing prop keys (vue/no-dupe-keys)\r\nconst hideComponentRef = ref([])\r\nconst expressionRef = ref('')\r\nconst crontabValueObj = ref({\r\n    second: \"*\",\r\n    min: \"*\",\r\n    hour: \"*\",\r\n    day: \"*\",\r\n    month: \"*\",\r\n    week: \"?\",\r\n    year: \"\",\r\n})\r\nconst crontabValueString = computed(() => {\r\n    const obj = crontabValueObj.value\r\n    return obj.second\r\n        + \" \"\r\n        + obj.min\r\n        + \" \"\r\n        + obj.hour\r\n        + \" \"\r\n        + obj.day\r\n        + \" \"\r\n        + obj.month\r\n        + \" \"\r\n        + obj.week\r\n        + (obj.year === \"\" ? \"\" : \" \" + obj.year)\r\n})\r\nwatch(expressionRef, () => resolveExp())\r\nfunction shouldHide(key) {\r\n    return !(hideComponentRef.value && hideComponentRef.value.includes(key))\r\n}\r\nfunction resolveExp() {\r\n    // 鍙嶈В鏋?琛ㄨ揪寮廫r\n    if (expressionRef.value) {\r\n        const arr = expressionRef.value.split(/\\s+/)\r\n        if (arr.length >= 6) {\r\n            //6 浣嶄互涓婃槸鍚堟硶琛ㄨ揪寮廫r\n            let obj = {\r\n                second: arr[0],\r\n                min: arr[1],\r\n                hour: arr[2],\r\n                day: arr[3],\r\n                month: arr[4],\r\n                week: arr[5],\r\n                year: arr[6] ? arr[6] : \"\"\r\n            }\r\n            crontabValueObj.value = {\r\n                ...obj,\r\n            }\r\n        }\r\n    } else {\r\n        // 娌℃湁浼犲叆鐨勮〃杈惧紡 鍒欒繕鍘焅r\n        clearCron()\r\n    }\r\n}\r\n// tab鍒囨崲鍊糪r\nfunction tabCheck(index) {\r\n    tabActive.value = index\r\n}\r\n// 鐢卞瓙缁勪欢瑙﹀彂锛屾洿鏀硅〃杈惧紡缁勬垚鐨勫瓧娈靛€糪r\nfunction updateCrontabValue(name, value, from) {\r\n    crontabValueObj.value[name] = value\r\n}\r\n// 琛ㄥ崟閫夐」鐨勫瓙缁勪欢鏍￠獙鏁板瓧鏍煎紡锛堥€氳繃-props浼犻€掞級\r\nfunction checkNumber(value, minLimit, maxLimit) {\r\n    // 妫€鏌ュ繀椤讳负鏁存暟\r\n    value = Math.floor(value)\r\n    if (value < minLimit) {\r\n        value = minLimit\r\n    } else if (value > maxLimit) {\r\n        value = maxLimit\r\n    }\r\n    return value\r\n}\r\n// 闅愯棌寮圭獥\r\nfunction hidePopup() {\r\n    emit(\"hide\")\r\n}\r\n// 濉厖琛ㄨ揪寮廫r\nfunction submitFill() {\r\n    emit(\"fill\", crontabValueString.value)\r\n    hidePopup()\r\n}\r\nfunction clearCron() {\r\n    // 杩樺師閫夋嫨椤筡r\n    crontabValueObj.value = {\r\n        second: \"*\",\r\n        min: \"*\",\r\n        hour: \"*\",\r\n        day: \"*\",\r\n        month: \"*\",\r\n        week: \"?\",\r\n        year: \"\",\r\n    }\r\n}\r\nonMounted(() => {\r\n    expressionRef.value = props.expression\r\n    hideComponentRef.value = props.hideComponent\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.pop_btn {\r\n    text-align: center;\r\n    margin-top: 20px;\r\n}\r\n.popup-main {\r\n    position: relative;\r\n    margin: 10px auto;\r\n    border-radius: 5px;\r\n    font-size: 12px;\r\n    overflow: hidden;\r\n}\r\n.popup-title {\r\n    overflow: hidden;\r\n    line-height: 34px;\r\n    padding-top: 6px;\r\n    background: #f2f2f2;\r\n}\r\n.popup-result {\r\n    box-sizing: border-box;\r\n    line-height: 24px;\r\n    margin: 25px auto;\r\n    padding: 15px 10px 10px;\r\n    border: 1px solid #ccc;\r\n    position: relative;\r\n}\r\n.popup-result .title {\r\n    position: absolute;\r\n    top: -28px;\r\n    left: 50%;\r\n    width: 140px;\r\n    font-size: 14px;\r\n    margin-left: -70px;\r\n    text-align: center;\r\n    line-height: 30px;\r\n    background: #fff;\r\n}\r\n.popup-result table {\r\n    text-align: center;\r\n    width: 100%;\r\n    margin: 0 auto;\r\n}\r\n.popup-result table td:not(.result) {\r\n    width: 3.5rem;\r\n    min-width: 3.5rem;\r\n    max-width: 3.5rem;\r\n}\r\n.popup-result table span {\r\n    display: block;\r\n    width: 100%;\r\n    font-family: arial;\r\n    line-height: 30px;\r\n    height: 30px;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    border: 1px solid #e8e8e8;\r\n}\r\n.popup-result-scroll {\r\n    font-size: 12px;\r\n    line-height: 24px;\r\n    height: 10em;\r\n    overflow-y: auto;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\min.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\month.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\result.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\second.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\week.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Crontab\\year.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\DictTag\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Editor\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'file' is defined but never used. Allowed unused args must match /^_/u.","line":153,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":153,"endColumn":39}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div>\r\n    <el-upload\r\n      :action=\"uploadUrl\"\r\n      :before-upload=\"handleBeforeUpload\"\r\n      :on-success=\"handleUploadSuccess\"\r\n      :on-error=\"handleUploadError\"\r\n      name=\"file\"\r\n      :show-file-list=\"false\"\r\n      :headers=\"headers\"\r\n      class=\"editor-img-uploader\"\r\n      v-if=\"type == 'url'\"\r\n    >\r\n      <i ref=\"uploadRef\" class=\"editor-img-uploader\"></i>\r\n    </el-upload>\r\n  </div>\r\n  <div class=\"editor\">\r\n    <quill-editor\r\n      ref=\"quillEditorRef\"\r\n      v-model:content=\"content\"\r\n      contentType=\"html\"\r\n      @textChange=\"(e) => $emit('update:modelValue', content)\"\r\n      :options=\"options\"\r\n      :style=\"styles\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport axios from 'axios'\r\nimport { QuillEditor } from \"@vueup/vue-quill\"\r\nimport \"@vueup/vue-quill/dist/vue-quill.snow.css\"\r\nimport { getToken } from \"@/utils/auth\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst quillEditorRef = ref()\r\nconst uploadUrl = ref(import.meta.env.VITE_APP_BASE_API + \"/common/upload\") // 涓婁紶鐨勫浘鐗囨湇鍔″櫒鍦板潃\r\nconst headers = ref({\r\n  Authorization: \"Bearer \" + getToken()\r\n})\r\n\r\nconst props = defineProps({\r\n  /* 缂栬緫鍣ㄧ殑鍐呭 */\r\n  modelValue: {\r\n    type: String,\r\n  },\r\n  /* 楂樺害 */\r\n  height: {\r\n    type: Number,\r\n    default: null,\r\n  },\r\n  /* 鏈€灏忛珮搴?*/\r\n  minHeight: {\r\n    type: Number,\r\n    default: null,\r\n  },\r\n  /* 鍙 */\r\n  readOnly: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  /* 涓婁紶鏂囦欢澶у皬闄愬埗(MB) */\r\n  fileSize: {\r\n    type: Number,\r\n    default: 5,\r\n  },\r\n  /* 绫诲瀷锛坆ase64鏍煎紡銆乽rl鏍煎紡锛?*/\r\n  type: {\r\n    type: String,\r\n    default: \"url\",\r\n  }\r\n})\r\n\r\nconst options = ref({\r\n  theme: \"snow\",\r\n  bounds: document.body,\r\n  debug: \"warn\",\r\n  modules: {\r\n    // 宸ュ叿鏍忛厤缃甛r\n    toolbar: [\r\n      [\"bold\", \"italic\", \"underline\", \"strike\"],      // 鍔犵矖 鏂滀綋 涓嬪垝绾?鍒犻櫎绾縗r\n      [\"blockquote\", \"code-block\"],                   // 寮曠敤  浠ｇ爜鍧梊r\n      [{ list: \"ordered\" }, { list: \"bullet\" }],      // 鏈夊簭銆佹棤搴忓垪琛╘r\n      [{ indent: \"-1\" }, { indent: \"+1\" }],           // 缂╄繘\r\n      [{ size: [\"small\", false, \"large\", \"huge\"] }],  // 瀛椾綋澶у皬\r\n      [{ header: [1, 2, 3, 4, 5, 6, false] }],        // 鏍囬\r\n      [{ color: [] }, { background: [] }],            // 瀛椾綋棰滆壊銆佸瓧浣撹儗鏅鑹瞈r\n      [{ align: [] }],                                // 瀵归綈鏂瑰紡\r\n      [\"clean\"],                                      // 娓呴櫎鏂囨湰鏍煎紡\r\n      [\"link\", \"image\", \"video\"]                      // 閾炬帴銆佸浘鐗囥€佽棰慭r\n    ],\r\n  },\r\n  placeholder: \"璇疯緭鍏ュ唴瀹筡",\r\n  readOnly: props.readOnly\r\n})\r\n\r\nconst styles = computed(() => {\r\n  let style = {}\r\n  if (props.minHeight) {\r\n    style.minHeight = `${props.minHeight}px`\r\n  }\r\n  if (props.height) {\r\n    style.height = `${props.height}px`\r\n  }\r\n  return style\r\n})\r\n\r\nconst content = ref(\"\")\r\nwatch(() => props.modelValue, (v) => {\r\n  if (v !== content.value) {\r\n    content.value = v == undefined ? \"<p></p>\" : v\r\n  }\r\n}, { immediate: true })\r\n\r\n// 濡傛灉璁剧疆浜嗕笂浼犲湴鍧€鍒欒嚜瀹氫箟鍥剧墖涓婁紶浜嬩欢\r\nonMounted(() => {\r\n  if (props.type == 'url') {\r\n    let quill = quillEditorRef.value.getQuill()\r\n    let toolbar = quill.getModule(\"toolbar\")\r\n    toolbar.addHandler(\"image\", (value) => {\r\n      if (value) {\r\n        proxy.$refs.uploadRef.click()\r\n      } else {\r\n        quill.format(\"image\", false)\r\n      }\r\n    })\r\n    quill.root.addEventListener('paste', handlePasteCapture, true)\r\n  }\r\n})\r\n\r\n// 涓婁紶鍓嶆牎妫€鏍煎紡鍜屽ぇ灏廫r\nfunction handleBeforeUpload(file) {\r\n  const type = [\"image/jpeg\", \"image/jpg\", \"image/png\", \"image/svg\"]\r\n  const isJPG = type.includes(file.type)\r\n  //妫€楠屾枃浠舵牸寮廫r\n  if (!isJPG) {\r\n    proxy.$modal.msgError(`鍥剧墖鏍煎紡閿欒!`)\r\n    return false\r\n  }\r\n  // 鏍℃鏂囦欢澶у皬\r\n  if (props.fileSize) {\r\n    const isLt = file.size / 1024 / 1024 < props.fileSize\r\n    if (!isLt) {\r\n      proxy.$modal.msgError(`涓婁紶鏂囦欢澶у皬涓嶈兘瓒呰繃 ${props.fileSize} MB!`)\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\n\r\n// 涓婁紶鎴愬姛澶勭悊\r\nfunction handleUploadSuccess(res, file) {\r\n  // 濡傛灉涓婁紶鎴愬姛\r\n  if (res.code == 200) {\r\n    // 鑾峰彇瀵屾枃鏈疄渚媆r\n    let quill = toRaw(quillEditorRef.value).getQuill()\r\n    // 鑾峰彇鍏夋爣浣嶇疆\r\n    let length = quill.selection.savedRange.index\r\n    // 鎻掑叆鍥剧墖锛宺es.url涓烘湇鍔″櫒杩斿洖鐨勫浘鐗囬摼鎺ュ湴鍧€\r\n    quill.insertEmbed(length, \"image\", import.meta.env.VITE_APP_BASE_API + res.fileName)\r\n    // 璋冩暣鍏夋爣鍒版渶鍚嶾r\n    quill.setSelection(length + 1)\r\n  } else {\r\n    proxy.$modal.msgError(\"鍥剧墖鎻掑叆澶辫触\")\r\n  }\r\n}\r\n\r\n// 涓婁紶澶辫触澶勭悊\r\nfunction handleUploadError() {\r\n  proxy.$modal.msgError(\"鍥剧墖鎻掑叆澶辫触\")\r\n}\r\n\r\n// 澶嶅埗绮樿创鍥剧墖澶勭悊\r\nfunction handlePasteCapture(e) {\r\n  const clipboard = e.clipboardData || window.clipboardData\r\n  if (clipboard && clipboard.items) {\r\n    for (let i = 0; i < clipboard.items.length; i++) {\r\n      const item = clipboard.items[i]\r\n      if (item.type.indexOf('image') !== -1) {\r\n        e.preventDefault()\r\n        const file = item.getAsFile()\r\n        insertImage(file)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction insertImage(file) {\r\n  const formData = new FormData()\r\n  formData.append(\"file\", file)\r\n  axios.post(uploadUrl.value, formData, { headers: { \"Content-Type\": \"multipart/form-data\", Authorization: headers.value.Authorization } }).then(res => {\r\n    handleUploadSuccess(res.data)\r\n  })\r\n}\r\n</script>\r\n\r\n<style>\r\n.editor-img-uploader {\r\n  display: none;\r\n}\r\n.editor, .ql-toolbar {\r\n  white-space: pre-wrap !important;\r\n  line-height: normal !important;\r\n}\r\n.quill-img {\r\n  display: none;\r\n}\r\n.ql-snow .ql-tooltip[data-mode=\"link\"]::before {\r\n  content: \"璇疯緭鍏ラ摼鎺ュ湴鍧€:\";\r\n}\r\n.ql-snow .ql-tooltip.ql-editing a.ql-action::after {\r\n  border-right: 0px;\r\n  content: \"淇濆瓨\";\r\n  padding-right: 0px;\r\n}\r\n.ql-snow .ql-tooltip[data-mode=\"video\"]::before {\r\n  content: \"璇疯緭鍏ヨ棰戝湴鍧€:\";\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item::before {\r\n  content: \"14px\";\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=\"small\"]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"small\"]::before {\r\n  content: \"10px\";\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=\"large\"]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"large\"]::before {\r\n  content: \"18px\";\r\n}\r\n.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=\"huge\"]::before,\r\n.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=\"huge\"]::before {\r\n  content: \"32px\";\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item::before {\r\n  content: \"鏂囨湰\";\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"1\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"1\"]::before {\r\n  content: \"鏍囬1\";\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"2\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"2\"]::before {\r\n  content: \"鏍囬2\";\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"3\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"3\"]::before {\r\n  content: \"鏍囬3\";\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"4\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"4\"]::before {\r\n  content: \"鏍囬4\";\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"5\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"5\"]::before {\r\n  content: \"鏍囬5\";\r\n}\r\n.ql-snow .ql-picker.ql-header .ql-picker-label[data-value=\"6\"]::before,\r\n.ql-snow .ql-picker.ql-header .ql-picker-item[data-value=\"6\"]::before {\r\n  content: \"鏍囬6\";\r\n}\r\n.ql-snow .ql-picker.ql-font .ql-picker-label::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item::before {\r\n  content: \"鏍囧噯瀛椾綋\";\r\n}\r\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=\"serif\"]::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=\"serif\"]::before {\r\n  content: \"琛嚎瀛椾綋\";\r\n}\r\n.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=\"monospace\"]::before,\r\n.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=\"monospace\"]::before {\r\n  content: \"绛夊瀛椾綋\";\r\n}\r\n</style>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\FileUpload\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used. Allowed unused args must match /^_/u.","line":145,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":145,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"upload-file\">\r\n    <el-upload multiple :action=\"uploadFileUrl\" :before-upload=\"handleBeforeUpload\" :file-list=\"fileList\" :data=\"data\"\r\n      :limit=\"limit\" :on-error=\"handleUploadError\" :on-exceed=\"handleExceed\" :on-success=\"handleUploadSuccess\"\r\n      :show-file-list=\"false\" :headers=\"headers\" class=\"upload-file-uploader\" ref=\"fileUpload\" v-if=\"!disabled\">\r\n      <!-- 涓婁紶鎸夐挳 -->\r\n      <el-button type=\"primary\">閫夊彇鏂囦欢</el-button>\r\n    </el-upload>\r\n    <!-- 涓婁紶鎻愮ず -->\r\n    <div class=\"el-upload__tip\" v-if=\"showTip && !disabled\">\r\n      璇蜂笂浼燶r\n      <template v-if=\"fileSize\"> 澶у皬涓嶈秴杩?<b style=\"color: #f56c6c\">{{ fileSize }}MB</b> </template>\r\n      <template v-if=\"fileType\"> 鏍煎紡涓?<b style=\"color: #f56c6c\">{{ fileType.join(\"/\") }}</b> </template>\r\n      鐨勬枃浠禱r\n    </div>\r\n    <!-- 鏂囦欢鍒楄〃 -->\r\n    <transition-group ref=\"uploadFileList\" class=\"upload-file-list el-upload-list el-upload-list--text\"\r\n      name=\"el-fade-in-linear\" tag=\"ul\">\r\n      <li :key=\"file.uid\" class=\"el-upload-list__item ele-upload-list__item-content\" v-for=\"(file, index) in fileList\">\r\n        <el-link :href=\"`${baseUrl}${file.url}`\" :underline=\"false\" target=\"_blank\">\r\n          <span class=\"el-icon-document\"> {{ getFileName(file.name) }} </span>\r\n        </el-link>\r\n        <div class=\"ele-upload-list__item-content-action\">\r\n          <el-link :underline=\"false\" @click=\"handleDelete(index)\" type=\"danger\" v-if=\"!disabled\">&nbsp;鍒犻櫎</el-link>\r\n        </div>\r\n      </li>\r\n    </transition-group>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { getToken } from \"@/utils/auth\"\r\nimport Sortable from 'sortablejs'\r\n\r\nconst props = defineProps({\r\n  modelValue: [String, Object, Array],\r\n  // 涓婁紶鎺ュ彛鍦板潃\r\n  action: {\r\n    type: String,\r\n    default: \"/common/upload\"\r\n  },\r\n  // 涓婁紶鎼哄甫鐨勫弬鏁癨r\n  data: {\r\n    type: Object\r\n  },\r\n  // 鏁伴噺闄愬埗\r\n  limit: {\r\n    type: Number,\r\n    default: 5\r\n  },\r\n  // 澶у皬闄愬埗(MB)\r\n  fileSize: {\r\n    type: Number,\r\n    default: 5\r\n  },\r\n  // 鏂囦欢绫诲瀷, 渚嬪['png', 'jpg', 'jpeg']\r\n  fileType: {\r\n    type: Array,\r\n    default: () => [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"txt\", \"pdf\"]\r\n  },\r\n  // 鏄惁鏄剧ず鎻愮ず\r\n  isShowTip: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  // 绂佺敤缁勪欢锛堜粎鏌ョ湅鏂囦欢锛塡r\n  disabled: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  // 鎷栧姩鎺掑簭\r\n  drag: {\r\n    type: Boolean,\r\n    default: true\r\n  }\r\n})\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst emit = defineEmits(['update:modelValue'])\r\nconst number = ref(0)\r\nconst uploadList = ref([])\r\nconst baseUrl = import.meta.env.VITE_APP_BASE_API\r\nconst uploadFileUrl = ref(import.meta.env.VITE_APP_BASE_API + props.action) // 涓婁紶鏂囦欢鏈嶅姟鍣ㄥ湴鍧€\r\nconst headers = ref({ Authorization: \"Bearer \" + getToken() })\r\nconst fileList = ref([])\r\nconst showTip = computed(\r\n  () => props.isShowTip && (props.fileType || props.fileSize)\r\n)\r\n\r\nwatch(() => props.modelValue, val => {\r\n  if (val) {\r\n    let temp = 1\r\n    // 棣栧厛灏嗗€艰浆涓烘暟缁刓r\n    const list = Array.isArray(val) ? val : props.modelValue.split(',')\r\n    // 鐒跺悗灏嗘暟缁勮浆涓哄璞℃暟缁刓r\n    fileList.value = list.map(item => {\r\n      if (typeof item === \"string\") {\r\n        item = { name: item, url: item }\r\n      }\r\n      item.uid = item.uid || new Date().getTime() + temp++\r\n      return item\r\n    })\r\n  } else {\r\n    fileList.value = []\r\n    return []\r\n  }\r\n}, { deep: true, immediate: true })\r\n\r\n// 涓婁紶鍓嶆牎妫€鏍煎紡鍜屽ぇ灏廫r\nfunction handleBeforeUpload(file) {\r\n  // 鏍℃鏂囦欢绫诲瀷\r\n  if (props.fileType.length) {\r\n    const fileName = file.name.split('.')\r\n    const fileExt = fileName[fileName.length - 1]\r\n    const isTypeOk = props.fileType.indexOf(fileExt) >= 0\r\n    if (!isTypeOk) {\r\n      proxy.$modal.msgError(`鏂囦欢鏍煎紡涓嶆纭紝璇蜂笂浼?{props.fileType.join(\"/\")}鏍煎紡鏂囦欢!`)\r\n      return false\r\n    }\r\n  }\r\n  // 鏍℃鏂囦欢鍚嶆槸鍚﹀寘鍚壒娈婂瓧绗r\n  if (file.name.includes(',')) {\r\n    proxy.$modal.msgError('鏂囦欢鍚嶄笉姝ｇ‘锛屼笉鑳藉寘鍚嫳鏂囬€楀彿!')\r\n    return false\r\n  }\r\n  // 鏍℃鏂囦欢澶у皬\r\n  if (props.fileSize) {\r\n    const isLt = file.size / 1024 / 1024 < props.fileSize\r\n    if (!isLt) {\r\n      proxy.$modal.msgError(`涓婁紶鏂囦欢澶у皬涓嶈兘瓒呰繃 ${props.fileSize} MB!`)\r\n      return false\r\n    }\r\n  }\r\n  proxy.$modal.loading(\"姝ｅ湪涓婁紶鏂囦欢锛岃绋嶅€?..\")\r\n  number.value++\r\n  return true\r\n}\r\n\r\n// 鏂囦欢涓暟瓒呭嚭\r\nfunction handleExceed() {\r\n  proxy.$modal.msgError(`涓婁紶鏂囦欢鏁伴噺涓嶈兘瓒呰繃 ${props.limit} 涓?`)\r\n}\r\n\r\n// 涓婁紶澶辫触\r\nfunction handleUploadError(err) {\r\n  proxy.$modal.msgError(\"涓婁紶鏂囦欢澶辫触\")\r\n  proxy.$modal.closeLoading()\r\n}\r\n\r\n// 涓婁紶鎴愬姛鍥炶皟\r\nfunction handleUploadSuccess(res, file) {\r\n  if (res.code === 200) {\r\n    uploadList.value.push({ name: res.fileName, url: res.fileName })\r\n    uploadedSuccessfully()\r\n  } else {\r\n    number.value--\r\n    proxy.$modal.closeLoading()\r\n    proxy.$modal.msgError(res.msg)\r\n    proxy.$refs.fileUpload.handleRemove(file)\r\n    uploadedSuccessfully()\r\n  }\r\n}\r\n\r\n// 鍒犻櫎鏂囦欢\r\nfunction handleDelete(index) {\r\n  fileList.value.splice(index, 1)\r\n  emit(\"update:modelValue\", listToString(fileList.value))\r\n}\r\n\r\n// 涓婁紶缁撴潫澶勭悊\r\nfunction uploadedSuccessfully() {\r\n  if (number.value > 0 && uploadList.value.length === number.value) {\r\n    fileList.value = fileList.value.filter(f => f.url !== undefined).concat(uploadList.value)\r\n    uploadList.value = []\r\n    number.value = 0\r\n    emit(\"update:modelValue\", listToString(fileList.value))\r\n    proxy.$modal.closeLoading()\r\n  }\r\n}\r\n\r\n// 鑾峰彇鏂囦欢鍚嶇О\r\nfunction getFileName(name) {\r\n  // 濡傛灉鏄痷rl閭ｄ箞鍙栨渶鍚庣殑鍚嶅瓧 濡傛灉涓嶆槸鐩存帴杩斿洖\r\n  if (name.lastIndexOf(\"/\") > -1) {\r\n    return name.slice(name.lastIndexOf(\"/\") + 1)\r\n  } else {\r\n    return name\r\n  }\r\n}\r\n\r\n// 瀵硅薄杞垚鎸囧畾瀛楃涓插垎闅擻r\nfunction listToString(list, separator) {\r\n  let strs = \"\"\r\n  separator = separator || \",\"\r\n  for (let i in list) {\r\n    if (list[i].url) {\r\n      strs += list[i].url + separator\r\n    }\r\n  }\r\n  return strs != '' ? strs.substr(0, strs.length - 1) : ''\r\n}\r\n\r\n// 鍒濆鍖栨嫋鎷芥帓搴廫r\nonMounted(() => {\r\n  if (props.drag && !props.disabled) {\r\n    nextTick(() => {\r\n      const element = proxy.$refs.uploadFileList?.$el || proxy.$refs.uploadFileList\r\n      Sortable.create(element, {\r\n        ghostClass: 'file-upload-darg',\r\n        onEnd: (evt) => {\r\n          const movedItem = fileList.value.splice(evt.oldIndex, 1)[0]\r\n          fileList.value.splice(evt.newIndex, 0, movedItem)\r\n          emit('update:modelValue', listToString(fileList.value))\r\n        }\r\n      })\r\n    })\r\n  }\r\n})\r\n</script>\r\n<style scoped lang=\"scss\">\r\n.file-upload-darg {\r\n  opacity: 0.5;\r\n  background: #c8ebfb;\r\n}\r\n\r\n.upload-file-uploader {\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.upload-file-list .el-upload-list__item {\r\n  border: 1px solid #e4e7ed;\r\n  line-height: 2;\r\n  margin-bottom: 10px;\r\n  position: relative;\r\n  transition: none !important;\r\n}\r\n\r\n.upload-file-list .ele-upload-list__item-content {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  color: inherit;\r\n}\r\n\r\n.ele-upload-list__item-content-action .el-link {\r\n  margin-right: 10px;\r\n}\r\n</style>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Hamburger\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\HeaderSearch\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\IconSelect\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'props' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":29,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"icon-body\">\r\n    <el-input\r\n      v-model=\"iconName\"\r\n      class=\"icon-search\"\r\n      clearable\r\n      placeholder=\"璇疯緭鍏ュ浘鏍囧悕绉癨"\r\n      @clear=\"filterIcons\"\r\n      @input=\"filterIcons\"\r\n    >\r\n      <template #suffix><i class=\"el-icon-search el-input__icon\" /></template>\r\n    </el-input>\r\n    <div class=\"icon-list\">\r\n      <div class=\"list-container\">\r\n        <div v-for=\"(item, index) in iconList\" class=\"icon-item-wrapper\" :key=\"index\" @click=\"selectedIcon(item)\">\r\n          <div :class=\"['icon-item', { active: activeIcon === item }]\">\r\n            <svg-icon :icon-class=\"item\" class-name=\"icon\" style=\"height: 25px;width: 16px;\"/>\r\n            <span>{{ item }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport icons from './requireIcons'\r\n\r\nconst props = defineProps({\r\n  activeIcon: {\r\n    type: String\r\n  }\r\n})\r\n\r\nconst iconName = ref('')\r\nconst iconList = ref(icons)\r\nconst emit = defineEmits(['selected'])\r\n\r\nfunction filterIcons() {\r\n  iconList.value = icons\r\n  if (iconName.value) {\r\n    iconList.value = icons.filter(item => item.indexOf(iconName.value) !== -1)\r\n  }\r\n}\r\n\r\nfunction selectedIcon(name) {\r\n  emit('selected', name)\r\n  document.body.click()\r\n}\r\n\r\nfunction reset() {\r\n  iconName.value = ''\r\n  iconList.value = icons\r\n}\r\n\r\ndefineExpose({\r\n  reset\r\n})\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n   .icon-body {\r\n    width: 100%;\r\n    padding: 10px;\r\n    .icon-search {\r\n      position: relative;\r\n      margin-bottom: 5px;\r\n    }\r\n    .icon-list {\r\n      height: 200px;\r\n      overflow: auto;\r\n      .list-container {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        .icon-item-wrapper {\r\n          width: calc(100% / 3);\r\n          height: 25px;\r\n          line-height: 25px;\r\n          cursor: pointer;\r\n          display: flex;\r\n          .icon-item {\r\n            display: flex;\r\n            max-width: 100%;\r\n            height: 100%;\r\n            padding: 0 5px;\r\n            &:hover {\r\n              background: #ececec;\r\n              border-radius: 5px;\r\n            }\r\n            .icon {\r\n              flex-shrink: 0;\r\n            }\r\n            span {\r\n              display: inline-block;\r\n              vertical-align: -0.15em;\r\n              fill: currentColor;\r\n              padding-left: 2px;\r\n              overflow: hidden;\r\n              text-overflow: ellipsis;\r\n              white-space: nowrap;\r\n            }\r\n          }\r\n          .icon-item.active {\r\n            background: #ececec;\r\n            border-radius: 5px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\IconSelect\\requireIcons.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\ImagePreview\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\ImageUpload\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Pagination\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\ParentView\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\RightToolbar\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\RuoYi\\Doc\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\RuoYi\\Git\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Screenfull\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'enter' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":10,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'exit' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":10,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div>\r\n    <svg-icon :icon-class=\"isFullscreen ? 'exit-fullscreen' : 'fullscreen'\" @click=\"toggle\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useFullscreen } from '@vueuse/core'\r\n\r\nconst { isFullscreen, enter, exit, toggle } = useFullscreen()\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n.screenfull-svg {\r\n  display: inline-block;\r\n  cursor: pointer;\r\n  fill: #5a5e66;\r\n  width: 20px;\r\n  height: 20px;\r\n  vertical-align: 10px;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\SizeSelect\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'route' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":23,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'router' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":24,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div>\r\n    <el-dropdown trigger=\"click\" @command=\"handleSetSize\">\r\n      <div class=\"size-icon--style\">\r\n        <svg-icon class-name=\"size-icon\" icon-class=\"size\" />\r\n      </div>\r\n      <template #dropdown>\r\n        <el-dropdown-menu>\r\n          <el-dropdown-item v-for=\"item of sizeOptions\" :key=\"item.value\" :disabled=\"size === item.value\" :command=\"item.value\">\r\n            {{ item.label }}\r\n          </el-dropdown-item>\r\n        </el-dropdown-menu>\r\n      </template>\r\n    </el-dropdown>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport useAppStore from \"@/store/modules/app\"\r\n\r\nconst appStore = useAppStore()\r\nconst size = computed(() => appStore.size)\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst { proxy } = getCurrentInstance()\r\nconst sizeOptions = ref([\r\n  { label: \"杈冨ぇ\", value: \"large\" },\r\n  { label: \"榛樿\", value: \"default\" },\r\n  { label: \"绋嶅皬\", value: \"small\" },\r\n])\r\n\r\nfunction handleSetSize(size) {\r\n  proxy.$modal.loading(\"姝ｅ湪璁剧疆甯冨眬澶у皬锛岃绋嶅€?..\")\r\n  appStore.setSize(size)\r\n  setTimeout(\"window.location.reload()\", 1000)\r\n}\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n.size-icon--style {\r\n  font-size: 18px;\r\n  line-height: 50px;\r\n  padding-right: 7px;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\Status\\StatusTag.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\SvgIcon\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\SvgIcon\\svgicon.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\TopNav\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'keyPath' is defined but never used. Allowed unused args must match /^_/u.","line":120,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":120,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <el-menu\r\n    :default-active=\"activeMenu\"\r\n    mode=\"horizontal\"\r\n    @select=\"handleSelect\"\r\n    :ellipsis=\"false\"\r\n  >\r\n    <template v-for=\"(item, index) in topMenus\">\r\n      <el-menu-item :style=\"{'--theme': theme}\" :index=\"item.path\" :key=\"index\" v-if=\"index < visibleNumber\">\r\n        <svg-icon\r\n        v-if=\"item.meta && item.meta.icon && item.meta.icon !== '#'\"\r\n        :icon-class=\"item.meta.icon\"/>\r\n        {{ item.meta.title }}\r\n      </el-menu-item>\r\n    </template>\r\n\r\n    <!-- 椤堕儴鑿滃崟瓒呭嚭鏁伴噺鎶樺彔 -->\r\n    <el-sub-menu :style=\"{'--theme': theme}\" index=\"more\" v-if=\"topMenus.length > visibleNumber\">\r\n      <template #title>鏇村鑿滃崟</template>\r\n      <template v-for=\"(item, index) in topMenus\">\r\n        <el-menu-item\r\n          :index=\"item.path\"\r\n          :key=\"index\"\r\n          v-if=\"index >= visibleNumber\">\r\n        <svg-icon\r\n          v-if=\"item.meta && item.meta.icon && item.meta.icon !== '#'\"\r\n          :icon-class=\"item.meta.icon\"/>\r\n        {{ item.meta.title }}\r\n        </el-menu-item>\r\n      </template>\r\n    </el-sub-menu>\r\n  </el-menu>\r\n</template>\r\n\r\n<script setup>\r\nimport { constantRoutes } from \"@/router\"\r\nimport { isHttp } from '@/utils/validate'\r\nimport useAppStore from '@/store/modules/app'\r\nimport useSettingsStore from '@/store/modules/settings'\r\nimport usePermissionStore from '@/store/modules/permission'\r\n\r\n// 椤堕儴鏍忓垵濮嬫暟\r\nconst visibleNumber = ref(null)\r\n// 褰撳墠婵€娲昏彍鍗曠殑 index\r\nconst currentIndex = ref(null)\r\n// 闅愯棌渚ц竟鏍忚矾鐢盶r\nconst hideList = ['/index', '/user/profile']\r\n\r\nconst appStore = useAppStore()\r\nconst settingsStore = useSettingsStore()\r\nconst permissionStore = usePermissionStore()\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\n// 涓婚棰滆壊\r\nconst theme = computed(() => settingsStore.theme)\r\n// 鎵€鏈夌殑璺敱淇℃伅\r\nconst routers = computed(() => permissionStore.topbarRouters)\r\n\r\n// 椤堕儴鏄剧ず鑿滃崟\r\nconst topMenus = computed(() => {\r\n  let topMenus = []\r\n  routers.value.map((menu) => {\r\n    if (menu.hidden !== true) {\r\n      // 鍏煎椤堕儴鏍忎竴绾ц彍鍗曞唴閮ㄨ烦杞琝r\n      if (menu.path === '/' && menu.children) {\r\n          topMenus.push(menu.children[0])\r\n      } else {\r\n          topMenus.push(menu)\r\n      }\r\n    }\r\n  })\r\n  return topMenus\r\n})\r\n\r\n// 璁剧疆瀛愯矾鐢盶r\nconst childrenMenus = computed(() => {\r\n  let childrenMenus = []\r\n  routers.value.map((router) => {\r\n    for (let item in router.children) {\r\n      if (router.children[item].parentPath === undefined) {\r\n        if(router.path === \"/\") {\r\n          router.children[item].path = \"/\" + router.children[item].path\r\n        } else {\r\n          if(!isHttp(router.children[item].path)) {\r\n            router.children[item].path = router.path + \"/\" + router.children[item].path\r\n          }\r\n        }\r\n        router.children[item].parentPath = router.path\r\n      }\r\n      childrenMenus.push(router.children[item])\r\n    }\r\n  })\r\n  return constantRoutes.concat(childrenMenus)\r\n})\r\n\r\n// 榛樿婵€娲荤殑鑿滃崟\r\nconst activeMenu = computed(() => {\r\n  const path = route.path\r\n  let activePath = path\r\n  if (path !== undefined && path.lastIndexOf(\"/\") > 0 && hideList.indexOf(path) === -1) {\r\n    const tmpPath = path.substring(1, path.length)\r\n    if (!route.meta.link) {\r\n      activePath = \"/\" + tmpPath.substring(0, tmpPath.indexOf(\"/\"))\r\n      appStore.toggleSideBarHide(false)\r\n    }\r\n  } else if(!route.children) {\r\n    activePath = path\r\n    appStore.toggleSideBarHide(true)\r\n  }\r\n  activeRoutes(activePath)\r\n  return activePath\r\n})\r\n\r\nfunction setVisibleNumber() {\r\n  const width = document.body.getBoundingClientRect().width / 3\r\n  visibleNumber.value = parseInt(width / 85)\r\n}\r\n\r\nfunction handleSelect(key, keyPath) {\r\n  currentIndex.value = key\r\n  const route = routers.value.find(item => item.path === key)\r\n  if (isHttp(key)) {\r\n    // http(s):// 璺緞鏂扮獥鍙ｆ墦寮€\r\n    window.open(key, \"_blank\")\r\n  } else if (!route || !route.children) {\r\n    // 娌℃湁瀛愯矾鐢辫矾寰勫唴閮ㄦ墦寮€\r\n    const routeMenu = childrenMenus.value.find(item => item.path === key)\r\n    if (routeMenu && routeMenu.query) {\r\n      let query = JSON.parse(routeMenu.query)\r\n      router.push({ path: key, query: query })\r\n    } else {\r\n      router.push({ path: key })\r\n    }\r\n    appStore.toggleSideBarHide(true)\r\n  } else {\r\n    // 鏄剧ず宸︿晶鑱斿姩鑿滃崟\r\n    activeRoutes(key)\r\n    appStore.toggleSideBarHide(false)\r\n  }\r\n}\r\n\r\nfunction activeRoutes(key) {\r\n  let routes = []\r\n  if (childrenMenus.value && childrenMenus.value.length > 0) {\r\n    childrenMenus.value.map((item) => {\r\n      if (key == item.parentPath || (key == \"index\" && \"\" == item.path)) {\r\n        routes.push(item)\r\n      }\r\n    })\r\n  }\r\n  if(routes.length > 0) {\r\n    permissionStore.setSidebarRouters(routes)\r\n  } else {\r\n    appStore.toggleSideBarHide(true)\r\n  }\r\n  return routes\r\n}\r\n\r\nonMounted(() => {\r\n  window.addEventListener('resize', setVisibleNumber)\r\n})\r\n\r\nonBeforeUnmount(() => {\r\n  window.removeEventListener('resize', setVisibleNumber)\r\n})\r\n\r\nonMounted(() => {\r\n  setVisibleNumber()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.topmenu-container.el-menu--horizontal > .el-menu-item {\r\n  float: left;\r\n  height: 50px !important;\r\n  line-height: 50px !important;\r\n  color: #999093 !important;\r\n  padding: 0 5px !important;\r\n  margin: 0 10px !important;\r\n}\r\n\r\n.topmenu-container.el-menu--horizontal > .el-menu-item.is-active, .el-menu--horizontal > .el-sub-menu.is-active .el-submenu__title {\r\n  border-bottom: 2px solid #{'var(--theme)'} !important;\r\n  color: #303133;\r\n}\r\n\r\n/* sub-menu item */\r\n.topmenu-container.el-menu--horizontal > .el-sub-menu .el-sub-menu__title {\r\n  float: left;\r\n  height: 50px !important;\r\n  line-height: 50px !important;\r\n  color: #999093 !important;\r\n  padding: 0 5px !important;\r\n  margin: 0 10px !important;\r\n}\r\n\r\n/* 鑳屾櫙鑹查殣钘?*/\r\n.topmenu-container.el-menu--horizontal>.el-menu-item:not(.is-disabled):focus, .topmenu-container.el-menu--horizontal>.el-menu-item:not(.is-disabled):hover, .topmenu-container.el-menu--horizontal>.el-submenu .el-submenu__title:hover {\r\n  background-color: #ffffff;\r\n}\r\n\r\n/* 鍥炬爣鍙抽棿璺?*/\r\n.topmenu-container .svg-icon {\r\n  margin-right: 4px;\r\n}\r\n\r\n/* topmenu more arrow */\r\n.topmenu-container .el-sub-menu .el-sub-menu__icon-arrow {\r\n  position: static;\r\n  vertical-align: middle;\r\n  margin-left: 8px;\r\n  margin-top: 0px;\r\n}\r\n\r\n\r\n</style>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\components\\iFrame\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\directive\\common\\copyText.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":54,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n* v-copyText 澶嶅埗鏂囨湰鍐呭\r\n* Copyright (c) 2022 ruoyi\r\n*/\r\nexport default {\r\n  beforeMount(el, { value, arg }) {\r\n    if (arg === \"callback\") {\r\n      el.$copyCallback = value\r\n    } else {\r\n      el.$copyValue = value\r\n      const handler = () => {\r\n        copyTextToClipboard(el.$copyValue)\r\n        if (el.$copyCallback) {\r\n          el.$copyCallback(el.$copyValue)\r\n        }\r\n      }\r\n      el.addEventListener(\"click\", handler)\r\n      el.$destroyCopy = () => el.removeEventListener(\"click\", handler)\r\n    }\r\n  },\r\n  unmounted(el) {\r\n    // 娓呯悊浜嬩欢鐩戝惉锛岄伩鍏嶅唴瀛樻硠婕廫r\n    el.$destroyCopy && el.$destroyCopy()\r\n  }\r\n}\r\n\r\nfunction copyTextToClipboard(input, { target = document.body } = {}) {\r\n  const element = document.createElement('textarea')\r\n  const previouslyFocusedElement = document.activeElement\r\n\r\n  element.value = input\r\n\r\n  // Prevent keyboard from showing on mobile\r\n  element.setAttribute('readonly', '')\r\n\r\n  element.style.contain = 'strict'\r\n  element.style.position = 'absolute'\r\n  element.style.left = '-9999px'\r\n  element.style.fontSize = '12pt' // Prevent zooming on iOS\r\n\r\n  const selection = document.getSelection()\r\n  const originalRange = selection.rangeCount > 0 && selection.getRangeAt(0)\r\n\r\n  target.append(element)\r\n  element.select()\r\n\r\n  // Explicit selection workaround for iOS\r\n  element.selectionStart = 0\r\n  element.selectionEnd = input.length\r\n\r\n  let isSuccess = false\r\n  try {\r\n    isSuccess = document.execCommand('copy')\r\n  } catch (e) {\r\n    // 蹇界暐澶嶅埗澶辫触锛堝彲鑳界敱浜庢祻瑙堝櫒闄愬埗锛塡r\n  }\r\n\r\n  element.remove()\r\n\r\n  if (originalRange) {\r\n    selection.removeAllRanges()\r\n    selection.addRange(originalRange)\r\n  }\r\n\r\n  // Get the focus back on the previously focused element, if any\r\n  if (previouslyFocusedElement) {\r\n    previouslyFocusedElement.focus()\r\n  }\r\n\r\n  return isSuccess\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\directive\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\directive\\permission\\hasPermi.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'vnode' is defined but never used. Allowed unused args must match /^_/u.","line":8,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":" /**\r\n * v-hasPermi 鎿嶄綔鏉冮檺澶勭悊\r\n * Copyright (c) 2019 ruoyi\r\n */\r\nimport useUserStore from '@/store/modules/user'\r\n\r\nexport default {\r\n  mounted(el, binding, vnode) {\r\n    const { value } = binding\r\n    const all_permission = \"*:*:*\"\r\n    const permissions = useUserStore().permissions\r\n\r\n    if (value && value instanceof Array && value.length > 0) {\r\n      const permissionFlag = value\r\n\r\n      const hasPermissions = permissions.some(permission => {\r\n        return all_permission === permission || permissionFlag.includes(permission)\r\n      })\r\n\r\n      if (!hasPermissions) {\r\n        el.parentNode && el.parentNode.removeChild(el)\r\n      }\r\n    } else {\r\n      throw new Error(`璇疯缃搷浣滄潈闄愭爣绛惧€糮)\r\n    }\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\directive\\permission\\hasRole.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'vnode' is defined but never used. Allowed unused args must match /^_/u.","line":8,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":" /**\r\n * v-hasRole 瑙掕壊鏉冮檺澶勭悊\r\n * Copyright (c) 2019 ruoyi\r\n */\r\nimport useUserStore from '@/store/modules/user'\r\n\r\nexport default {\r\n  mounted(el, binding, vnode) {\r\n    const { value } = binding\r\n    const super_admin = \"admin\"\r\n    const roles = useUserStore().roles\r\n\r\n    if (value && value instanceof Array && value.length > 0) {\r\n      const roleFlag = value\r\n\r\n      const hasRole = roles.some(role => {\r\n        return super_admin === role || roleFlag.includes(role)\r\n      })\r\n\r\n      if (!hasRole) {\r\n        el.parentNode && el.parentNode.removeChild(el)\r\n      }\r\n    } else {\r\n      throw new Error(`璇疯缃鑹叉潈闄愭爣绛惧€糮)\r\n    }\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\AppMain.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\Copyright\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\IframeToggle\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\InnerLink\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'props' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":14,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div :style=\"'height:' + height\" v-loading=\"loading\" element-loading-text=\"姝ｅ湪鍔犺浇椤甸潰锛岃绋嶅€欙紒\">\r\n    <iframe\r\n      :id=\"iframeId\"\r\n      style=\"width: 100%; height: 100%\"\r\n      :src=\"src\"\r\n      ref=\"iframeRef\"\r\n      frameborder=\"no\"\r\n    ></iframe>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nconst props = defineProps({\r\n  src: {\r\n    type: String,\r\n    default: \"/\"\r\n  },\r\n  iframeId: {\r\n    type: String\r\n  }\r\n})\r\n\r\nconst loading = ref(true)\r\nconst height = ref(document.documentElement.clientHeight - 94.5 + 'px')\r\nconst iframeRef = ref(null)\r\n\r\nonMounted(() => {\r\n  if (iframeRef.value) {\r\n    iframeRef.value.onload = () => {\r\n      loading.value = false\r\n    }\r\n  }\r\n})\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\Navbar.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\Settings\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\Sidebar\\Link.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\Sidebar\\Logo.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\Sidebar\\SidebarItem.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\Sidebar\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\TagsView\\ScrollPane.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\TagsView\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":105,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":105,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":113,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":113,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div id=\"tags-view-container\" class=\"tags-view-container\">\r\n    <scroll-pane ref=\"scrollPaneRef\" class=\"tags-view-wrapper\" @scroll=\"handleScroll\">\r\n      <router-link\r\n        v-for=\"tag in visitedViews\"\r\n        :key=\"tag.path\"\r\n        :data-path=\"tag.path\"\r\n        :class=\"{ 'active': isActive(tag), 'has-icon': tagsIcon }\"\r\n        :to=\"{ path: tag.path, query: tag.query, fullPath: tag.fullPath }\"\r\n        class=\"tags-view-item\"\r\n        :style=\"activeStyle(tag)\"\r\n        @click.middle=\"!isAffix(tag) ? closeSelectedTag(tag) : ''\"\r\n        @contextmenu.prevent=\"openMenu(tag, $event)\"\r\n      >\r\n        <svg-icon v-if=\"tagsIcon && tag.meta && tag.meta.icon && tag.meta.icon !== '#'\" :icon-class=\"tag.meta.icon\" />\r\n        {{ tag.title }}\r\n        <span v-if=\"!isAffix(tag)\" @click.prevent.stop=\"closeSelectedTag(tag)\">\r\n          <close class=\"el-icon-close\" style=\"width: 1em; height: 1em;vertical-align: middle;\" />\r\n        </span>\r\n      </router-link>\r\n    </scroll-pane>\r\n    <ul v-show=\"visible\" :style=\"{ left: left + 'px', top: top + 'px' }\" class=\"contextmenu\">\r\n      <li @click=\"refreshSelectedTag(selectedTag)\">\r\n        <refresh-right style=\"width: 1em; height: 1em;\" /> 鍒锋柊椤甸潰\r\n      </li>\r\n      <li v-if=\"!isAffix(selectedTag)\" @click=\"closeSelectedTag(selectedTag)\">\r\n        <close style=\"width: 1em; height: 1em;\" /> 鍏抽棴褰撳墠\r\n      </li>\r\n      <li @click=\"closeOthersTags\">\r\n        <circle-close style=\"width: 1em; height: 1em;\" /> 鍏抽棴鍏朵粬\r\n      </li>\r\n      <li v-if=\"!isFirstView()\" @click=\"closeLeftTags\">\r\n        <back style=\"width: 1em; height: 1em;\" /> 鍏抽棴宸︿晶\r\n      </li>\r\n      <li v-if=\"!isLastView()\" @click=\"closeRightTags\">\r\n        <right style=\"width: 1em; height: 1em;\" /> 鍏抽棴鍙充晶\r\n      </li>\r\n      <li @click=\"closeAllTags(selectedTag)\">\r\n        <circle-close style=\"width: 1em; height: 1em;\" /> 鍏ㄩ儴鍏抽棴\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport ScrollPane from './ScrollPane'\r\nimport { getNormalPath } from '@/utils/ruoyi'\r\nimport useTagsViewStore from '@/store/modules/tagsView'\r\nimport useSettingsStore from '@/store/modules/settings'\r\nimport usePermissionStore from '@/store/modules/permission'\r\n\r\nconst visible = ref(false)\r\nconst top = ref(0)\r\nconst left = ref(0)\r\nconst selectedTag = ref({})\r\nconst affixTags = ref([])\r\nconst scrollPaneRef = ref(null)\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\nconst visitedViews = computed(() => useTagsViewStore().visitedViews)\r\nconst routes = computed(() => usePermissionStore().routes)\r\nconst theme = computed(() => useSettingsStore().theme)\r\nconst tagsIcon = computed(() => useSettingsStore().tagsIcon)\r\n\r\nwatch(route, () => {\r\n  addTags()\r\n  moveToCurrentTag()\r\n})\r\n\r\nwatch(visible, (value) => {\r\n  if (value) {\r\n    document.body.addEventListener('click', closeMenu)\r\n  } else {\r\n    document.body.removeEventListener('click', closeMenu)\r\n  }\r\n})\r\n\r\nonMounted(() => {\r\n  initTags()\r\n  addTags()\r\n})\r\n\r\nfunction isActive(r) {\r\n  return r.path === route.path\r\n}\r\n\r\nfunction activeStyle(tag) {\r\n  if (!isActive(tag)) return {}\r\n  return {\r\n    \"background-color\": theme.value,\r\n    \"border-color\": theme.value\r\n  }\r\n}\r\n\r\nfunction isAffix(tag) {\r\n  return tag.meta && tag.meta.affix\r\n}\r\n\r\nfunction isFirstView() {\r\n  try {\r\n    return selectedTag.value.fullPath === '/index' || selectedTag.value.fullPath === visitedViews.value[1].fullPath\r\n  } catch (err) {\r\n    return false\r\n  }\r\n}\r\n\r\nfunction isLastView() {\r\n  try {\r\n    return selectedTag.value.fullPath === visitedViews.value[visitedViews.value.length - 1].fullPath\r\n  } catch (err) {\r\n    return false\r\n  }\r\n}\r\n\r\nfunction filterAffixTags(routes, basePath = '') {\r\n  let tags = []\r\n  routes.forEach(route => {\r\n    if (route.meta && route.meta.affix) {\r\n      const tagPath = getNormalPath(basePath + '/' + route.path)\r\n      tags.push({\r\n        fullPath: tagPath,\r\n        path: tagPath,\r\n        name: route.name,\r\n        meta: { ...route.meta }\r\n      })\r\n    }\r\n    if (route.children) {\r\n      const tempTags = filterAffixTags(route.children, route.path)\r\n      if (tempTags.length >= 1) {\r\n        tags = [...tags, ...tempTags]\r\n      }\r\n    }\r\n  })\r\n  return tags\r\n}\r\n\r\nfunction initTags() {\r\n  const res = filterAffixTags(routes.value)\r\n  affixTags.value = res\r\n  for (const tag of res) {\r\n    // Must have tag name\r\n    if (tag.name) {\r\n       useTagsViewStore().addVisitedView(tag)\r\n    }\r\n  }\r\n}\r\n\r\nfunction addTags() {\r\n  const { name } = route\r\n  if (name) {\r\n    useTagsViewStore().addView(route)\r\n  }\r\n}\r\n\r\nfunction moveToCurrentTag() {\r\n  nextTick(() => {\r\n    for (const r of visitedViews.value) {\r\n      if (r.path === route.path) {\r\n        scrollPaneRef.value.moveToTarget(r)\r\n        // when query is different then update\r\n        if (r.fullPath !== route.fullPath) {\r\n          useTagsViewStore().updateVisitedView(route)\r\n        }\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nfunction refreshSelectedTag(view) {\r\n  proxy.$tab.refreshPage(view)\r\n  if (route.meta.link) {\r\n    useTagsViewStore().delIframeView(route)\r\n  }\r\n}\r\n\r\nfunction closeSelectedTag(view) {\r\n  proxy.$tab.closePage(view).then(({ visitedViews }) => {\r\n    if (isActive(view)) {\r\n      toLastView(visitedViews, view)\r\n    }\r\n  })\r\n}\r\n\r\nfunction closeRightTags() {\r\n  proxy.$tab.closeRightPage(selectedTag.value).then(visitedViews => {\r\n    if (!visitedViews.find(i => i.fullPath === route.fullPath)) {\r\n      toLastView(visitedViews)\r\n    }\r\n  })\r\n}\r\n\r\nfunction closeLeftTags() {\r\n  proxy.$tab.closeLeftPage(selectedTag.value).then(visitedViews => {\r\n    if (!visitedViews.find(i => i.fullPath === route.fullPath)) {\r\n      toLastView(visitedViews)\r\n    }\r\n  })\r\n}\r\n\r\nfunction closeOthersTags() {\r\n  router.push(selectedTag.value).catch(() => { })\r\n  proxy.$tab.closeOtherPage(selectedTag.value).then(() => {\r\n    moveToCurrentTag()\r\n  })\r\n}\r\n\r\nfunction closeAllTags(view) {\r\n  proxy.$tab.closeAllPage().then(({ visitedViews }) => {\r\n    if (affixTags.value.some(tag => tag.path === route.path)) {\r\n      return\r\n    }\r\n    toLastView(visitedViews, view)\r\n  })\r\n}\r\n\r\nfunction toLastView(visitedViews, view) {\r\n  const latestView = visitedViews.slice(-1)[0]\r\n  if (latestView) {\r\n    router.push(latestView.fullPath)\r\n  } else {\r\n    // now the default is to redirect to the home page if there is no tags-view,\r\n    // you can adjust it according to your needs.\r\n    if (view.name === 'Dashboard') {\r\n      // to reload home page\r\n      router.replace({ path: '/redirect' + view.fullPath })\r\n    } else {\r\n      router.push('/')\r\n    }\r\n  }\r\n}\r\n\r\nfunction openMenu(tag, e) {\r\n  const menuMinWidth = 105\r\n  const offsetLeft = proxy.$el.getBoundingClientRect().left // container margin left\r\n  const offsetWidth = proxy.$el.offsetWidth // container width\r\n  const maxLeft = offsetWidth - menuMinWidth // left boundary\r\n  const l = e.clientX - offsetLeft + 15 // 15: margin right\r\n\r\n  if (l > maxLeft) {\r\n    left.value = maxLeft\r\n  } else {\r\n    left.value = l\r\n  }\r\n\r\n  top.value = e.clientY\r\n  visible.value = true\r\n  selectedTag.value = tag\r\n}\r\n\r\nfunction closeMenu() {\r\n  visible.value = false\r\n}\r\n\r\nfunction handleScroll() {\r\n  closeMenu()\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.tags-view-container {\r\n  height: 34px;\r\n  width: 100%;\r\n  background: var(--tags-bg, #fff);\r\n  border-bottom: 1px solid var(--tags-item-border, #d8dce5);\r\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, .12), 0 0 3px 0 rgba(0, 0, 0, .04);\r\n\r\n  .tags-view-wrapper {\r\n    .tags-view-item {\r\n      display: inline-block;\r\n      position: relative;\r\n      cursor: pointer;\r\n      height: 26px;\r\n      line-height: 26px;\r\n      border: 1px solid var(--tags-item-border, #d8dce5);\r\n      color: var(--tags-item-text, #495060);\r\n      background: var(--tags-item-bg, #fff);\r\n      padding: 0 8px;\r\n      font-size: 12px;\r\n      margin-left: 5px;\r\n      margin-top: 4px;\r\n\r\n      &:first-of-type {\r\n        margin-left: 15px;\r\n      }\r\n\r\n      &:last-of-type {\r\n        margin-right: 15px;\r\n      }\r\n\r\n      &.active {\r\n        background-color: #42b983;\r\n        color: #fff;\r\n        border-color: #42b983;\r\n\r\n        &::before {\r\n          content: '';\r\n          background: #fff;\r\n          display: inline-block;\r\n          width: 8px;\r\n          height: 8px;\r\n          border-radius: 50%;\r\n          position: relative;\r\n          margin-right: 5px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .tags-view-item.active.has-icon::before {\r\n    content: none !important;\r\n  }\r\n\r\n  .contextmenu {\r\n    margin: 0;\r\n    background: var(--el-bg-color-overlay, #fff);\r\n    z-index: 3000;\r\n    position: absolute;\r\n    list-style-type: none;\r\n    padding: 5px 0;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    font-weight: 400;\r\n    color: var(--tags-item-text, #333);\r\n    box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, .3);\r\n    border: 1px solid var(--el-border-color-light, #e4e7ed);\r\n\r\n    li {\r\n      margin: 0;\r\n      padding: 7px 16px;\r\n      cursor: pointer;\r\n\r\n      &:hover {\r\n        background: var(--tags-item-hover, #eee);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n<style lang=\"scss\">\r\n//reset element css of el-icon-close\r\n.tags-view-wrapper {\r\n  .tags-view-item {\r\n    .el-icon-close {\r\n      width: 16px;\r\n      height: 16px;\r\n      vertical-align: 2px;\r\n      border-radius: 50%;\r\n      text-align: center;\r\n      transition: all .3s cubic-bezier(.645, .045, .355, 1);\r\n      transform-origin: 100% 50%;\r\n\r\n      &:before {\r\n        transform: scale(.6);\r\n        display: inline-block;\r\n        vertical-align: -3px;\r\n      }\r\n\r\n      &:hover {\r\n        background-color: var(--tags-close-hover, #b4bccc);\r\n        color: #fff;\r\n        width: 12px !important;\r\n        height: 12px !important;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\components\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\layout\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'Sidebar' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'sideTheme' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":31,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'height' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":44,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div :class=\"classObj\" class=\"app-wrapper\" :style=\"{ '--current-color': theme }\">\r\n    <div v-if=\"device === 'mobile' && sidebar.opened\" class=\"drawer-bg\" @click=\"handleClickOutside\" />\r\n    <sidebar v-if=\"!sidebar.hide\" class=\"sidebar-container\" />\r\n    <div :class=\"{ hasTagsView: needTagsView, sidebarHide: sidebar.hide }\" class=\"main-container\">\r\n      <div :class=\"{ 'fixed-header': fixedHeader }\">\r\n        <navbar @setLayout=\"setLayout\" />\r\n        <tags-view v-if=\"needTagsView\" />\r\n      </div>\r\n      <app-main />\r\n      <settings ref=\"settingRef\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useWindowSize } from '@vueuse/core'\r\nimport Sidebar from './components/Sidebar/index.vue'\r\nimport { AppMain, Navbar, Settings, TagsView } from './components'\r\nimport useAppStore from '@/store/modules/app'\r\nimport useSettingsStore from '@/store/modules/settings'\r\n// 寮曞叆涓氬姟鏈嶅姟\r\nimport ticketEscalation from '@/utils/business/ticketEscalation'\r\nimport maintenanceReminder from '@/utils/business/maintenanceReminder'\r\nimport inspectionAnomaly from '@/utils/business/inspectionAnomaly'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst settingsStore = useSettingsStore()\r\nconst theme = computed(() => settingsStore.theme)\r\n// use Vite env variable replacement\r\nconst sideTheme = computed(() => settingsStore.sideTheme || import.meta.env.VITE_APP_SIDE_THEME)\r\nconst sidebar = computed(() => useAppStore().sidebar)\r\nconst device = computed(() => useAppStore().device)\r\nconst needTagsView = computed(() => settingsStore.tagsView)\r\nconst fixedHeader = computed(() => settingsStore.fixedHeader)\r\n\r\nconst classObj = computed(() => ({\r\n  hideSidebar: !sidebar.value.opened,\r\n  openSidebar: sidebar.value.opened,\r\n  withoutAnimation: sidebar.value.withoutAnimation,\r\n  mobile: device.value === 'mobile'\r\n}))\r\n\r\nconst { width, height } = useWindowSize()\r\nconst WIDTH = 992 // refer to Bootstrap's responsive design\r\n\r\nwatch(() => device.value, () => {\r\n  if (device.value === 'mobile' && sidebar.value.opened) {\r\n    useAppStore().closeSideBar({ withoutAnimation: false })\r\n  }\r\n})\r\n\r\nwatchEffect(() => {\r\n  if (width.value - 1 < WIDTH) {\r\n    useAppStore().toggleDevice('mobile')\r\n    useAppStore().closeSideBar({ withoutAnimation: true })\r\n  } else {\r\n    useAppStore().toggleDevice('desktop')\r\n  }\r\n})\r\n\r\nfunction handleClickOutside() {\r\n  useAppStore().closeSideBar({ withoutAnimation: false })\r\n}\r\n\r\nconst settingRef = ref(null)\r\nfunction setLayout() {\r\n  settingRef.value.openSetting()\r\n}\r\n\r\n// 鍒濆鍖栦笟鍔℃湇鍔r\nonMounted(() => {\r\n  // 妫€鏌ョ敤鎴锋潈闄愶紝鍐冲畾鏄惁鍚姩鏈嶅姟\r\n  const userPermissions = proxy.$auth.getPermissions()\r\n\r\n  // 宸ュ崟鑷姩鍗囩骇鏈嶅姟锛堥渶瑕佸伐鍗曠鐞嗘潈闄愶級\r\n  if (userPermissions.includes('business:ticket:edit') || userPermissions.includes('*:*:*')) {\r\n    ticketEscalation.init(proxy)\r\n    ticketEscalation.start()\r\n    console.log('[绯荤粺鏈嶅姟] 宸ュ崟鑷姩鍗囩骇鏈嶅姟宸插惎鍔?)\r\n  }\r\n\r\n  // 缁翠繚鎻愰啋鏈嶅姟锛堥渶瑕佺淮淇濈鐞嗘潈闄愶級\r\n  if (userPermissions.includes('business:maintenance:query') || userPermissions.includes('*:*:*')) {\r\n    maintenanceReminder.init(proxy)\r\n    maintenanceReminder.start()\r\n    console.log('[绯荤粺鏈嶅姟] 缁翠繚鎻愰啋鏈嶅姟宸插惎鍔?)\r\n  }\r\n\r\n  // 瀵煎嚭宸℃寮傚父鏈嶅姟渚涘叏灞€浣跨敤\r\n  window.$inspectionAnomaly = inspectionAnomaly\r\n  console.log('[绯荤粺鏈嶅姟] 宸℃寮傚父妫€娴嬫湇鍔″凡鍔犺浇')\r\n\r\n  // 鍦ㄥ紑鍙戠幆澧冩墦鍗版湇鍔＄姸鎬乗r\n  // 浣跨敤 Vite 鐜鍙橀噺\r\n  if (import.meta.env.DEV) {\r\n    window.$services = {\r\n      ticketEscalation,\r\n      maintenanceReminder,\r\n      inspectionAnomaly\r\n    }\r\n    console.log('[寮€鍙戞ā寮廬 鍙€氳繃 window.$services 璁块棶涓氬姟鏈嶅姟')\r\n  }\r\n})\r\n\r\n// 鍋滄涓氬姟鏈嶅姟\r\nonBeforeUnmount(() => {\r\n  // 鍋滄宸ュ崟鍗囩骇鏈嶅姟\r\n  if (ticketEscalation.getStatus().isRunning) {\r\n    ticketEscalation.stop()\r\n    console.log('[绯荤粺鏈嶅姟] 宸ュ崟鑷姩鍗囩骇鏈嶅姟宸插仠姝?)\r\n  }\r\n\r\n  // 鍋滄缁翠繚鎻愰啋鏈嶅姟\r\n  if (maintenanceReminder.getStatus().isRunning) {\r\n    maintenanceReminder.stop()\r\n    console.log('[绯荤粺鏈嶅姟] 缁翠繚鎻愰啋鏈嶅姟宸插仠姝?)\r\n  }\r\n\r\n  // 娓呯悊鍏ㄥ眬鏈嶅姟寮曠敤\r\n  if (window.$inspectionAnomaly) {\r\n    delete window.$inspectionAnomaly\r\n  }\r\n  if (window.$services) {\r\n    delete window.$services\r\n  }\r\n})\r\n\r\n// 鐩戝惉椤甸潰鍙鎬у彉鍖栵紝浼樺寲鏈嶅姟鎬ц兘\r\ndocument.addEventListener('visibilitychange', () => {\r\n  if (document.hidden) {\r\n    // 椤甸潰闅愯棌鏃舵殏鍋滀笉蹇呰鐨勬湇鍔r\n    console.log('[绯荤粺鏈嶅姟] 椤甸潰宸查殣钘忥紝鏈嶅姟杩涘叆寰呮満妯″紡')\r\n  } else {\r\n    // 椤甸潰鏄剧ず鏃舵仮澶嶆湇鍔r\n    console.log('[绯荤粺鏈嶅姟] 椤甸潰宸叉樉绀猴紝鏈嶅姟鎭㈠姝ｅ父')\r\n    // 鍙互瑙﹀彂涓€娆℃墜鍔ㄦ鏌r\n    if (maintenanceReminder.getStatus().isRunning) {\r\n      maintenanceReminder.manualCheck()\r\n    }\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@use \"@/assets/styles/mixin.scss\" as mix;\r\n@use \"@/assets/styles/variables.module.scss\" as vars;\r\n\r\n.app-wrapper {\r\n  @include mix.clearfix;\r\n  position: relative;\r\n  height: 100%;\r\n  width: 100%;\r\n\r\n  &.mobile.openSidebar {\r\n    position: fixed;\r\n    top: 0;\r\n  }\r\n}\r\n\r\n.drawer-bg {\r\n  background: #000;\r\n  opacity: 0.3;\r\n  width: 100%;\r\n  top: 0;\r\n  height: 100%;\r\n  position: absolute;\r\n  z-index: 999;\r\n}\r\n\r\n.fixed-header {\r\n  position: fixed;\r\n  top: 0;\r\n  right: 0;\r\n  z-index: 9;\r\n  width: calc(100% - #{vars.$base-sidebar-width});\r\n  transition: width 0.28s;\r\n}\r\n\r\n.hideSidebar .fixed-header {\r\n  width: calc(100% - 54px);\r\n}\r\n\r\n.sidebarHide .fixed-header {\r\n  width: 100%;\r\n}\r\n\r\n.mobile .fixed-header {\r\n  width: 100%;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\main.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\mock\\business.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\mock\\database.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\mock\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\mock\\modules\\ticket.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'pageNum' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":17,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// src/mock/modules/ticket.js\r\nfunction generateTickets(size) {\r\n  return Array.from({ length: Number(size) }, (_, i) => ({\r\n    ticketId: i + 1,\r\n    title: `Mock 宸ュ崟 #${i + 1}`,\r\n    status: 'open',\r\n    priority: ['low', 'medium', 'high'][i % 3],\r\n    createTime: new Date(Date.now() - i * 3600_000).toISOString()\r\n  }))\r\n}\r\n\r\nexport default [\r\n  {\r\n    url: '/business/ticket/list',\r\n    method: 'get',\r\n    response: ({ query }) => {\r\n      const { pageNum = 1, pageSize = 10 } = query\r\n      return {\r\n        code: 200,\r\n        rows: generateTickets(pageSize),\r\n        total: 100\r\n      }\r\n    }\r\n  },\r\n  // CRUD瀹屾暣Mock\r\n  {\r\n    url: '/business/ticket/assign',\r\n    method: 'post',\r\n    response: () => ({ code: 200, msg: '鎸囨淳鎴愬姛' })\r\n  }\r\n]","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\mock\\store.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\permission.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\plugins\\auth.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\plugins\\cache.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\plugins\\download.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\plugins\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\plugins\\modal.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\plugins\\tab.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\router\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\router\\modules\\business.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\settings.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\store\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\store\\modules\\app.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\store\\modules\\dict.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":19,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":42,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const useDictStore = defineStore(\r\n  'dict',\r\n  {\r\n    state: () => ({\r\n      dict: new Array()\r\n    }),\r\n    actions: {\r\n      // 鑾峰彇瀛楀吀\r\n      getDict(_key) {\r\n        if (_key == null && _key == \"\") {\r\n          return null\r\n        }\r\n        try {\r\n          for (let i = 0; i < this.dict.length; i++) {\r\n            if (this.dict[i].key == _key) {\r\n              return this.dict[i].value\r\n            }\r\n          }\r\n        } catch (e) {\r\n          return null\r\n        }\r\n      },\r\n      // 璁剧疆瀛楀吀\r\n      setDict(_key, value) {\r\n        if (_key !== null && _key !== \"\") {\r\n          this.dict.push({\r\n            key: _key,\r\n            value: value\r\n          })\r\n        }\r\n      },\r\n      // 鍒犻櫎瀛楀吀\r\n      removeDict(_key) {\r\n        var bln = false\r\n        try {\r\n          for (let i = 0; i < this.dict.length; i++) {\r\n            if (this.dict[i].key == _key) {\r\n              this.dict.splice(i, 1)\r\n              return true\r\n            }\r\n          }\r\n        } catch (e) {\r\n          bln = false\r\n        }\r\n        return bln\r\n      },\r\n      // 娓呯┖瀛楀吀\r\n      cleanDict() {\r\n        this.dict = new Array()\r\n      },\r\n      // 鍒濆瀛楀吀\r\n      initDict() {\r\n      }\r\n    }\r\n  })\r\n\r\nexport default useDictStore\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\store\\modules\\permission.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'roles' is defined but never used. Allowed unused args must match /^_/u.","line":35,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'lastRouter' is assigned a value but never used. Allowed unused args must match /^_/u.","line":59,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":59,"endColumn":54},{"ruleId":"no-unused-vars","severity":1,"message":"'lastRouter' is assigned a value but never used. Allowed unused args must match /^_/u.","line":93,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":93,"endColumn":48}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import auth from '@/plugins/auth'\r\nimport router, { constantRoutes, dynamicRoutes } from '@/router'\r\nimport { getRouters } from '@/api/menu'\r\nimport Layout from '@/layout/index'\r\nimport ParentView from '@/components/ParentView'\r\nimport InnerLink from '@/layout/components/InnerLink'\r\n\r\n// 鍖归厤views閲岄潰鎵€鏈夌殑.vue鏂囦欢\r\nconst modules = import.meta.glob('./../../views/**/*.vue')\r\n\r\nconst usePermissionStore = defineStore(\r\n  'permission',\r\n  {\r\n    state: () => ({\r\n      routes: [],\r\n      addRoutes: [],\r\n      defaultRoutes: [],\r\n      topbarRouters: [],\r\n      sidebarRouters: []\r\n    }),\r\n    actions: {\r\n      setRoutes(routes) {\r\n        this.addRoutes = routes\r\n        this.routes = constantRoutes.concat(routes)\r\n      },\r\n      setDefaultRoutes(routes) {\r\n        this.defaultRoutes = constantRoutes.concat(routes)\r\n      },\r\n      setTopbarRoutes(routes) {\r\n        this.topbarRouters = routes\r\n      },\r\n      setSidebarRouters(routes) {\r\n        this.sidebarRouters = routes\r\n      },\r\n      generateRoutes(roles) {\r\n        return new Promise(resolve => {\r\n          // 鍚戝悗绔姹傝矾鐢辨暟鎹甛r\n          getRouters().then(res => {\r\n            const sdata = JSON.parse(JSON.stringify(res.data))\r\n            const rdata = JSON.parse(JSON.stringify(res.data))\r\n            const defaultData = JSON.parse(JSON.stringify(res.data))\r\n            const sidebarRoutes = filterAsyncRouter(sdata)\r\n            const rewriteRoutes = filterAsyncRouter(rdata, false, true)\r\n            const defaultRoutes = filterAsyncRouter(defaultData)\r\n            const asyncRoutes = filterDynamicRoutes(dynamicRoutes)\r\n            asyncRoutes.forEach(route => { router.addRoute(route) })\r\n            this.setRoutes(rewriteRoutes)\r\n            this.setSidebarRouters(constantRoutes.concat(sidebarRoutes))\r\n            this.setDefaultRoutes(sidebarRoutes)\r\n            this.setTopbarRoutes(defaultRoutes)\r\n            resolve(rewriteRoutes)\r\n          })\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\n// 閬嶅巻鍚庡彴浼犳潵鐨勮矾鐢卞瓧绗︿覆锛岃浆鎹负缁勪欢瀵硅薄\r\nfunction filterAsyncRouter(asyncRouterMap, lastRouter = false, type = false) {\r\n  const processed = asyncRouterMap.filter(route => {\r\n    if (type && route.children) {\r\n      route.children = filterChildren(route.children)\r\n    }\r\n    if (route.component) {\r\n      // Layout ParentView 缁勪欢鐗规畩澶勭悊\r\n      if (route.component === 'Layout') {\r\n        route.component = Layout\r\n      } else if (route.component === 'ParentView') {\r\n        route.component = ParentView\r\n      } else if (route.component === 'InnerLink') {\r\n        route.component = InnerLink\r\n      } else {\r\n        route.component = loadView(route.component)\r\n      }\r\n    }\r\n    if (route.children != null && route.children && route.children.length) {\r\n      route.children = filterAsyncRouter(route.children, route, type)\r\n    } else if (!route.component) {\r\n      // 浠呭湪娌℃湁 component 涔熸病鏈夊瓙璺敱鏃舵墠涓㈠純\r\n      delete route['children']\r\n      delete route['redirect']\r\n      console.warn('[permission] 涓㈠純鏃犵粍浠跺彾瀛愯矾鐢憋細', route.path)\r\n      return false\r\n    }\r\n    return true\r\n  })\r\n  if (import.meta.env.DEV) {\r\n    console.debug('[permission] 澶勭悊鍚庣殑寮傛璺敱锛?, processed.map(r => r.path))\r\n  }\r\n  return processed\r\n}\r\n\r\nfunction filterChildren(childrenMap, lastRouter = false) {\r\n  const children = []\r\n  childrenMap.forEach(el => {\r\n    // 淇濇寔鍘熺浉瀵?path锛岄伩鍏嶉噸澶嶆嫾鎺ュ鑷村尮閰嶅紓甯竆r\n    if (el.children && el.children.length && el.component === 'ParentView') {\r\n      // 淇濈暀 ParentView 鑷韩锛岀户缁€掑綊鍏跺瓙鍏冪礌\r\n      el.children = filterChildren(el.children, el)\r\n      children.push(el)\r\n    } else {\r\n      children.push(el)\r\n    }\r\n  })\r\n  return children\r\n}\r\n\r\n// 鍔ㄦ€佽矾鐢遍亶鍘嗭紝楠岃瘉鏄惁鍏峰鏉冮檺\r\nexport function filterDynamicRoutes(routes) {\r\n  const res = []\r\n  routes.forEach(route => {\r\n    if (route.permissions) {\r\n      if (auth.hasPermiOr(route.permissions)) {\r\n        res.push(route)\r\n      }\r\n    } else if (route.roles) {\r\n      if (auth.hasRoleOr(route.roles)) {\r\n        res.push(route)\r\n      }\r\n    }\r\n  })\r\n  return res\r\n}\r\n\r\nexport const loadView = (view) => {\r\n  let res\r\n  for (const path in modules) {\r\n    const dir = path.split('views/')[1].split('.vue')[0]\r\n    if (dir === view) {\r\n      res = () => modules[path]()\r\n    }\r\n  }\r\n  return res\r\n}\r\n\r\nexport default usePermissionStore\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\store\\modules\\settings.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\store\\modules\\tagsView.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'view' is defined but never used. Allowed unused args must match /^_/u.","line":111,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":111,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'view' is defined but never used. Allowed unused args must match /^_/u.","line":119,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":119,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const useTagsViewStore = defineStore(\r\n  'tags-view',\r\n  {\r\n    state: () => ({\r\n      visitedViews: [],\r\n      cachedViews: [],\r\n      iframeViews: []\r\n    }),\r\n    actions: {\r\n      addView(view) {\r\n        this.addVisitedView(view)\r\n        this.addCachedView(view)\r\n      },\r\n      addIframeView(view) {\r\n        if (this.iframeViews.some(v => v.path === view.path)) return\r\n        this.iframeViews.push(\r\n          Object.assign({}, view, {\r\n            title: view.meta.title || 'no-name'\r\n          })\r\n        )\r\n      },\r\n      addVisitedView(view) {\r\n        if (this.visitedViews.some(v => v.path === view.path)) return\r\n        this.visitedViews.push(\r\n          Object.assign({}, view, {\r\n            title: view.meta.title || 'no-name'\r\n          })\r\n        )\r\n      },\r\n      addCachedView(view) {\r\n        if (this.cachedViews.includes(view.name)) return\r\n        if (!view.meta.noCache) {\r\n          this.cachedViews.push(view.name)\r\n        }\r\n      },\r\n      delView(view) {\r\n        return new Promise(resolve => {\r\n          this.delVisitedView(view)\r\n          this.delCachedView(view)\r\n          resolve({\r\n            visitedViews: [...this.visitedViews],\r\n            cachedViews: [...this.cachedViews]\r\n          })\r\n        })\r\n      },\r\n      delVisitedView(view) {\r\n        return new Promise(resolve => {\r\n          for (const [i, v] of this.visitedViews.entries()) {\r\n            if (v.path === view.path) {\r\n              this.visitedViews.splice(i, 1)\r\n              break\r\n            }\r\n          }\r\n          this.iframeViews = this.iframeViews.filter(item => item.path !== view.path)\r\n          resolve([...this.visitedViews])\r\n        })\r\n      },\r\n      delIframeView(view) {\r\n        return new Promise(resolve => {\r\n          this.iframeViews = this.iframeViews.filter(item => item.path !== view.path)\r\n          resolve([...this.iframeViews])\r\n        })\r\n      },\r\n      delCachedView(view) {\r\n        return new Promise(resolve => {\r\n          const index = this.cachedViews.indexOf(view.name)\r\n          index > -1 && this.cachedViews.splice(index, 1)\r\n          resolve([...this.cachedViews])\r\n        })\r\n      },\r\n      delOthersViews(view) {\r\n        return new Promise(resolve => {\r\n          this.delOthersVisitedViews(view)\r\n          this.delOthersCachedViews(view)\r\n          resolve({\r\n            visitedViews: [...this.visitedViews],\r\n            cachedViews: [...this.cachedViews]\r\n          })\r\n        })\r\n      },\r\n      delOthersVisitedViews(view) {\r\n        return new Promise(resolve => {\r\n          this.visitedViews = this.visitedViews.filter(v => {\r\n            return v.meta.affix || v.path === view.path\r\n          })\r\n          this.iframeViews = this.iframeViews.filter(item => item.path === view.path)\r\n          resolve([...this.visitedViews])\r\n        })\r\n      },\r\n      delOthersCachedViews(view) {\r\n        return new Promise(resolve => {\r\n          const index = this.cachedViews.indexOf(view.name)\r\n          if (index > -1) {\r\n            this.cachedViews = this.cachedViews.slice(index, index + 1)\r\n          } else {\r\n            this.cachedViews = []\r\n          }\r\n          resolve([...this.cachedViews])\r\n        })\r\n      },\r\n      delAllViews(view) {\r\n        return new Promise(resolve => {\r\n          this.delAllVisitedViews(view)\r\n          this.delAllCachedViews(view)\r\n          resolve({\r\n            visitedViews: [...this.visitedViews],\r\n            cachedViews: [...this.cachedViews]\r\n          })\r\n        })\r\n      },\r\n      delAllVisitedViews(view) {\r\n        return new Promise(resolve => {\r\n          const affixTags = this.visitedViews.filter(tag => tag.meta.affix)\r\n          this.visitedViews = affixTags\r\n          this.iframeViews = []\r\n          resolve([...this.visitedViews])\r\n        })\r\n      },\r\n      delAllCachedViews(view) {\r\n        return new Promise(resolve => {\r\n          this.cachedViews = []\r\n          resolve([...this.cachedViews])\r\n        })\r\n      },\r\n      updateVisitedView(view) {\r\n        for (let v of this.visitedViews) {\r\n          if (v.path === view.path) {\r\n            v = Object.assign(v, view)\r\n            break\r\n          }\r\n        }\r\n      },\r\n      delRightTags(view) {\r\n        return new Promise(resolve => {\r\n          const index = this.visitedViews.findIndex(v => v.path === view.path)\r\n          if (index === -1) {\r\n            return\r\n          }\r\n          this.visitedViews = this.visitedViews.filter((item, idx) => {\r\n            if (idx <= index || (item.meta && item.meta.affix)) {\r\n              return true\r\n            }\r\n            const i = this.cachedViews.indexOf(item.name)\r\n            if (i > -1) {\r\n              this.cachedViews.splice(i, 1)\r\n            }\r\n            if(item.meta.link) {\r\n              const fi = this.iframeViews.findIndex(v => v.path === item.path)\r\n              this.iframeViews.splice(fi, 1)\r\n            }\r\n            return false\r\n          })\r\n          resolve([...this.visitedViews])\r\n        })\r\n      },\r\n      delLeftTags(view) {\r\n        return new Promise(resolve => {\r\n          const index = this.visitedViews.findIndex(v => v.path === view.path)\r\n          if (index === -1) {\r\n            return\r\n          }\r\n          this.visitedViews = this.visitedViews.filter((item, idx) => {\r\n            if (idx >= index || (item.meta && item.meta.affix)) {\r\n              return true\r\n            }\r\n            const i = this.cachedViews.indexOf(item.name)\r\n            if (i > -1) {\r\n              this.cachedViews.splice(i, 1)\r\n            }\r\n            if(item.meta.link) {\r\n              const fi = this.iframeViews.findIndex(v => v.path === item.path)\r\n              this.iframeViews.splice(fi, 1)\r\n            }\r\n            return false\r\n          })\r\n          resolve([...this.visitedViews])\r\n        })\r\n      }\r\n    }\r\n  })\r\n\r\nexport default useTagsViewStore\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\store\\modules\\user.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\auth.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\business\\inspectionAnomaly.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getInspection' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":23},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'class-methods-use-this').","line":207,"column":3,"severity":1,"nodeType":null,"fix":{"range":[6547,6597],"text":" "}},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":212,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":212,"endColumn":15}],"suppressedMessages":[{"ruleId":"no-unreachable","severity":2,"message":"Unreachable code.","line":212,"column":17,"nodeType":"BlockStatement","messageId":"unreachableCode","endLine":214,"endColumn":6,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":1,"source":"// src/utils/business/inspectionAnomaly.js\r\nimport { getInspection } from '@/api/business/inspection'\r\nimport { addTicket } from '@/api/business/ticket'\r\nimport {\r\n  INSPECTION_ITEMS,\r\n  ANOMALY_RULES,\r\n  getAnomalyPriority\r\n} from '@/views/business/inspection/constants'\r\n\r\n/* eslint-disable no-unreachable */\r\nexport class InspectionAnomalyService {\r\n  /**\r\n   * 妫€娴嬪崟娆″贰妫€鐨勬墍鏈夊紓甯搁」\r\n   * @param {Object} inspectionData - 鍚庣杩斿洖鐨勫贰妫€璁板綍锛岄渶鍖呭惈 floor銆乮tems(JSON瀛楃涓?瀵硅薄)\r\n   * @returns {Array<Object>} 寮傚父椤规暟缁刓r\n   */\r\n  detectAnomalies(inspectionData) {\r\n    const anomalies = []\r\n    const items = typeof inspectionData.items === 'string'\r\n      ? (JSON.parse(inspectionData.items || '{}') || {})\r\n      : (inspectionData.items || {})\r\n    const floor = inspectionData.floor\r\n\r\n    // 鑾峰彇璇ユゼ灞傜殑妫€鏌ラ」閰嶇疆\r\n    const floorItems = INSPECTION_ITEMS[floor] || []\r\n\r\n    floorItems.forEach(itemCfg => {\r\n      const value = items[itemCfg.id]\r\n      // 璺宠繃鏈～鍐橽r\n      if (value === undefined || value === null || value === '') return\r\n\r\n      if (this.isAnomaly(itemCfg, value)) {\r\n        anomalies.push({\r\n          floor,\r\n          itemId: itemCfg.id,\r\n          itemName: itemCfg.label,\r\n          value,\r\n          unit: itemCfg.unit || '',\r\n          expectedRange: this.getExpectedRange(itemCfg),\r\n          priority: getAnomalyPriority(itemCfg.label),\r\n          severity: this.calculateSeverity(itemCfg, value)\r\n        })\r\n      }\r\n    })\r\n\r\n    return anomalies\r\n  }\r\n\r\n  /**\r\n   * 鏄惁寮傚父锛氬竷灏旈」 false 涓哄紓甯革紱鏁板€奸」瓒?min/max 涓哄紓甯竆r\n   * constants.js 宸叉彁渚?ANOMALY_RULES锛歜oolean(value) 涓?number(item, value)\r\n   */\r\n  isAnomaly(itemCfg, value) {\r\n    if (itemCfg.type === 'boolean') {\r\n      return ANOMALY_RULES.boolean(value)\r\n    }\r\n    if (itemCfg.type === 'number') {\r\n      return ANOMALY_RULES.number(itemCfg, Number(value))\r\n    }\r\n    return false\r\n  }\r\n\r\n  /** 鏈熸湜鑼冨洿灞曠ず */\r\n  getExpectedRange(itemCfg) {\r\n    if (itemCfg.type === 'boolean') return '姝ｅ父'\r\n    if (itemCfg.type === 'number' && itemCfg.min !== undefined && itemCfg.max !== undefined) {\r\n      return `${itemCfg.min}-${itemCfg.max} ${itemCfg.unit || ''}`.trim()\r\n    }\r\n    return '-'\r\n  }\r\n\r\n  /**\r\n   * 涓ラ噸搴︼細鎸夊亸绂诲尯闂存瘮渚嬪垽瀹歕r\n   * critical > major > minor > normal\r\n   */\r\n  calculateSeverity(itemCfg, valueRaw) {\r\n    if (itemCfg.type !== 'number' || itemCfg.min === undefined || itemCfg.max === undefined) {\r\n      return 'normal'\r\n    }\r\n    const value = Number(valueRaw)\r\n    if (Number.isNaN(value)) return 'normal'\r\n\r\n    const range = Number(itemCfg.max) - Number(itemCfg.min)\r\n    if (range <= 0) return 'normal'\r\n\r\n    let deviation = 0\r\n    if (value < itemCfg.min) deviation = itemCfg.min - value\r\n    else if (value > itemCfg.max) deviation = value - itemCfg.max\r\n\r\n    const rate = deviation / range\r\n    if (rate > 0.5) return 'critical'\r\n    if (rate > 0.3) return 'major'\r\n    if (rate > 0.1) return 'minor'\r\n    return 'normal'\r\n  }\r\n\r\n  /**\r\n   * 鎵归噺鐢熸垚宸ュ崟\r\n   * @param {string|number} inspectionId\r\n   * @param {Array<Object>} anomalies\r\n   * @param {any} proxy - Vue 瀹炰緥 proxy锛岀敤浜?$modal 涓?parseTime\r\n   */\r\n  async generateTickets(inspectionId, anomalies, proxy) {\r\n    const tickets = []\r\n\r\n    for (const anomaly of anomalies) {\r\n      const ticketData = {\r\n        title: `[宸℃寮傚父] ${this.getFloorLabel(anomaly.floor)} - ${anomaly.itemName}`,\r\n        description: this.generateDescription(anomaly),\r\n        priority: anomaly.priority,\r\n        source: 'inspection',\r\n        sourceId: inspectionId,\r\n        equipment: anomaly.itemName,\r\n        location: this.getFloorLabel(anomaly.floor),\r\n        specialty: this.detectSpecialty(anomaly.itemName),\r\n        status: 'pending',\r\n        deadline: this.calculateDeadline(anomaly.priority, proxy)\r\n      }\r\n\r\n      try {\r\n        const resp = await addTicket(ticketData)\r\n        tickets.push(resp?.data ?? resp)\r\n        proxy?.$modal?.msgSuccess?.(`宸蹭负銆?{anomaly.itemName}銆嶇敓鎴愬伐鍗昤)\r\n      } catch (err) {\r\n        console.error('鐢熸垚宸ュ崟澶辫触:', err)\r\n        proxy?.$modal?.msgError?.(`鏃犳硶涓恒€?{anomaly.itemName}銆嶇敓鎴愬伐鍗昤)\r\n      }\r\n    }\r\n\r\n    return tickets\r\n  }\r\n\r\n  /** 宸ュ崟鎻忚堪 */\r\n  generateDescription(anomaly) {\r\n    const time =\r\n      (this._proxyParseTime?.(new Date())) ||\r\n      new Date().toLocaleString()\r\n    return [\r\n      '宸℃鍙戠幇寮傚父锛?,\r\n      `- 妫€鏌ラ」鐩細${anomaly.itemName}`,\r\n      `- 鎵€鍦ㄤ綅缃細${this.getFloorLabel(anomaly.floor)}`,\r\n      `- 寮傚父鍊硷細${anomaly.value}${anomaly.unit || ''}`,\r\n      `- 姝ｅ父鑼冨洿锛?{anomaly.expectedRange}`,\r\n      `- 寮傚父绛夌骇锛?{this.getPriorityLabel(anomaly.priority)}`,\r\n      `- 涓ラ噸绋嬪害锛?{this.getSeverityLabel(anomaly.severity)}`,\r\n      `- 鍙戠幇鏃堕棿锛?{time}`,\r\n      '',\r\n      '澶勭悊寤鸿锛?,\r\n      this.getHandlingSuggestion(anomaly),\r\n      '',\r\n      '璇峰強鏃跺鐞嗭紒'\r\n    ].join('\\n')\r\n  }\r\n\r\n  /** 寤鸿锛堟牴鎹叧閿瘝锛?*/\r\n  getHandlingSuggestion(anomaly) {\r\n    const suggestions = {\r\n      '姘㈡皵': '璇风珛鍗虫鏌ユ阿姘旂洃娴嬬郴缁燂紝纭鏄惁瀛樺湪娉勬紡椋庨櫓锛屽繀瑕佹椂鍚姩搴旀€ラ妗?,\r\n      '婕忔按': '璇风珛鍗冲墠寰€鐜板満鏌ョ湅婕忔按鎯呭喌锛屽叧闂浉鍏抽榾闂紝闃叉璁惧鎹熷潖',\r\n      '娓╁害': '璇锋鏌ョ┖璋冪郴缁熻繍琛岀姸鎬侊紝璋冩暣娓╁害璁剧疆鎴栨淇┖璋冭澶?,\r\n      '鍘嬪姏': '璇锋鏌ョ浉鍏虫车缁勫拰绠￠亾绯荤粺锛岃皟鏁村帇鍔涘弬鏁版垨鎺掓煡鏁呴殰',\r\n      'UPS': '璇锋鏌PS绯荤粺杩愯鐘舵€侊紝鏌ョ湅鍛婅鏃ュ織锛屽繀瑕佹椂鍒囨崲鑷虫梺璺緵鐢?,\r\n      '娑堥槻': '璇风珛鍗虫鏌ユ秷闃茬郴缁燂紝纭鏄惁瀛樺湪鐪熷疄鐏锛屾帓鏌ヨ鎶ュ師鍥?,\r\n      '娌?: '璇锋鏌ユ补缃愭补浣嶅拰渚涙补绯荤粺锛岀‘淇濅緵娌规甯?,\r\n      '鐢?: '璇锋鏌ラ厤鐢电郴缁燂紝娴嬮噺鐢靛帇鐢垫祦鏄惁姝ｅ父'\r\n    }\r\n\r\n    for (const [kw, tip] of Object.entries(suggestions)) {\r\n      if (anomaly.itemName.includes(kw)) return tip\r\n    }\r\n    return '璇峰敖蹇墠寰€鐜板満妫€鏌ワ紝纭寮傚父鎯呭喌骞惰繘琛屽鐞?\r\n  }\r\n\r\n  /** 褰掑睘涓撲笟 */\r\n  detectSpecialty(itemName) {\r\n    if (itemName.includes('鐢?) || itemName.includes('UPS') || itemName.includes('閰嶇數')) return 'power'\r\n    if (itemName.includes('绌鸿皟') || itemName.includes('娓╁害') || itemName.includes('鍐?)) return 'hvac'\r\n    if (itemName.includes('娑堥槻') || itemName.includes('姘?) || itemName.includes('閽㈢摱')) return 'fire'\r\n    if (itemName.includes('鐩戞帶') || itemName.includes('闂ㄧ') || itemName.includes('寮辩數')) return 'weak'\r\n    return 'other'\r\n  }\r\n\r\n  /** 澶勭悊鏃堕檺 */\r\n  calculateDeadline(priority, proxy) {\r\n    const now = new Date()\r\n    const hours = { high: 4, medium: 8, low: 24 }\r\n    now.setHours(now.getHours() + (hours[priority] ?? 24))\r\n    const format = proxy?.parseTime || this._proxyParseTime\r\n    return format ? format(now, '{y}-{m}-{d} {h}:{i}:{s}') : now.toISOString()\r\n  }\r\n\r\n  /** 妤煎眰/鏍囩鏄犲皠 */\r\n  getFloorLabel(floor) {\r\n    const map = { floor1: '1妤?, floor2: '2妤?, floor3: '3妤?, floor4: '4妤?, '1': '1妤?, '2': '2妤?, '3': '3妤?, '4': '4妤? }\r\n    return map[floor] || floor\r\n  }\r\n\r\n  getPriorityLabel(p) {\r\n    return ({ high: '楂?, medium: '涓?, low: '浣? }[p]) || p\r\n  }\r\n\r\n  getSeverityLabel(s) {\r\n    return ({ critical: '涓ラ噸', major: '閲嶈', minor: '杞诲井', normal: '涓€鑸? }[s]) || s\r\n  }\r\n\r\n  // 渚?generateDescription 浣跨敤鐨勫厹搴曟牸寮忓寲\r\n  // eslint-disable-next-line class-methods-use-this\r\n  _proxyParseTime() {\r\n    try {\r\n      // 鍙寜闇€鎺ュ叆鍏ㄥ眬宸ュ叿锛屾殏鏈疄鐜版牸寮忓寲閫昏緫\r\n      return null\r\n    } catch (e) {\r\n      return null\r\n    }\r\n  }\r\n}\r\n\r\n// 瀵煎嚭鍗曚緥\r\nexport default new InspectionAnomalyService()\r\n// 鏂囦欢鏈熬纭繚鏃犻澶栦笉鍙揪浠ｇ爜锛堜繚鐣欐娉ㄩ噴锛塡r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\business\\maintenanceReminder.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'diffHours' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":61,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// src/utils/business/maintenanceReminder.js\r\nimport { listMaintenance } from '@/api/business/maintenance';\r\n\r\nclass MaintenanceReminderService {\r\n  constructor() {\r\n    this.checkInterval = 60 * 60 * 1000; // 姣忓皬鏃舵鏌ヤ竴娆r\n    this.timer = null;\r\n    this.isRunning = false;\r\n    this.remindedPlans = new Set(); // 宸叉彁閱掔殑璁″垝ID闆嗗悎\r\n    this.proxy = null;\r\n  }\r\n  \r\n  // 鍒濆鍖杙roxy\r\n  init(proxy) {\r\n    this.proxy = proxy;\r\n  }\r\n  \r\n  // 鍚姩鏈嶅姟\r\n  start() {\r\n    if (this.isRunning) return;\r\n    \r\n    this.isRunning = true;\r\n    this.timer = setInterval(() => {\r\n      this.checkMaintenancePlans();\r\n    }, this.checkInterval);\r\n    \r\n    // 绔嬪嵆鎵ц涓€娆r\n    this.checkMaintenancePlans();\r\n    console.log('缁翠繚鎻愰啋鏈嶅姟宸插惎鍔?);\r\n  }\r\n  \r\n  // 鍋滄鏈嶅姟\r\n  stop() {\r\n    if (this.timer) {\r\n      clearInterval(this.timer);\r\n      this.timer = null;\r\n      this.isRunning = false;\r\n      this.remindedPlans.clear();\r\n      console.log('缁翠繚鎻愰啋鏈嶅姟宸插仠姝?);\r\n    }\r\n  }\r\n  \r\n  // 妫€鏌ョ淮淇濊鍒抃r\n  async checkMaintenancePlans() {\r\n    try {\r\n      // 鑾峰彇宸叉壒鍑嗕笖寰呮墽琛岀殑缁翠繚璁″垝\r\n      const response = await listMaintenance({\r\n        approvalStatus: 'approved',\r\n        executionStatus: 'pending',\r\n        pageSize: 100\r\n      });\r\n      \r\n      const plans = response.rows;\r\n      const now = new Date();\r\n      \r\n      plans.forEach(plan => {\r\n        if (!plan.nextExecutionTime) return;\r\n        \r\n        const nextExecution = new Date(plan.nextExecutionTime);\r\n        const diffMinutes = Math.floor((nextExecution - now) / (1000 * 60));\r\n        const diffHours = Math.floor(diffMinutes / 60);\r\n        \r\n        // 鎻愬墠24灏忔椂銆?2灏忔椂銆?灏忔椂鎻愰啋\r\n        const reminderPoints = [24 * 60, 12 * 60, 60]; // 鍒嗛挓鏁癨r\n        \r\n        reminderPoints.forEach(point => {\r\n          if (diffMinutes > 0 && diffMinutes <= point && diffMinutes > point - 60) {\r\n            this.sendReminder(plan, diffMinutes, point);\r\n          }\r\n        });\r\n        \r\n        // 妫€鏌ユ槸鍚﹂€炬湡\r\n        if (diffMinutes < -60) { // 瓒呰繃1灏忔椂鏈墽琛孿r\n          this.sendOverdueAlert(plan, -diffMinutes);\r\n        }\r\n      });\r\n      \r\n      // 娓呯悊杩囨湡鐨勬彁閱掕褰昞r\n      this.cleanExpiredReminders();\r\n      \r\n    } catch (error) {\r\n      console.error('妫€鏌ョ淮淇濊鍒掑け璐?', error);\r\n      this.notifyError(error);\r\n    }\r\n  }\r\n  \r\n  // 鍙戦€佹彁閱抃r\n  sendReminder(plan, minutesLeft, reminderPoint) {\r\n    const remindKey = `${plan.planId}-${reminderPoint}-${plan.nextExecutionTime}`;\r\n    \r\n    // 閬垮厤閲嶅鎻愰啋\r\n    if (this.remindedPlans.has(remindKey)) return;\r\n    \r\n    const message = `缁翠繚璁″垝\"${plan.title}\"灏嗗湪${this.formatTime(minutesLeft)}鍚庢墽琛宍;\r\n    \r\n    if (this.proxy && this.proxy.$modal) {\r\n      this.proxy.$modal.msgWarning(message);\r\n    }\r\n    \r\n    this.remindedPlans.add(remindKey);\r\n    \r\n    // 璁板綍鎻愰啋鏃ュ織\r\n    console.log(`[缁翠繚鎻愰啋] ${message}`);\r\n  }\r\n  \r\n  // 鍙戦€侀€炬湡鍛婅\r\n  sendOverdueAlert(plan, overdueMinutes) {\r\n    const alertKey = `overdue-${plan.planId}-${new Date().toDateString()}`;\r\n    \r\n    // 姣忓ぉ鍙彁閱掍竴娆r\n    if (this.remindedPlans.has(alertKey)) return;\r\n    \r\n    const message = `缁翠繚璁″垝\"${plan.title}\"宸查€炬湡${this.formatTime(overdueMinutes)}鏈墽琛岋紝璇峰敖蹇鐞嗭紒`;\r\n    \r\n    if (this.proxy && this.proxy.$modal) {\r\n      this.proxy.$modal.msgError(message);\r\n    }\r\n    \r\n    this.remindedPlans.add(alertKey);\r\n    \r\n    // 璁板綍鍛婅鏃ュ織\r\n    console.error(`[缁翠繚閫炬湡] ${message}`);\r\n  }\r\n  \r\n  // 鏍煎紡鍖栨椂闂碶r\n  formatTime(minutes) {\r\n    if (minutes < 60) {\r\n      return `${minutes}鍒嗛挓`;\r\n    }\r\n    const hours = Math.floor(minutes / 60);\r\n    const mins = minutes % 60;\r\n    \r\n    if (hours < 24) {\r\n      return mins > 0 ? `${hours}灏忔椂${mins}鍒嗛挓` : `${hours}灏忔椂`;\r\n    }\r\n    \r\n    const days = Math.floor(hours / 24);\r\n    const restHours = hours % 24;\r\n    \r\n    if (restHours > 0) {\r\n      return `${days}澶?{restHours}灏忔椂`;\r\n    }\r\n    return `${days}澶ー;\r\n  }\r\n  \r\n  // 娓呯悊杩囨湡鐨勬彁閱掕褰昞r\n  cleanExpiredReminders() {\r\n    const now = new Date();\r\n    const today = now.toDateString();\r\n    const expiredKeys = [];\r\n    \r\n    this.remindedPlans.forEach(key => {\r\n      // 娓呯悊闈炰粖澶╃殑閫炬湡鍛婅\r\n      if (key.startsWith('overdue-') && !key.includes(today)) {\r\n        expiredKeys.push(key);\r\n      }\r\n      \r\n      // 娓呯悊宸茶繃鏈熺殑甯歌鎻愰啋\r\n      const parts = key.split('-');\r\n      if (parts.length >= 3) {\r\n        const timeStr = parts.slice(2).join('-');\r\n        const planTime = new Date(timeStr);\r\n        if (now > planTime) {\r\n          expiredKeys.push(key);\r\n        }\r\n      }\r\n    });\r\n    \r\n    expiredKeys.forEach(key => {\r\n      this.remindedPlans.delete(key);\r\n    });\r\n  }\r\n  \r\n  // 閿欒閫氱煡\r\n  notifyError(error) {\r\n    if (this.proxy && this.proxy.$modal) {\r\n      this.proxy.$modal.msgError('缁翠繚鎻愰啋鏈嶅姟寮傚父锛? + (error.message || '璇锋鏌ョ郴缁熸棩蹇?));\r\n    }\r\n  }\r\n  \r\n  // 鑾峰彇鏈嶅姟鐘舵€乗r\n  getStatus() {\r\n    return {\r\n      isRunning: this.isRunning,\r\n      checkInterval: this.checkInterval,\r\n      remindedCount: this.remindedPlans.size,\r\n      nextCheckTime: this.timer ? new Date(Date.now() + this.checkInterval) : null\r\n    };\r\n  }\r\n  \r\n  // 鎵嬪姩瑙﹀彂妫€鏌r\n  async manualCheck() {\r\n    console.log('鎵嬪姩瑙﹀彂缁翠繚璁″垝妫€鏌?);\r\n    await this.checkMaintenancePlans();\r\n    return {\r\n      success: true,\r\n      message: '妫€鏌ュ畬鎴?,\r\n      timestamp: new Date()\r\n    };\r\n  }\r\n}\r\n\r\n// 瀵煎嚭鍗曚緥\r\nexport default new MaintenanceReminderService();","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\business\\ticketEscalation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\dict.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'index' is defined but never used. Allowed unused args must match /^_/u.","line":10,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import useDictStore from '@/store/modules/dict'\r\nimport { getDicts } from '@/api/system/dict/data'\r\n\r\n/**\r\n * 鑾峰彇瀛楀吀鏁版嵁\r\n */\r\nexport function useDict(...args) {\r\n  const res = ref({})\r\n  return (() => {\r\n    args.forEach((dictType, index) => {\r\n      res.value[dictType] = []\r\n      const dicts = useDictStore().getDict(dictType)\r\n      if (dicts) {\r\n        res.value[dictType] = dicts\r\n      } else {\r\n        getDicts(dictType).then(resp => {\r\n          res.value[dictType] = resp.data.map(p => ({ label: p.dictLabel, value: p.dictValue, elTagType: p.listClass, elTagClass: p.cssClass }))\r\n          useDictStore().setDict(dictType, res.value[dictType])\r\n        })\r\n      }\r\n    })\r\n    return toRefs(res.value)\r\n  })()\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\dynamicTitle.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\errorCode.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\generator\\config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\generator\\css.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\generator\\drawingDefalut.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\generator\\html.js","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'max-len').","line":1,"column":1,"severity":1,"nodeType":null,"fix":{"range":[0,28],"text":" "}},{"ruleId":"no-unused-vars","severity":1,"message":"'tag' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":112,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":112,"endColumn":10},{"ruleId":"no-unused-vars","severity":1,"message":"'max' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":244,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":244,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":1,"source":"/* eslint-disable max-len */\r\nimport { trigger } from './config'\r\n\r\nlet confGlobal\r\nlet someSpanIsNot24\r\n\r\nexport function dialogWrapper(str) {\r\n  return `<el-dialog v-model=\"dialogVisible\"  @open=\"onOpen\" @close=\"onClose\" title=\"Dialog Titile\">\r\n    ${str}\r\n    <template #footer>\r\n      <el-button @click=\"close\">鍙栨秷</el-button>\r\n\t  <el-button type=\"primary\" @click=\"handelConfirm\">纭畾</el-button>\r\n    </template>\r\n  </el-dialog>`\r\n}\r\n\r\nexport function vueTemplate(str) {\r\n  return `<template>\r\n    <div class=\"app-container\">\r\n      ${str}\r\n    </div>\r\n  </template>`\r\n}\r\n\r\nexport function vueScript(str) {\r\n  return `<script setup>\r\n    ${str}\r\n  </script>`\r\n}\r\n\r\nexport function cssStyle(cssStr) {\r\n  return `<style>\r\n    ${cssStr}\r\n  </style>`\r\n}\r\n\r\nfunction buildFormTemplate(conf, child, type) {\r\n  let labelPosition = ''\r\n  if (conf.labelPosition !== 'right') {\r\n    labelPosition = `label-position=\"${conf.labelPosition}\"`\r\n  }\r\n  const disabled = conf.disabled ? `:disabled=\"${conf.disabled}\"` : ''\r\n  let str = `<el-form ref=\"${conf.formRef}\" :model=\"${conf.formModel}\" :rules=\"${conf.formRules}\" size=\"${conf.size}\" ${disabled} label-width=\"${conf.labelWidth}px\" ${labelPosition}>\r\n      ${child}\r\n      ${buildFromBtns(conf, type)}\r\n    </el-form>`\r\n  if (someSpanIsNot24) {\r\n    str = `<el-row :gutter=\"${conf.gutter}\">\r\n        ${str}\r\n      </el-row>`\r\n  }\r\n  return str\r\n}\r\n\r\nfunction buildFromBtns(conf, type) {\r\n  let str = ''\r\n  if (conf.formBtns && type === 'file') {\r\n    str = `<el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitForm\">鎻愪氦</el-button>\r\n          <el-button @click=\"resetForm\">閲嶇疆</el-button>\r\n        </el-form-item>`\r\n    if (someSpanIsNot24) {\r\n      str = `<el-col :span=\"24\">\r\n          ${str}\r\n        </el-col>`\r\n    }\r\n  }\r\n  return str\r\n}\r\n\r\n// span涓嶄负24鐨勭敤el-col鍖呰９\r\nfunction colWrapper(element, str) {\r\n  if (someSpanIsNot24 || element.span !== 24) {\r\n    return `<el-col :span=\"${element.span}\">\r\n      ${str}\r\n    </el-col>`\r\n  }\r\n  return str\r\n}\r\n\r\nconst layouts = {\r\n  colFormItem(element) {\r\n    let labelWidth = ''\r\n    if (element.labelWidth && element.labelWidth !== confGlobal.labelWidth) {\r\n      labelWidth = `label-width=\"${element.labelWidth}px\"`\r\n    }\r\n    const required = !trigger[element.tag] && element.required ? 'required' : ''\r\n    const tagDom = tags[element.tag] ? tags[element.tag](element) : null\r\n    let str = `<el-form-item ${labelWidth} label=\"${element.label}\" prop=\"${element.vModel}\" ${required}>\r\n        ${tagDom}\r\n      </el-form-item>`\r\n    str = colWrapper(element, str)\r\n    return str\r\n  },\r\n  rowFormItem(element) {\r\n    const type = element.type === 'default' ? '' : `type=\"${element.type}\"`\r\n    const justify = element.type === 'default' ? '' : `justify=\"${element.justify}\"`\r\n    const align = element.type === 'default' ? '' : `align=\"${element.align}\"`\r\n    const gutter = element.gutter ? `gutter=\"${element.gutter}\"` : ''\r\n    const children = element.children.map(el => layouts[el.layout](el))\r\n    let str = `<el-row ${type} ${justify} ${align} ${gutter}>\r\n      ${children.join('\\n')}\r\n    </el-row>`\r\n    str = colWrapper(element, str)\r\n    return str\r\n  }\r\n}\r\n\r\nconst tags = {\r\n  'el-button': el => {\r\n    const {\r\n      tag, disabled\r\n    } = attrBuilder(el)\r\n    const type = el.type ? `type=\"${el.type}\"` : ''\r\n    const icon = el.icon ? `icon=\"${el.icon}\"` : ''\r\n    const size = el.size ? `size=\"${el.size}\"` : ''\r\n    let child = buildElButtonChild(el)\r\n\r\n    if (child) child = `\\n${child}\\n` // 鎹㈣\r\n    return `<${el.tag} ${type} ${icon} ${size} ${disabled}>${child}</${el.tag}>`\r\n  },\r\n  'el-input': el => {\r\n    const {\r\n      disabled, vModel, clearable, placeholder, width\r\n    } = attrBuilder(el)\r\n    const maxlength = el.maxlength ? `:maxlength=\"${el.maxlength}\"` : ''\r\n    const showWordLimit = el['show-word-limit'] ? 'show-word-limit' : ''\r\n    const readonly = el.readonly ? 'readonly' : ''\r\n    const prefixIcon = el['prefix-icon'] ? `prefix-icon='${el['prefix-icon']}'` : ''\r\n    const suffixIcon = el['suffix-icon'] ? `suffix-icon='${el['suffix-icon']}'` : ''\r\n    const showPassword = el['show-password'] ? 'show-password' : ''\r\n    const type = el.type ? `type=\"${el.type}\"` : ''\r\n    const autosize = el.autosize && el.autosize.minRows\r\n      ? `:autosize=\"{minRows: ${el.autosize.minRows}, maxRows: ${el.autosize.maxRows}}\"`\r\n      : ''\r\n    let child = buildElInputChild(el)\r\n\r\n    if (child) child = `\\n${child}\\n` // 鎹㈣\r\n    return `<${el.tag} ${vModel} ${type} ${placeholder} ${maxlength} ${showWordLimit} ${readonly} ${disabled} ${clearable} ${prefixIcon} ${suffixIcon} ${showPassword} ${autosize} ${width}>${child}</${el.tag}>`\r\n  },\r\n  'el-input-number': el => {\r\n    const { disabled, vModel, placeholder } = attrBuilder(el)\r\n    const controlsPosition = el['controls-position'] ? `controls-position=${el['controls-position']}` : ''\r\n    const min = el.min ? `:min='${el.min}'` : ''\r\n    const max = el.max ? `:max='${el.max}'` : ''\r\n    const step = el.step ? `:step='${el.step}'` : ''\r\n    const stepStrictly = el['step-strictly'] ? 'step-strictly' : ''\r\n    const precision = el.precision ? `:precision='${el.precision}'` : ''\r\n\r\n    return `<${el.tag} ${vModel} ${placeholder} ${step} ${stepStrictly} ${precision} ${controlsPosition} ${min} ${max} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-select': el => {\r\n    const {\r\n      disabled, vModel, clearable, placeholder, width\r\n    } = attrBuilder(el)\r\n    const filterable = el.filterable ? 'filterable' : ''\r\n    const multiple = el.multiple ? 'multiple' : ''\r\n    let child = buildElSelectChild(el)\r\n\r\n    if (child) child = `\\n${child}\\n` // 鎹㈣\r\n    return `<${el.tag} ${vModel} ${placeholder} ${disabled} ${multiple} ${filterable} ${clearable} ${width}>${child}</${el.tag}>`\r\n  },\r\n  'el-radio-group': el => {\r\n    const { disabled, vModel } = attrBuilder(el)\r\n    const size = `size=\"${el.size}\"`\r\n    let child = buildElRadioGroupChild(el)\r\n\r\n    if (child) child = `\\n${child}\\n` // 鎹㈣\r\n    return `<${el.tag} ${vModel} ${size} ${disabled}>${child}</${el.tag}>`\r\n  },\r\n  'el-checkbox-group': el => {\r\n    const { disabled, vModel } = attrBuilder(el)\r\n    const size = `size=\"${el.size}\"`\r\n    const min = el.min ? `:min=\"${el.min}\"` : ''\r\n    const max = el.max ? `:max=\"${el.max}\"` : ''\r\n    let child = buildElCheckboxGroupChild(el)\r\n\r\n    if (child) child = `\\n${child}\\n` // 鎹㈣\r\n    return `<${el.tag} ${vModel} ${min} ${max} ${size} ${disabled}>${child}</${el.tag}>`\r\n  },\r\n  'el-switch': el => {\r\n    const { disabled, vModel } = attrBuilder(el)\r\n    const activeText = el['active-text'] ? `active-text=\"${el['active-text']}\"` : ''\r\n    const inactiveText = el['inactive-text'] ? `inactive-text=\"${el['inactive-text']}\"` : ''\r\n    const activeColor = el['active-color'] ? `active-color=\"${el['active-color']}\"` : ''\r\n    const inactiveColor = el['inactive-color'] ? `inactive-color=\"${el['inactive-color']}\"` : ''\r\n    const activeValue = el['active-value'] !== true ? `:active-value='${JSON.stringify(el['active-value'])}'` : ''\r\n    const inactiveValue = el['inactive-value'] !== false ? `:inactive-value='${JSON.stringify(el['inactive-value'])}'` : ''\r\n\r\n    return `<${el.tag} ${vModel} ${activeText} ${inactiveText} ${activeColor} ${inactiveColor} ${activeValue} ${inactiveValue} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-cascader': el => {\r\n    const {\r\n      disabled, vModel, clearable, placeholder, width\r\n    } = attrBuilder(el)\r\n    const options = el.options ? `:options=\"${el.vModel}Options\"` : ''\r\n    const props = el.props ? `:props=\"${el.vModel}Props\"` : ''\r\n    const showAllLevels = el['show-all-levels'] ? '' : ':show-all-levels=\"false\"'\r\n    const filterable = el.filterable ? 'filterable' : ''\r\n    const separator = el.separator === '/' ? '' : `separator=\"${el.separator}\"`\r\n\r\n    return `<${el.tag} ${vModel} ${options} ${props} ${width} ${showAllLevels} ${placeholder} ${separator} ${filterable} ${clearable} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-slider': el => {\r\n    const { disabled, vModel } = attrBuilder(el)\r\n    const min = el.min ? `:min='${el.min}'` : ''\r\n    const max = el.max ? `:max='${el.max}'` : ''\r\n    const step = el.step ? `:step='${el.step}'` : ''\r\n    const range = el.range ? 'range' : ''\r\n    const showStops = el['show-stops'] ? `:show-stops=\"${el['show-stops']}\"` : ''\r\n\r\n    return `<${el.tag} ${min} ${max} ${step} ${vModel} ${range} ${showStops} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-time-picker': el => {\r\n    const {\r\n      disabled, vModel, clearable, placeholder, width\r\n    } = attrBuilder(el)\r\n    const startPlaceholder = el['start-placeholder'] ? `start-placeholder=\"${el['start-placeholder']}\"` : ''\r\n    const endPlaceholder = el['end-placeholder'] ? `end-placeholder=\"${el['end-placeholder']}\"` : ''\r\n    const rangeSeparator = el['range-separator'] ? `range-separator=\"${el['range-separator']}\"` : ''\r\n    const isRange = el['is-range'] ? 'is-range' : ''\r\n    const format = el.format ? `format=\"${el.format}\"` : ''\r\n    const valueFormat = el['value-format'] ? `value-format=\"${el['value-format']}\"` : ''\r\n    const pickerOptions = el['picker-options'] ? `:picker-options='${JSON.stringify(el['picker-options'])}'` : ''\r\n\r\n    return `<${el.tag} ${vModel} ${isRange} ${format} ${valueFormat} ${pickerOptions} ${width} ${placeholder} ${startPlaceholder} ${endPlaceholder} ${rangeSeparator} ${clearable} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-date-picker': el => {\r\n    const {\r\n      disabled, vModel, clearable, placeholder, width\r\n    } = attrBuilder(el)\r\n    const startPlaceholder = el['start-placeholder'] ? `start-placeholder=\"${el['start-placeholder']}\"` : ''\r\n    const endPlaceholder = el['end-placeholder'] ? `end-placeholder=\"${el['end-placeholder']}\"` : ''\r\n    const rangeSeparator = el['range-separator'] ? `range-separator=\"${el['range-separator']}\"` : ''\r\n    const format = el.format ? `format=\"${el.format}\"` : ''\r\n    const valueFormat = el['value-format'] ? `value-format=\"${el['value-format']}\"` : ''\r\n    const type = el.type === 'date' ? '' : `type=\"${el.type}\"`\r\n    const readonly = el.readonly ? 'readonly' : ''\r\n\r\n    return `<${el.tag} ${type} ${vModel} ${format} ${valueFormat} ${width} ${placeholder} ${startPlaceholder} ${endPlaceholder} ${rangeSeparator} ${clearable} ${readonly} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-rate': el => {\r\n    const { disabled, vModel } = attrBuilder(el)\r\n    const max = el.max ? `:max='${el.max}'` : ''\r\n    const allowHalf = el['allow-half'] ? 'allow-half' : ''\r\n    const showText = el['show-text'] ? 'show-text' : ''\r\n    const showScore = el['show-score'] ? 'show-score' : ''\r\n\r\n    return `<${el.tag} ${vModel} ${allowHalf} ${showText} ${showScore} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-color-picker': el => {\r\n    const { disabled, vModel } = attrBuilder(el)\r\n    const size = `size=\"${el.size}\"`\r\n    const showAlpha = el['show-alpha'] ? 'show-alpha' : ''\r\n    const colorFormat = el['color-format'] ? `color-format=\"${el['color-format']}\"` : ''\r\n\r\n    return `<${el.tag} ${vModel} ${size} ${showAlpha} ${colorFormat} ${disabled}></${el.tag}>`\r\n  },\r\n  'el-upload': el => {\r\n    const disabled = el.disabled ? ':disabled=\\'true\\'' : ''\r\n    const action = el.action ? `:action=\"${el.vModel}Action\"` : ''\r\n    const multiple = el.multiple ? 'multiple' : ''\r\n    const listType = el['list-type'] !== 'text' ? `list-type=\"${el['list-type']}\"` : ''\r\n    const accept = el.accept ? `accept=\"${el.accept}\"` : ''\r\n    const name = el.name !== 'file' ? `name=\"${el.name}\"` : ''\r\n    const autoUpload = el['auto-upload'] === false ? ':auto-upload=\"false\"' : ''\r\n    const beforeUpload = `:before-upload=\"${el.vModel}BeforeUpload\"`\r\n    const fileList = `:file-list=\"${el.vModel}fileList\"`\r\n    const ref = `ref=\"${el.vModel}\"`\r\n    let child = buildElUploadChild(el)\r\n\r\n    if (child) child = `\\n${child}\\n` // 鎹㈣\r\n    return `<${el.tag} ${ref} ${fileList} ${action} ${autoUpload} ${multiple} ${beforeUpload} ${listType} ${accept} ${name} ${disabled}>${child}</${el.tag}>`\r\n  }\r\n}\r\n\r\nfunction attrBuilder(el) {\r\n  return {\r\n    vModel: `v-model=\"${confGlobal.formModel}.${el.vModel}\"`,\r\n    clearable: el.clearable ? 'clearable' : '',\r\n    placeholder: el.placeholder ? `placeholder=\"${el.placeholder}\"` : '',\r\n    width: el.style && el.style.width ? ':style=\"{width: \\'100%\\'}\"' : '',\r\n    disabled: el.disabled ? ':disabled=\\'true\\'' : ''\r\n  }\r\n}\r\n\r\n// el-buttin 瀛愮骇\r\nfunction buildElButtonChild(conf) {\r\n  const children = []\r\n  if (conf.default) {\r\n    children.push(conf.default)\r\n  }\r\n  return children.join('\\n')\r\n}\r\n\r\n// el-input innerHTML\r\nfunction buildElInputChild(conf) {\r\n  const children = []\r\n  if (conf.prepend) {\r\n    children.push(`<template slot=\"prepend\">${conf.prepend}</template>`)\r\n  }\r\n  if (conf.append) {\r\n    children.push(`<template slot=\"append\">${conf.append}</template>`)\r\n  }\r\n  return children.join('\\n')\r\n}\r\n\r\nfunction buildElSelectChild(conf) {\r\n  const children = []\r\n  if (conf.options && conf.options.length) {\r\n    children.push(`<el-option v-for=\"(item, index) in ${conf.vModel}Options\" :key=\"index\" :label=\"item.label\" :value=\"item.value\" :disabled=\"item.disabled\"></el-option>`)\r\n  }\r\n  return children.join('\\n')\r\n}\r\n\r\nfunction buildElRadioGroupChild(conf) {\r\n  const children = []\r\n  if (conf.options && conf.options.length) {\r\n    const tag = conf.optionType === 'button' ? 'el-radio-button' : 'el-radio'\r\n    const border = conf.border ? 'border' : ''\r\n    children.push(`<${tag} v-for=\"(item, index) in ${conf.vModel}Options\" :key=\"index\" :value=\"item.value\" :disabled=\"item.disabled\" ${border}>{{item.label}}</${tag}>`)\r\n  }\r\n  return children.join('\\n')\r\n}\r\n\r\nfunction buildElCheckboxGroupChild(conf) {\r\n  const children = []\r\n  if (conf.options && conf.options.length) {\r\n    const tag = conf.optionType === 'button' ? 'el-checkbox-button' : 'el-checkbox'\r\n    const border = conf.border ? 'border' : ''\r\n    children.push(`<${tag} v-for=\"(item, index) in ${conf.vModel}Options\" :key=\"index\" :label=\"item.value\" :value=\"item.label\" :disabled=\"item.disabled\" ${border} />`)\r\n  }\r\n  return children.join('\\n')\r\n}\r\n\r\nfunction buildElUploadChild(conf) {\r\n  const list = []\r\n  if (conf['list-type'] === 'picture-card') list.push('<i class=\"el-icon-plus\"></i>')\r\n  else list.push(`<el-button size=\"small\" type=\"primary\" icon=\"el-icon-upload\">${conf.buttonText}</el-button>`)\r\n  if (conf.showTip) list.push(`<div slot=\"tip\" class=\"el-upload__tip\">鍙兘涓婁紶涓嶈秴杩?${conf.fileSize}${conf.sizeUnit} 鐨?{conf.accept}鏂囦欢</div>`)\r\n  return list.join('\\n')\r\n}\r\n\r\nexport function makeUpHtml(conf, type) {\r\n  const htmlList = []\r\n  confGlobal = conf\r\n  someSpanIsNot24 = conf.fields.some(item => item.span !== 24)\r\n  conf.fields.forEach(el => {\r\n    htmlList.push(layouts[el.layout](el))\r\n  })\r\n  const htmlStr = htmlList.join('\\n')\r\n\r\n  let temp = buildFormTemplate(conf, htmlStr, type)\r\n  if (type === 'dialog') {\r\n    temp = dialogWrapper(temp)\r\n  }\r\n  confGlobal = null\r\n  return temp\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\generator\\js.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\generator\\render.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'useVModel' is defined but never used. Allowed unused vars must match /^_/u.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":36,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":44,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":54,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":25},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":64,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":64,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":85,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":85,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { defineComponent, h } from 'vue'\r\nimport { makeMap } from '@/utils/index'\r\n\r\nconst isAttr = makeMap(\r\n  'accept,accept-charset,accesskey,action,align,alt,async,autocomplete,' +\r\n  'autofocus,autoplay,autosave,bgcolor,border,buffered,challenge,charset,' +\r\n  'checked,cite,class,code,codebase,color,cols,colspan,content,http-equiv,' +\r\n  'name,contenteditable,contextmenu,controls,coords,data,datetime,default,' +\r\n  'defer,dir,dirname,disabled,download,draggable,dropzone,enctype,method,for,' +\r\n  'form,formaction,headers,height,hidden,high,href,hreflang,http-equiv,' +\r\n  'icon,id,ismap,itemprop,keytype,kind,label,lang,language,list,loop,low,' +\r\n  'manifest,max,maxlength,media,method,GET,POST,min,multiple,email,file,' +\r\n  'muted,name,novalidate,open,optimum,pattern,ping,placeholder,poster,' +\r\n  'preload,radiogroup,readonly,rel,required,reversed,rows,rowspan,sandbox,' +\r\n  'scope,scoped,seamless,selected,shape,size,type,text,password,sizes,span,' +\r\n  'spellcheck,src,srcdoc,srclang,srcset,start,step,style,summary,tabindex,' +\r\n  'target,title,type,usemap,value,width,wrap' + 'prefix-icon'\r\n)\r\nconst isNotProps = makeMap(\r\n  'layout,prepend,regList,tag,document,changeTag,defaultValue'\r\n)\r\n\r\nfunction useVModel(props, emit) {\r\n  return {\r\n    modelValue: props.defaultValue,\r\n    'onUpdate:modelValue': (val) => emit('update:modelValue', val),\r\n  }\r\n}\r\nconst componentChild = {\r\n  'el-button': {\r\n    default(h, conf, key) {\r\n      return conf[key]\r\n    },\r\n  },\r\n  'el-select': {\r\n    options(h, conf, key) {\r\n      return conf.options.map(item => h(resolveComponent('el-option'), {\r\n        label: item.label,\r\n        value: item.value,\r\n      }))\r\n    }\r\n  },\r\n  'el-radio-group': {\r\n    options(h, conf, key) {\r\n      return conf.optionType === 'button' ? conf.options.map(item => h(resolveComponent('el-checkbox-button'), {\r\n        label: item.value,\r\n      }, () => item.label)) : conf.options.map(item => h(resolveComponent('el-radio'), {\r\n        label: item.value,\r\n        border: conf.border,\r\n      }, () => item.label))\r\n    }\r\n  },\r\n  'el-checkbox-group': {\r\n    options(h, conf, key) {\r\n      return conf.optionType === 'button' ? conf.options.map(item => h(resolveComponent('el-checkbox-button'), {\r\n        label: item.value,\r\n      }, () => item.label)) : conf.options.map(item => h(resolveComponent('el-checkbox'), {\r\n        label: item.value,\r\n        border: conf.border,\r\n      }, () => item.label))\r\n    }\r\n  },\r\n  'el-upload': {\r\n    'list-type': (h, conf, key) => {\r\n      const option = {}\r\n      // if (conf.showTip) {\r\n      //   tip = h('div', {\r\n      //     class: \"el-upload__tip\"\r\n      //   }, () => '鍙兘涓婁紶涓嶈秴杩? + conf.fileSize + conf.sizeUnit + '鐨? + conf.accept + '鏂囦欢')\r\n      // }\r\n      if (conf['list-type'] === 'picture-card') {\r\n        return h(resolveComponent('el-icon'), option, () => h(resolveComponent('Plus')))\r\n      } else {\r\n        // option.size = \"small\"\r\n        option.type = \"primary\"\r\n        option.icon = \"Upload\"\r\n        return h(resolveComponent('el-button'), option, () => conf.buttonText)\r\n      }\r\n    },\r\n\r\n  }\r\n}\r\nconst componentSlot = {\r\n  'el-upload': {\r\n    'tip': (h, conf, key) => {\r\n      if (conf.showTip) {\r\n        return () => h('div', {\r\n          class: \"el-upload__tip\"\r\n        }, '鍙兘涓婁紶涓嶈秴杩? + conf.fileSize + conf.sizeUnit + '鐨? + conf.accept + '鏂囦欢')\r\n      }\r\n    },\r\n  }\r\n}\r\nexport default defineComponent({\r\n\r\n  // 浣跨敤 render 鍑芥暟\r\n  render() {\r\n    const dataObject = {\r\n      attrs: {},\r\n      props: {},\r\n      on: {},\r\n      style: {}\r\n    }\r\n    const confClone = JSON.parse(JSON.stringify(this.conf))\r\n    const children = []\r\n    const slot = {}\r\n    const childObjs = componentChild[confClone.tag]\r\n    if (childObjs) {\r\n      Object.keys(childObjs).forEach(key => {\r\n        const childFunc = childObjs[key]\r\n        if (confClone[key]) {\r\n          children.push(childFunc(h, confClone, key))\r\n        }\r\n      })\r\n    }\r\n    const slotObjs = componentSlot[confClone.tag]\r\n    if (slotObjs) {\r\n      Object.keys(slotObjs).forEach(key => {\r\n        const childFunc = slotObjs[key]\r\n        if (confClone[key]) {\r\n          slot[key] = childFunc(h, confClone, key)\r\n        }\r\n      })\r\n    }\r\n    Object.keys(confClone).forEach(key => {\r\n      const val = confClone[key]\r\n      if (dataObject[key]) {\r\n        dataObject[key] = val\r\n      } else if (isAttr(key)) {\r\n        dataObject.attrs[key] = val\r\n      } else if (!isNotProps(key)) {\r\n        dataObject.props[key] = val\r\n      }\r\n    })\r\n    if(children.length > 0){\r\n      slot.default = () => children\r\n    }\r\n    \r\n    return h(resolveComponent(this.conf.tag),\r\n      {\r\n        modelValue: this.$attrs.modelValue,\r\n        ...dataObject.props,\r\n        ...dataObject.attrs,\r\n        style: {\r\n          ...dataObject.style\r\n        },\r\n      }\r\n      , slot ?? null)\r\n  },\r\n  props: {\r\n    conf: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n  }\r\n})","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\jsencrypt.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\mockControl.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\permission.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\request.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\ruoyi.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":144,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":144,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 閫氱敤js鏂规硶灏佽澶勭悊\r\n * Copyright (c) 2019 ruoyi\r\n */\r\n\r\n// 鏃ユ湡鏍煎紡鍖朶r\nexport function parseTime(time, pattern) {\r\n  if (arguments.length === 0 || !time) {\r\n    return null\r\n  }\r\n  const format = pattern || '{y}-{m}-{d} {h}:{i}:{s}'\r\n  let date\r\n  if (typeof time === 'object') {\r\n    date = time\r\n  } else {\r\n    if ((typeof time === 'string') && (/^[0-9]+$/.test(time))) {\r\n      time = parseInt(time)\r\n    } else if (typeof time === 'string') {\r\n      time = time.replace(new RegExp(/-/gm), '/').replace('T', ' ').replace(new RegExp(/\\.[\\d]{3}/gm), '')\r\n    }\r\n    if ((typeof time === 'number') && (time.toString().length === 10)) {\r\n      time = time * 1000\r\n    }\r\n    date = new Date(time)\r\n  }\r\n  const formatObj = {\r\n    y: date.getFullYear(),\r\n    m: date.getMonth() + 1,\r\n    d: date.getDate(),\r\n    h: date.getHours(),\r\n    i: date.getMinutes(),\r\n    s: date.getSeconds(),\r\n    a: date.getDay()\r\n  }\r\n  const time_str = format.replace(/{(y|m|d|h|i|s|a)+}/g, (result, key) => {\r\n    let value = formatObj[key]\r\n    // Note: getDay() returns 0 on Sunday\r\n    if (key === 'a') { return ['鏃?, '涓€', '浜?, '涓?, '鍥?, '浜?, '鍏?][value] }\r\n    if (result.length > 0 && value < 10) {\r\n      value = '0' + value\r\n    }\r\n    return value || 0\r\n  })\r\n  return time_str\r\n}\r\n\r\n// 琛ㄥ崟閲嶇疆\r\nexport function resetForm(refName) {\r\n  if (this.$refs[refName]) {\r\n    this.$refs[refName].resetFields()\r\n  }\r\n}\r\n\r\n// 娣诲姞鏃ユ湡鑼冨洿\r\nexport function addDateRange(params, dateRange, propName) {\r\n  let search = params\r\n  search.params = typeof (search.params) === 'object' && search.params !== null && !Array.isArray(search.params) ? search.params : {}\r\n  dateRange = Array.isArray(dateRange) ? dateRange : []\r\n  if (typeof (propName) === 'undefined') {\r\n    search.params['beginTime'] = dateRange[0]\r\n    search.params['endTime'] = dateRange[1]\r\n  } else {\r\n    search.params['begin' + propName] = dateRange[0]\r\n    search.params['end' + propName] = dateRange[1]\r\n  }\r\n  return search\r\n}\r\n\r\n// 鍥炴樉鏁版嵁瀛楀吀\r\nexport function selectDictLabel(datas, value) {\r\n  if (value === undefined) {\r\n    return \"\"\r\n  }\r\n  var actions = []\r\n  Object.keys(datas).some((key) => {\r\n    if (datas[key].value == ('' + value)) {\r\n      actions.push(datas[key].label)\r\n      return true\r\n    }\r\n  })\r\n  if (actions.length === 0) {\r\n    actions.push(value)\r\n  }\r\n  return actions.join('')\r\n}\r\n\r\n// 鍥炴樉鏁版嵁瀛楀吀锛堝瓧绗︿覆銆佹暟缁勶級\r\nexport function selectDictLabels(datas, value, separator) {\r\n  if (value === undefined || value.length ===0) {\r\n    return \"\"\r\n  }\r\n  if (Array.isArray(value)) {\r\n    value = value.join(\",\")\r\n  }\r\n  var actions = []\r\n  var currentSeparator = undefined === separator ? \",\" : separator\r\n  var temp = value.split(currentSeparator)\r\n  Object.keys(value.split(currentSeparator)).some((val) => {\r\n    var match = false\r\n    Object.keys(datas).some((key) => {\r\n      if (datas[key].value == ('' + temp[val])) {\r\n        actions.push(datas[key].label + currentSeparator)\r\n        match = true\r\n      }\r\n    })\r\n    if (!match) {\r\n      actions.push(temp[val] + currentSeparator)\r\n    }\r\n  })\r\n  return actions.join('').substring(0, actions.join('').length - 1)\r\n}\r\n\r\n// 瀛楃涓叉牸寮忓寲(%s )\r\nexport function sprintf(str) {\r\n  var args = arguments, flag = true, i = 1\r\n  str = str.replace(/%s/g, function () {\r\n    var arg = args[i++]\r\n    if (typeof arg === 'undefined') {\r\n      flag = false\r\n      return ''\r\n    }\r\n    return arg\r\n  })\r\n  return flag ? str : ''\r\n}\r\n\r\n// 杞崲瀛楃涓诧紝undefined,null绛夎浆鍖栦负\"\"\r\nexport function parseStrEmpty(str) {\r\n  if (!str || str == \"undefined\" || str == \"null\") {\r\n    return \"\"\r\n  }\r\n  return str\r\n}\r\n\r\n// 鏁版嵁鍚堝苟\r\nexport function mergeRecursive(source, target) {\r\n  for (var p in target) {\r\n    try {\r\n      if (target[p].constructor == Object) {\r\n        source[p] = mergeRecursive(source[p], target[p])\r\n      } else {\r\n        source[p] = target[p]\r\n      }\r\n    } catch (e) {\r\n      source[p] = target[p]\r\n    }\r\n  }\r\n  return source\r\n}\r\n\r\n/**\r\n * 鏋勯€犳爲鍨嬬粨鏋勬暟鎹甛r\n * @param {*} data 鏁版嵁婧怽r\n * @param {*} id id瀛楁 榛樿 'id'\r\n * @param {*} parentId 鐖惰妭鐐瑰瓧娈?榛樿 'parentId'\r\n * @param {*} children 瀛╁瓙鑺傜偣瀛楁 榛樿 'children'\r\n */\r\nexport function handleTree(data, id, parentId, children) {\r\n  let config = {\r\n    id: id || 'id',\r\n    parentId: parentId || 'parentId',\r\n    childrenList: children || 'children'\r\n  }\r\n\r\n  var childrenListMap = {}\r\n  var tree = []\r\n  for (let d of data) {\r\n    let id = d[config.id]\r\n    childrenListMap[id] = d\r\n    if (!d[config.childrenList]) {\r\n      d[config.childrenList] = []\r\n    }\r\n  }\r\n\r\n  for (let d of data) {\r\n    let parentId = d[config.parentId]\r\n    let parentObj = childrenListMap[parentId]\r\n    if (!parentObj) {\r\n      tree.push(d)\r\n    } else {\r\n      parentObj[config.childrenList].push(d)\r\n    }\r\n  }\r\n  return tree\r\n}\r\n\r\n/**\r\n* 鍙傛暟澶勭悊\r\n* @param {*} params  鍙傛暟\r\n*/\r\nexport function tansParams(params) {\r\n  let result = ''\r\n  for (const propName of Object.keys(params)) {\r\n    const value = params[propName]\r\n    var part = encodeURIComponent(propName) + \"=\"\r\n    if (value !== null && value !== \"\" && typeof (value) !== \"undefined\") {\r\n      if (typeof value === 'object') {\r\n        for (const key of Object.keys(value)) {\r\n          if (value[key] !== null && value[key] !== \"\" && typeof (value[key]) !== 'undefined') {\r\n            let params = propName + '[' + key + ']'\r\n            var subPart = encodeURIComponent(params) + \"=\"\r\n            result += subPart + encodeURIComponent(value[key]) + \"&\"\r\n          }\r\n        }\r\n      } else {\r\n        result += part + encodeURIComponent(value) + \"&\"\r\n      }\r\n    }\r\n  }\r\n  return result\r\n}\r\n\r\n// 杩斿洖椤圭洰璺緞\r\nexport function getNormalPath(p) {\r\n  if (p.length === 0 || !p || p == 'undefined') {\r\n    return p\r\n  }\r\n  let res = p.replace('//', '/')\r\n  if (res[res.length - 1] === '/') {\r\n    return res.slice(0, res.length - 1)\r\n  }\r\n  return res\r\n}\r\n\r\n// 楠岃瘉鏄惁涓篵lob鏍煎紡\r\nexport function blobValidate(data) {\r\n  return data.type !== 'application/json'\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\scroll-to.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\theme.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\utils\\validate.js","messages":[],"suppressedMessages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\[.","line":94,"column":25,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":94,"endColumn":26,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2182,2183],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2182,2182],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\[.","line":94,"column":50,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":94,"endColumn":51,"suggestions":[{"messageId":"removeEscape","fix":{"range":[2207,2208],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[2207,2207],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\config.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\constants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\create.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'reactive' is defined but never used. Allowed unused vars must match /^_/u.","line":205,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":205,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鍩烘湰淇℃伅 -->\r\n    <el-card class=\"mb20\">\r\n      <template #header>\r\n        <span>宸℃鍩烘湰淇℃伅</span>\r\n        <el-button \r\n          v-if=\"!inspectionId\"\r\n          type=\"info\" \r\n          style=\"float: right\"\r\n          @click=\"handleCopyLast\"\r\n        >澶嶅埗涓婃宸℃</el-button>\r\n      </template>\r\n      \r\n      <el-form ref=\"inspectionRef\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"宸℃鏃ユ湡\" prop=\"inspectionDate\">\r\n              <el-date-picker\r\n                v-model=\"form.inspectionDate\"\r\n                type=\"date\"\r\n                placeholder=\"閫夋嫨鏃ユ湡\"\r\n                format=\"YYYY-MM-DD\"\r\n                value-format=\"YYYY-MM-DD\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"宸℃浜哄憳\" prop=\"inspectorName\">\r\n              <el-input v-model=\"form.inspectorName\" placeholder=\"璇疯緭鍏ュ贰妫€浜哄憳\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"鎺ュ姏浜哄憳\">\r\n              <el-input v-model=\"form.relayPerson\" placeholder=\"鎺ュ姏浜哄憳锛堝彲閫夛級\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"24\">\r\n            <el-form-item label=\"澶囨敞\">\r\n              <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ娉╘" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n    </el-card>\r\n\r\n    <!-- 宸℃杩涘害 -->\r\n    <el-card class=\"mb20\">\r\n      <div class=\"progress-info\">\r\n        <span>宸℃杩涘害锛?/span>\r\n        <el-progress \r\n          :percentage=\"progress\" \r\n          :status=\"progress === 100 ? 'success' : ''\"\r\n          style=\"width: 400px\"\r\n        />\r\n        <span class=\"ml10\">{{ completedCount }}/{{ totalCount }}椤?/span>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 宸℃椤圭洰 -->\r\n    <el-card>\r\n      <template #header>\r\n        <span>宸℃椤圭洰</span>\r\n      </template>\r\n      \r\n      <el-tabs v-model=\"activeTab\">\r\n        <el-tab-pane label=\"1妤硷紙22椤癸級\" name=\"floor1\">\r\n          <div class=\"inspection-items\">\r\n            <div v-for=\"(item, index) in INSPECTION_ITEMS.floor1\" :key=\"item.id\" class=\"inspection-item\">\r\n              <div class=\"item-index\">{{ index + 1 }}</div>\r\n              <div class=\"item-content\">\r\n                <div class=\"item-label\">\r\n                  {{ item.label }}\r\n                  <el-tag v-if=\"item.type === 'number'\" size=\"small\" type=\"info\">\r\n                    {{ item.unit }}\r\n                  </el-tag>\r\n                </div>\r\n                <div class=\"item-input\">\r\n                  <el-radio-group v-if=\"item.type === 'boolean'\" v-model=\"form.items.floor1[item.id]\">\r\n                    <el-radio :label=\"true\">姝ｅ父</el-radio>\r\n                    <el-radio :label=\"false\">寮傚父</el-radio>\r\n                  </el-radio-group>\r\n                  <el-input-number\r\n                    v-else-if=\"item.type === 'number'\"\r\n                    v-model=\"form.items.floor1[item.id]\"\r\n                    :min=\"item.min\"\r\n                    :max=\"item.max\"\r\n                    :precision=\"2\"\r\n                    :controls-position=\"'right'\"\r\n                  />\r\n                  <span v-if=\"item.type === 'number'\" class=\"ml10\">{{ item.unit }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-tab-pane>\r\n        \r\n        <el-tab-pane label=\"2妤硷紙18椤癸級\" name=\"floor2\">\r\n          <div class=\"inspection-items\">\r\n            <div v-for=\"(item, index) in INSPECTION_ITEMS.floor2\" :key=\"item.id\" class=\"inspection-item\">\r\n              <div class=\"item-index\">{{ index + 1 }}</div>\r\n              <div class=\"item-content\">\r\n                <div class=\"item-label\">{{ item.label }}</div>\r\n                <div class=\"item-input\">\r\n                  <el-radio-group v-model=\"form.items.floor2[item.id]\">\r\n                    <el-radio :label=\"true\">姝ｅ父</el-radio>\r\n                    <el-radio :label=\"false\">寮傚父</el-radio>\r\n                  </el-radio-group>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-tab-pane>\r\n        \r\n        <el-tab-pane label=\"3妤硷紙13椤癸級\" name=\"floor3\">\r\n          <div class=\"inspection-items\">\r\n            <div v-for=\"(item, index) in INSPECTION_ITEMS.floor3\" :key=\"item.id\" class=\"inspection-item\">\r\n              <div class=\"item-index\">{{ index + 1 }}</div>\r\n              <div class=\"item-content\">\r\n                <div class=\"item-label\">{{ item.label }}</div>\r\n                <div class=\"item-input\">\r\n                  <el-radio-group v-model=\"form.items.floor3[item.id]\">\r\n                    <el-radio :label=\"true\">姝ｅ父</el-radio>\r\n                    <el-radio :label=\"false\">寮傚父</el-radio>\r\n                  </el-radio-group>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-tab-pane>\r\n        \r\n        <el-tab-pane label=\"4妤硷紙3椤癸級\" name=\"floor4\">\r\n          <div class=\"inspection-items\">\r\n            <div v-for=\"(item, index) in INSPECTION_ITEMS.floor4\" :key=\"item.id\" class=\"inspection-item\">\r\n              <div class=\"item-index\">{{ index + 1 }}</div>\r\n              <div class=\"item-content\">\r\n                <div class=\"item-label\">\r\n                  {{ item.label }}\r\n                  <el-tag v-if=\"item.type === 'number'\" size=\"small\" type=\"info\">\r\n                    {{ item.unit }}\r\n                  </el-tag>\r\n                </div>\r\n                <div class=\"item-input\">\r\n                  <el-radio-group v-if=\"item.type === 'boolean'\" v-model=\"form.items.floor4[item.id]\">\r\n                    <el-radio :label=\"true\">姝ｅ父</el-radio>\r\n                    <el-radio :label=\"false\">寮傚父</el-radio>\r\n                  </el-radio-group>\r\n                  <el-input-number\r\n                    v-else-if=\"item.type === 'number'\"\r\n                    v-model=\"form.items.floor4[item.id]\"\r\n                    :min=\"item.min\"\r\n                    :max=\"item.max\"\r\n                    :precision=\"0\"\r\n                  />\r\n                  <span v-if=\"item.type === 'number'\" class=\"ml10\">{{ item.unit }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n    </el-card>\r\n\r\n    <!-- 鐜板満鐓х墖 -->\r\n    <el-card class=\"mt20\">\r\n      <template #header>\r\n        <span>鐜板満鐓х墖</span>\r\n      </template>\r\n      <image-upload v-model=\"form.photos\" :limit=\"6\" />\r\n    </el-card>\r\n\r\n    <!-- 鎿嶄綔鎸夐挳 -->\r\n    <div class=\"mt20 text-center\">\r\n      <el-button type=\"primary\" @click=\"handleSubmit\">淇濆瓨骞舵鏌ュ紓甯?/el-button>\r\n      <el-button @click=\"handleCancel\">鍙栨秷</el-button>\r\n    </div>\r\n\r\n    <!-- 寮傚父纭瀵硅瘽妗?-->\r\n    <el-dialog title=\"妫€娴嬪埌寮傚父椤筡" v-model=\"anomalyDialogVisible\" width=\"600px\">\r\n      <el-alert :title=\"`鍙戠幇 ${anomalies.length} 涓紓甯搁」`\" type=\"warning\" :closable=\"false\" />\r\n      <el-table :data=\"anomalies\" class=\"mt10\">\r\n        <el-table-column prop=\"floor\" label=\"妤煎眰\" width=\"80\" />\r\n        <el-table-column prop=\"itemName\" label=\"妫€鏌ラ」\" />\r\n        <el-table-column prop=\"value\" label=\"寮傚父鍊糪" width=\"100\" />\r\n        <el-table-column prop=\"priority\" label=\"浼樺厛绾" width=\"80\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getPriorityType(scope.row.priority)\">\r\n              {{ scope.row.priority }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <template #footer>\r\n        <el-checkbox v-model=\"autoGenerateTickets\">鑷姩鐢熸垚宸ュ崟</el-checkbox>\r\n        <el-button @click=\"anomalyDialogVisible = false\">璺宠繃</el-button>\r\n        <el-button type=\"primary\" @click=\"confirmAnomalies\">纭</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"InspectionCreate\">\r\nimport { ref, reactive, computed, onMounted, getCurrentInstance } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { INSPECTION_ITEMS, anomalyDetectionRules, anomalyPriorityRules } from './constants'\r\nimport { addInspection, updateInspection, getInspection, getLatestInspection, generateTickets } from '@/api/business/inspection'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\n// 鏁版嵁瀹氫箟\r\nconst inspectionId = ref(route.params.id)\r\nconst activeTab = ref('floor1')\r\nconst anomalyDialogVisible = ref(false)\r\nconst anomalies = ref([])\r\nconst autoGenerateTickets = ref(true)\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({\r\n  inspectionDate: new Date().toISOString().split('T')[0],\r\n  inspectorName: '',\r\n  relayPerson: '',\r\n  remark: '',\r\n  items: {\r\n    floor1: {},\r\n    floor2: {},\r\n    floor3: {},\r\n    floor4: {}\r\n  },\r\n  photos: []\r\n})\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst rules = {\r\n  inspectionDate: [\r\n    { required: true, message: '璇烽€夋嫨宸℃鏃ユ湡', trigger: 'change' }\r\n  ],\r\n  inspectorName: [\r\n    { required: true, message: '璇疯緭鍏ュ贰妫€浜哄憳', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 璁＄畻灞炴€r\nconst totalCount = computed(() => {\r\n  return Object.values(INSPECTION_ITEMS).reduce((sum, items) => sum + items.length, 0)\r\n})\r\n\r\nconst completedCount = computed(() => {\r\n  let count = 0\r\n  Object.keys(form.value.items).forEach(floor => {\r\n    Object.values(form.value.items[floor]).forEach(value => {\r\n      if (value !== undefined && value !== null && value !== '') count++\r\n    })\r\n  })\r\n  return count\r\n})\r\n\r\nconst progress = computed(() => {\r\n  return Math.round((completedCount.value / totalCount.value) * 100)\r\n})\r\n\r\n// 澶嶅埗涓婃宸℃\r\nfunction handleCopyLast() {\r\n  getLatestInspection().then(response => {\r\n    if (response.data) {\r\n      form.value.items = response.data.items\r\n      form.value.remark = `[澶嶅埗鑷贰妫€#${response.data.inspectionNo}]`\r\n      proxy.$modal.msgSuccess('宸插鍒朵笂娆″贰妫€璁板綍')\r\n    } else {\r\n      proxy.$modal.msgWarning('娌℃湁鎵惧埌涓婃宸℃璁板綍')\r\n    }\r\n  })\r\n}\r\n\r\n// 妫€娴嬪紓甯竆r\nfunction detectAnomalies() {\r\n  const detectedAnomalies = []\r\n  \r\n  Object.keys(INSPECTION_ITEMS).forEach(floor => {\r\n    const items = INSPECTION_ITEMS[floor]\r\n    const values = form.value.items[floor]\r\n    \r\n    items.forEach(item => {\r\n      const value = values[item.id]\r\n      if (value === undefined || value === null) return\r\n      \r\n      let isAnomaly = false\r\n      if (item.type === 'boolean') {\r\n        isAnomaly = anomalyDetectionRules.boolean(value)\r\n      } else if (item.type === 'number' && anomalyDetectionRules.number[item.id]) {\r\n        isAnomaly = anomalyDetectionRules.number[item.id](value)\r\n      }\r\n      \r\n      if (isAnomaly) {\r\n        detectedAnomalies.push({\r\n          floor: floor.replace('floor', '') + '妤?,\r\n          itemId: item.id,\r\n          itemName: item.label,\r\n          value: value,\r\n          priority: determinePriority(item.label)\r\n        })\r\n      }\r\n    })\r\n  })\r\n  \r\n  return detectedAnomalies\r\n}\r\n\r\n// 纭畾浼樺厛绾r\nfunction determinePriority(itemName) {\r\n  for (const [priority, keywords] of Object.entries(anomalyPriorityRules)) {\r\n    if (keywords.some(keyword => itemName.includes(keyword))) {\r\n      return priority\r\n    }\r\n  }\r\n  return 'low'\r\n}\r\n\r\n// 鎻愪氦琛ㄥ崟\r\nfunction handleSubmit() {\r\n  proxy.$refs.inspectionRef.validate(valid => {\r\n    if (valid) {\r\n      // 妫€娴嬪紓甯竆r\n      anomalies.value = detectAnomalies()\r\n      \r\n      if (anomalies.value.length > 0) {\r\n        anomalyDialogVisible.value = true\r\n      } else {\r\n        saveInspection()\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 淇濆瓨宸℃\r\nfunction saveInspection() {\r\n  const data = {\r\n    ...form.value,\r\n    anomalyCount: anomalies.value.length,\r\n    progress: progress.value\r\n  }\r\n  \r\n  if (inspectionId.value) {\r\n    updateInspection(data).then(() => {\r\n      proxy.$modal.msgSuccess('淇敼鎴愬姛')\r\n      router.push('/business/inspection')\r\n    })\r\n  } else {\r\n    addInspection(data).then(() => {\r\n      proxy.$modal.msgSuccess('鏂板鎴愬姛')\r\n      router.push('/business/inspection')\r\n    })\r\n  }\r\n}\r\n\r\n// 纭寮傚父澶勭悊\r\nfunction confirmAnomalies() {\r\n  if (autoGenerateTickets.value && anomalies.value.length > 0) {\r\n    generateTickets(inspectionId.value, anomalies.value).then(response => {\r\n      proxy.$modal.msgSuccess(`宸茬敓鎴?${response.data.length} 涓伐鍗昤)\r\n    })\r\n  }\r\n  \r\n  anomalyDialogVisible.value = false\r\n  saveInspection()\r\n}\r\n\r\n// 鍙栨秷\r\nfunction handleCancel() {\r\n  router.back()\r\n}\r\n\r\n// 鑾峰彇浼樺厛绾х被鍨媆r\nfunction getPriorityType(priority) {\r\n  const types = {\r\n    high: 'danger',\r\n    medium: 'warning',\r\n    low: 'info'\r\n  }\r\n  return types[priority] || 'info'\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(() => {\r\n  if (inspectionId.value) {\r\n    getInspection(inspectionId.value).then(response => {\r\n      form.value = response.data\r\n    })\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.mb20 {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.mt20 {\r\n  margin-top: 20px;\r\n}\r\n\r\n.mt10 {\r\n  margin-top: 10px;\r\n}\r\n\r\n.ml10 {\r\n  margin-left: 10px;\r\n}\r\n\r\n.text-center {\r\n  text-align: center;\r\n}\r\n\r\n.progress-info {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px 0;\r\n}\r\n\r\n.inspection-items {\r\n  .inspection-item {\r\n    display: flex;\r\n    padding: 15px;\r\n    border-bottom: 1px solid #ebeef5;\r\n    \r\n    &:hover {\r\n      background-color: #f5f7fa;\r\n    }\r\n    \r\n    .item-index {\r\n      width: 40px;\r\n      height: 40px;\r\n      background-color: #409eff;\r\n      color: white;\r\n      border-radius: 50%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      font-weight: bold;\r\n      margin-right: 20px;\r\n    }\r\n    \r\n    .item-content {\r\n      flex: 1;\r\n      \r\n      .item-label {\r\n        margin-bottom: 10px;\r\n        font-size: 14px;\r\n        font-weight: 500;\r\n      }\r\n      \r\n      .item-input {\r\n        display: flex;\r\n        align-items: center;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\detail.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getInspection' is defined but never used. Allowed unused vars must match /^_/u.","line":241,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":241,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'generateTickets' is defined but never used. Allowed unused vars must match /^_/u.","line":241,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":241,"endColumn":40},{"ruleId":"no-unused-vars","severity":1,"message":"'addTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":242,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":242,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'ticket_status' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":256,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":256,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'equipment_specialty' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":256,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":256,"endColumn":60},{"ruleId":"no-unused-vars","severity":1,"message":"'evaluateItems' is defined but never used. Allowed unused vars must match /^_/u.","line":294,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":294,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'item' is defined but never used. Allowed unused args must match /^_/u.","line":367,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":367,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'item' is defined but never used. Allowed unused args must match /^_/u.","line":388,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":388,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 澶撮儴淇℃伅鍗＄墖 -->\r\n    <el-card class=\"header-card\">\r\n      <div class=\"header-content\">\r\n        <div class=\"header-left\">\r\n          <el-button link type=\"primary\" icon=\"Back\" @click=\"handleClose\">杩斿洖鍒楄〃</el-button>\r\n        </div>\r\n        <div class=\"header-center\">\r\n          <h2>宸℃璇︽儏 - {{ form.inspectionNo }}</h2>\r\n        </div>\r\n        <div class=\"header-right\">\r\n          <el-button type=\"primary\" icon=\"Printer\" @click=\"handlePrint\">鎵撳嵃</el-button>\r\n          <el-button type=\"success\" icon=\"Download\" @click=\"handleExport\">瀵煎嚭鎶ュ憡</el-button>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 鍩烘湰淇℃伅 -->\r\n    <el-card class=\"info-card\" v-loading=\"loading\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span class=\"descriptions-title\">鍩烘湰淇℃伅</span>\r\n          <div>\r\n            <el-tag v-if=\"form.isCopied === 'Y'\" type=\"info\">澶嶅埗</el-tag>\r\n            <el-tag v-if=\"form.anomalyCount > 0\" type=\"danger\">\r\n              寮傚父锛歿{ form.anomalyCount }}椤筡r\n            </el-tag>\r\n            <el-tag v-else type=\"success\">姝ｅ父</el-tag>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      \r\n      <el-descriptions :column=\"3\" border>\r\n        <el-descriptions-item label=\"宸℃缂栧彿\">\r\n          <span class=\"text-primary\">{{ form.inspectionNo }}</span>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"宸℃妤煎眰\">\r\n          <dict-tag :options=\"floor_dict\" :value=\"form.floor\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"宸℃鏃ユ湡\">\r\n          {{ parseTime(form.inspectionDate, '{y}-{m}-{d}') }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"宸℃浜哄憳\">\r\n          {{ form.inspectorName }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎺ュ姏浜哄憳\">\r\n          {{ form.relayPerson || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹屾垚杩涘害\">\r\n          <el-progress \r\n            :percentage=\"form.progress\" \r\n            :status=\"form.progress === 100 ? 'success' : ''\"\r\n          />\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"妫€鏌ラ」鐩甛">\r\n          {{ completedItems }}/{{ totalItems }}椤筡r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鐢熸垚宸ュ崟\">\r\n          <el-link \r\n            v-if=\"form.ticketCount > 0\"\r\n            type=\"primary\" \r\n            @click=\"viewTickets\"\r\n          >\r\n            {{ form.ticketCount }}涓猏r\n          </el-link>\r\n          <span v-else>0涓?/span>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鍒涘缓鏃堕棿\">\r\n          {{ parseTime(form.createTime) }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"澶囨敞\" :span=\"3\">\r\n          {{ form.remark || '鏃? }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n    </el-card>\r\n\r\n    <!-- 宸℃椤圭洰缁撴灉 -->\r\n    <el-card class=\"items-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span class=\"descriptions-title\">宸℃椤圭洰缁撴灉</span>\r\n          <el-radio-group v-model=\"filterType\" @change=\"handleFilterChange\">\r\n            <el-radio-button label=\"all\">鍏ㄩ儴</el-radio-button>\r\n            <el-radio-button label=\"normal\">姝ｅ父</el-radio-button>\r\n            <el-radio-button label=\"anomaly\">寮傚父</el-radio-button>\r\n          </el-radio-group>\r\n        </div>\r\n      </template>\r\n\r\n      <!-- 缁熻淇℃伅 -->\r\n      <el-row :gutter=\"20\" class=\"statistics-row\">\r\n        <el-col :span=\"6\">\r\n          <el-statistic title=\"鎬绘鏌ラ」\" :value=\"statistics.total\">\r\n            <template #suffix>椤?/template>\r\n          </el-statistic>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-statistic title=\"姝ｅ父椤筡" :value=\"statistics.normal\" value-style=\"color: #67c23a\">\r\n            <template #suffix>椤?/template>\r\n          </el-statistic>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-statistic title=\"寮傚父椤筡" :value=\"statistics.anomaly\" value-style=\"color: #f56c6c\">\r\n            <template #suffix>椤?/template>\r\n          </el-statistic>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-statistic title=\"寮傚父鐜嘰" :value=\"statistics.anomalyRate\" :precision=\"1\">\r\n            <template #suffix>%</template>\r\n          </el-statistic>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <!-- 椤圭洰鍒楄〃 -->\r\n      <el-table \r\n        :data=\"filteredItems\" \r\n        stripe\r\n        :row-class-name=\"getRowClassName\"\r\n        class=\"items-table\"\r\n      >\r\n        <el-table-column label=\"搴忓彿\" type=\"index\" width=\"60\" align=\"center\" />\r\n        <el-table-column label=\"妫€鏌ラ」鐩甛" prop=\"label\" min-width=\"300\" show-overflow-tooltip />\r\n        <el-table-column label=\"绫诲瀷\" prop=\"type\" width=\"80\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-tag size=\"small\" type=\"info\">\r\n              {{ scope.row.type === 'boolean' ? '鐘舵€? : '鏁板€? }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"妫€鏌ョ粨鏋淺" prop=\"value\" width=\"150\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <div v-if=\"scope.row.type === 'boolean'\">\r\n              <el-tag v-if=\"scope.row.value === true\" type=\"success\">姝ｅ父</el-tag>\r\n              <el-tag v-else-if=\"scope.row.value === false\" type=\"danger\">寮傚父</el-tag>\r\n              <el-tag v-else type=\"info\">鏈鏌?/el-tag>\r\n            </div>\r\n            <div v-else>\r\n              <span v-if=\"scope.row.value !== null && scope.row.value !== undefined\">\r\n                {{ scope.row.value }} {{ scope.row.unit }}\r\n              </span>\r\n              <el-tag v-else type=\"info\" size=\"small\">鏈～鍐?/el-tag>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"姝ｅ父鑼冨洿\" prop=\"range\" width=\"150\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <span v-if=\"scope.row.type === 'boolean'\">姝ｅ父</span>\r\n            <span v-else-if=\"scope.row.min !== undefined\">\r\n              {{ scope.row.min }}-{{ scope.row.max }} {{ scope.row.unit }}\r\n            </span>\r\n            <span v-else>-</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"鐘舵€乗" prop=\"status\" width=\"100\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-tag v-if=\"scope.row.isAnomaly\" type=\"danger\" effect=\"dark\">寮傚父</el-tag>\r\n            <el-tag v-else-if=\"scope.row.value !== null && scope.row.value !== undefined\" type=\"success\">姝ｅ父</el-tag>\r\n            <el-tag v-else type=\"info\">鏈鏌?/el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"鐢熸垚宸ュ崟\" width=\"120\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-link \r\n              v-if=\"scope.row.ticketNo\" \r\n              type=\"primary\"\r\n              @click=\"viewTicketDetail(scope.row.ticketId)\"\r\n            >\r\n              {{ scope.row.ticketNo }}\r\n            </el-link>\r\n            <span v-else>-</span>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n\r\n    <!-- 寮傚父椤规眹鎬?-->\r\n    <el-card class=\"anomaly-card\" v-if=\"anomalyItems.length > 0\">\r\n      <template #header>\r\n        <span class=\"descriptions-title\">寮傚父椤规眹鎬?/span>\r\n      </template>\r\n      <el-alert\r\n        title=\"鍙戠幇浠ヤ笅寮傚父椤癸紝璇峰強鏃跺鐞哱"\r\n        type=\"warning\"\r\n        :closable=\"false\"\r\n        show-icon\r\n      />\r\n      <div class=\"anomaly-list\">\r\n        <div v-for=\"(item, index) in anomalyItems\" :key=\"index\" class=\"anomaly-item\">\r\n          <div class=\"anomaly-header\">\r\n            <span class=\"anomaly-index\">{{ index + 1 }}</span>\r\n            <span class=\"anomaly-title\">{{ item.label }}</span>\r\n            <dict-tag :options=\"ticket_priority\" :value=\"item.priority\"/>\r\n          </div>\r\n          <div class=\"anomaly-content\">\r\n            <el-row>\r\n              <el-col :span=\"8\">\r\n                <span class=\"label\">寮傚父鍊硷細</span>\r\n                <span class=\"value danger\">{{ formatValue(item) }}</span>\r\n              </el-col>\r\n              <el-col :span=\"8\">\r\n                <span class=\"label\">姝ｅ父鑼冨洿锛?/span>\r\n                <span class=\"value\">{{ formatRange(item) }}</span>\r\n              </el-col>\r\n              <el-col :span=\"8\">\r\n                <span class=\"label\">宸ュ崟鐘舵€侊細</span>\r\n                <span class=\"value\">\r\n                  <el-link \r\n                    v-if=\"item.ticketNo\" \r\n                    type=\"primary\"\r\n                    @click=\"viewTicketDetail(item.ticketId)\"\r\n                  >\r\n                    {{ item.ticketNo }}\r\n                  </el-link>\r\n                  <el-button\r\n                    v-else\r\n                    link\r\n                    type=\"primary\"\r\n                    size=\"small\"\r\n                    @click=\"generateTicket(item)\"\r\n                  >\r\n                    鐢熸垚宸ュ崟\r\n                  </el-button>\r\n                </span>\r\n              </el-col>\r\n            </el-row>\r\n            <div class=\"suggestion\">\r\n              <span class=\"label\">澶勭悊寤鸿锛?/span>\r\n              {{ getHandlingSuggestion(item) }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"InspectionDetail\">\r\nimport { getCurrentInstance, ref, computed } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { getInspection, generateTickets } from \"@/api/business/inspection\"\r\nimport { addTicket } from \"@/api/business/ticket\"\r\nimport { FLOORS, INSPECTION_ITEMS, anomalyDetectionRules, anomalyPriorityRules } from \"./constants\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst inspectionId = route.params && route.params.id\r\nconst loading = ref(false)\r\nconst filterType = ref('all')\r\nconst form = ref({})\r\nconst inspectionItems = ref([])\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { ticket_status, ticket_priority, equipment_specialty } = proxy.useDict('ticket_status', 'ticket_priority', 'equipment_specialty')\r\n\r\n// 妤煎眰瀛楀吀\r\nconst floor_dict = FLOORS.map(f => ({ label: f.label, value: f.value }))\r\n\r\n// 缁熻鏁版嵁\r\nconst totalItems = computed(() => {\r\n  const floorItems = INSPECTION_ITEMS[form.value.floor]\r\n  return floorItems ? floorItems.length : 0\r\n})\r\n\r\nconst completedItems = computed(() => {\r\n  return inspectionItems.value.filter(item => item.value !== null && item.value !== undefined).length\r\n})\r\n\r\nconst statistics = computed(() => {\r\n  const total = inspectionItems.value.length\r\n  const normal = inspectionItems.value.filter(item => !item.isAnomaly && item.value !== null).length\r\n  const anomaly = inspectionItems.value.filter(item => item.isAnomaly).length\r\n  const anomalyRate = total > 0 ? (anomaly / total) * 100 : 0\r\n  \r\n  return { total, normal, anomaly, anomalyRate }\r\n})\r\n\r\n// 杩囨护鍚庣殑椤圭洰\r\nconst filteredItems = computed(() => {\r\n  if (filterType.value === 'normal') {\r\n    return inspectionItems.value.filter(item => !item.isAnomaly && item.value !== null)\r\n  }\r\n  if (filterType.value === 'anomaly') {\r\n    return inspectionItems.value.filter(item => item.isAnomaly)\r\n  }\r\n  return inspectionItems.value\r\n})\r\n\r\n// 寮傚父椤筡r\nconst anomalyItems = computed(() => inspectionItems.value.filter(item => item.isAnomaly))\r\n\r\nfunction evaluateItems() {\r\n  inspectionItems.value = inspectionItems.value.map(item => {\r\n    const value = item.value\r\n    let isAnomaly = false\r\n    if (value !== null && value !== undefined) {\r\n      if (item.type === 'boolean') {\r\n        isAnomaly = anomalyDetectionRules.boolean(value)\r\n      } else if (item.type === 'number' && anomalyDetectionRules.number[item.id]) {\r\n        isAnomaly = anomalyDetectionRules.number[item.id](value)\r\n      }\r\n    }\r\n    if (isAnomaly) {\r\n      // 璁＄畻浼樺厛绾r\n      let priority = 'low'\r\n      for (const [p, keywords] of Object.entries(anomalyPriorityRules)) {\r\n        if (keywords.some(k => item.label.includes(k))) { priority = p; break }\r\n      }\r\n      return { ...item, isAnomaly: true, priority }\r\n    }\r\n    return { ...item, isAnomaly: false }\r\n  })\r\n}\r\n\r\n/** 鑾峰彇宸℃璇︽儏 */\r\nfunction getDetail() {\r\n  loading.value = true\r\n  // Mock鏁版嵁\r\n  setTimeout(() => {\r\n    form.value = {\r\n      inspectionId: inspectionId,\r\n      inspectionNo: 'INS202501001',\r\n      floor: 'floor1',\r\n      inspectionDate: new Date(),\r\n      inspectorName: '寮犱笁',\r\n      relayPerson: '鏉庡洓',\r\n      progress: 100,\r\n      anomalyCount: 2,\r\n      ticketCount: 1,\r\n      createTime: new Date(),\r\n      remark: '渚嬭宸℃'\r\n    }\r\n    \r\n    // Mock宸℃椤圭洰鏁版嵁\r\n    inspectionItems.value = [\r\n      { id: 'oil_tank', label: '鍦板煁娌圭綈鍙婅搫鍐风綈鏄惁姝ｅ父', type: 'boolean', value: true, isAnomaly: false },\r\n      { id: 'electric_room', label: '鍗椾晶鐢垫皵闂寸幆澧冭鏂芥槸鍚︽甯?, type: 'boolean', value: false, isAnomaly: true, priority: 'medium' },\r\n      { id: 'pump_pressure', label: '鍐峰喕娉靛洖姘村帇鍔?, type: 'number', value: 0.5, unit: 'MPa', min: 0.3, max: 0.6, isAnomaly: false }\r\n    ]\r\n    \r\n    loading.value = false\r\n  }, 500)\r\n}\r\n\r\n/** 鏍煎紡鍖栧€?*/\r\nfunction formatValue(item) {\r\n  if (item.type === 'boolean') {\r\n    return item.value ? '姝ｅ父' : '寮傚父'\r\n  }\r\n  return `${item.value} ${item.unit || ''}`\r\n}\r\n\r\n/** 鏍煎紡鍖栬寖鍥?*/\r\nfunction formatRange(item) {\r\n  if (item.type === 'boolean') {\r\n    return '姝ｅ父'\r\n  }\r\n  if (item.min !== undefined) {\r\n    return `${item.min}-${item.max} ${item.unit || ''}`\r\n  }\r\n  return '-'\r\n}\r\n\r\n/** 鑾峰彇澶勭悊寤鸿 */\r\nfunction getHandlingSuggestion(item) {\r\n  return '璇峰敖蹇墠寰€鐜板満妫€鏌ュ苟澶勭悊'\r\n}\r\n\r\n/** 鑾峰彇琛屾牱寮?*/\r\nfunction getRowClassName({ row }) {\r\n  if (row.isAnomaly) {\r\n    return 'anomaly-row'\r\n  }\r\n  if (row.value === null || row.value === undefined) {\r\n    return 'unchecked-row'\r\n  }\r\n  return ''\r\n}\r\n\r\n/** 绛涢€夊彉鍖?*/\r\nfunction handleFilterChange() {\r\n  // 绛涢€夐€昏緫宸查€氳繃computed灞炴€у鐞哱r\n}\r\n\r\n/** 鐢熸垚鍗曚釜宸ュ崟 */\r\nfunction generateTicket(item) {\r\n  proxy.$modal.msgSuccess(\"宸ュ崟鐢熸垚鎴愬姛\")\r\n}\r\n\r\n/** 鏌ョ湅宸ュ崟鍒楄〃 */\r\nfunction viewTickets() {\r\n  router.push('/business/ticket')\r\n}\r\n\r\n/** 鏌ョ湅宸ュ崟璇︽儏 */\r\nfunction viewTicketDetail(id) {\r\n  router.push('/business/ticket/detail/' + id)\r\n}\r\n\r\n/** 鎵撳嵃 */\r\nfunction handlePrint() {\r\n  window.print()\r\n}\r\n\r\n/** 瀵煎嚭鎶ュ憡 */\r\nfunction handleExport() {\r\n  proxy.$modal.msgSuccess(\"瀵煎嚭鍔熻兘寰呭疄鐜癨")\r\n}\r\n\r\n/** 杩斿洖 */\r\nfunction handleClose() {\r\n  router.back()\r\n}\r\n\r\ngetDetail()\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.header-card {\r\n  margin-bottom: 20px;\r\n  \r\n  .header-content {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    \r\n    .header-center h2 {\r\n      margin: 0;\r\n      font-size: 18px;\r\n    }\r\n  }\r\n}\r\n\r\n.info-card,\r\n.items-card,\r\n.anomaly-card {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.descriptions-title {\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n}\r\n\r\n.text-primary {\r\n  color: #409EFF;\r\n  font-weight: bold;\r\n}\r\n\r\n.statistics-row {\r\n  margin-bottom: 20px;\r\n  padding: 20px;\r\n  background: #f5f7fa;\r\n  border-radius: 4px;\r\n}\r\n\r\n.items-table {\r\n  :deep(.anomaly-row) {\r\n    background-color: #fef0f0;\r\n  }\r\n  \r\n  :deep(.unchecked-row) {\r\n    background-color: #f5f5f5;\r\n  }\r\n}\r\n\r\n.anomaly-list {\r\n  margin-top: 20px;\r\n  \r\n  .anomaly-item {\r\n    padding: 15px;\r\n    margin-bottom: 15px;\r\n    background: #fff7e6;\r\n    border: 1px solid #ffd666;\r\n    border-radius: 4px;\r\n    \r\n    .anomaly-header {\r\n      display: flex;\r\n      align-items: center;\r\n      margin-bottom: 10px;\r\n      \r\n      .anomaly-index {\r\n        width: 30px;\r\n        height: 30px;\r\n        background: #ff4d4f;\r\n        color: white;\r\n        border-radius: 50%;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        font-weight: bold;\r\n        margin-right: 10px;\r\n      }\r\n      \r\n      .anomaly-title {\r\n        flex: 1;\r\n        font-weight: bold;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n    \r\n    .anomaly-content {\r\n      margin-left: 40px;\r\n      \r\n      .label {\r\n        color: #909399;\r\n        margin-right: 5px;\r\n      }\r\n      \r\n      .value {\r\n        font-weight: 500;\r\n        \r\n        &.danger {\r\n          color: #f56c6c;\r\n        }\r\n      }\r\n      \r\n      .suggestion {\r\n        margin-top: 10px;\r\n        padding-top: 10px;\r\n        border-top: 1px dashed #dcdfe6;\r\n        color: #606266;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n@media print {\r\n  .header-card .header-right {\r\n    display: none;\r\n  }\r\n  \r\n  .el-radio-group {\r\n    display: none;\r\n  }\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\edit.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'watch' is defined but never used. Allowed unused vars must match /^_/u.","line":204,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":204,"endColumn":50},{"ruleId":"no-unused-vars","severity":1,"message":"'getInspection' is defined but never used. Allowed unused vars must match /^_/u.","line":206,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'updateInspection' is defined but never used. Allowed unused vars must match /^_/u.","line":206,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'generateTickets' is defined but never used. Allowed unused vars must match /^_/u.","line":206,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":206,"endColumn":58},{"ruleId":"no-unused-vars","severity":1,"message":"'listUser' is defined but never used. Allowed unused vars must match /^_/u.","line":207,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":207,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'getAnomalyPriority' is defined but never used. Allowed unused vars must match /^_/u.","line":208,"column":81,"nodeType":"Identifier","messageId":"unusedVar","endLine":208,"endColumn":99},{"ruleId":"no-unused-vars","severity":1,"message":"'item' is defined but never used. Allowed unused args must match /^_/u.","line":396,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":396,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'data' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":410,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":410,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <span>缂栬緫宸℃璁板綍</span>\r\n      </template>\r\n      \r\n      <el-form ref=\"inspectionRef\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\r\n        <!-- 鍩虹淇℃伅 -->\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸℃缂栧彿\">\r\n              <el-input v-model=\"form.inspectionNo\" disabled />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸℃鏃ユ湡\" prop=\"inspectionDate\">\r\n              <el-date-picker\r\n                v-model=\"form.inspectionDate\"\r\n                type=\"date\"\r\n                placeholder=\"閫夋嫨宸℃鏃ユ湡\"\r\n                format=\"YYYY-MM-DD\"\r\n                value-format=\"YYYY-MM-DD\"\r\n                :disabled-date=\"disabledDate\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸℃妤煎眰\" prop=\"floor\">\r\n              <el-select v-model=\"form.floor\" placeholder=\"璇烽€夋嫨妤煎眰\" @change=\"handleFloorChange\">\r\n                <el-option\r\n                  v-for=\"floor in FLOORS\"\r\n                  :key=\"floor.value\"\r\n                  :label=\"floor.label\"\r\n                  :value=\"floor.value\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸℃浜哄憳\" prop=\"inspectorName\">\r\n              <el-input v-model=\"form.inspectorName\" placeholder=\"璇疯緭鍏ュ贰妫€浜哄憳濮撳悕\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎺ュ姏浜哄憳\">\r\n              <el-select v-model=\"form.relayPersonId\" placeholder=\"璇烽€夋嫨鎺ュ姏浜哄憳\" clearable>\r\n                <el-option\r\n                  v-for=\"user in userList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸℃鐘舵€乗">\r\n              <el-tag :type=\"getStatusType()\">{{ getStatusLabel() }}</el-tag>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <!-- 宸℃椤圭洰 -->\r\n        <el-divider content-position=\"left\">宸℃椤圭洰</el-divider>\r\n        \r\n        <div class=\"inspection-progress\">\r\n          <el-progress :percentage=\"progress\" :status=\"progressStatus\">\r\n            <span>{{ completedCount }}/{{ totalCount }}椤?/span>\r\n          </el-progress>\r\n        </div>\r\n\r\n        <el-tabs v-model=\"activeTab\" type=\"card\">\r\n          <el-tab-pane \r\n            v-for=\"category in categories\" \r\n            :key=\"category.value\"\r\n            :label=\"category.label\"\r\n            :name=\"category.value\"\r\n          >\r\n            <el-form-item \r\n              v-for=\"item in getCategoryItems(category.value)\" \r\n              :key=\"item.id\"\r\n              :label=\"item.label\"\r\n              :prop=\"`items.${item.id}`\"\r\n            >\r\n              <!-- 甯冨皵绫诲瀷 -->\r\n              <template v-if=\"item.type === 'boolean'\">\r\n                <el-radio-group v-model=\"formItems[item.id]\" @change=\"handleItemChange(item)\">\r\n                  <el-radio :label=\"true\">姝ｅ父</el-radio>\r\n                  <el-radio :label=\"false\">寮傚父</el-radio>\r\n                  <el-radio :label=\"null\">鏈鏌?/el-radio>\r\n                </el-radio-group>\r\n                <el-tag \r\n                  v-if=\"formItems[item.id] === false\" \r\n                  type=\"danger\" \r\n                  style=\"margin-left: 10px\"\r\n                >\r\n                  闇€瑕佸鐞哱r\n                </el-tag>\r\n              </template>\r\n              \r\n              <!-- 鏁板€肩被鍨?-->\r\n              <template v-else-if=\"item.type === 'number'\">\r\n                <el-input-number \r\n                  v-model=\"formItems[item.id]\" \r\n                  :min=\"0\"\r\n                  :precision=\"2\"\r\n                  :placeholder=\"`璇疯緭鍏?{item.label}`\"\r\n                  @change=\"handleItemChange(item)\"\r\n                />\r\n                <span style=\"margin-left: 10px\">{{ item.unit }}</span>\r\n                <span v-if=\"item.min !== undefined\" style=\"margin-left: 10px; color: #909399;\">\r\n                  (姝ｅ父鑼冨洿: {{ item.min }}-{{ item.max }} {{ item.unit }})\r\n                </span>\r\n                <el-tag \r\n                  v-if=\"checkAnomaly(item, formItems[item.id])\" \r\n                  type=\"danger\" \r\n                  style=\"margin-left: 10px\"\r\n                >\r\n                  瓒呭嚭鑼冨洿\r\n                </el-tag>\r\n              </template>\r\n            </el-form-item>\r\n          </el-tab-pane>\r\n        </el-tabs>\r\n\r\n        <!-- 寮傚父椤规眹鎬?-->\r\n        <el-divider content-position=\"left\" v-if=\"anomalyItems.length > 0\">\r\n          寮傚父椤规眹鎬籠r\n          <el-tag type=\"danger\" style=\"margin-left: 10px\">{{ anomalyItems.length }}椤?/el-tag>\r\n        </el-divider>\r\n        \r\n        <el-alert\r\n          v-if=\"anomalyItems.length > 0\"\r\n          title=\"鍙戠幇寮傚父椤筡"\r\n          type=\"warning\"\r\n          :description=\"`鍙戠幇${anomalyItems.length}涓紓甯搁」锛屼繚瀛樺悗鍙敓鎴愬伐鍗昤\"\r\n          show-icon\r\n          :closable=\"false\"\r\n        />\r\n        \r\n        <div v-if=\"anomalyItems.length > 0\" class=\"anomaly-summary\">\r\n          <el-checkbox-group v-model=\"selectedAnomalies\">\r\n            <div v-for=\"item in anomalyItems\" :key=\"item.id\" class=\"anomaly-item\">\r\n              <el-checkbox :label=\"item.id\">\r\n                <span class=\"anomaly-label\">{{ item.label }}</span>\r\n                <el-tag size=\"small\" :type=\"getPriorityType(item.priority)\">\r\n                  {{ getPriorityLabel(item.priority) }}\r\n                </el-tag>\r\n              </el-checkbox>\r\n            </div>\r\n          </el-checkbox-group>\r\n        </div>\r\n\r\n        <!-- 鍏朵粬淇℃伅 -->\r\n        <el-divider content-position=\"left\">鍏朵粬淇℃伅</el-divider>\r\n        \r\n        <el-form-item label=\"澶囨敞\">\r\n          <el-input \r\n            v-model=\"form.remark\" \r\n            type=\"textarea\" \r\n            :rows=\"3\" \r\n            placeholder=\"璇疯緭鍏ュ娉ㄤ俊鎭痋"\r\n            maxlength=\"500\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"鐜板満鐓х墖\">\r\n          <image-upload\r\n            v-model=\"form.photos\"\r\n            :limit=\"5\"\r\n            :fileSize=\"10\"\r\n            :fileType='[\"jpg\", \"jpeg\", \"png\", \"gif\"]'\r\n            :isShowTip=\"true\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <!-- 鎿嶄綔鎸夐挳 -->\r\n      <div class=\"form-footer\">\r\n        <el-button @click=\"handleCancel\">鍙?娑?/el-button>\r\n        <el-button type=\"primary\" @click=\"handleSave\" :loading=\"loading\">淇?瀛?/el-button>\r\n        <el-button \r\n          type=\"success\" \r\n          @click=\"handleSaveAndGenerate\" \r\n          :loading=\"loading\"\r\n          v-if=\"anomalyItems.length > 0\"\r\n        >\r\n          淇濆瓨骞剁敓鎴愬伐鍗昞r\n        </el-button>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"InspectionEdit\">\r\nimport { getCurrentInstance, ref, computed, watch, onMounted } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { getInspection, updateInspection, generateTickets } from '@/api/business/inspection'\r\nimport { listUser } from '@/api/system/user'\r\nimport { FLOORS, INSPECTION_ITEMS, anomalyDetectionRules, anomalyPriorityRules, getAnomalyPriority } from './constants'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst inspectionId = route.params && route.params.id\r\nconst loading = ref(false)\r\nconst activeTab = ref('basic')\r\nconst userList = ref([])\r\nconst selectedAnomalies = ref([])\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({\r\n  inspectionId: undefined,\r\n  inspectionNo: '',\r\n  inspectionDate: '',\r\n  floor: '',\r\n  inspectorName: '',\r\n  relayPersonId: undefined,\r\n  remark: '',\r\n  photos: []\r\n})\r\n\r\nconst formItems = ref({})\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst rules = {\r\n  inspectionDate: [\r\n    { required: true, message: '璇烽€夋嫨宸℃鏃ユ湡', trigger: 'change' }\r\n  ],\r\n  floor: [\r\n    { required: true, message: '璇烽€夋嫨宸℃妤煎眰', trigger: 'change' }\r\n  ],\r\n  inspectorName: [\r\n    { required: true, message: '璇疯緭鍏ュ贰妫€浜哄憳', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 褰撳墠妤煎眰鐨勫贰妫€椤圭洰\r\nconst currentItems = computed(() => {\r\n  return INSPECTION_ITEMS[form.value.floor] || []\r\n})\r\n\r\n// 鍒嗙被\r\nconst categories = computed(() => {\r\n  const cats = [{ value: 'basic', label: '鍩虹璁炬柦' }]\r\n  if (form.value.floor === 'floor1') {\r\n    cats.push({ value: 'pump', label: '姘存车绯荤粺' })\r\n    cats.push({ value: 'cold', label: '鍐峰喕绯荤粺' })\r\n  }\r\n  return cats\r\n})\r\n\r\n// 缁熻淇℃伅\r\nconst totalCount = computed(() => currentItems.value.length)\r\n\r\nconst completedCount = computed(() => {\r\n  return Object.keys(formItems.value).filter(key => \r\n    formItems.value[key] !== null && formItems.value[key] !== undefined\r\n  ).length\r\n})\r\n\r\nconst progress = computed(() => {\r\n  if (totalCount.value === 0) return 0\r\n  return Math.round((completedCount.value / totalCount.value) * 100)\r\n})\r\n\r\nconst progressStatus = computed(() => {\r\n  if (progress.value === 100) return 'success'\r\n  if (progress.value >= 80) return ''\r\n  if (progress.value >= 50) return 'warning'\r\n  return 'exception'\r\n})\r\n\r\n// 寮傚父椤癸紙澶嶇敤缁熶竴瑙勫垯锛塡r\nconst anomalyItems = computed(() => {\r\n  const items = []\r\n  currentItems.value.forEach(item => {\r\n    const value = formItems.value[item.id]\r\n    if (value === null || value === undefined) return\r\n    let isAnomaly = false\r\n    if (item.type === 'boolean') {\r\n      isAnomaly = anomalyDetectionRules.boolean(value)\r\n    } else if (item.type === 'number' && anomalyDetectionRules.number[item.id]) {\r\n      isAnomaly = anomalyDetectionRules.number[item.id](value)\r\n    }\r\n    if (isAnomaly) {\r\n      items.push({\r\n        ...item,\r\n        value,\r\n        priority: determinePriority(item.label)\r\n      })\r\n    }\r\n  })\r\n  return items\r\n})\r\n\r\n/** 鑾峰彇宸℃璇︽儏 */\r\nfunction getInspectionDetail() {\r\n  loading.value = true\r\n  // Mock鏁版嵁\r\n  setTimeout(() => {\r\n    form.value = {\r\n      inspectionId: inspectionId,\r\n      inspectionNo: 'INS202501001',\r\n      inspectionDate: '2024-01-20',\r\n      floor: 'floor1',\r\n      inspectorName: '寮犱笁',\r\n      relayPersonId: 2,\r\n      remark: '渚嬭宸℃'\r\n    }\r\n    \r\n    // Mock椤圭洰鏁版嵁\r\n    formItems.value = {\r\n      'oil_tank': true,\r\n      'electric_room': false,\r\n      'pump_pressure': 0.5\r\n    }\r\n    \r\n    loading.value = false\r\n  }, 500)\r\n}\r\n\r\n/** 鑾峰彇鍒嗙被椤圭洰 */\r\nfunction getCategoryItems(category) {\r\n  if (category === 'basic') {\r\n    return currentItems.value.slice(0, 10)\r\n  }\r\n  if (category === 'pump') {\r\n    return currentItems.value.slice(10, 15)\r\n  }\r\n  if (category === 'cold') {\r\n    return currentItems.value.slice(15)\r\n  }\r\n  return []\r\n}\r\n\r\n// 缁熶竴浼樺厛绾у垽瀹氾紙浣跨敤 constants 涓殑鍏抽敭璇嶆槧灏勶級\r\nfunction determinePriority(label) {\r\n  for (const [priority, keywords] of Object.entries(anomalyPriorityRules)) {\r\n    if (keywords.some(k => label.includes(k))) return priority\r\n  }\r\n  return 'low'\r\n}\r\n\r\n/** 鑾峰彇浼樺厛绾х被鍨?*/\r\nfunction getPriorityType(priority) {\r\n  const map = {\r\n    high: 'danger',\r\n    medium: 'warning',\r\n    low: 'info'\r\n  }\r\n  return map[priority] || 'info'\r\n}\r\n\r\n/** 鑾峰彇浼樺厛绾ф爣绛?*/\r\nfunction getPriorityLabel(priority) {\r\n  const map = {\r\n    high: '楂?,\r\n    medium: '涓?,\r\n    low: '浣?\r\n  }\r\n  return map[priority] || priority\r\n}\r\n\r\n/** 鑾峰彇鐘舵€佺被鍨?*/\r\nfunction getStatusType() {\r\n  if (progress.value === 100) return 'success'\r\n  if (progress.value > 0) return 'warning'\r\n  return 'info'\r\n}\r\n\r\n/** 鑾峰彇鐘舵€佹爣绛?*/\r\nfunction getStatusLabel() {\r\n  if (progress.value === 100) return '宸插畬鎴?\r\n  if (progress.value > 0) return '杩涜涓?\r\n  return '鏈紑濮?\r\n}\r\n\r\n/** 妤煎眰鍙樺寲 */\r\nfunction handleFloorChange() {\r\n  // 娓呯┖椤圭洰鏁版嵁\r\n  formItems.value = {}\r\n  selectedAnomalies.value = []\r\n}\r\n\r\n/** 椤圭洰鍊煎彉鍖?*/\r\nfunction handleItemChange(item) {\r\n  // 鍙互娣诲姞瀹炴椂妫€娴嬮€昏緫\r\n}\r\n\r\n/** 绂佺敤鏃ユ湡 */\r\nfunction disabledDate(time) {\r\n  return time.getTime() > Date.now()\r\n}\r\n\r\n/** 淇濆瓨 */\r\nfunction handleSave() {\r\n  proxy.$refs.inspectionRef.validate(valid => {\r\n    if (valid) {\r\n      loading.value = true\r\n      const data = {\r\n        ...form.value,\r\n        items: JSON.stringify(formItems.value),\r\n        anomalyCount: anomalyItems.value.length\r\n      }\r\n      \r\n      setTimeout(() => {\r\n        proxy.$modal.msgSuccess(\"淇濆瓨鎴愬姛\")\r\n        loading.value = false\r\n        router.push('/business/inspection')\r\n      }, 500)\r\n    }\r\n  })\r\n}\r\n\r\n/** 淇濆瓨骞剁敓鎴愬伐鍗?*/\r\nfunction handleSaveAndGenerate() {\r\n  if (selectedAnomalies.value.length === 0) {\r\n    proxy.$modal.msgWarning(\"璇烽€夋嫨瑕佺敓鎴愬伐鍗曠殑寮傚父椤筡")\r\n    return\r\n  }\r\n  \r\n  proxy.$refs.inspectionRef.validate(valid => {\r\n    if (valid) {\r\n      loading.value = true\r\n      \r\n      setTimeout(() => {\r\n        proxy.$modal.msgSuccess(`淇濆瓨鎴愬姛锛屽凡鐢熸垚${selectedAnomalies.value.length}涓伐鍗昤)\r\n        loading.value = false\r\n        router.push('/business/inspection')\r\n      }, 500)\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍙栨秷 */\r\nfunction handleCancel() {\r\n  proxy.$modal.confirm('纭畾瑕佸彇娑堝悧锛熸湭淇濆瓨鐨勬暟鎹皢涓㈠け').then(() => {\r\n    router.push('/business/inspection')\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍒楄〃 */\r\nfunction getUserList() {\r\n  userList.value = [\r\n    { userId: 1, nickName: '寮犱笁' },\r\n    { userId: 2, nickName: '鏉庡洓' },\r\n    { userId: 3, nickName: '鐜嬩簲' }\r\n  ]\r\n}\r\n\r\nonMounted(() => {\r\n  getUserList()\r\n  getInspectionDetail()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.inspection-progress {\r\n  margin: 20px 0;\r\n  padding: 20px;\r\n  background: #f5f7fa;\r\n  border-radius: 4px;\r\n}\r\n\r\n.anomaly-summary {\r\n  margin-top: 15px;\r\n  padding: 15px;\r\n  background: #fff7e6;\r\n  border: 1px solid #ffd666;\r\n  border-radius: 4px;\r\n  \r\n  .anomaly-item {\r\n    margin-bottom: 10px;\r\n    \r\n    .anomaly-label {\r\n      margin: 0 10px;\r\n    }\r\n  }\r\n}\r\n\r\n.form-footer {\r\n  margin-top: 30px;\r\n  text-align: center;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #e8e8e8;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getInspection' is defined but never used. Allowed unused vars must match /^_/u.","line":223,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'getLatestInspection' is defined but never used. Allowed unused vars must match /^_/u.","line":223,"column":73,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":92},{"ruleId":"no-unused-vars","severity":1,"message":"'INSPECTION_ITEMS' is defined but never used. Allowed unused vars must match /^_/u.","line":224,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":224,"endColumn":34},{"ruleId":"no-unused-vars","severity":1,"message":"'title' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":237,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":237,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'cancel' is defined but never used. Allowed unused vars must match /^_/u.","line":271,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":271,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鎼滅储琛ㄥ崟 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"妤煎眰\" prop=\"floor\">\r\n        <el-select v-model=\"queryParams.floor\" placeholder=\"璇烽€夋嫨妤煎眰\" clearable>\r\n          <el-option\r\n            v-for=\"floor in FLOORS\"\r\n            :key=\"floor.value\"\r\n            :label=\"floor.label\"\r\n            :value=\"floor.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"宸℃浜篭" prop=\"inspectorName\">\r\n        <el-input\r\n          v-model=\"queryParams.inspectorName\"\r\n          placeholder=\"璇疯緭鍏ュ贰妫€浜篭"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"宸℃鏃ユ湡\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          type=\"daterange\"\r\n          range-separator=\"鑷砛"\r\n          start-placeholder=\"寮€濮嬫棩鏈焅"\r\n          end-placeholder=\"缁撴潫鏃ユ湡\"\r\n          value-format=\"YYYY-MM-DD\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"寮傚父椤筡" prop=\"hasAnomaly\">\r\n        <el-select v-model=\"queryParams.hasAnomaly\" placeholder=\"鍏ㄩ儴\" clearable>\r\n          <el-option label=\"鏈夊紓甯竆" :value=\"1\" />\r\n          <el-option label=\"鏃犲紓甯竆" :value=\"0\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 鎿嶄綔宸ュ叿鏍?-->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Plus\"\r\n          @click=\"handleAdd\"\r\n          v-hasPermi=\"['business:inspection:add']\"\r\n        >寮€濮嬪贰妫€</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"DocumentCopy\"\r\n          @click=\"handleCopyLast\"\r\n          v-hasPermi=\"['business:inspection:add']\"\r\n        >澶嶅埗涓婃</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"danger\"\r\n          plain\r\n          icon=\"Delete\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleDelete\"\r\n          v-hasPermi=\"['business:inspection:remove']\"\r\n        >鍒犻櫎</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"warning\"\r\n          plain\r\n          icon=\"Download\"\r\n          @click=\"handleExport\"\r\n          v-hasPermi=\"['business:inspection:export']\"\r\n        >瀵煎嚭</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"info\"\r\n          plain\r\n          icon=\"DataAnalysis\"\r\n          @click=\"handleStatistics\"\r\n        >缁熻鍒嗘瀽</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table \r\n      v-loading=\"loading\" \r\n      :data=\"inspectionList\" \r\n      @selection-change=\"handleSelectionChange\"\r\n      :row-class-name=\"getRowClassName\"\r\n    >\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"宸℃缂栧彿\" align=\"center\" prop=\"inspectionNo\" width=\"120\" />\r\n      <el-table-column label=\"妤煎眰\" align=\"center\" prop=\"floor\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          {{ getFloorLabel(scope.row.floor) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"宸℃浜篭" align=\"center\" prop=\"inspectorName\" width=\"100\" />\r\n      <el-table-column label=\"鎺ュ姏浜哄憳\" align=\"center\" prop=\"relayPerson\" width=\"100\" />\r\n      <el-table-column label=\"宸℃鏃ユ湡\" align=\"center\" prop=\"inspectionDate\" width=\"110\">\r\n        <template #default=\"scope\">\r\n          {{ parseTime(scope.row.inspectionDate, '{y}-{m}-{d}') }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"瀹屾垚杩涘害\" align=\"center\" prop=\"progress\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <el-progress \r\n            :percentage=\"scope.row.progress\" \r\n            :width=\"70\"\r\n            :stroke-width=\"6\"\r\n            :color=\"scope.row.progress === 100 ? '#67c23a' : '#409eff'\"\r\n          />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"寮傚父椤规暟\" align=\"center\" prop=\"anomalyCount\" width=\"90\">\r\n        <template #default=\"scope\">\r\n          <el-tag v-if=\"scope.row.anomalyCount > 0\" type=\"danger\">\r\n            {{ scope.row.anomalyCount }}椤筡r\n          </el-tag>\r\n          <el-tag v-else type=\"success\">姝ｅ父</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鐢熸垚宸ュ崟\" align=\"center\" prop=\"ticketCount\" width=\"90\">\r\n        <template #default=\"scope\">\r\n          <el-tag v-if=\"scope.row.ticketCount > 0\" type=\"warning\">\r\n            {{ scope.row.ticketCount }}涓猏r\n          </el-tag>\r\n          <span v-else>-</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"澶嶅埗鏍囪\" align=\"center\" prop=\"isCopied\" width=\"90\">\r\n        <template #default=\"scope\">\r\n          <el-tag v-if=\"scope.row.isCopied === 'Y'\" type=\"info\">澶嶅埗</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"澶囨敞\" align=\"left\" prop=\"remark\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          {{ parseTime(scope.row.createTime) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"200\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"View\"\r\n            @click=\"handleView(scope.row)\"\r\n            v-hasPermi=\"['business:inspection:query']\"\r\n          >鏌ョ湅</el-button>\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"Edit\"\r\n            @click=\"handleUpdate(scope.row)\"\r\n            v-hasPermi=\"['business:inspection:edit']\"\r\n            v-if=\"scope.row.progress < 100\"\r\n          >缁х画</el-button>\r\n          <el-button\r\n            link\r\n            type=\"success\"\r\n            icon=\"DocumentCopy\"\r\n            @click=\"handleCopy(scope.row)\"\r\n            v-hasPermi=\"['business:inspection:add']\"\r\n          >澶嶅埗</el-button>\r\n          <el-button\r\n            link\r\n            type=\"warning\"\r\n            icon=\"Tickets\"\r\n            @click=\"handleGenerateTickets(scope.row)\"\r\n            v-hasPermi=\"['business:inspection:add']\"\r\n            v-if=\"scope.row.anomalyCount > 0 && scope.row.ticketCount === 0\"\r\n          >鐢熸垚宸ュ崟</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total > 0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 缁熻寮圭獥 -->\r\n    <el-dialog title=\"宸℃缁熻\" v-model=\"statisticsOpen\" width=\"800px\" append-to-body>\r\n      <div class=\"statistics-content\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-statistic title=\"鏈湀宸℃娆℃暟\" :value=\"statistics.monthCount\" />\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-statistic title=\"鏈湀寮傚父鎬绘暟\" :value=\"statistics.monthAnomalyCount\" />\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-statistic title=\"寮傚父澶勭悊鐜嘰" :value=\"statistics.handleRate\" suffix=\"%\" />\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button @click=\"statisticsOpen = false\">鍏抽棴</el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"Inspection\">\r\nimport { listInspection, getInspection, delInspection, generateTickets, getLatestInspection } from \"@/api/business/inspection\";\r\nimport { FLOORS, INSPECTION_ITEMS } from \"./constants\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst router = useRouter();\r\n\r\nconst inspectionList = ref([]);\r\nconst open = ref(false);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst title = ref(\"\");\r\nconst dateRange = ref([]);\r\nconst statisticsOpen = ref(false);\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    floor: undefined,\r\n    inspectorName: undefined,\r\n    hasAnomaly: undefined\r\n  },\r\n  statistics: {\r\n    monthCount: 0,\r\n    monthAnomalyCount: 0,\r\n    handleRate: 0\r\n  }\r\n});\r\n\r\nconst { queryParams, form, statistics } = toRefs(data);\r\n\r\n/** 鏌ヨ宸℃鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  let params = proxy.addDateRange(queryParams.value, dateRange.value);\r\n  listInspection(params).then(response => {\r\n    inspectionList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false;\r\n  reset();\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    inspectionId: undefined,\r\n    inspectionNo: undefined,\r\n    floor: undefined,\r\n    inspectorName: undefined,\r\n    items: {},\r\n    progress: 0,\r\n    anomalyCount: 0,\r\n    ticketCount: 0,\r\n    isCopied: 'N',\r\n    relayPerson: undefined,\r\n    photos: undefined,\r\n    remark: undefined\r\n  };\r\n  proxy.resetForm(\"inspectionRef\");\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = [];\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.inspectionId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  router.push('/business/inspection/create');\r\n}\r\n\r\n/** 澶嶅埗涓婃宸℃ */\r\nfunction handleCopyLast() {\r\n  // 鏌ユ壘鏈€鍚庝竴娆″畬鎴愮殑宸℃\r\n  const lastCompleted = inspectionList.value\r\n    .filter(item => item.status === 'completed')\r\n    .sort((a, b) => new Date(b.inspectionDate) - new Date(a.inspectionDate))[0];\r\n\r\n  if (lastCompleted) {\r\n    router.push('/business/inspection/create?copy=' + lastCompleted.inspectionId);\r\n  } else {\r\n    proxy.$modal.msgWarning(\"鏆傛棤鍙鍒剁殑宸插畬鎴愬贰妫€璁板綍\");\r\n  }\r\n}\r\n\r\n/** 鏌ョ湅璇︽儏 */\r\nfunction handleView(row) {\r\n  router.push('/business/inspection/detail/' + row.inspectionId);\r\n}\r\n\r\n/** 缁х画宸℃ */\r\nfunction handleUpdate(row) {\r\n  router.push('/business/inspection/edit/' + row.inspectionId);\r\n}\r\n\r\n/** 澶嶅埗宸℃ */\r\nfunction handleCopy(row) {\r\n  proxy.$modal.confirm('鏄惁澶嶅埗璇ュ贰妫€璁板綍锛?).then(function() {\r\n    router.push('/business/inspection/create?copy=' + row.inspectionId);\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鐢熸垚宸ュ崟 */\r\nfunction handleGenerateTickets(row) {\r\n  proxy.$modal.confirm('妫€娴嬪埌' + row.anomalyCount + '涓紓甯搁」锛屾槸鍚︾敓鎴愬伐鍗曪紵').then(function() {\r\n    return generateTickets(row.inspectionId, row.anomalies);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"宸茬敓鎴怽" + row.anomalyCount + \"涓伐鍗昞");\r\n    getList();\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const inspectionIds = row.inspectionId || ids.value;\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎宸℃缂栧彿涓篭"' + inspectionIds + '\"鐨勬暟鎹」锛?).then(function() {\r\n    return delInspection(inspectionIds);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\");\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download('business/inspection/export', {\r\n    ...queryParams.value\r\n  }, `inspection_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/** 缁熻鍒嗘瀽 */\r\nfunction handleStatistics() {\r\n  // 鑾峰彇缁熻鏁版嵁\r\n  statistics.value = {\r\n    monthCount: 45,\r\n    monthAnomalyCount: 23,\r\n    handleRate: 87.5\r\n  };\r\n  statisticsOpen.value = true;\r\n}\r\n\r\n/** 鑾峰彇妤煎眰鏍囩 */\r\nfunction getFloorLabel(value) {\r\n  const floor = FLOORS.find(f => f.value === value);\r\n  return floor ? floor.label : value;\r\n}\r\n\r\n/** 琛屾牱寮?*/\r\nfunction getRowClassName({ row }) {\r\n  if (row.anomalyCount > 5) {\r\n    return 'danger-row';\r\n  }\r\n  if (row.anomalyCount > 0) {\r\n    return 'warning-row';\r\n  }\r\n  return '';\r\n}\r\n\r\ngetList();\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n:deep(.el-table .warning-row) {\r\n  background: #fdf6ec;\r\n}\r\n\r\n:deep(.el-table .danger-row) {\r\n  background: #fef0f0;\r\n}\r\n\r\n.statistics-content {\r\n  padding: 20px 0;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\plan.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'listUser' is defined but never used. Allowed unused vars must match /^_/u.","line":295,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":295,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'id' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":423,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":423,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":448,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":448,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"inspection-plan\">\r\n    <!-- 鎼滅储鍖哄煙 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\">\r\n      <el-form-item label=\"璁″垝鍚嶇О\" prop=\"planName\">\r\n        <el-input\r\n          v-model=\"queryParams.planName\"\r\n          placeholder=\"璇疯緭鍏ヨ鍒掑悕绉癨"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"妤煎眰\" prop=\"floor\">\r\n        <el-select v-model=\"queryParams.floor\" placeholder=\"璇烽€夋嫨妤煎眰\" clearable>\r\n          <el-option\r\n            v-for=\"floor in FLOORS\"\r\n            :key=\"floor.value\"\r\n            :label=\"floor.label\"\r\n            :value=\"floor.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"鐘舵€乗" prop=\"enabled\">\r\n        <el-select v-model=\"queryParams.enabled\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option label=\"鍚敤\" :value=\"true\" />\r\n          <el-option label=\"鍋滅敤\" :value=\"false\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 鎿嶄綔鎸夐挳 -->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Plus\"\r\n          @click=\"handleAdd\"\r\n          v-hasPermi=\"['inspection:plan:add']\"\r\n        >鏂板缓璁″垝</el-button>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table v-loading=\"loading\" :data=\"dataList\">\r\n      <el-table-column label=\"搴忓彿\" type=\"index\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"璁″垝鍚嶇О\" align=\"center\" prop=\"planName\" />\r\n      <el-table-column label=\"妤煎眰\" align=\"center\" prop=\"floor\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          {{ getFloorLabel(scope.row.floor) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц棰戠巼\" align=\"center\" prop=\"frequency\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          {{ getFrequencyLabel(scope.row.frequency) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鏃堕棿\" align=\"center\" prop=\"executionTime\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <el-tag type=\"info\">{{ scope.row.executionTime }}</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鏃ユ湡\" align=\"center\" prop=\"executionDays\" width=\"180\">\r\n        <template #default=\"scope\">\r\n          {{ getExecutionDaysLabel(scope.row) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"璐熻矗浜篭" align=\"center\" prop=\"responsibleName\" width=\"100\" />\r\n      <el-table-column label=\"鎻愰啋鏃堕棿\" align=\"center\" prop=\"reminderTime\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          {{ getReminderLabel(scope.row.reminderTime) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"涓嬫鎵ц\" align=\"center\" prop=\"nextExecutionTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          <span v-if=\"scope.row.enabled\">\r\n            {{ parseTime(scope.row.nextExecutionTime) }}\r\n          </span>\r\n          <span v-else>-</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"enabled\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-switch\r\n            v-model=\"scope.row.enabled\"\r\n            @change=\"handleStatusChange(scope.row)\"\r\n          />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"180\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"Edit\"\r\n            @click=\"handleUpdate(scope.row)\"\r\n            v-hasPermi=\"['inspection:plan:edit']\"\r\n          >淇敼</el-button>\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"Timer\"\r\n            @click=\"handleExecute(scope.row)\"\r\n            v-hasPermi=\"['inspection:execute']\"\r\n            :disabled=\"!scope.row.enabled\"\r\n          >绔嬪嵆鎵ц</el-button>\r\n          <el-button\r\n            link\r\n            type=\"danger\"\r\n            icon=\"Delete\"\r\n            @click=\"handleDelete(scope.row)\"\r\n            v-hasPermi=\"['inspection:plan:delete']\"\r\n          >鍒犻櫎</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total > 0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 鏂板/缂栬緫瀵硅瘽妗?-->\r\n    <el-dialog :title=\"title\" v-model=\"open\" width=\"700px\" append-to-body>\r\n      <el-form ref=\"formRef\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"璁″垝鍚嶇О\" prop=\"planName\">\r\n              <el-input v-model=\"form.planName\" placeholder=\"璇疯緭鍏ヨ鍒掑悕绉癨" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸℃妤煎眰\" prop=\"floor\">\r\n              <el-select v-model=\"form.floor\" placeholder=\"璇烽€夋嫨妤煎眰\">\r\n                <el-option\r\n                  v-for=\"floor in FLOORS\"\r\n                  :key=\"floor.value\"\r\n                  :label=\"`${floor.label} (${floor.itemCount}椤?`\"\r\n                  :value=\"floor.value\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц棰戠巼\" prop=\"frequency\">\r\n              <el-select v-model=\"form.frequency\" placeholder=\"璇烽€夋嫨鎵ц棰戠巼\" @change=\"handleFrequencyChange\">\r\n                <el-option label=\"姣忔棩\" value=\"daily\" />\r\n                <el-option label=\"姣忓懆\" value=\"weekly\" />\r\n                <el-option label=\"姣忔湀\" value=\"monthly\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц鏃堕棿\" prop=\"executionTime\">\r\n              <el-time-select\r\n                v-model=\"form.executionTime\"\r\n                start=\"00:00\"\r\n                step=\"00:30\"\r\n                end=\"23:30\"\r\n                placeholder=\"閫夋嫨鎵ц鏃堕棿\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item \r\n              v-if=\"form.frequency === 'weekly'\" \r\n              label=\"鎵ц鏄熸湡\" \r\n              prop=\"weekDays\"\r\n            >\r\n              <el-checkbox-group v-model=\"form.weekDays\">\r\n                <el-checkbox label=\"1\">鍛ㄤ竴</el-checkbox>\r\n                <el-checkbox label=\"2\">鍛ㄤ簩</el-checkbox>\r\n                <el-checkbox label=\"3\">鍛ㄤ笁</el-checkbox>\r\n                <el-checkbox label=\"4\">鍛ㄥ洓</el-checkbox>\r\n                <el-checkbox label=\"5\">鍛ㄤ簲</el-checkbox>\r\n                <el-checkbox label=\"6\">鍛ㄥ叚</el-checkbox>\r\n                <el-checkbox label=\"0\">鍛ㄦ棩</el-checkbox>\r\n              </el-checkbox-group>\r\n            </el-form-item>\r\n\r\n            <el-form-item \r\n              v-if=\"form.frequency === 'monthly'\" \r\n              label=\"鎵ц鏃ユ湡\" \r\n              prop=\"monthDays\"\r\n            >\r\n              <el-checkbox-group v-model=\"form.monthDays\">\r\n                <el-checkbox \r\n                  v-for=\"day in 31\" \r\n                  :key=\"day\" \r\n                  :label=\"String(day)\"\r\n                >\r\n                  {{ day }}鍙穃r\n                </el-checkbox>\r\n              </el-checkbox-group>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"璐熻矗浜篭" prop=\"responsibleId\">\r\n              <el-select v-model=\"form.responsibleId\" placeholder=\"璇烽€夋嫨璐熻矗浜篭" filterable>\r\n                <el-option\r\n                  v-for=\"user in userList\"\r\n                  :key=\"user.id\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.id\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎻愬墠鎻愰啋\" prop=\"reminderTime\">\r\n              <el-select v-model=\"form.reminderTime\" placeholder=\"璇烽€夋嫨鎻愰啋鏃堕棿\">\r\n                <el-option label=\"涓嶆彁閱抃" :value=\"0\" />\r\n                <el-option label=\"15鍒嗛挓鍓峔" :value=\"15\" />\r\n                <el-option label=\"30鍒嗛挓鍓峔" :value=\"30\" />\r\n                <el-option label=\"1灏忔椂鍓峔" :value=\"60\" />\r\n                <el-option label=\"2灏忔椂鍓峔" :value=\"120\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item label=\"閫氱煡浜哄憳\" prop=\"notifyUserIds\">\r\n              <el-select \r\n                v-model=\"form.notifyUserIds\" \r\n                placeholder=\"璇烽€夋嫨閫氱煡浜哄憳\" \r\n                multiple \r\n                filterable\r\n              >\r\n                <el-option\r\n                  v-for=\"user in userList\"\r\n                  :key=\"user.id\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.id\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"24\">\r\n            <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n              <el-input\r\n                v-model=\"form.remark\"\r\n                type=\"textarea\"\r\n                :rows=\"3\"\r\n                placeholder=\"璇疯緭鍏ュ娉ㄤ俊鎭痋"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鍚敤鐘舵€乗" prop=\"enabled\">\r\n              <el-switch v-model=\"form.enabled\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n\r\n      <template #footer>\r\n        <el-button @click=\"cancel\">鍙栨秷</el-button>\r\n        <el-button type=\"primary\" @click=\"submitForm\">纭畾</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { useRouter } from 'vue-router'\r\n// 淇瀵煎叆璺緞锛屽師 '@/api/inspection' 涓嶅瓨鍦╘r\nimport { inspectionPlanApi } from '@/api/business'\r\nimport { listUser } from '@/api/system/user'\r\nimport { FLOORS } from './constants'\r\nimport { parseTime } from '@/utils'\r\n\r\nconst router = useRouter()\r\nconst loading = ref(false)\r\nconst dataList = ref([])\r\nconst total = ref(0)\r\nconst open = ref(false)\r\nconst title = ref('')\r\nconst queryRef = ref()\r\nconst formRef = ref()\r\nconst userList = ref([])\r\n\r\n// 鏌ヨ鍙傛暟\r\nconst queryParams = reactive({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  planName: undefined,\r\n  floor: undefined,\r\n  enabled: undefined\r\n})\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({\r\n  id: undefined,\r\n  planName: '',\r\n  floor: undefined,\r\n  frequency: 'daily',\r\n  executionTime: '09:00',\r\n  weekDays: [],\r\n  monthDays: [],\r\n  responsibleId: undefined,\r\n  reminderTime: 30,\r\n  notifyUserIds: [],\r\n  remark: '',\r\n  enabled: true\r\n})\r\n\r\n// 琛ㄥ崟楠岃瘉瑙勫垯\r\nconst rules = {\r\n  planName: [\r\n    { required: true, message: '璁″垝鍚嶇О涓嶈兘涓虹┖', trigger: 'blur' }\r\n  ],\r\n  floor: [\r\n    { required: true, message: '璇烽€夋嫨宸℃妤煎眰', trigger: 'change' }\r\n  ],\r\n  frequency: [\r\n    { required: true, message: '璇烽€夋嫨鎵ц棰戠巼', trigger: 'change' }\r\n  ],\r\n  executionTime: [\r\n    { required: true, message: '璇烽€夋嫨鎵ц鏃堕棿', trigger: 'change' }\r\n  ],\r\n  responsibleId: [\r\n    { required: true, message: '璇烽€夋嫨璐熻矗浜?, trigger: 'change' }\r\n  ],\r\n  weekDays: [\r\n    { \r\n      validator: (rule, value, callback) => {\r\n        if (form.value.frequency === 'weekly' && (!value || value.length === 0)) {\r\n          callback(new Error('璇烽€夋嫨鎵ц鏄熸湡'))\r\n        } else {\r\n          callback()\r\n        }\r\n      },\r\n      trigger: 'change'\r\n    }\r\n  ],\r\n  monthDays: [\r\n    {\r\n      validator: (rule, value, callback) => {\r\n        if (form.value.frequency === 'monthly' && (!value || value.length === 0)) {\r\n          callback(new Error('璇烽€夋嫨鎵ц鏃ユ湡'))\r\n        } else {\r\n          callback()\r\n        }\r\n      },\r\n      trigger: 'change'\r\n    }\r\n  ]\r\n}\r\n\r\n// 鑾峰彇鍒楄〃\r\nconst getList = async () => {\r\n  loading.value = true\r\n  try {\r\n    // 妯℃嫙鏁版嵁\r\n    dataList.value = [\r\n      {\r\n        id: 1,\r\n        planName: '1妤兼瘡鏃ュ贰妫€',\r\n        floor: 'floor1',\r\n        frequency: 'daily',\r\n        executionTime: '09:00',\r\n        responsibleName: '寮犱笁',\r\n        reminderTime: 30,\r\n        nextExecutionTime: new Date(),\r\n        enabled: true\r\n      }\r\n    ]\r\n    total.value = 1\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 鎼滅储\r\nconst handleQuery = () => {\r\n  queryParams.pageNum = 1\r\n  getList()\r\n}\r\n\r\n// 閲嶇疆\r\nconst resetQuery = () => {\r\n  queryRef.value?.resetFields()\r\n  handleQuery()\r\n}\r\n\r\n// 鏂板\r\nconst handleAdd = () => {\r\n  reset()\r\n  open.value = true\r\n  title.value = '鏂板缓宸℃璁″垝'\r\n}\r\n\r\n// 淇敼\r\nconst handleUpdate = async (row) => {\r\n  reset()\r\n  const id = row.id\r\n  // 鑾峰彇璇︽儏\r\n  form.value = { ...row }\r\n  open.value = true\r\n  title.value = '淇敼宸℃璁″垝'\r\n}\r\n\r\n// 鍒犻櫎\r\nconst handleDelete = async (row) => {\r\n  await ElMessageBox.confirm('鏄惁纭鍒犻櫎璇ュ贰妫€璁″垝锛?, '绯荤粺鎻愮ず', {\r\n    confirmButtonText: '纭畾',\r\n    cancelButtonText: '鍙栨秷',\r\n    type: 'warning'\r\n  })\r\n  \r\n  await inspectionPlanApi.delete(row.id)\r\n  ElMessage.success('鍒犻櫎鎴愬姛')\r\n  getList()\r\n}\r\n\r\n// 鐘舵€佸彉鏇碶r\nconst handleStatusChange = async (row) => {\r\n  try {\r\n    await inspectionPlanApi.toggle(row.id, row.enabled)\r\n    ElMessage.success(row.enabled ? '鍚敤鎴愬姛' : '鍋滅敤鎴愬姛')\r\n  } catch (error) {\r\n    row.enabled = !row.enabled\r\n  }\r\n}\r\n\r\n// 绔嬪嵆鎵ц\r\nconst handleExecute = (row) => {\r\n  ElMessageBox.confirm('鏄惁绔嬪嵆鎵ц璇ュ贰妫€璁″垝锛?, '绯荤粺鎻愮ず', {\r\n    confirmButtonText: '纭畾',\r\n    cancelButtonText: '鍙栨秷',\r\n    type: 'warning'\r\n  }).then(() => {\r\n    router.push(`/inspection/create?floor=${row.floor}`)\r\n  })\r\n}\r\n\r\n// 棰戠巼鍙樻洿\r\nconst handleFrequencyChange = () => {\r\n  form.value.weekDays = []\r\n  form.value.monthDays = []\r\n}\r\n\r\n// 鎻愪氦琛ㄥ崟\r\nconst submitForm = async () => {\r\n  await formRef.value?.validate()\r\n  \r\n  if (form.value.id) {\r\n    await inspectionPlanApi.update(form.value.id, form.value)\r\n    ElMessage.success('淇敼鎴愬姛')\r\n  } else {\r\n    await inspectionPlanApi.create(form.value)\r\n    ElMessage.success('鏂板鎴愬姛')\r\n  }\r\n  \r\n  open.value = false\r\n  getList()\r\n}\r\n\r\n// 鍙栨秷\r\nconst cancel = () => {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n// 閲嶇疆琛ㄥ崟\r\nconst reset = () => {\r\n  form.value = {\r\n    id: undefined,\r\n    planName: '',\r\n    floor: undefined,\r\n    frequency: 'daily',\r\n    executionTime: '09:00',\r\n    weekDays: [],\r\n    monthDays: [],\r\n    responsibleId: undefined,\r\n    reminderTime: 30,\r\n    notifyUserIds: [],\r\n    remark: '',\r\n    enabled: true\r\n  }\r\n  formRef.value?.resetFields()\r\n}\r\n\r\n// 鑾峰彇妤煎眰鏍囩\r\nconst getFloorLabel = (value) => {\r\n  const floor = FLOORS.find(f => f.value === value)\r\n  return floor ? floor.label : value\r\n}\r\n\r\n// 鑾峰彇棰戠巼鏍囩\r\nconst getFrequencyLabel = (value) => {\r\n  const map = {\r\n    daily: '姣忔棩',\r\n    weekly: '姣忓懆',\r\n    monthly: '姣忔湀'\r\n  }\r\n  return map[value] || value\r\n}\r\n\r\n// 鑾峰彇鎻愰啋鏍囩\r\nconst getReminderLabel = (value) => {\r\n  if (value === 0) return '涓嶆彁閱?\r\n  if (value < 60) return `${value}鍒嗛挓鍓峘\r\n  return `${value / 60}灏忔椂鍓峘\r\n}\r\n\r\n// 鑾峰彇鎵ц鏃ユ湡鏍囩\r\nconst getExecutionDaysLabel = (row) => {\r\n  if (row.frequency === 'daily') {\r\n    return '姣忓ぉ'\r\n  } else if (row.frequency === 'weekly') {\r\n    const weekMap = { '0': '鏃?, '1': '涓€', '2': '浜?, '3': '涓?, '4': '鍥?, '5': '浜?, '6': '鍏? }\r\n    const days = (row.weekDays || []).map(d => `鍛?{weekMap[d]}`).join('銆?)\r\n    return days || '-'\r\n  } else if (row.frequency === 'monthly') {\r\n    const days = (row.monthDays || []).map(d => `${d}鍙穈).join('銆?)\r\n    return days || '-'\r\n  }\r\n  return '-'\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(async () => {\r\n  getList()\r\n  // 鍔犺浇鐢ㄦ埛鍒楄〃\r\n  // const res = await listUser()\r\n  // userList.value = res.rows\r\n  \r\n  // 妯℃嫙鏁版嵁\r\n  userList.value = [\r\n    { id: 1, nickName: '寮犱笁' },\r\n    { id: 2, nickName: '鏉庡洓' },\r\n    { id: 3, nickName: '鐜嬩簲' }\r\n  ]\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.inspection-plan {\r\n  padding: 20px;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\inspection\\statistics.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'parseTime' is defined but never used. Allowed unused vars must match /^_/u.","line":216,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":216,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"inspection-statistics\">\r\n    <!-- 鏃堕棿鑼冨洿閫夋嫨 -->\r\n    <el-card class=\"filter-card\">\r\n      <el-form :inline=\"true\">\r\n        <el-form-item label=\"缁熻鏃堕棿\">\r\n          <el-date-picker\r\n            v-model=\"dateRange\"\r\n            type=\"daterange\"\r\n            range-separator=\"鑷砛"\r\n            start-placeholder=\"寮€濮嬫棩鏈焅"\r\n            end-placeholder=\"缁撴潫鏃ユ湡\"\r\n            :shortcuts=\"shortcuts\"\r\n            @change=\"handleDateChange\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"妤煎眰\">\r\n          <el-select v-model=\"selectedFloor\" placeholder=\"鍏ㄩ儴妤煎眰\" clearable @change=\"handleFloorChange\">\r\n            <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"\" />\r\n            <el-option\r\n              v-for=\"floor in FLOORS\"\r\n              :key=\"floor.value\"\r\n              :label=\"floor.label\"\r\n              :value=\"floor.value\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" icon=\"Refresh\" @click=\"refreshData\">鍒锋柊鏁版嵁</el-button>\r\n          <el-button icon=\"Download\" @click=\"exportReport\">瀵煎嚭鎶ヨ〃</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n\r\n    <!-- 鍏抽敭鎸囨爣 -->\r\n    <el-row :gutter=\"20\" class=\"statistics-cards\">\r\n      <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\r\n        <el-card>\r\n          <el-statistic title=\"宸℃鎬绘暟\" :value=\"statistics.total\">\r\n            <template #suffix>娆?/template>\r\n          </el-statistic>\r\n          <div class=\"statistic-footer\">\r\n            <div class=\"footer-item\">\r\n              <span>杈冧笂鏈?/span>\r\n              <span class=\"green\">\r\n                <el-icon><CaretTop /></el-icon>\r\n                12%\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\r\n        <el-card>\r\n          <el-statistic title=\"瀹屾垚鐜嘰" :value=\"statistics.completionRate\" :precision=\"1\">\r\n            <template #suffix>%</template>\r\n          </el-statistic>\r\n          <el-progress :percentage=\"statistics.completionRate\" :show-text=\"false\" />\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\r\n        <el-card>\r\n          <el-statistic title=\"寮傚父鍙戠幇鏁癨" :value=\"statistics.anomalyCount\" value-style=\"color: #cf1322\">\r\n            <template #suffix>椤?/template>\r\n          </el-statistic>\r\n          <div class=\"statistic-footer\">\r\n            <div class=\"footer-item\">\r\n              <span>鐢熸垚宸ュ崟</span>\r\n              <span class=\"red\">{{ statistics.ticketCount }}</span>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n      <el-col :xs=\"24\" :sm=\"12\" :md=\"6\">\r\n        <el-card>\r\n          <el-statistic title=\"骞冲潎瀹屾垚鏃堕暱\" :value=\"statistics.avgDuration\" :precision=\"1\">\r\n            <template #suffix>鍒嗛挓</template>\r\n          </el-statistic>\r\n          <div class=\"statistic-footer\">\r\n            <div class=\"footer-item\">\r\n              <span>杈冧笂鏈?/span>\r\n              <span class=\"green\">\r\n                <el-icon><CaretBottom /></el-icon>\r\n                8%\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <!-- 鍥捐〃鍖哄煙 -->\r\n    <el-row :gutter=\"20\">\r\n      <!-- 宸℃瀹屾垚瓒嬪娍 -->\r\n      <el-col :xs=\"24\" :md=\"12\">\r\n        <el-card class=\"chart-card\">\r\n          <template #header>\r\n            <div class=\"chart-header\">\r\n              <span>宸℃瀹屾垚瓒嬪娍</span>\r\n              <el-radio-group v-model=\"trendType\" size=\"small\" @change=\"updateTrendChart\">\r\n                <el-radio-button label=\"day\">鏃?/el-radio-button>\r\n                <el-radio-button label=\"week\">鍛?/el-radio-button>\r\n                <el-radio-button label=\"month\">鏈?/el-radio-button>\r\n              </el-radio-group>\r\n            </div>\r\n          </template>\r\n          <div id=\"trendChart\" class=\"chart-container\"></div>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <!-- 鍚勬ゼ灞傚贰妫€瀵规瘮 -->\r\n      <el-col :xs=\"24\" :md=\"12\">\r\n        <el-card class=\"chart-card\">\r\n          <template #header>\r\n            <span>鍚勬ゼ灞傚贰妫€瀵规瘮</span>\r\n          </template>\r\n          <div id=\"floorChart\" class=\"chart-container\"></div>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <!-- 寮傚父椤筎OP10 -->\r\n      <el-col :xs=\"24\" :md=\"12\">\r\n        <el-card class=\"chart-card\">\r\n          <template #header>\r\n            <span>寮傚父椤筎OP10</span>\r\n          </template>\r\n          <div id=\"anomalyChart\" class=\"chart-container\"></div>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <!-- 宸℃浜哄憳宸ヤ綔閲?-->\r\n      <el-col :xs=\"24\" :md=\"12\">\r\n        <el-card class=\"chart-card\">\r\n          <template #header>\r\n            <span>宸℃浜哄憳宸ヤ綔閲?/span>\r\n          </template>\r\n          <div id=\"workloadChart\" class=\"chart-container\"></div>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <!-- 寮傚父澶勭悊鏃舵晥鍒嗘瀽 -->\r\n    <el-card class=\"table-card\">\r\n      <template #header>\r\n        <span>寮傚父澶勭悊鏃舵晥鍒嗘瀽</span>\r\n      </template>\r\n      <el-table :data=\"anomalyAnalysis\" stripe>\r\n        <el-table-column prop=\"floor\" label=\"妤煎眰\" width=\"80\">\r\n          <template #default=\"scope\">\r\n            {{ getFloorLabel(scope.row.floor) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"itemName\" label=\"妫€鏌ラ」\" show-overflow-tooltip />\r\n        <el-table-column prop=\"count\" label=\"寮傚父娆℃暟\" width=\"90\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-tag type=\"danger\">{{ scope.row.count }}</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"avgTime\" label=\"骞冲潎澶勭悊鏃堕暱\" width=\"120\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            {{ scope.row.avgTime }}灏忔椂\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"priority\" label=\"浼樺厛绾" width=\"80\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getPriorityType(scope.row.priority)\">\r\n              {{ getPriorityLabel(scope.row.priority) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"suggestion\" label=\"鏀硅繘寤鸿\" show-overflow-tooltip />\r\n      </el-table>\r\n    </el-card>\r\n\r\n    <!-- 宸℃瀹屾垚鐜囨帓琛?-->\r\n    <el-card class=\"table-card\">\r\n      <template #header>\r\n        <span>宸℃瀹屾垚鐜囨帓琛?/span>\r\n      </template>\r\n      <el-table :data=\"completionRanking\" stripe>\r\n        <el-table-column type=\"index\" label=\"鎺掑悕\" width=\"60\" align=\"center\" />\r\n        <el-table-column prop=\"name\" label=\"宸℃浜哄憳\" width=\"120\" />\r\n        <el-table-column prop=\"total\" label=\"宸℃娆℃暟\" width=\"90\" align=\"center\" />\r\n        <el-table-column prop=\"completed\" label=\"瀹屾垚娆℃暟\" width=\"90\" align=\"center\" />\r\n        <el-table-column prop=\"completionRate\" label=\"瀹屾垚鐜嘰" width=\"100\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-progress \r\n              :percentage=\"scope.row.completionRate\" \r\n              :text-inside=\"true\"\r\n              :stroke-width=\"18\"\r\n              :status=\"getProgressStatus(scope.row.completionRate)\"\r\n            />\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"avgDuration\" label=\"骞冲潎鏃堕暱\" width=\"100\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            {{ scope.row.avgDuration }}鍒嗛挓\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"anomalyFoundRate\" label=\"寮傚父鍙戠幇鐜嘰" width=\"110\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            {{ scope.row.anomalyFoundRate }}%\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, onBeforeUnmount, nextTick } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { CaretTop, CaretBottom } from '@element-plus/icons-vue'\r\nimport * as echarts from 'echarts'\r\nimport { FLOORS } from './constants'\r\nimport { parseTime } from '@/utils'\r\n\r\n// 鏁版嵁鐘舵€乗r\nconst dateRange = ref([\r\n  new Date(new Date().setDate(new Date().getDate() - 30)),\r\n  new Date()\r\n])\r\nconst selectedFloor = ref('')\r\nconst trendType = ref('day')\r\n\r\n// 缁熻鏁版嵁\r\nconst statistics = reactive({\r\n  total: 156,\r\n  completionRate: 95.6,\r\n  anomalyCount: 42,\r\n  ticketCount: 38,\r\n  avgDuration: 45.2\r\n})\r\n\r\n// 寮傚父鍒嗘瀽鏁版嵁\r\nconst anomalyAnalysis = ref([\r\n  {\r\n    floor: 'floor1',\r\n    itemName: '鍦板煁娌圭綈鍙婅搫鍐风綈鏄惁姝ｅ父',\r\n    count: 8,\r\n    avgTime: 2.5,\r\n    priority: 'high',\r\n    suggestion: '寤鸿澧炲姞鏃ュ父缁存姢棰戞锛屽畾鏈熸鏌ョ閬撹繛鎺?\r\n  },\r\n  {\r\n    floor: 'floor2',\r\n    itemName: '鍐峰嵈濉旀槸鍚︽甯?,\r\n    count: 6,\r\n    avgTime: 4.2,\r\n    priority: 'medium',\r\n    suggestion: '寤鸿姣忔湀娓呮礂鍐峰嵈濉旓紝妫€鏌ラ鎵囪繍琛岀姸鎬?\r\n  },\r\n  {\r\n    floor: 'floor3',\r\n    itemName: 'UPS璁惧杩愯鐘舵€?,\r\n    count: 5,\r\n    avgTime: 1.8,\r\n    priority: 'high',\r\n    suggestion: '寤鸿瀹氭湡杩涜UPS鐢垫睜娴嬭瘯鍜岀淮鎶?\r\n  }\r\n])\r\n\r\n// 瀹屾垚鐜囨帓琛屾暟鎹甛r\nconst completionRanking = ref([\r\n  {\r\n    name: '寮犱笁',\r\n    total: 28,\r\n    completed: 28,\r\n    completionRate: 100,\r\n    avgDuration: 42,\r\n    anomalyFoundRate: 15\r\n  },\r\n  {\r\n    name: '鏉庡洓',\r\n    total: 25,\r\n    completed: 24,\r\n    completionRate: 96,\r\n    avgDuration: 48,\r\n    anomalyFoundRate: 12\r\n  },\r\n  {\r\n    name: '鐜嬩簲',\r\n    total: 22,\r\n    completed: 20,\r\n    completionRate: 91,\r\n    avgDuration: 52,\r\n    anomalyFoundRate: 18\r\n  },\r\n  {\r\n    name: '璧靛叚',\r\n    total: 20,\r\n    completed: 17,\r\n    completionRate: 85,\r\n    avgDuration: 55,\r\n    anomalyFoundRate: 10\r\n  }\r\n])\r\n\r\n// 鍥捐〃瀹炰緥\r\nlet trendChart = null\r\nlet floorChart = null\r\nlet anomalyChart = null\r\nlet workloadChart = null\r\n\r\n// 蹇嵎鏃堕棿閫夐」\r\nconst shortcuts = [\r\n  {\r\n    text: '鏈€杩戜竴鍛?,\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\r\n      return [start, end]\r\n    }\r\n  },\r\n  {\r\n    text: '鏈€杩戜竴鏈?,\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 30)\r\n      return [start, end]\r\n    }\r\n  },\r\n  {\r\n    text: '鏈€杩戜笁鏈?,\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 90)\r\n      return [start, end]\r\n    }\r\n  }\r\n]\r\n\r\n// 鍒濆鍖栬秼鍔垮浘\r\nconst initTrendChart = () => {\r\n  trendChart = echarts.init(document.getElementById('trendChart'))\r\n  const option = {\r\n    tooltip: {\r\n      trigger: 'axis'\r\n    },\r\n    legend: {\r\n      data: ['宸℃娆℃暟', '寮傚父鏁伴噺']\r\n    },\r\n    grid: {\r\n      left: '3%',\r\n      right: '4%',\r\n      bottom: '3%',\r\n      containLabel: true\r\n    },\r\n    xAxis: {\r\n      type: 'category',\r\n      boundaryGap: false,\r\n      data: generateDateLabels(trendType.value)\r\n    },\r\n    yAxis: {\r\n      type: 'value'\r\n    },\r\n    series: [\r\n      {\r\n        name: '宸℃娆℃暟',\r\n        type: 'line',\r\n        smooth: true,\r\n        data: [12, 15, 13, 18, 20, 17, 19],\r\n        itemStyle: { color: '#409eff' }\r\n      },\r\n      {\r\n        name: '寮傚父鏁伴噺',\r\n        type: 'line',\r\n        smooth: true,\r\n        data: [2, 3, 1, 4, 2, 3, 2],\r\n        itemStyle: { color: '#f56c6c' }\r\n      }\r\n    ]\r\n  }\r\n  trendChart.setOption(option)\r\n}\r\n\r\n// 鍒濆鍖栨ゼ灞傚姣斿浘\r\nconst initFloorChart = () => {\r\n  floorChart = echarts.init(document.getElementById('floorChart'))\r\n  const option = {\r\n    tooltip: {\r\n      trigger: 'axis',\r\n      axisPointer: { type: 'shadow' }\r\n    },\r\n    legend: {\r\n      data: ['宸℃娆℃暟', '寮傚父娆℃暟', '瀹屾垚鐜?]\r\n    },\r\n    grid: {\r\n      left: '3%',\r\n      right: '4%',\r\n      bottom: '3%',\r\n      containLabel: true\r\n    },\r\n    xAxis: {\r\n      type: 'category',\r\n      data: ['1妤?, '2妤?, '3妤?, '4妤?]\r\n    },\r\n    yAxis: [\r\n      {\r\n        type: 'value',\r\n        name: '娆℃暟'\r\n      },\r\n      {\r\n        type: 'value',\r\n        name: '瀹屾垚鐜?,\r\n        max: 100,\r\n        axisLabel: {\r\n          formatter: '{value}%'\r\n        }\r\n      }\r\n    ],\r\n    series: [\r\n      {\r\n        name: '宸℃娆℃暟',\r\n        type: 'bar',\r\n        data: [45, 38, 32, 28],\r\n        itemStyle: { color: '#409eff' }\r\n      },\r\n      {\r\n        name: '寮傚父娆℃暟',\r\n        type: 'bar',\r\n        data: [12, 8, 6, 5],\r\n        itemStyle: { color: '#f56c6c' }\r\n      },\r\n      {\r\n        name: '瀹屾垚鐜?,\r\n        type: 'line',\r\n        yAxisIndex: 1,\r\n        data: [95, 92, 88, 90],\r\n        itemStyle: { color: '#67c23a' }\r\n      }\r\n    ]\r\n  }\r\n  floorChart.setOption(option)\r\n}\r\n\r\n// 鍒濆鍖栧紓甯窽OP鍥綷r\nconst initAnomalyChart = () => {\r\n  anomalyChart = echarts.init(document.getElementById('anomalyChart'))\r\n  const option = {\r\n    tooltip: {\r\n      trigger: 'axis',\r\n      axisPointer: { type: 'shadow' }\r\n    },\r\n    grid: {\r\n      left: '3%',\r\n      right: '4%',\r\n      bottom: '3%',\r\n      containLabel: true\r\n    },\r\n    xAxis: {\r\n      type: 'value'\r\n    },\r\n    yAxis: {\r\n      type: 'category',\r\n      data: [\r\n        '鏈烘埧娓╁害瓒呮爣',\r\n        '鍐峰嵈濉旀晠闅?,\r\n        'UPS鍛婅',\r\n        '婕忔按妫€娴?,\r\n        '娑堥槻璁惧寮傚父',\r\n        '娌规満鏁呴殰',\r\n        '閰嶇數寮傚父',\r\n        '婀垮害瓒呮爣',\r\n        '闂ㄧ寮傚父',\r\n        '鐓ф槑鏁呴殰'\r\n      ].reverse()\r\n    },\r\n    series: [{\r\n      name: '寮傚父娆℃暟',\r\n      type: 'bar',\r\n      data: [2, 3, 3, 4, 5, 6, 7, 8, 10, 12].reverse(),\r\n      itemStyle: {\r\n        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [\r\n          { offset: 0, color: '#fccb05' },\r\n          { offset: 1, color: '#f5804d' }\r\n        ])\r\n      },\r\n      label: {\r\n        show: true,\r\n        position: 'right'\r\n      }\r\n    }]\r\n  }\r\n  anomalyChart.setOption(option)\r\n}\r\n\r\n// 鍒濆鍖栧伐浣滈噺鍥綷r\nconst initWorkloadChart = () => {\r\n  workloadChart = echarts.init(document.getElementById('workloadChart'))\r\n  const option = {\r\n    tooltip: {\r\n      trigger: 'item'\r\n    },\r\n    legend: {\r\n      bottom: '5%',\r\n      left: 'center'\r\n    },\r\n    series: [{\r\n      name: '宸℃宸ヤ綔閲?,\r\n      type: 'pie',\r\n      radius: ['40%', '70%'],\r\n      avoidLabelOverlap: false,\r\n      itemStyle: {\r\n        borderRadius: 10,\r\n        borderColor: '#fff',\r\n        borderWidth: 2\r\n      },\r\n      label: {\r\n        show: false,\r\n        position: 'center'\r\n      },\r\n      emphasis: {\r\n        label: {\r\n          show: true,\r\n          fontSize: 20,\r\n          fontWeight: 'bold'\r\n        }\r\n      },\r\n      labelLine: {\r\n        show: false\r\n      },\r\n      data: [\r\n        { value: 28, name: '寮犱笁' },\r\n        { value: 25, name: '鏉庡洓' },\r\n        { value: 22, name: '鐜嬩簲' },\r\n        { value: 20, name: '璧靛叚' },\r\n        { value: 15, name: '鍏朵粬' }\r\n      ]\r\n    }]\r\n  }\r\n  workloadChart.setOption(option)\r\n}\r\n\r\n// 鐢熸垚鏃ユ湡鏍囩\r\nconst generateDateLabels = (type) => {\r\n  const labels = []\r\n  const count = type === 'day' ? 7 : type === 'week' ? 4 : 12\r\n  \r\n  for (let i = count - 1; i >= 0; i--) {\r\n    const date = new Date()\r\n    if (type === 'day') {\r\n      date.setDate(date.getDate() - i)\r\n      labels.push(`${date.getMonth() + 1}/${date.getDate()}`)\r\n    } else if (type === 'week') {\r\n      date.setDate(date.getDate() - i * 7)\r\n      labels.push(`绗?{count - i}鍛╜)\r\n    } else {\r\n      date.setMonth(date.getMonth() - i)\r\n      labels.push(`${date.getMonth() + 1}鏈坄)\r\n    }\r\n  }\r\n  return labels\r\n}\r\n\r\n// 鏃ユ湡鍙樺寲澶勭悊\r\nconst handleDateChange = () => {\r\n  refreshData()\r\n}\r\n\r\n// 妤煎眰鍙樺寲澶勭悊\r\nconst handleFloorChange = () => {\r\n  refreshData()\r\n}\r\n\r\n// 鏇存柊瓒嬪娍鍥綷r\nconst updateTrendChart = () => {\r\n  if (trendChart) {\r\n    trendChart.setOption({\r\n      xAxis: {\r\n        data: generateDateLabels(trendType.value)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n// 鍒锋柊鏁版嵁\r\nconst refreshData = () => {\r\n  ElMessage.success('鏁版嵁宸插埛鏂?)\r\n  // 閲嶆柊鍔犺浇鍥捐〃鏁版嵁\r\n  if (trendChart) trendChart.resize()\r\n  if (floorChart) floorChart.resize()\r\n  if (anomalyChart) anomalyChart.resize()\r\n  if (workloadChart) workloadChart.resize()\r\n}\r\n\r\n// 瀵煎嚭鎶ヨ〃\r\nconst exportReport = () => {\r\n  ElMessage.success('姝ｅ湪鐢熸垚鎶ヨ〃...')\r\n  // 瀵煎嚭閫昏緫\r\n}\r\n\r\n// 鑾峰彇妤煎眰鏍囩\r\nconst getFloorLabel = (value) => {\r\n  const floor = FLOORS.find(f => f.value === value)\r\n  return floor ? floor.label : value\r\n}\r\n\r\n// 鑾峰彇浼樺厛绾х被鍨媆r\nconst getPriorityType = (priority) => {\r\n  const map = {\r\n    high: 'danger',\r\n    medium: 'warning',\r\n    low: 'info'\r\n  }\r\n  return map[priority] || 'info'\r\n}\r\n\r\n// 鑾峰彇浼樺厛绾ф爣绛綷r\nconst getPriorityLabel = (priority) => {\r\n  const map = {\r\n    high: '楂?,\r\n    medium: '涓?,\r\n    low: '浣?\r\n  }\r\n  return map[priority] || priority\r\n}\r\n\r\n// 鑾峰彇杩涘害鏉＄姸鎬乗r\nconst getProgressStatus = (percentage) => {\r\n  if (percentage >= 95) return 'success'\r\n  if (percentage >= 80) return ''\r\n  if (percentage >= 60) return 'warning'\r\n  return 'exception'\r\n}\r\n\r\n// 绐楀彛澶у皬鍙樺寲澶勭悊\r\nconst handleResize = () => {\r\n  if (trendChart) trendChart.resize()\r\n  if (floorChart) floorChart.resize()\r\n  if (anomalyChart) anomalyChart.resize()\r\n  if (workloadChart) workloadChart.resize()\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(async () => {\r\n  await nextTick()\r\n  initTrendChart()\r\n  initFloorChart()\r\n  initAnomalyChart()\r\n  initWorkloadChart()\r\n  \r\n  window.addEventListener('resize', handleResize)\r\n})\r\n\r\n// 娓呯悊\r\nonBeforeUnmount(() => {\r\n  window.removeEventListener('resize', handleResize)\r\n  if (trendChart) {\r\n    trendChart.dispose()\r\n    trendChart = null\r\n  }\r\n  if (floorChart) {\r\n    floorChart.dispose()\r\n    floorChart = null\r\n  }\r\n  if (anomalyChart) {\r\n    anomalyChart.dispose()\r\n    anomalyChart = null\r\n  }\r\n  if (workloadChart) {\r\n    workloadChart.dispose()\r\n    workloadChart = null\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.inspection-statistics {\r\n  padding: 20px;\r\n  \r\n  .filter-card {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .statistics-cards {\r\n    margin-bottom: 20px;\r\n    \r\n    .el-card {\r\n      margin-bottom: 20px;\r\n    }\r\n    \r\n    .statistic-footer {\r\n      margin-top: 10px;\r\n      \r\n      .footer-item {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        font-size: 14px;\r\n        \r\n        .green {\r\n          color: #67c23a;\r\n          display: flex;\r\n          align-items: center;\r\n        }\r\n        \r\n        .red {\r\n          color: #f56c6c;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  .chart-card {\r\n    margin-bottom: 20px;\r\n    \r\n    .chart-header {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n    }\r\n    \r\n    .chart-container {\r\n      height: 350px;\r\n    }\r\n  }\r\n  \r\n  .table-card {\r\n    margin-bottom: 20px;\r\n  }\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\approval.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":262,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":464,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":464,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鎼滅储琛ㄥ崟 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"璁″垝鏍囬\" prop=\"title\">\r\n        <el-input\r\n          v-model=\"queryParams.title\"\r\n          placeholder=\"璇疯緭鍏ヨ鍒掓爣棰榎"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"妤煎眰\" prop=\"floor\">\r\n        <el-select v-model=\"queryParams.floor\" placeholder=\"璇烽€夋嫨妤煎眰\" clearable>\r\n          <el-option label=\"1妤糪" value=\"1\" />\r\n          <el-option label=\"2妤糪" value=\"2\" />\r\n          <el-option label=\"3妤糪" value=\"3\" />\r\n          <el-option label=\"4妤糪" value=\"4\" />\r\n          <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"all\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"MOP绫诲埆\" prop=\"mopCategory\">\r\n        <el-select v-model=\"queryParams.mopCategory\" placeholder=\"璇烽€夋嫨绫诲埆\" clearable>\r\n          <el-option\r\n            v-for=\"dict in mop_category\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"瀹℃壒鐘舵€乗" prop=\"approvalStatus\">\r\n        <el-select v-model=\"queryParams.approvalStatus\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option\r\n            v-for=\"dict in approval_status\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 鎿嶄綔宸ュ叿鏍?-->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"Select\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleBatchApprove\"\r\n          v-hasPermi=\"['business:maintenance:approve']\"\r\n        >鎵归噺閫氳繃</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"danger\"\r\n          plain\r\n          icon=\"CloseBold\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleBatchReject\"\r\n          v-hasPermi=\"['business:maintenance:approve']\"\r\n        >鎵归噺鎷掔粷</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table v-loading=\"loading\" :data=\"approvalList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"璁″垝缂栧彿\" align=\"center\" prop=\"planNo\" width=\"120\" />\r\n      <el-table-column label=\"璁″垝鏍囬\" align=\"left\" prop=\"title\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"妤煎眰\" align=\"center\" prop=\"floor\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-tag>{{ getFloorLabel(scope.row.floor) }}</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鐗堟湰\" align=\"center\" prop=\"version\" width=\"80\" />\r\n      <el-table-column label=\"MOP绫诲埆\" align=\"center\" prop=\"mopCategory\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"mop_category\" :value=\"scope.row.mopCategory\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鍛ㄦ湡\" align=\"center\" prop=\"executionCycle\" width=\"100\" />\r\n      <el-table-column label=\"鐢宠浜篭" align=\"center\" prop=\"applicantName\" width=\"100\" />\r\n      <el-table-column label=\"鐢宠鏃堕棿\" align=\"center\" prop=\"submitTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          {{ parseTime(scope.row.submitTime) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"瀹℃壒鐘舵€乗" align=\"center\" prop=\"approvalStatus\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"approval_status\" :value=\"scope.row.approvalStatus\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"浼樺厛绾" align=\"center\" prop=\"priority\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-tag v-if=\"isUrgent(scope.row)\" type=\"danger\">绱ф€?/el-tag>\r\n          <el-tag v-else type=\"info\">鏅€?/el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"200\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"View\"\r\n            @click=\"handleView(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:query']\"\r\n          >鏌ョ湅</el-button>\r\n          <el-button\r\n            link\r\n            type=\"success\"\r\n            icon=\"Select\"\r\n            @click=\"handleApprove(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:approve']\"\r\n            v-if=\"scope.row.approvalStatus === 'pending'\"\r\n          >閫氳繃</el-button>\r\n          <el-button\r\n            link\r\n            type=\"danger\"\r\n            icon=\"CloseBold\"\r\n            @click=\"handleReject(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:approve']\"\r\n            v-if=\"scope.row.approvalStatus === 'pending'\"\r\n          >鎷掔粷</el-button>\r\n          <el-button\r\n            link\r\n            type=\"warning\"\r\n            icon=\"RefreshRight\"\r\n            @click=\"handleRevoke(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:approve']\"\r\n            v-if=\"scope.row.approvalStatus !== 'pending' && canRevoke(scope.row)\"\r\n          >鎾ゅ洖</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total>0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 鏌ョ湅璇︽儏瀵硅瘽妗?-->\r\n    <el-dialog title=\"缁翠繚璁″垝璇︽儏\" v-model=\"detailOpen\" width=\"900px\" append-to-body>\r\n      <el-descriptions :column=\"2\" border>\r\n        <el-descriptions-item label=\"璁″垝缂栧彿\">{{ currentPlan.planNo }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"璁″垝鏍囬\">{{ currentPlan.title }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"妤煎眰\">{{ getFloorLabel(currentPlan.floor) }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鐗堟湰\">{{ currentPlan.version }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"MOP绫诲埆\">\r\n          <dict-tag :options=\"mop_category\" :value=\"currentPlan.mopCategory\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц鍛ㄦ湡\">{{ currentPlan.executionCycle }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鐢宠浜篭">{{ currentPlan.applicantName }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鐢宠鏃堕棿\">{{ parseTime(currentPlan.submitTime) }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"MOP鍚嶇О\" :span=\"2\">{{ currentPlan.mopName }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"MOP鐩殑\" :span=\"2\">{{ currentPlan.mopPurpose }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"閫氱煡浜哄憳\" :span=\"2\">\r\n          <el-tag v-for=\"userId in currentPlan.notifyUsers\" :key=\"userId\" style=\"margin-right: 5px\">\r\n            {{ getUserName(userId) }}\r\n          </el-tag>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"宸ュ叿浠〃\" :span=\"2\">{{ currentPlan.tools }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鏉愭枡\" :span=\"2\">{{ currentPlan.materials }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹夊叏PPE\" :span=\"2\">{{ currentPlan.safety }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鐗规畩宸ュ叿\" :span=\"2\">{{ currentPlan.specialTools }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц姝ラ\" :span=\"2\">\r\n          <div v-html=\"currentPlan.steps\"></div>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"宸℃缁撴灉\" :span=\"2\">{{ currentPlan.inspectionResult || '寰呮墽琛? }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"澶囨敞\" :span=\"2\">{{ currentPlan.remark }}</el-descriptions-item>\r\n      </el-descriptions>\r\n      \r\n      <!-- 瀹℃壒鍘嗗彶 -->\r\n      <el-divider content-position=\"left\">瀹℃壒鍘嗗彶</el-divider>\r\n      <el-timeline>\r\n        <el-timeline-item\r\n          v-for=\"(log, index) in approvalHistory\"\r\n          :key=\"index\"\r\n          :timestamp=\"parseTime(log.createTime)\"\r\n          placement=\"top\"\r\n          :type=\"getHistoryType(log.action)\"\r\n        >\r\n          <div>\r\n            <span style=\"font-weight: bold\">{{ log.userName }}</span>\r\n            <span style=\"margin: 0 10px\">{{ getActionLabel(log.action) }}</span>\r\n            <el-tag :type=\"getHistoryType(log.action)\" size=\"small\">{{ getActionLabel(log.action) }}</el-tag>\r\n          </div>\r\n          <div v-if=\"log.comment\" style=\"margin-top: 5px; color: #909399\">\r\n            瀹℃壒鎰忚锛歿{ log.comment }}\r\n          </div>\r\n        </el-timeline-item>\r\n      </el-timeline>\r\n      \r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button @click=\"detailOpen = false\">鍏?闂?/el-button>\r\n          <el-button \r\n            type=\"success\" \r\n            @click=\"handleApprove(currentPlan)\"\r\n            v-if=\"currentPlan.approvalStatus === 'pending'\"\r\n            v-hasPermi=\"['business:maintenance:approve']\"\r\n          >閫?杩?/el-button>\r\n          <el-button \r\n            type=\"danger\" \r\n            @click=\"handleReject(currentPlan)\"\r\n            v-if=\"currentPlan.approvalStatus === 'pending'\"\r\n            v-hasPermi=\"['business:maintenance:approve']\"\r\n          >鎷?缁?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 瀹℃壒瀵硅瘽妗?-->\r\n    <el-dialog :title=\"approvalTitle\" v-model=\"approvalOpen\" width=\"500px\" append-to-body>\r\n      <el-form ref=\"approvalRef\" :model=\"approvalForm\" :rules=\"approvalRules\" label-width=\"80px\">\r\n        <el-form-item label=\"瀹℃壒缁撴灉\" v-if=\"!isBatch\">\r\n          <el-radio-group v-model=\"approvalForm.result\" :disabled=\"true\">\r\n            <el-radio label=\"approved\">閫氳繃</el-radio>\r\n            <el-radio label=\"rejected\">鎷掔粷</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"瀹℃壒鎰忚\" prop=\"comment\">\r\n          <el-input\r\n            v-model=\"approvalForm.comment\"\r\n            type=\"textarea\"\r\n            :rows=\"4\"\r\n            placeholder=\"璇疯緭鍏ュ鎵规剰瑙乗"\r\n            maxlength=\"200\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"閫氱煡鏂瑰紡\" v-if=\"approvalForm.result === 'approved'\">\r\n          <el-checkbox-group v-model=\"approvalForm.notifyTypes\">\r\n            <el-checkbox label=\"system\">绯荤粺閫氱煡</el-checkbox>\r\n            <el-checkbox label=\"email\">閭欢閫氱煡</el-checkbox>\r\n            <el-checkbox label=\"sms\">鐭俊閫氱煡</el-checkbox>\r\n          </el-checkbox-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitApproval\">纭?瀹?/el-button>\r\n          <el-button @click=\"approvalOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"MaintenanceApproval\">\r\nimport { listMaintenance, getMaintenance, approvePlan, rejectPlan, revokeApproval, getApprovalHistory } from \"@/api/business/maintenance\";\r\nimport { listUser } from \"@/api/system/user\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\n\r\nconst approvalList = ref([]);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst detailOpen = ref(false);\r\nconst approvalOpen = ref(false);\r\nconst approvalTitle = ref(\"\");\r\nconst currentPlan = ref({});\r\nconst approvalHistory = ref([]);\r\nconst userList = ref([]);\r\nconst isBatch = ref(false);\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { mop_category, approval_status } = proxy.useDict('mop_category', 'approval_status');\r\n\r\nconst data = reactive({\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    title: undefined,\r\n    floor: undefined,\r\n    mopCategory: undefined,\r\n    approvalStatus: 'pending' // 榛樿鏄剧ず寰呭鎵筡r\n  },\r\n  approvalForm: {\r\n    planIds: [],\r\n    result: 'approved',\r\n    comment: '',\r\n    notifyTypes: ['system']\r\n  }\r\n});\r\n\r\nconst { queryParams, approvalForm } = toRefs(data);\r\n\r\n// 琛ㄥ崟楠岃瘉\r\nconst approvalRules = {\r\n  comment: [\r\n    { required: true, message: \"璇疯緭鍏ュ鎵规剰瑙乗", trigger: \"blur\" },\r\n    { min: 5, max: 200, message: \"瀹℃壒鎰忚闀垮害鍦?5 鍒?200 涓瓧绗", trigger: \"blur\" }\r\n  ]\r\n};\r\n\r\n/** 鏌ヨ寰呭鎵瑰垪琛?*/\r\nfunction getList() {\r\n  loading.value = true;\r\n  listMaintenance(queryParams.value).then(response => {\r\n    approvalList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 鑾峰彇妤煎眰鏍囩 */\r\nfunction getFloorLabel(floor) {\r\n  const labels = {\r\n    '1': '1妤?,\r\n    '2': '2妤?,\r\n    '3': '3妤?,\r\n    '4': '4妤?,\r\n    'all': '鍏ㄩ儴妤煎眰'\r\n  };\r\n  return labels[floor] || floor;\r\n}\r\n\r\n/** 鍒ゆ柇鏄惁绱ф€?*/\r\nfunction isUrgent(row) {\r\n  // 绱ф€ョ淮淇垨瓒呰繃3澶╂湭瀹℃壒\r\n  if (row.mopCategory === 'emergency') return true;\r\n  if (row.submitTime) {\r\n    const days = Math.floor((new Date() - new Date(row.submitTime)) / (1000 * 60 * 60 * 24));\r\n    return days > 3;\r\n  }\r\n  return false;\r\n}\r\n\r\n/** 鍒ゆ柇鏄惁鍙挙鍥?*/\r\nfunction canRevoke(row) {\r\n  // 24灏忔椂鍐呯殑瀹℃壒鍙互鎾ゅ洖\r\n  if (row.approvalTime) {\r\n    const hours = Math.floor((new Date() - new Date(row.approvalTime)) / (1000 * 60 * 60));\r\n    return hours < 24;\r\n  }\r\n  return false;\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\");\r\n  queryParams.value.approvalStatus = 'pending';\r\n  handleQuery();\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.planId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n\r\n/** 鏌ョ湅璇︽儏 */\r\nfunction handleView(row) {\r\n  currentPlan.value = row;\r\n  detailOpen.value = true;\r\n  // 鍔犺浇瀹℃壒鍘嗗彶\r\n  getApprovalHistory(row.planId).then(response => {\r\n    approvalHistory.value = response.rows;\r\n  });\r\n}\r\n\r\n/** 閫氳繃瀹℃壒 */\r\nfunction handleApprove(row) {\r\n  isBatch.value = false;\r\n  approvalForm.value = {\r\n    planIds: [row.planId],\r\n    result: 'approved',\r\n    comment: '鍚屾剰鎵ц',\r\n    notifyTypes: ['system']\r\n  };\r\n  approvalTitle.value = `閫氳繃缁翠繚璁″垝锛?{row.title}`;\r\n  approvalOpen.value = true;\r\n}\r\n\r\n/** 鎷掔粷瀹℃壒 */\r\nfunction handleReject(row) {\r\n  isBatch.value = false;\r\n  approvalForm.value = {\r\n    planIds: [row.planId],\r\n    result: 'rejected',\r\n    comment: '',\r\n    notifyTypes: ['system']\r\n  };\r\n  approvalTitle.value = `鎷掔粷缁翠繚璁″垝锛?{row.title}`;\r\n  approvalOpen.value = true;\r\n}\r\n\r\n/** 鎵归噺閫氳繃 */\r\nfunction handleBatchApprove() {\r\n  if (ids.value.length === 0) {\r\n    proxy.$modal.msgWarning(\"璇峰厛閫夋嫨瑕佸鎵圭殑璁″垝\");\r\n    return;\r\n  }\r\n  isBatch.value = true;\r\n  approvalForm.value = {\r\n    planIds: ids.value,\r\n    result: 'approved',\r\n    comment: '鎵归噺瀹℃壒閫氳繃',\r\n    notifyTypes: ['system']\r\n  };\r\n  approvalTitle.value = `鎵归噺閫氳繃 ${ids.value.length} 涓淮淇濊鍒抈;\r\n  approvalOpen.value = true;\r\n}\r\n\r\n/** 鎵归噺鎷掔粷 */\r\nfunction handleBatchReject() {\r\n  if (ids.value.length === 0) {\r\n    proxy.$modal.msgWarning(\"璇峰厛閫夋嫨瑕佸鎵圭殑璁″垝\");\r\n    return;\r\n  }\r\n  isBatch.value = true;\r\n  approvalForm.value = {\r\n    planIds: ids.value,\r\n    result: 'rejected',\r\n    comment: '',\r\n    notifyTypes: ['system']\r\n  };\r\n  approvalTitle.value = `鎵归噺鎷掔粷 ${ids.value.length} 涓淮淇濊鍒抈;\r\n  approvalOpen.value = true;\r\n}\r\n\r\n/** 鎾ゅ洖瀹℃壒 */\r\nfunction handleRevoke(row) {\r\n  proxy.$modal.confirm('鏄惁纭鎾ゅ洖璇ュ鎵癸紵').then(() => {\r\n    return revokeApproval(row.planId);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"鎾ゅ洖鎴愬姛\");\r\n    getList();\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鎻愪氦瀹℃壒 */\r\nfunction submitApproval() {\r\n  proxy.$refs[\"approvalRef\"].validate(valid => {\r\n    if (valid) {\r\n      const isApprove = approvalForm.value.result === 'approved';\r\n      const promise = isApprove \r\n        ? approvePlan(approvalForm.value.planIds, approvalForm.value.comment, approvalForm.value.notifyTypes)\r\n        : rejectPlan(approvalForm.value.planIds, approvalForm.value.comment);\r\n      \r\n      promise.then(response => {\r\n        proxy.$modal.msgSuccess(isApprove ? \"瀹℃壒閫氳繃\" : \"瀹℃壒鎷掔粷\");\r\n        approvalOpen.value = false;\r\n        detailOpen.value = false;\r\n        getList();\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍚嶇О */\r\nfunction getUserName(userId) {\r\n  const user = userList.value.find(u => u.userId === userId);\r\n  return user ? user.nickName : userId;\r\n}\r\n\r\n/** 鑾峰彇鎿嶄綔鏍囩 */\r\nfunction getActionLabel(action) {\r\n  const labels = {\r\n    submit: '鎻愪氦瀹℃壒',\r\n    approved: '瀹℃壒閫氳繃',\r\n    rejected: '瀹℃壒鎷掔粷',\r\n    revoked: '鎾ゅ洖瀹℃壒'\r\n  };\r\n  return labels[action] || action;\r\n}\r\n\r\n/** 鑾峰彇鍘嗗彶绫诲瀷 */\r\nfunction getHistoryType(action) {\r\n  const types = {\r\n    submit: 'primary',\r\n    approved: 'success',\r\n    rejected: 'danger',\r\n    revoked: 'warning'\r\n  };\r\n  return types[action] || 'info';\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍒楄〃 */\r\nfunction getUserList() {\r\n  listUser({ status: '0' }).then(response => {\r\n    userList.value = response.rows;\r\n  });\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(() => {\r\n  getList();\r\n  getUserList();\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\create.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'addMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":202,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":202,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'getLatestPlan' is defined but never used. Allowed unused vars must match /^_/u.","line":202,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":202,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'submitApproval' is defined but never used. Allowed unused vars must match /^_/u.","line":202,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":202,"endColumn":55},{"ruleId":"no-unused-vars","severity":1,"message":"'getApproverList' is defined but never used. Allowed unused vars must match /^_/u.","line":202,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":202,"endColumn":72},{"ruleId":"no-unused-vars","severity":1,"message":"'listUser' is defined but never used. Allowed unused vars must match /^_/u.","line":203,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":203,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <span>鏂板缓缁翠繚璁″垝</span>\r\n      </template>\r\n      \r\n      <el-form ref=\"formRef\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\r\n        <!-- 鍩虹淇℃伅 -->\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"璁″垝鏍囬\" prop=\"title\">\r\n              <el-input v-model=\"form.title\" placeholder=\"璇疯緭鍏ヨ鍒掓爣棰榎" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"妤煎眰缂栧彿\" prop=\"floor\">\r\n              <el-select v-model=\"form.floor\" placeholder=\"璇烽€夋嫨妤煎眰\">\r\n                <el-option label=\"1妤糪" value=\"1\" />\r\n                <el-option label=\"2妤糪" value=\"2\" />\r\n                <el-option label=\"3妤糪" value=\"3\" />\r\n                <el-option label=\"4妤糪" value=\"4\" />\r\n                <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"all\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鐗堟湰鍙穃" prop=\"version\">\r\n              <el-input v-model=\"form.version\" placeholder=\"榛樿V1.0\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"MOP绫诲埆\" prop=\"mopCategory\">\r\n              <el-select v-model=\"form.mopCategory\" placeholder=\"璇烽€夋嫨MOP绫诲埆\">\r\n                <el-option label=\"鏃ュ父缁存姢\" value=\"daily\" />\r\n                <el-option label=\"瀹氭湡淇濆吇\" value=\"regular\" />\r\n                <el-option label=\"鏈堝害妫€淇甛" value=\"monthly\" />\r\n                <el-option label=\"瀛ｅ害妫€淇甛" value=\"quarterly\" />\r\n                <el-option label=\"骞村害妫€淇甛" value=\"annual\" />\r\n                <el-option label=\"搴旀€ョ淮淇甛" value=\"emergency\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <!-- MOP淇℃伅 -->\r\n        <el-divider content-position=\"left\">MOP淇℃伅</el-divider>\r\n        \r\n        <el-form-item label=\"MOP鍚嶇О\" prop=\"mopName\">\r\n          <el-input v-model=\"form.mopName\" placeholder=\"璇疯緭鍏OP鍚嶇О\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"MOP鐩殑\" prop=\"mopPurpose\">\r\n          <el-input v-model=\"form.mopPurpose\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏OP鐩殑\" />\r\n        </el-form-item>\r\n\r\n        <!-- 鎵ц鍛ㄦ湡 -->\r\n        <el-divider content-position=\"left\">鎵ц鍛ㄦ湡</el-divider>\r\n        \r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц棰戞\" prop=\"executionFrequency\">\r\n              <el-input-number v-model=\"form.executionFrequency\" :min=\"1\" :max=\"100\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"棰戞鍗曚綅\" prop=\"executionUnit\">\r\n              <el-select v-model=\"form.executionUnit\" placeholder=\"璇烽€夋嫨鍗曚綅\">\r\n                <el-option label=\"娆?鏈圽" value=\"month\" />\r\n                <el-option label=\"娆?瀛" value=\"quarter\" />\r\n                <el-option label=\"娆?骞碶" value=\"year\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"瀹℃牳浜篭" prop=\"approverId\">\r\n              <el-select v-model=\"form.approverId\" placeholder=\"璇烽€夋嫨瀹℃牳浜篭">\r\n                <el-option\r\n                  v-for=\"user in approverList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц瀹℃牳浜篭" prop=\"executorId\">\r\n              <el-select v-model=\"form.executorId\" placeholder=\"璇烽€夋嫨鎵ц瀹℃牳浜篭">\r\n                <el-option\r\n                  v-for=\"user in approverList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item label=\"閫氱煡浜哄憳\" prop=\"notifyUsers\">\r\n          <el-select v-model=\"form.notifyUsers\" multiple placeholder=\"璇烽€夋嫨閫氱煡浜哄憳\">\r\n            <el-option\r\n              v-for=\"user in userList\"\r\n              :key=\"user.userId\"\r\n              :label=\"user.nickName\"\r\n              :value=\"user.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <!-- 宸ュ叿鏉愭枡 -->\r\n        <el-divider content-position=\"left\">宸ュ叿鏉愭枡</el-divider>\r\n        \r\n        <el-form-item label=\"宸ュ叿浠〃\" prop=\"tools\">\r\n          <el-input v-model=\"form.tools\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ユ墍闇€宸ュ叿浠〃\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"鏉愭枡\" prop=\"materials\">\r\n          <el-input v-model=\"form.materials\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ユ墍闇€鏉愭枡\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"瀹夊叏(PPE)\" prop=\"safety\">\r\n          <el-input v-model=\"form.safety\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ヤ釜浜洪槻鎶よ澶囪姹俓" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"鐗规畩宸ュ叿\" prop=\"specialTools\">\r\n          <el-input v-model=\"form.specialTools\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ユ墍闇€鐗规畩宸ュ叿鎴栭厤浠禱" />\r\n        </el-form-item>\r\n\r\n        <!-- 鎵ц姝ラ -->\r\n        <el-divider content-position=\"left\">鎵ц姝ラ</el-divider>\r\n        \r\n        <el-form-item label=\"姝ラ鍐呭\" prop=\"steps\">\r\n          <el-input v-model=\"form.steps\" type=\"textarea\" :rows=\"5\" placeholder=\"璇疯緭鍏ユ墽琛屾楠" />\r\n        </el-form-item>\r\n\r\n        <!-- 鍒涘缓琛ㄦ牸 -->\r\n        <el-form-item label=\"鍒涘缓琛ㄦ牸\">\r\n          <el-row :gutter=\"10\">\r\n            <el-col :span=\"4\">\r\n              <el-input v-model=\"tableRows\" placeholder=\"琛屾暟\" />\r\n            </el-col>\r\n            <el-col :span=\"1\" style=\"text-align: center\">脳</el-col>\r\n            <el-col :span=\"4\">\r\n              <el-input v-model=\"tableCols\" placeholder=\"鍒楁暟\" />\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n              <el-button @click=\"generateTable\">鐢熸垚琛ㄦ牸</el-button>\r\n            </el-col>\r\n          </el-row>\r\n        </el-form-item>\r\n\r\n        <!-- 鐢熸垚鐨勮〃鏍?-->\r\n        <el-form-item v-if=\"tableData.length > 0\">\r\n          <el-table :data=\"tableData\" border>\r\n            <el-table-column\r\n              v-for=\"(col, index) in tableCols\"\r\n              :key=\"index\"\r\n              :label=\"`鍒?{index + 1}`\"\r\n              :prop=\"`col${index}`\"\r\n            >\r\n              <template #default=\"scope\">\r\n                <el-input v-model=\"scope.row[`col${index}`]\" />\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-form-item>\r\n\r\n        <!-- 鍏朵粬淇℃伅 -->\r\n        <el-divider content-position=\"left\">鍏朵粬淇℃伅</el-divider>\r\n        \r\n        <el-form-item label=\"宸℃缁撴灉\" prop=\"inspectionResult\">\r\n          <el-input v-model=\"form.inspectionResult\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ贰妫€缁撴灉\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n          <el-input v-model=\"form.remark\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ娉╘" />\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <!-- 鎿嶄綔鎸夐挳 -->\r\n      <div class=\"form-footer\">\r\n        <el-button type=\"primary\" @click=\"handleSubmit\">淇?瀛?/el-button>\r\n        <el-button type=\"success\" @click=\"handleSubmitApproval\">鎻愪氦瀹℃牳</el-button>\r\n        <el-button @click=\"handleCopyLast\">澶嶅埗涓婃璁″垝</el-button>\r\n        <el-button @click=\"handleCancel\">鍙?娑?/el-button>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"MaintenanceCreate\">\r\nimport { getCurrentInstance, ref } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { addMaintenance, getLatestPlan, submitApproval, getApproverList } from '@/api/business/maintenance'\r\nimport { listUser } from '@/api/system/user'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\n\r\nconst formRef = ref(null)\r\nconst approverList = ref([])\r\nconst userList = ref([])\r\nconst tableRows = ref(6)\r\nconst tableCols = ref(7)\r\nconst tableData = ref([])\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({\r\n  title: '',\r\n  floor: '',\r\n  version: 'V1.0',\r\n  mopCategory: '',\r\n  mopName: '',\r\n  mopPurpose: '',\r\n  executionFrequency: 1,\r\n  executionUnit: 'month',\r\n  approverId: undefined,\r\n  executorId: undefined,\r\n  notifyUsers: [],\r\n  tools: '',\r\n  materials: '',\r\n  safety: '',\r\n  specialTools: '',\r\n  steps: '',\r\n  inspectionResult: '',\r\n  remark: ''\r\n})\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst rules = {\r\n  title: [{ required: true, message: '璇疯緭鍏ヨ鍒掓爣棰?, trigger: 'blur' }],\r\n  floor: [{ required: true, message: '璇烽€夋嫨妤煎眰', trigger: 'change' }],\r\n  mopCategory: [{ required: true, message: '璇烽€夋嫨MOP绫诲埆', trigger: 'change' }],\r\n  mopName: [{ required: true, message: '璇疯緭鍏OP鍚嶇О', trigger: 'blur' }],\r\n  approverId: [{ required: true, message: '璇烽€夋嫨瀹℃牳浜?, trigger: 'change' }]\r\n}\r\n\r\n// 鐢熸垚琛ㄦ牸\r\nfunction generateTable() {\r\n  const rows = parseInt(tableRows.value) || 6\r\n  const cols = parseInt(tableCols.value) || 7\r\n  \r\n  tableData.value = []\r\n  for (let i = 0; i < rows; i++) {\r\n    const row = {}\r\n    for (let j = 0; j < cols; j++) {\r\n      row[`col${j}`] = ''\r\n    }\r\n    tableData.value.push(row)\r\n  }\r\n}\r\n\r\n// 澶嶅埗涓婃璁″垝\r\nfunction handleCopyLast() {\r\n  proxy.$modal.confirm('鏄惁澶嶅埗涓婃缁翠繚璁″垝锛?).then(() => {\r\n    // Mock鏁版嵁\r\n    form.value = {\r\n      title: '鏈堝害缁翠繚璁″垝(澶嶅埗)',\r\n      floor: '1',\r\n      version: 'V1.1',\r\n      mopCategory: 'monthly',\r\n      mopName: '鏈堝害璁惧妫€淇?,\r\n      mopPurpose: '纭繚璁惧姝ｅ父杩愯',\r\n      executionFrequency: 1,\r\n      executionUnit: 'month',\r\n      approverId: 1,\r\n      executorId: 2,\r\n      notifyUsers: [1, 2],\r\n      tools: '涓囩敤琛ㄣ€佽灪涓濆垁銆佹壋鎵?,\r\n      materials: '娑︽粦娌广€佹竻娲佸墏',\r\n      safety: '瀹夊叏甯姐€佹墜濂椼€佹姢鐩暅',\r\n      specialTools: '涓撶敤妫€娴嬩华',\r\n      steps: '1. 妫€鏌ヨ澶囧瑙俓\n2. 娴嬭瘯杩愯鐘舵€乗\n3. 璁板綍鏁版嵁',\r\n      inspectionResult: '',\r\n      remark: `[澶嶅埗鑷鍒?1锛屽鍒舵椂闂达細${proxy.parseTime(new Date())}]`\r\n    }\r\n    proxy.$modal.msgSuccess('澶嶅埗鎴愬姛')\r\n  })\r\n}\r\n\r\n// 淇濆瓨\r\nfunction handleSubmit() {\r\n  proxy.$refs.formRef.validate(valid => {\r\n    if (valid) {\r\n      proxy.$modal.msgSuccess('淇濆瓨鎴愬姛')\r\n      router.push('/business/maintenance')\r\n    }\r\n  })\r\n}\r\n\r\n// 鎻愪氦瀹℃牳\r\nfunction handleSubmitApproval() {\r\n  proxy.$refs.formRef.validate(valid => {\r\n    if (valid) {\r\n      proxy.$modal.confirm('纭鎻愪氦瀹℃牳锛?).then(() => {\r\n        proxy.$modal.msgSuccess('鎻愪氦鎴愬姛锛岀瓑寰呭鏍?)\r\n        router.push('/business/maintenance')\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n// 鍙栨秷\r\nfunction handleCancel() {\r\n  router.back()\r\n}\r\n\r\n// 鑾峰彇瀹℃壒浜哄垪琛╘r\nfunction getApprovers() {\r\n  // Mock鏁版嵁\r\n  approverList.value = [\r\n    { userId: 1, nickName: '鐜嬬粡鐞? },\r\n    { userId: 2, nickName: '鏉庝富绠? },\r\n    { userId: 3, nickName: '寮犳€荤洃' }\r\n  ]\r\n}\r\n\r\n// 鑾峰彇鐢ㄦ埛鍒楄〃\r\nfunction getUserList() {\r\n  // Mock鏁版嵁\r\n  userList.value = [\r\n    { userId: 1, nickName: '寮犱笁' },\r\n    { userId: 2, nickName: '鏉庡洓' },\r\n    { userId: 3, nickName: '鐜嬩簲' },\r\n    { userId: 4, nickName: '璧靛叚' }\r\n  ]\r\n}\r\n\r\ngetApprovers()\r\ngetUserList()\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.form-footer {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #e8e8e8;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\detail.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":284,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'submitApprovalApi' is defined but never used. Allowed unused vars must match /^_/u.","line":284,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":61},{"ruleId":"no-unused-vars","severity":1,"message":"'approvePlan' is defined but never used. Allowed unused vars must match /^_/u.","line":284,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":74},{"ruleId":"no-unused-vars","severity":1,"message":"'rejectPlan' is defined but never used. Allowed unused vars must match /^_/u.","line":284,"column":76,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":86},{"ruleId":"no-unused-vars","severity":1,"message":"'startExecution' is defined but never used. Allowed unused vars must match /^_/u.","line":284,"column":88,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":102},{"ruleId":"no-unused-vars","severity":1,"message":"'generateTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":284,"column":104,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":118},{"ruleId":"no-unused-vars","severity":1,"message":"'getApproverList' is defined but never used. Allowed unused vars must match /^_/u.","line":284,"column":120,"nodeType":"Identifier","messageId":"unusedVar","endLine":284,"endColumn":135}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-card v-loading=\"loading\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span class=\"title\">缁翠繚璁″垝璇︽儏 - {{ form.planNo }}</span>\r\n          <div class=\"header-buttons\">\r\n            <el-button link type=\"primary\" icon=\"Refresh\" @click=\"getDetail\">鍒锋柊</el-button>\r\n            <el-button link type=\"primary\" icon=\"Close\" @click=\"handleClose\">鍏抽棴</el-button>\r\n          </div>\r\n        </div>\r\n      </template>\r\n\r\n      <!-- 鍩虹淇℃伅 -->\r\n      <el-descriptions :column=\"3\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">鍩虹淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"璁″垝缂栧彿\">\r\n          <span class=\"text-primary\">{{ form.planNo }}</span>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"璁″垝鏍囬\" :span=\"2\">\r\n          {{ form.title }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"妤煎眰\">\r\n          {{ getFloorLabel(form.floor) }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鐗堟湰鍙穃">\r\n          {{ form.version }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"MOP绫诲埆\">\r\n          <dict-tag :options=\"mop_category\" :value=\"form.mopCategory\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹℃牳鐘舵€乗">\r\n          <el-tag :type=\"getApprovalType(form.approvalStatus)\">\r\n            {{ getApprovalLabel(form.approvalStatus) }}\r\n          </el-tag>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц鐘舵€乗">\r\n          <el-tag :type=\"getExecutionType(form.executionStatus)\">\r\n            {{ getExecutionLabel(form.executionStatus) }}\r\n          </el-tag>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鍒涘缓鏃堕棿\">\r\n          {{ parseTime(form.createTime) }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- MOP淇℃伅 -->\r\n      <el-descriptions :column=\"2\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">MOP淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"MOP鍚嶇О\" :span=\"2\">\r\n          {{ form.mopName }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"MOP鐩殑\" :span=\"2\">\r\n          <div class=\"description-content\">{{ form.mopPurpose }}</div>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц鍛ㄦ湡\">\r\n          {{ form.executionFrequency }} {{ getUnitLabel(form.executionUnit) }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"涓嬫鎵ц鏃堕棿\">\r\n          {{ parseTime(form.nextExecutionTime) || '-' }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 浜哄憳淇℃伅 -->\r\n      <el-descriptions :column=\"2\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">浜哄憳淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"瀹℃牳浜篭">\r\n          {{ form.approverName || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц瀹℃牳浜篭">\r\n          {{ form.executorName || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鐢宠浜篭">\r\n          {{ form.applicantName || form.createBy }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎻愪氦鏃堕棿\">\r\n          {{ parseTime(form.submitTime) || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"閫氱煡浜哄憳\" :span=\"2\">\r\n          <el-tag v-for=\"user in notifyUserList\" :key=\"user\" size=\"small\" style=\"margin-right: 5px\">\r\n            {{ user }}\r\n          </el-tag>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 宸ュ叿鏉愭枡 -->\r\n      <el-descriptions :column=\"1\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">宸ュ叿鏉愭枡</span>\r\n        </template>\r\n        <el-descriptions-item label=\"宸ュ叿浠〃\">\r\n          <div class=\"description-content\">{{ form.tools || '鏃? }}</div>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鏉愭枡\">\r\n          <div class=\"description-content\">{{ form.materials || '鏃? }}</div>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹夊叏(PPE)\">\r\n          <div class=\"description-content\">{{ form.safety || '鏃? }}</div>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鐗规畩宸ュ叿\">\r\n          <div class=\"description-content\">{{ form.specialTools || '鏃? }}</div>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 鎵ц姝ラ -->\r\n      <el-descriptions :column=\"1\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">鎵ц姝ラ</span>\r\n        </template>\r\n        <el-descriptions-item>\r\n          <div class=\"steps-content\" v-html=\"formatSteps(form.steps)\"></div>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 瀹℃牳淇℃伅 -->\r\n      <el-descriptions :column=\"2\" border class=\"margin-bottom\" v-if=\"form.approvalStatus !== 'draft'\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">瀹℃牳淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"瀹℃牳鏃堕棿\">\r\n          {{ parseTime(form.approvalTime) || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹℃牳鐘舵€乗">\r\n          <el-tag :type=\"getApprovalType(form.approvalStatus)\">\r\n            {{ getApprovalLabel(form.approvalStatus) }}\r\n          </el-tag>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹℃牳鎰忚\" :span=\"2\">\r\n          <div class=\"description-content\">{{ form.approvalComment || '-' }}</div>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 鎵ц璁板綍 -->\r\n      <el-descriptions :column=\"1\" border class=\"margin-bottom\" v-if=\"executionList.length > 0\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">鎵ц璁板綍</span>\r\n        </template>\r\n        <el-descriptions-item>\r\n          <el-table :data=\"executionList\" border>\r\n            <el-table-column prop=\"executionNo\" label=\"鎵ц缂栧彿\" width=\"150\" />\r\n            <el-table-column prop=\"executorName\" label=\"鎵ц浜篭" width=\"100\" />\r\n            <el-table-column prop=\"actualExecutionTime\" label=\"鎵ц鏃堕棿\" width=\"180\">\r\n              <template #default=\"scope\">\r\n                {{ parseTime(scope.row.actualExecutionTime) }}\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"executionResult\" label=\"鎵ц缁撴灉\" width=\"100\">\r\n              <template #default=\"scope\">\r\n                <el-tag :type=\"scope.row.executionResult === 'normal' ? 'success' : 'danger'\">\r\n                  {{ scope.row.executionResult === 'normal' ? '姝ｅ父' : '寮傚父' }}\r\n                </el-tag>\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"executionRecord\" label=\"鎵ц璁板綍\" min-width=\"200\" />\r\n            <el-table-column label=\"鎿嶄綔\" width=\"100\" fixed=\"right\">\r\n              <template #default=\"scope\">\r\n                <el-button link type=\"primary\" @click=\"viewExecution(scope.row)\">鏌ョ湅</el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 鎿嶄綔鎸夐挳 -->\r\n      <div class=\"action-buttons\">\r\n        <el-button \r\n          type=\"primary\" \r\n          icon=\"Edit\" \r\n          @click=\"handleEdit\"\r\n          v-hasPermi=\"['business:maintenance:edit']\"\r\n          v-if=\"form.approvalStatus === 'draft'\"\r\n        >缂栬緫</el-button>\r\n        \r\n        <el-button \r\n          type=\"success\" \r\n          icon=\"Select\" \r\n          @click=\"handleSubmitApproval\"\r\n          v-hasPermi=\"['business:maintenance:edit']\"\r\n          v-if=\"form.approvalStatus === 'draft'\"\r\n        >鎻愪氦瀹℃牳</el-button>\r\n        \r\n        <el-button \r\n          type=\"success\" \r\n          icon=\"CircleCheck\" \r\n          @click=\"handleApprove\"\r\n          v-hasPermi=\"['business:maintenance:approve']\"\r\n          v-if=\"form.approvalStatus === 'pending' && canApprove\"\r\n        >瀹℃牳閫氳繃</el-button>\r\n        \r\n        <el-button \r\n          type=\"danger\" \r\n          icon=\"CircleClose\" \r\n          @click=\"handleReject\"\r\n          v-hasPermi=\"['business:maintenance:approve']\"\r\n          v-if=\"form.approvalStatus === 'pending' && canApprove\"\r\n        >瀹℃牳鎷掔粷</el-button>\r\n        \r\n        <el-button \r\n          type=\"warning\" \r\n          icon=\"VideoPlay\" \r\n          @click=\"handleExecute\"\r\n          v-hasPermi=\"['business:maintenance:execute']\"\r\n          v-if=\"form.approvalStatus === 'approved' && form.executionStatus === 'pending'\"\r\n        >寮€濮嬫墽琛?/el-button>\r\n        \r\n        <el-button \r\n          type=\"primary\" \r\n          icon=\"Ticket\" \r\n          @click=\"handleGenerateTicket\"\r\n          v-hasPermi=\"['business:maintenance:edit']\"\r\n          v-if=\"form.executionStatus === 'executing'\"\r\n        >鐢熸垚宸ュ崟</el-button>\r\n        \r\n        <el-button \r\n          type=\"info\" \r\n          icon=\"CopyDocument\" \r\n          @click=\"handleCopy\"\r\n        >澶嶅埗璁″垝</el-button>\r\n        \r\n        <el-button \r\n          type=\"info\" \r\n          icon=\"Printer\" \r\n          @click=\"handlePrint\"\r\n        >鎵撳嵃</el-button>\r\n        \r\n        <el-button \r\n          icon=\"Back\" \r\n          @click=\"handleClose\"\r\n        >杩斿洖</el-button>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 鎻愪氦瀹℃牳瀵硅瘽妗?-->\r\n    <el-dialog title=\"鎻愪氦瀹℃牳\" v-model=\"submitOpen\" width=\"500px\" append-to-body>\r\n      <el-form ref=\"submitRef\" :model=\"submitForm\" :rules=\"submitRules\" label-width=\"80px\">\r\n        <el-form-item label=\"瀹℃牳浜篭" prop=\"approverId\">\r\n          <el-select v-model=\"submitForm.approverId\" placeholder=\"璇烽€夋嫨瀹℃牳浜篭">\r\n            <el-option\r\n              v-for=\"user in approverList\"\r\n              :key=\"user.userId\"\r\n              :label=\"user.nickName\"\r\n              :value=\"user.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"璇存槑\" prop=\"remark\">\r\n          <el-input v-model=\"submitForm.remark\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ヨ鏄嶾"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitApproval\">纭?瀹?/el-button>\r\n          <el-button @click=\"submitOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 瀹℃牳瀵硅瘽妗?-->\r\n    <el-dialog :title=\"approvalTitle\" v-model=\"approvalOpen\" width=\"500px\" append-to-body>\r\n      <el-form ref=\"approvalRef\" :model=\"approvalForm\" :rules=\"approvalRules\" label-width=\"80px\">\r\n        <el-form-item label=\"瀹℃牳鎰忚\" prop=\"comment\">\r\n          <el-input v-model=\"approvalForm.comment\" type=\"textarea\" :rows=\"4\" placeholder=\"璇疯緭鍏ュ鏍告剰瑙乗"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitApprovalAction\">纭?瀹?/el-button>\r\n          <el-button @click=\"approvalOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"MaintenanceDetail\">\r\nimport { getCurrentInstance, ref, computed } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { getMaintenance, submitApproval as submitApprovalApi, approvePlan, rejectPlan, startExecution, generateTicket, getApproverList } from '@/api/business/maintenance'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst planId = route.params && route.params.id\r\nconst loading = ref(false)\r\nconst submitOpen = ref(false)\r\nconst approvalOpen = ref(false)\r\nconst approvalType = ref('')\r\nconst approverList = ref([])\r\nconst executionList = ref([])\r\nconst notifyUserList = ref([])\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { mop_category } = proxy.useDict('mop_category')\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({})\r\nconst submitForm = ref({\r\n  approverId: undefined,\r\n  remark: ''\r\n})\r\nconst approvalForm = ref({\r\n  comment: ''\r\n})\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst submitRules = {\r\n  approverId: [{ required: true, message: \"璇烽€夋嫨瀹℃牳浜篭", trigger: \"change\" }]\r\n}\r\nconst approvalRules = {\r\n  comment: [{ required: true, message: \"璇疯緭鍏ュ鏍告剰瑙乗", trigger: \"blur\" }]\r\n}\r\n\r\n// 璁＄畻灞炴€r\nconst canApprove = computed(() => {\r\n  // 鍒ゆ柇褰撳墠鐢ㄦ埛鏄惁涓哄鏍镐汉\r\n  return true // Mock\r\n})\r\n\r\nconst approvalTitle = computed(() => {\r\n  return approvalType.value === 'approve' ? '瀹℃牳閫氳繃' : '瀹℃牳鎷掔粷'\r\n})\r\n\r\n/** 鑾峰彇璇︽儏 */\r\nfunction getDetail() {\r\n  loading.value = true\r\n  // Mock鏁版嵁\r\n  form.value = {\r\n    planId: planId,\r\n    planNo: 'MP202501001',\r\n    title: '鏈堝害缁翠繚璁″垝',\r\n    floor: '1',\r\n    version: 'V1.0',\r\n    mopCategory: 'monthly',\r\n    mopName: '鏈堝害璁惧妫€淇?,\r\n    mopPurpose: '纭繚璁惧姝ｅ父杩愯锛岄闃叉晠闅滃彂鐢?,\r\n    executionFrequency: 1,\r\n    executionUnit: 'month',\r\n    approverName: '鐜嬬粡鐞?,\r\n    executorName: '鏉庝富绠?,\r\n    applicantName: '寮犱笁',\r\n    approvalStatus: 'draft',\r\n    executionStatus: 'pending',\r\n    tools: '涓囩敤琛ㄣ€佽灪涓濆垁銆佹壋鎵?,\r\n    materials: '娑︽粦娌广€佹竻娲佸墏',\r\n    safety: '瀹夊叏甯姐€佹墜濂椼€佹姢鐩暅',\r\n    specialTools: '涓撶敤妫€娴嬩华',\r\n    steps: '1. 妫€鏌ヨ澶囧瑙俓\n2. 娴嬭瘯杩愯鐘舵€乗\n3. 璁板綍鏁版嵁\\n4. 娓呮磥淇濆吇\\n5. 鏇存崲鑰楁潗',\r\n    createTime: new Date(),\r\n    nextExecutionTime: new Date(Date.now() + 30*24*60*60*1000)\r\n  }\r\n  \r\n  notifyUserList.value = ['寮犱笁', '鏉庡洓', '鐜嬩簲']\r\n  \r\n  executionList.value = []\r\n  \r\n  loading.value = false\r\n}\r\n\r\n/** 鑾峰彇妤煎眰鏍囩 */\r\nfunction getFloorLabel(floor) {\r\n  const floorMap = {\r\n    '1': '1妤?,\r\n    '2': '2妤?,\r\n    '3': '3妤?,\r\n    '4': '4妤?,\r\n    'all': '鍏ㄩ儴妤煎眰'\r\n  }\r\n  return floorMap[floor] || floor\r\n}\r\n\r\n/** 鑾峰彇鍗曚綅鏍囩 */\r\nfunction getUnitLabel(unit) {\r\n  const unitMap = {\r\n    'month': '娆?鏈?,\r\n    'quarter': '娆?瀛?,\r\n    'year': '娆?骞?\r\n  }\r\n  return unitMap[unit] || unit\r\n}\r\n\r\n/** 鑾峰彇瀹℃牳鐘舵€佺被鍨?*/\r\nfunction getApprovalType(status) {\r\n  const typeMap = {\r\n    'draft': 'info',\r\n    'pending': 'warning',\r\n    'approved': 'success',\r\n    'rejected': 'danger'\r\n  }\r\n  return typeMap[status] || 'info'\r\n}\r\n\r\n/** 鑾峰彇瀹℃牳鐘舵€佹爣绛?*/\r\nfunction getApprovalLabel(status) {\r\n  const labelMap = {\r\n    'draft': '鑽夌',\r\n    'pending': '寰呭鏍?,\r\n    'approved': '宸叉壒鍑?,\r\n    'rejected': '宸叉嫆缁?\r\n  }\r\n  return labelMap[status] || status\r\n}\r\n\r\n/** 鑾峰彇鎵ц鐘舵€佺被鍨?*/\r\nfunction getExecutionType(status) {\r\n  const typeMap = {\r\n    'pending': 'warning',\r\n    'executing': 'primary',\r\n    'completed': 'success',\r\n    'cancelled': 'info'\r\n  }\r\n  return typeMap[status] || 'info'\r\n}\r\n\r\n/** 鑾峰彇鎵ц鐘舵€佹爣绛?*/\r\nfunction getExecutionLabel(status) {\r\n  const labelMap = {\r\n    'pending': '寰呮墽琛?,\r\n    'executing': '鎵ц涓?,\r\n    'completed': '宸插畬鎴?,\r\n    'cancelled': '宸插彇娑?\r\n  }\r\n  return labelMap[status] || status\r\n}\r\n\r\n/** 鏍煎紡鍖栨楠?*/\r\nfunction formatSteps(steps) {\r\n  if (!steps) return ''\r\n  return steps.replace(/\\n/g, '<br>')\r\n}\r\n\r\n/** 缂栬緫 */\r\nfunction handleEdit() {\r\n  router.push('/business/maintenance/edit/' + planId)\r\n}\r\n\r\n/** 鎻愪氦瀹℃牳 */\r\nfunction handleSubmitApproval() {\r\n  submitForm.value = {\r\n    approverId: undefined,\r\n    remark: ''\r\n  }\r\n  submitOpen.value = true\r\n  getApprovers()\r\n}\r\n\r\n/** 纭鎻愪氦瀹℃牳 */\r\nfunction submitApproval() {\r\n  proxy.$refs[\"submitRef\"].validate(valid => {\r\n    if (valid) {\r\n      proxy.$modal.msgSuccess(\"鎻愪氦鎴愬姛\")\r\n      submitOpen.value = false\r\n      form.value.approvalStatus = 'pending'\r\n      getDetail()\r\n    }\r\n  })\r\n}\r\n\r\n/** 瀹℃牳閫氳繃 */\r\nfunction handleApprove() {\r\n  approvalType.value = 'approve'\r\n  approvalForm.value.comment = ''\r\n  approvalOpen.value = true\r\n}\r\n\r\n/** 瀹℃牳鎷掔粷 */\r\nfunction handleReject() {\r\n  approvalType.value = 'reject'\r\n  approvalForm.value.comment = ''\r\n  approvalOpen.value = true\r\n}\r\n\r\n/** 鎻愪氦瀹℃牳鎿嶄綔 */\r\nfunction submitApprovalAction() {\r\n  proxy.$refs[\"approvalRef\"].validate(valid => {\r\n    if (valid) {\r\n      const msg = approvalType.value === 'approve' ? '瀹℃牳閫氳繃' : '瀹℃牳鎷掔粷'\r\n      proxy.$modal.msgSuccess(msg)\r\n      approvalOpen.value = false\r\n      form.value.approvalStatus = approvalType.value === 'approve' ? 'approved' : 'rejected'\r\n      getDetail()\r\n    }\r\n  })\r\n}\r\n\r\n/** 寮€濮嬫墽琛?*/\r\nfunction handleExecute() {\r\n  proxy.$modal.confirm('纭寮€濮嬫墽琛岃缁翠繚璁″垝锛?).then(() => {\r\n    proxy.$modal.msgSuccess(\"宸插紑濮嬫墽琛孿")\r\n    form.value.executionStatus = 'executing'\r\n    getDetail()\r\n  })\r\n}\r\n\r\n/** 鐢熸垚宸ュ崟 */\r\nfunction handleGenerateTicket() {\r\n  proxy.$modal.confirm('纭鐢熸垚缁翠繚宸ュ崟锛?).then(() => {\r\n    proxy.$modal.msgSuccess(\"宸ュ崟鐢熸垚鎴愬姛\")\r\n  })\r\n}\r\n\r\n/** 澶嶅埗璁″垝 */\r\nfunction handleCopy() {\r\n  proxy.$modal.confirm('纭澶嶅埗璇ョ淮淇濊鍒掞紵').then(() => {\r\n    proxy.$modal.msgSuccess(\"澶嶅埗鎴愬姛\")\r\n    router.push('/business/maintenance/create')\r\n  })\r\n}\r\n\r\n/** 鏌ョ湅鎵ц璁板綍 */\r\nfunction viewExecution(row) {\r\n  proxy.$modal.msgInfo(\"鏌ョ湅鎵ц璁板綍锛歕" + row.executionNo)\r\n}\r\n\r\n/** 鎵撳嵃 */\r\nfunction handlePrint() {\r\n  window.print()\r\n}\r\n\r\n/** 杩斿洖 */\r\nfunction handleClose() {\r\n  router.back()\r\n}\r\n\r\n/** 鑾峰彇瀹℃壒浜哄垪琛?*/\r\nfunction getApprovers() {\r\n  approverList.value = [\r\n    { userId: 1, nickName: '鐜嬬粡鐞? },\r\n    { userId: 2, nickName: '鏉庝富绠? },\r\n    { userId: 3, nickName: '寮犳€荤洃' }\r\n  ]\r\n}\r\n\r\ngetDetail()\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  \r\n  .title {\r\n    font-size: 16px;\r\n    font-weight: bold;\r\n  }\r\n}\r\n\r\n.margin-bottom {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.descriptions-title {\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n}\r\n\r\n.description-content {\r\n  white-space: pre-wrap;\r\n  word-break: break-all;\r\n}\r\n\r\n.steps-content {\r\n  line-height: 1.8;\r\n}\r\n\r\n.text-primary {\r\n  color: #409EFF;\r\n  font-weight: bold;\r\n}\r\n\r\n.action-buttons {\r\n  margin-top: 20px;\r\n  text-align: center;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #EBEEF5;\r\n}\r\n\r\n@media print {\r\n  .action-buttons {\r\n    display: none;\r\n  }\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\edit.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":268,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":268,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'updateMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":268,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":268,"endColumn":43},{"ruleId":"no-unused-vars","severity":1,"message":"'submitApproval' is defined but never used. Allowed unused vars must match /^_/u.","line":268,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":268,"endColumn":59},{"ruleId":"no-unused-vars","severity":1,"message":"'getApproverList' is defined but never used. Allowed unused vars must match /^_/u.","line":268,"column":61,"nodeType":"Identifier","messageId":"unusedVar","endLine":268,"endColumn":76},{"ruleId":"no-unused-vars","severity":1,"message":"'listUser' is defined but never used. Allowed unused vars must match /^_/u.","line":269,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":269,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <span>缂栬緫缁翠繚璁″垝</span>\r\n      </template>\r\n      \r\n      <el-form ref=\"formRef\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\r\n        <!-- 鍩虹淇℃伅 -->\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"璁″垝缂栧彿\">\r\n              <el-input v-model=\"form.planNo\" disabled />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"璁″垝鏍囬\" prop=\"title\">\r\n              <el-input v-model=\"form.title\" placeholder=\"璇疯緭鍏ヨ鍒掓爣棰榎" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"妤煎眰缂栧彿\" prop=\"floor\">\r\n              <el-select v-model=\"form.floor\" placeholder=\"璇烽€夋嫨妤煎眰\">\r\n                <el-option label=\"1妤糪" value=\"1\" />\r\n                <el-option label=\"2妤糪" value=\"2\" />\r\n                <el-option label=\"3妤糪" value=\"3\" />\r\n                <el-option label=\"4妤糪" value=\"4\" />\r\n                <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"all\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鐗堟湰鍙穃" prop=\"version\">\r\n              <el-input v-model=\"form.version\" placeholder=\"榛樿V1.0\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"MOP绫诲埆\" prop=\"mopCategory\">\r\n              <el-select v-model=\"form.mopCategory\" placeholder=\"璇烽€夋嫨MOP绫诲埆\">\r\n                <el-option label=\"鏃ュ父缁存姢\" value=\"daily\" />\r\n                <el-option label=\"瀹氭湡淇濆吇\" value=\"regular\" />\r\n                <el-option label=\"鏈堝害妫€淇甛" value=\"monthly\" />\r\n                <el-option label=\"瀛ｅ害妫€淇甛" value=\"quarterly\" />\r\n                <el-option label=\"骞村害妫€淇甛" value=\"annual\" />\r\n                <el-option label=\"搴旀€ョ淮淇甛" value=\"emergency\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"瀹℃牳鐘舵€乗">\r\n              <el-tag :type=\"getApprovalType(form.approvalStatus)\">\r\n                {{ getApprovalLabel(form.approvalStatus) }}\r\n              </el-tag>\r\n              <el-tag v-if=\"form.executionStatus\" :type=\"getExecutionType(form.executionStatus)\" style=\"margin-left: 10px\">\r\n                {{ getExecutionLabel(form.executionStatus) }}\r\n              </el-tag>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <!-- MOP淇℃伅 -->\r\n        <el-divider content-position=\"left\">MOP淇℃伅</el-divider>\r\n        \r\n        <el-form-item label=\"MOP鍚嶇О\" prop=\"mopName\">\r\n          <el-input v-model=\"form.mopName\" placeholder=\"璇疯緭鍏OP鍚嶇О\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"MOP鐩殑\" prop=\"mopPurpose\">\r\n          <el-input v-model=\"form.mopPurpose\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏OP鐩殑\" />\r\n        </el-form-item>\r\n\r\n        <!-- 鎵ц鍛ㄦ湡 -->\r\n        <el-divider content-position=\"left\">鎵ц鍛ㄦ湡</el-divider>\r\n        \r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц棰戞\" prop=\"executionFrequency\">\r\n              <el-input-number v-model=\"form.executionFrequency\" :min=\"1\" :max=\"100\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"棰戞鍗曚綅\" prop=\"executionUnit\">\r\n              <el-select v-model=\"form.executionUnit\" placeholder=\"璇烽€夋嫨鍗曚綅\">\r\n                <el-option label=\"娆?鏈圽" value=\"month\" />\r\n                <el-option label=\"娆?瀛" value=\"quarter\" />\r\n                <el-option label=\"娆?骞碶" value=\"year\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"瀹℃牳浜篭" prop=\"approverId\">\r\n              <el-select v-model=\"form.approverId\" placeholder=\"璇烽€夋嫨瀹℃牳浜篭" :disabled=\"form.approvalStatus !== 'draft'\">\r\n                <el-option\r\n                  v-for=\"user in approverList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц瀹℃牳浜篭" prop=\"executorId\">\r\n              <el-select v-model=\"form.executorId\" placeholder=\"璇烽€夋嫨鎵ц瀹℃牳浜篭">\r\n                <el-option\r\n                  v-for=\"user in approverList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item label=\"閫氱煡浜哄憳\" prop=\"notifyUsers\">\r\n          <el-select v-model=\"form.notifyUsers\" multiple placeholder=\"璇烽€夋嫨閫氱煡浜哄憳\">\r\n            <el-option\r\n              v-for=\"user in userList\"\r\n              :key=\"user.userId\"\r\n              :label=\"user.nickName\"\r\n              :value=\"user.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <!-- 宸ュ叿鏉愭枡 -->\r\n        <el-divider content-position=\"left\">宸ュ叿鏉愭枡</el-divider>\r\n        \r\n        <el-form-item label=\"宸ュ叿浠〃\" prop=\"tools\">\r\n          <el-input v-model=\"form.tools\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ユ墍闇€宸ュ叿浠〃\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"鏉愭枡\" prop=\"materials\">\r\n          <el-input v-model=\"form.materials\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ユ墍闇€鏉愭枡\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"瀹夊叏(PPE)\" prop=\"safety\">\r\n          <el-input v-model=\"form.safety\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ヤ釜浜洪槻鎶よ澶囪姹俓" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"鐗规畩宸ュ叿\" prop=\"specialTools\">\r\n          <el-input v-model=\"form.specialTools\" type=\"textarea\" :rows=\"2\" placeholder=\"璇疯緭鍏ユ墍闇€鐗规畩宸ュ叿鎴栭厤浠禱" />\r\n        </el-form-item>\r\n\r\n        <!-- 鎵ц姝ラ -->\r\n        <el-divider content-position=\"left\">鎵ц姝ラ</el-divider>\r\n        \r\n        <el-form-item label=\"姝ラ鍐呭\" prop=\"steps\">\r\n          <div class=\"steps-editor\">\r\n            <el-button type=\"primary\" size=\"small\" @click=\"addStep\" style=\"margin-bottom: 10px\">娣诲姞姝ラ</el-button>\r\n            <draggable v-model=\"stepsList\" item-key=\"id\" handle=\".handle\">\r\n              <template #item=\"{element, index}\">\r\n                <div class=\"step-item\">\r\n                  <el-icon class=\"handle\"><Rank /></el-icon>\r\n                  <span class=\"step-number\">{{ index + 1 }}.</span>\r\n                  <el-input \r\n                    v-model=\"element.content\" \r\n                    placeholder=\"璇疯緭鍏ユ楠ゅ唴瀹筡"\r\n                    style=\"flex: 1\"\r\n                  />\r\n                  <el-button type=\"danger\" size=\"small\" icon=\"Delete\" @click=\"removeStep(index)\" />\r\n                </div>\r\n              </template>\r\n            </draggable>\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <!-- 琛ㄦ牸缂栬緫 -->\r\n        <el-form-item label=\"妫€鏌ヨ〃鏍糪" v-if=\"tableData.length > 0\">\r\n          <el-table :data=\"tableData\" border>\r\n            <el-table-column\r\n              v-for=\"(col, index) in tableCols\"\r\n              :key=\"index\"\r\n              :label=\"tableHeaders[index] || `鍒?{index + 1}`\"\r\n              :prop=\"`col${index}`\"\r\n            >\r\n              <template #header>\r\n                <el-input \r\n                  v-model=\"tableHeaders[index]\" \r\n                  placeholder=\"鍒楁爣棰榎"\r\n                  size=\"small\"\r\n                />\r\n              </template>\r\n              <template #default=\"scope\">\r\n                <el-input v-model=\"scope.row[`col${index}`]\" />\r\n              </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"鎿嶄綔\" width=\"80\" fixed=\"right\">\r\n              <template #default=\"scope\">\r\n                <el-button type=\"danger\" size=\"small\" icon=\"Delete\" @click=\"removeTableRow(scope.$index)\" />\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n          <el-button type=\"primary\" size=\"small\" @click=\"addTableRow\" style=\"margin-top: 10px\">娣诲姞琛?/el-button>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"鍒涘缓琛ㄦ牸\" v-else>\r\n          <el-row :gutter=\"10\">\r\n            <el-col :span=\"4\">\r\n              <el-input v-model=\"tableRows\" placeholder=\"琛屾暟\" />\r\n            </el-col>\r\n            <el-col :span=\"1\" style=\"text-align: center\">脳</el-col>\r\n            <el-col :span=\"4\">\r\n              <el-input v-model=\"tableCols\" placeholder=\"鍒楁暟\" />\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n              <el-button @click=\"generateTable\">鐢熸垚琛ㄦ牸</el-button>\r\n            </el-col>\r\n          </el-row>\r\n        </el-form-item>\r\n\r\n        <!-- 鍏朵粬淇℃伅 -->\r\n        <el-divider content-position=\"left\">鍏朵粬淇℃伅</el-divider>\r\n        \r\n        <el-form-item label=\"宸℃缁撴灉\" prop=\"inspectionResult\">\r\n          <el-input v-model=\"form.inspectionResult\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ贰妫€缁撴灉\" />\r\n        </el-form-item>\r\n        \r\n        <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n          <el-input v-model=\"form.remark\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ娉╘" />\r\n        </el-form-item>\r\n\r\n        <!-- 瀹℃牳璁板綍 -->\r\n        <el-divider content-position=\"left\" v-if=\"form.approvalHistory && form.approvalHistory.length > 0\">瀹℃牳璁板綍</el-divider>\r\n        \r\n        <el-timeline v-if=\"form.approvalHistory && form.approvalHistory.length > 0\">\r\n          <el-timeline-item\r\n            v-for=\"(record, index) in form.approvalHistory\"\r\n            :key=\"index\"\r\n            :timestamp=\"parseTime(record.time)\"\r\n            placement=\"top\"\r\n            :type=\"record.action === 'approved' ? 'success' : record.action === 'rejected' ? 'danger' : 'primary'\"\r\n          >\r\n            <div>\r\n              <strong>{{ record.userName }}</strong> {{ getActionLabel(record.action) }}\r\n              <div v-if=\"record.comment\" style=\"margin-top: 5px; color: #909399\">\r\n                {{ record.comment }}\r\n              </div>\r\n            </div>\r\n          </el-timeline-item>\r\n        </el-timeline>\r\n      </el-form>\r\n\r\n      <!-- 鎿嶄綔鎸夐挳 -->\r\n      <div class=\"form-footer\">\r\n        <el-button @click=\"handleCancel\">鍙?娑?/el-button>\r\n        <el-button type=\"primary\" @click=\"handleSave\" v-if=\"form.approvalStatus === 'draft'\">淇?瀛?/el-button>\r\n        <el-button type=\"success\" @click=\"handleSubmitApproval\" v-if=\"form.approvalStatus === 'draft'\">鎻愪氦瀹℃牳</el-button>\r\n        <el-button type=\"warning\" @click=\"handleRevise\" v-if=\"form.approvalStatus === 'rejected'\">淇敼閲嶆彁</el-button>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"MaintenanceEdit\">\r\nimport { getCurrentInstance, ref, onMounted } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { getMaintenance, updateMaintenance, submitApproval, getApproverList } from '@/api/business/maintenance'\r\nimport { listUser } from '@/api/system/user'\r\nimport draggable from 'vuedraggable'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst planId = route.params && route.params.id\r\nconst formRef = ref(null)\r\nconst approverList = ref([])\r\nconst userList = ref([])\r\nconst stepsList = ref([])\r\nconst tableRows = ref(6)\r\nconst tableCols = ref(7)\r\nconst tableData = ref([])\r\nconst tableHeaders = ref([])\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({\r\n  planId: undefined,\r\n  planNo: '',\r\n  title: '',\r\n  floor: '',\r\n  version: 'V1.0',\r\n  mopCategory: '',\r\n  mopName: '',\r\n  mopPurpose: '',\r\n  executionFrequency: 1,\r\n  executionUnit: 'month',\r\n  approverId: undefined,\r\n  executorId: undefined,\r\n  notifyUsers: [],\r\n  tools: '',\r\n  materials: '',\r\n  safety: '',\r\n  specialTools: '',\r\n  steps: '',\r\n  inspectionResult: '',\r\n  remark: '',\r\n  approvalStatus: 'draft',\r\n  executionStatus: 'pending',\r\n  approvalHistory: []\r\n})\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst rules = {\r\n  title: [{ required: true, message: '璇疯緭鍏ヨ鍒掓爣棰?, trigger: 'blur' }],\r\n  floor: [{ required: true, message: '璇烽€夋嫨妤煎眰', trigger: 'change' }],\r\n  mopCategory: [{ required: true, message: '璇烽€夋嫨MOP绫诲埆', trigger: 'change' }],\r\n  mopName: [{ required: true, message: '璇疯緭鍏OP鍚嶇О', trigger: 'blur' }],\r\n  approverId: [{ required: true, message: '璇烽€夋嫨瀹℃牳浜?, trigger: 'change' }]\r\n}\r\n\r\n/** 鑾峰彇璁″垝璇︽儏 */\r\nfunction getPlanDetail() {\r\n  // Mock鏁版嵁\r\n  form.value = {\r\n    planId: planId,\r\n    planNo: 'MP202501001',\r\n    title: '鏈堝害缁翠繚璁″垝',\r\n    floor: '1',\r\n    version: 'V1.0',\r\n    mopCategory: 'monthly',\r\n    mopName: '鏈堝害璁惧妫€淇?,\r\n    mopPurpose: '纭繚璁惧姝ｅ父杩愯',\r\n    executionFrequency: 1,\r\n    executionUnit: 'month',\r\n    approverId: 1,\r\n    executorId: 2,\r\n    notifyUsers: [1, 2],\r\n    tools: '涓囩敤琛ㄣ€佽灪涓濆垁銆佹壋鎵?,\r\n    materials: '娑︽粦娌广€佹竻娲佸墏',\r\n    safety: '瀹夊叏甯姐€佹墜濂椼€佹姢鐩暅',\r\n    specialTools: '涓撶敤妫€娴嬩华',\r\n    steps: '1. 妫€鏌ヨ澶囧瑙俓\n2. 娴嬭瘯杩愯鐘舵€乗\n3. 璁板綍鏁版嵁',\r\n    inspectionResult: '',\r\n    remark: '',\r\n    approvalStatus: 'draft',\r\n    executionStatus: 'pending',\r\n    approvalHistory: []\r\n  }\r\n  \r\n  // 杞崲姝ラ涓哄垪琛╘r\n  if (form.value.steps) {\r\n    stepsList.value = form.value.steps.split('\\n').map((step, index) => ({\r\n      id: index + 1,\r\n      content: step.replace(/^\\d+\\.\\s*/, '')\r\n    }))\r\n  }\r\n}\r\n\r\n/** 娣诲姞姝ラ */\r\nfunction addStep() {\r\n  stepsList.value.push({\r\n    id: Date.now(),\r\n    content: ''\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎姝ラ */\r\nfunction removeStep(index) {\r\n  stepsList.value.splice(index, 1)\r\n}\r\n\r\n/** 鐢熸垚琛ㄦ牸 */\r\nfunction generateTable() {\r\n  const rows = parseInt(tableRows.value) || 6\r\n  const cols = parseInt(tableCols.value) || 7\r\n  \r\n  tableData.value = []\r\n  tableHeaders.value = new Array(cols).fill('')\r\n  \r\n  for (let i = 0; i < rows; i++) {\r\n    const row = {}\r\n    for (let j = 0; j < cols; j++) {\r\n      row[`col${j}`] = ''\r\n    }\r\n    tableData.value.push(row)\r\n  }\r\n}\r\n\r\n/** 娣诲姞琛ㄦ牸琛?*/\r\nfunction addTableRow() {\r\n  const row = {}\r\n  for (let j = 0; j < tableCols.value; j++) {\r\n    row[`col${j}`] = ''\r\n  }\r\n  tableData.value.push(row)\r\n}\r\n\r\n/** 鍒犻櫎琛ㄦ牸琛?*/\r\nfunction removeTableRow(index) {\r\n  tableData.value.splice(index, 1)\r\n}\r\n\r\n/** 鑾峰彇瀹℃壒鐘舵€佺被鍨?*/\r\nfunction getApprovalType(status) {\r\n  const map = {\r\n    'draft': 'info',\r\n    'pending': 'warning',\r\n    'approved': 'success',\r\n    'rejected': 'danger'\r\n  }\r\n  return map[status] || 'info'\r\n}\r\n\r\n/** 鑾峰彇瀹℃壒鐘舵€佹爣绛?*/\r\nfunction getApprovalLabel(status) {\r\n  const map = {\r\n    'draft': '鑽夌',\r\n    'pending': '寰呭鏍?,\r\n    'approved': '宸叉壒鍑?,\r\n    'rejected': '宸叉嫆缁?\r\n  }\r\n  return map[status] || status\r\n}\r\n\r\n/** 鑾峰彇鎵ц鐘舵€佺被鍨?*/\r\nfunction getExecutionType(status) {\r\n  const map = {\r\n    'pending': 'warning',\r\n    'executing': 'primary',\r\n    'completed': 'success',\r\n    'cancelled': 'info'\r\n  }\r\n  return map[status] || 'info'\r\n}\r\n\r\n/** 鑾峰彇鎵ц鐘舵€佹爣绛?*/\r\nfunction getExecutionLabel(status) {\r\n  const map = {\r\n    'pending': '寰呮墽琛?,\r\n    'executing': '鎵ц涓?,\r\n    'completed': '宸插畬鎴?,\r\n    'cancelled': '宸插彇娑?\r\n  }\r\n  return map[status] || status\r\n}\r\n\r\n/** 鑾峰彇鎿嶄綔鏍囩 */\r\nfunction getActionLabel(action) {\r\n  const map = {\r\n    'created': '鍒涘缓浜嗚鍒?,\r\n    'submitted': '鎻愪氦浜嗗鏍?,\r\n    'approved': '瀹℃牳閫氳繃',\r\n    'rejected': '瀹℃牳鎷掔粷',\r\n    'revised': '淇敼閲嶆彁'\r\n  }\r\n  return map[action] || action\r\n}\r\n\r\n/** 淇濆瓨 */\r\nfunction handleSave() {\r\n  proxy.$refs.formRef.validate(valid => {\r\n    if (valid) {\r\n      // 杞崲姝ラ涓哄瓧绗︿覆\r\n      form.value.steps = stepsList.value.map((step, index) => \r\n        `${index + 1}. ${step.content}`\r\n      ).join('\\n')\r\n      \r\n      proxy.$modal.msgSuccess('淇濆瓨鎴愬姛')\r\n      router.push('/business/maintenance')\r\n    }\r\n  })\r\n}\r\n\r\n/** 鎻愪氦瀹℃牳 */\r\nfunction handleSubmitApproval() {\r\n  proxy.$refs.formRef.validate(valid => {\r\n    if (valid) {\r\n      proxy.$modal.confirm('纭鎻愪氦瀹℃牳锛?).then(() => {\r\n        proxy.$modal.msgSuccess('鎻愪氦鎴愬姛锛岀瓑寰呭鏍?)\r\n        router.push('/business/maintenance')\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n/** 淇敼閲嶆彁 */\r\nfunction handleRevise() {\r\n  form.value.approvalStatus = 'draft'\r\n  proxy.$modal.msgSuccess('宸叉仮澶嶄负鑽夌鐘舵€侊紝璇蜂慨鏀瑰悗閲嶆柊鎻愪氦')\r\n}\r\n\r\n/** 鍙栨秷 */\r\nfunction handleCancel() {\r\n  router.back()\r\n}\r\n\r\n/** 鑾峰彇瀹℃壒浜哄垪琛?*/\r\nfunction getApprovers() {\r\n  approverList.value = [\r\n    { userId: 1, nickName: '鐜嬬粡鐞? },\r\n    { userId: 2, nickName: '鏉庝富绠? },\r\n    { userId: 3, nickName: '寮犳€荤洃' }\r\n  ]\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍒楄〃 */\r\nfunction getUserList() {\r\n  userList.value = [\r\n    { userId: 1, nickName: '寮犱笁' },\r\n    { userId: 2, nickName: '鏉庡洓' },\r\n    { userId: 3, nickName: '鐜嬩簲' },\r\n    { userId: 4, nickName: '璧靛叚' }\r\n  ]\r\n}\r\n\r\nonMounted(() => {\r\n  getApprovers()\r\n  getUserList()\r\n  getPlanDetail()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.steps-editor {\r\n  .step-item {\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 10px;\r\n    \r\n    .handle {\r\n      cursor: move;\r\n      margin-right: 10px;\r\n      color: #909399;\r\n    }\r\n    \r\n    .step-number {\r\n      margin-right: 10px;\r\n      font-weight: bold;\r\n      color: #606266;\r\n    }\r\n  }\r\n}\r\n\r\n.form-footer {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #e8e8e8;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\execution.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":477,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":477,"endColumn":59},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":484,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":484,"endColumn":56}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鎼滅储琛ㄥ崟 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"璁″垝鏍囬\" prop=\"title\">\r\n        <el-input\r\n          v-model=\"queryParams.title\"\r\n          placeholder=\"璇疯緭鍏ヨ鍒掓爣棰榎"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"妤煎眰\" prop=\"floor\">\r\n        <el-select v-model=\"queryParams.floor\" placeholder=\"璇烽€夋嫨妤煎眰\" clearable>\r\n          <el-option label=\"1妤糪" value=\"1\" />\r\n          <el-option label=\"2妤糪" value=\"2\" />\r\n          <el-option label=\"3妤糪" value=\"3\" />\r\n          <el-option label=\"4妤糪" value=\"4\" />\r\n          <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"all\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"鎵ц鐘舵€乗" prop=\"executionStatus\">\r\n        <el-select v-model=\"queryParams.executionStatus\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option\r\n            v-for=\"dict in execution_status\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"鎵ц鏃堕棿\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          value-format=\"YYYY-MM-DD\"\r\n          type=\"daterange\"\r\n          range-separator=\"鑷砛"\r\n          start-placeholder=\"寮€濮嬫棩鏈焅"\r\n          end-placeholder=\"缁撴潫鏃ユ湡\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 鎿嶄綔宸ュ叿鏍?-->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"VideoPlay\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleBatchExecute\"\r\n          v-hasPermi=\"['business:maintenance:execute']\"\r\n        >鎵归噺鎵ц</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"warning\"\r\n          plain\r\n          icon=\"Download\"\r\n          @click=\"handleExport\"\r\n          v-hasPermi=\"['business:maintenance:export']\"\r\n        >瀵煎嚭</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"info\"\r\n          plain\r\n          icon=\"Document\"\r\n          @click=\"handleReport\"\r\n        >鐢熸垚鎶ュ憡</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table v-loading=\"loading\" :data=\"executionList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"鎵ц缂栧彿\" align=\"center\" prop=\"executionNo\" width=\"120\" />\r\n      <el-table-column label=\"璁″垝鏍囬\" align=\"left\" prop=\"title\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"妤煎眰\" align=\"center\" prop=\"floor\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-tag>{{ getFloorLabel(scope.row.floor) }}</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鐗堟湰\" align=\"center\" prop=\"version\" width=\"80\" />\r\n      <el-table-column label=\"MOP绫诲埆\" align=\"center\" prop=\"mopCategory\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"mop_category\" :value=\"scope.row.mopCategory\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц浜篭" align=\"center\" prop=\"executorName\" width=\"100\" />\r\n      <el-table-column label=\"璁″垝鏃堕棿\" align=\"center\" prop=\"planExecutionTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          {{ parseTime(scope.row.planExecutionTime) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"瀹為檯鎵ц鏃堕棿\" align=\"center\" prop=\"actualExecutionTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          <span v-if=\"scope.row.actualExecutionTime\">\r\n            {{ parseTime(scope.row.actualExecutionTime) }}\r\n            <el-tag v-if=\"isDelayed(scope.row)\" type=\"warning\" size=\"small\">寤舵湡</el-tag>\r\n          </span>\r\n          <span v-else>-</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鐘舵€乗" align=\"center\" prop=\"executionStatus\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"execution_status\" :value=\"scope.row.executionStatus\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц缁撴灉\" align=\"center\" prop=\"executionResult\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <el-tag v-if=\"scope.row.executionResult === 'normal'\" type=\"success\">姝ｅ父</el-tag>\r\n          <el-tag v-else-if=\"scope.row.executionResult === 'abnormal'\" type=\"danger\">寮傚父</el-tag>\r\n          <span v-else>-</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"220\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"View\"\r\n            @click=\"handleView(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:query']\"\r\n          >鏌ョ湅</el-button>\r\n          <el-button\r\n            v-if=\"scope.row.executionStatus === 'pending'\"\r\n            link\r\n            type=\"success\"\r\n            icon=\"VideoPlay\"\r\n            @click=\"handleExecute(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:execute']\"\r\n          >鎵ц</el-button>\r\n          <el-button\r\n            v-if=\"scope.row.executionStatus === 'executing'\"\r\n            link\r\n            type=\"warning\"\r\n            icon=\"Check\"\r\n            @click=\"handleComplete(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:execute']\"\r\n          >瀹屾垚</el-button>\r\n          <el-button\r\n            v-if=\"scope.row.executionResult === 'abnormal'\"\r\n            link\r\n            type=\"danger\"\r\n            icon=\"Tickets\"\r\n            @click=\"handleCreateTicket(scope.row)\"\r\n            v-hasPermi=\"['business:ticket:add']\"\r\n          >鐢熸垚宸ュ崟</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total>0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 鎵ц璁板綍瀵硅瘽妗?-->\r\n    <el-dialog :title=\"dialogTitle\" v-model=\"executeOpen\" width=\"700px\" append-to-body>\r\n      <el-form ref=\"executeRef\" :model=\"executeForm\" :rules=\"executeRules\" label-width=\"100px\">\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц浜篭" prop=\"executorId\">\r\n              <el-select v-model=\"executeForm.executorId\" placeholder=\"璇烽€夋嫨鎵ц浜篭">\r\n                <el-option\r\n                  v-for=\"user in userList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵ц鏃堕棿\" prop=\"executionTime\">\r\n              <el-date-picker\r\n                v-model=\"executeForm.executionTime\"\r\n                type=\"datetime\"\r\n                placeholder=\"閫夋嫨鎵ц鏃堕棿\"\r\n                format=\"YYYY-MM-DD HH:mm:ss\"\r\n                value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-form-item label=\"鎵ц鎯呭喌\" prop=\"executionResult\">\r\n          <el-radio-group v-model=\"executeForm.executionResult\">\r\n            <el-radio label=\"normal\">姝ｅ父</el-radio>\r\n            <el-radio label=\"abnormal\">寮傚父</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"寮傚父鎻忚堪\" v-if=\"executeForm.executionResult === 'abnormal'\" prop=\"abnormalDescription\">\r\n          <el-input\r\n            v-model=\"executeForm.abnormalDescription\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"璇锋弿杩板紓甯告儏鍐礬"\r\n            maxlength=\"500\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"鎵ц璁板綍\" prop=\"executionRecord\">\r\n          <el-input\r\n            v-model=\"executeForm.executionRecord\"\r\n            type=\"textarea\"\r\n            :rows=\"4\"\r\n            placeholder=\"璇疯緭鍏ユ墽琛岃褰昞"\r\n            maxlength=\"1000\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"鐜板満鐓х墖\">\r\n          <image-upload \r\n            v-model=\"executeForm.photos\"\r\n            :limit=\"6\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"闄勪欢\">\r\n          <file-upload \r\n            v-model=\"executeForm.attachments\"\r\n            :limit=\"3\"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitExecute\">纭?瀹?/el-button>\r\n          <el-button @click=\"executeOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 鏌ョ湅璇︽儏瀵硅瘽妗?-->\r\n    <el-dialog title=\"鎵ц璁板綍璇︽儏\" v-model=\"detailOpen\" width=\"800px\" append-to-body>\r\n      <el-descriptions :column=\"2\" border>\r\n        <el-descriptions-item label=\"鎵ц缂栧彿\">{{ currentRecord.executionNo }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"璁″垝鏍囬\">{{ currentRecord.title }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"妤煎眰\">{{ getFloorLabel(currentRecord.floor) }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鐗堟湰\">{{ currentRecord.version }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"MOP绫诲埆\">\r\n          <dict-tag :options=\"mop_category\" :value=\"currentRecord.mopCategory\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц浜篭">{{ currentRecord.executorName }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"璁″垝鏃堕棿\">{{ parseTime(currentRecord.planExecutionTime) }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹為檯鎵ц鏃堕棿\">\r\n          {{ parseTime(currentRecord.actualExecutionTime) || '鏈墽琛? }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц鐘舵€乗">\r\n          <dict-tag :options=\"execution_status\" :value=\"currentRecord.executionStatus\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц缁撴灉\">\r\n          <el-tag :type=\"currentRecord.executionResult === 'normal' ? 'success' : 'danger'\">\r\n            {{ currentRecord.executionResult === 'normal' ? '姝ｅ父' : '寮傚父' }}\r\n          </el-tag>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎵ц璁板綍\" :span=\"2\">{{ currentRecord.executionRecord }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"寮傚父鎻忚堪\" :span=\"2\" v-if=\"currentRecord.abnormalDescription\">\r\n          <el-alert\r\n            :title=\"currentRecord.abnormalDescription\"\r\n            type=\"warning\"\r\n            :closable=\"false\"\r\n          />\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鐜板満鐓х墖\" :span=\"2\" v-if=\"currentRecord.photos && currentRecord.photos.length > 0\">\r\n          <image-preview :src-list=\"currentRecord.photos\" />\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"闄勪欢\" :span=\"2\" v-if=\"currentRecord.attachments && currentRecord.attachments.length > 0\">\r\n          <div v-for=\"(file, index) in currentRecord.attachments\" :key=\"index\">\r\n            <el-link type=\"primary\" :href=\"file.url\" target=\"_blank\">{{ file.name }}</el-link>\r\n          </div>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n      \r\n      <!-- 鎵ц姝ラ妫€鏌ユ竻鍗?-->\r\n      <el-divider content-position=\"left\">鎵ц姝ラ妫€鏌?/el-divider>\r\n      <el-table :data=\"currentRecord.checkList\" v-if=\"currentRecord.checkList\">\r\n        <el-table-column label=\"搴忓彿\" type=\"index\" width=\"60\" align=\"center\" />\r\n        <el-table-column label=\"妫€鏌ラ」\" prop=\"item\" />\r\n        <el-table-column label=\"鏍囧噯\" prop=\"standard\" />\r\n        <el-table-column label=\"缁撴灉\" prop=\"result\" width=\"100\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"scope.row.result === 'pass' ? 'success' : 'danger'\">\r\n              {{ scope.row.result === 'pass' ? '鍚堟牸' : '涓嶅悎鏍? }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"澶囨敞\" prop=\"remark\" />\r\n      </el-table>\r\n      \r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button @click=\"detailOpen = false\">鍏?闂?/el-button>\r\n          <el-button type=\"primary\" @click=\"handlePrint\">鎵?鍗?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"MaintenanceExecution\">\r\nimport { listExecution, getExecution, startExecution, completeExecution, createTicketFromExecution } from \"@/api/business/maintenance\";\r\nimport { listUser } from \"@/api/system/user\";\r\nimport ImageUpload from '@/components/ImageUpload';\r\nimport FileUpload from '@/components/FileUpload';\r\nimport ImagePreview from '@/components/ImagePreview';\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst router = useRouter();\r\n\r\nconst executionList = ref([]);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst dateRange = ref([]);\r\nconst executeOpen = ref(false);\r\nconst detailOpen = ref(false);\r\nconst dialogTitle = ref(\"\");\r\nconst currentRecord = ref({});\r\nconst userList = ref([]);\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { mop_category, execution_status } = proxy.useDict('mop_category', 'execution_status');\r\n\r\nconst data = reactive({\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    title: undefined,\r\n    floor: undefined,\r\n    executionStatus: undefined\r\n  },\r\n  executeForm: {\r\n    executionId: undefined,\r\n    planId: undefined,\r\n    executorId: undefined,\r\n    executionTime: undefined,\r\n    executionResult: 'normal',\r\n    abnormalDescription: '',\r\n    executionRecord: '',\r\n    photos: [],\r\n    attachments: []\r\n  }\r\n});\r\n\r\nconst { queryParams, executeForm } = toRefs(data);\r\n\r\n// 琛ㄥ崟楠岃瘉\r\nconst executeRules = {\r\n  executorId: [\r\n    { required: true, message: \"璇烽€夋嫨鎵ц浜篭", trigger: \"change\" }\r\n  ],\r\n  executionTime: [\r\n    { required: true, message: \"璇烽€夋嫨鎵ц鏃堕棿\", trigger: \"change\" }\r\n  ],\r\n  executionResult: [\r\n    { required: true, message: \"璇烽€夋嫨鎵ц鎯呭喌\", trigger: \"change\" }\r\n  ],\r\n  executionRecord: [\r\n    { required: true, message: \"璇疯緭鍏ユ墽琛岃褰昞", trigger: \"blur\" },\r\n    { min: 10, max: 1000, message: \"鎵ц璁板綍闀垮害鍦?10 鍒?1000 涓瓧绗", trigger: \"blur\" }\r\n  ],\r\n  abnormalDescription: [\r\n    { required: true, message: \"璇锋弿杩板紓甯告儏鍐礬", trigger: \"blur\" }\r\n  ]\r\n};\r\n\r\n/** 鏌ヨ鎵ц鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  let params = proxy.addDateRange(queryParams.value, dateRange.value);\r\n  listExecution(params).then(response => {\r\n    executionList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 鑾峰彇妤煎眰鏍囩 */\r\nfunction getFloorLabel(floor) {\r\n  const labels = {\r\n    '1': '1妤?,\r\n    '2': '2妤?,\r\n    '3': '3妤?,\r\n    '4': '4妤?,\r\n    'all': '鍏ㄩ儴妤煎眰'\r\n  };\r\n  return labels[floor] || floor;\r\n}\r\n\r\n/** 鍒ゆ柇鏄惁寤舵湡 */\r\nfunction isDelayed(row) {\r\n  if (!row.actualExecutionTime || !row.planExecutionTime) return false;\r\n  return new Date(row.actualExecutionTime) > new Date(row.planExecutionTime);\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = [];\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.executionId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n\r\n/** 鏌ョ湅璇︽儏 */\r\nfunction handleView(row) {\r\n  getExecution(row.executionId).then(response => {\r\n    currentRecord.value = response.data;\r\n    detailOpen.value = true;\r\n  });\r\n}\r\n\r\n/** 鎵ц鎿嶄綔 */\r\nfunction handleExecute(row) {\r\n  reset();\r\n  executeForm.value.planId = row.planId;\r\n  executeForm.value.executionId = row.executionId;\r\n  executeForm.value.executionTime = new Date();\r\n  dialogTitle.value = `鎵ц缁翠繚璁″垝锛?{row.title}`;\r\n  executeOpen.value = true;\r\n}\r\n\r\n/** 瀹屾垚鎿嶄綔 */\r\nfunction handleComplete(row) {\r\n  reset();\r\n  getExecution(row.executionId).then(response => {\r\n    executeForm.value = response.data;\r\n    dialogTitle.value = `瀹屾垚缁翠繚璁″垝锛?{row.title}`;\r\n    executeOpen.value = true;\r\n  });\r\n}\r\n\r\n/** 鎵归噺鎵ц */\r\nfunction handleBatchExecute() {\r\n  if (ids.value.length === 0) {\r\n    proxy.$modal.msgWarning(\"璇峰厛閫夋嫨瑕佹墽琛岀殑璁″垝\");\r\n    return;\r\n  }\r\n  proxy.$modal.confirm(`纭鎵归噺鎵ц ${ids.value.length} 涓淮淇濊鍒掑悧锛焋).then(() => {\r\n    // 鎵归噺鎵ц閫昏緫\r\n    proxy.$modal.msgSuccess(\"宸插紑濮嬫壒閲忔墽琛孿");\r\n    getList();\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鎻愪氦鎵ц璁板綍 */\r\nfunction submitExecute() {\r\n  proxy.$refs[\"executeRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (executeForm.value.executionId) {\r\n        // 瀹屾垚鎵ц\r\n        completeExecution(executeForm.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鎵ц璁板綍宸蹭繚瀛榎");\r\n          executeOpen.value = false;\r\n          getList();\r\n        });\r\n      } else {\r\n        // 寮€濮嬫墽琛孿r\n        startExecution(executeForm.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"宸插紑濮嬫墽琛孿");\r\n          executeOpen.value = false;\r\n          getList();\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n/** 鐢熸垚宸ュ崟 */\r\nfunction handleCreateTicket(row) {\r\n  proxy.$modal.confirm('纭鏍规嵁寮傚父鎯呭喌鐢熸垚宸ュ崟鍚楋紵').then(() => {\r\n    return createTicketFromExecution(row.executionId);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"宸ュ崟鐢熸垚鎴愬姛\");\r\n    router.push('/business/ticket');\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鐢熸垚鎶ュ憡 */\r\nfunction handleReport() {\r\n  const params = proxy.addDateRange(queryParams.value, dateRange.value);\r\n  proxy.download('business/maintenance/execution/report', params, `缁翠繚鎵ц鎶ュ憡_${new Date().getTime()}.pdf`);\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download('business/maintenance/execution/export', {\r\n    ...queryParams.value\r\n  }, `execution_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/** 鎵撳嵃 */\r\nfunction handlePrint() {\r\n  window.print();\r\n}\r\n\r\n/** 閲嶇疆琛ㄥ崟 */\r\nfunction reset() {\r\n  executeForm.value = {\r\n    executionId: undefined,\r\n    planId: undefined,\r\n    executorId: undefined,\r\n    executionTime: undefined,\r\n    executionResult: 'normal',\r\n    abnormalDescription: '',\r\n    executionRecord: '',\r\n    photos: [],\r\n    attachments: []\r\n  };\r\n  proxy.resetForm(\"executeRef\");\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍒楄〃 */\r\nfunction getUserList() {\r\n  listUser({ status: '0' }).then(response => {\r\n    userList.value = response.rows;\r\n  });\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(() => {\r\n  getList();\r\n  getUserList();\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\execution\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'maintenancePlanApi' is defined but never used. Allowed unused vars must match /^_/u.","line":173,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":173,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":245,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":245,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'row' is defined but never used. Allowed unused args must match /^_/u.","line":308,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":308,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<!-- src/views/maintenance/execution/index.vue -->\r\n<template>\r\n  <div class=\"maintenance-execution-list\">\r\n    <!-- 鎼滅储鍖哄煙 -->\r\n    <el-card class=\"search-card\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\">\r\n        <el-form-item label=\"璁″垝鍚嶇О\" prop=\"planName\">\r\n          <el-input\r\n            v-model=\"queryParams.planName\"\r\n            placeholder=\"璇疯緭鍏ヨ鍒掑悕绉癨"\r\n            clearable\r\n            @keyup.enter=\"handleQuery\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"鎵ц浜篭" prop=\"executorName\">\r\n          <el-input\r\n            v-model=\"queryParams.executorName\"\r\n            placeholder=\"璇疯緭鍏ユ墽琛屼汉\"\r\n            clearable\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"鎵ц鐘舵€乗" prop=\"status\">\r\n          <el-select v-model=\"queryParams.status\" placeholder=\"鍏ㄩ儴\" clearable>\r\n            <el-option label=\"鎵ц涓璡" value=\"executing\" />\r\n            <el-option label=\"宸插畬鎴怽" value=\"completed\" />\r\n            <el-option label=\"宸蹭腑姝" value=\"aborted\" />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"鎵ц鏃堕棿\">\r\n          <el-date-picker\r\n            v-model=\"dateRange\"\r\n            type=\"daterange\"\r\n            value-format=\"YYYY-MM-DD\"\r\n            range-separator=\"鑷砛"\r\n            start-placeholder=\"寮€濮嬫棩鏈焅"\r\n            end-placeholder=\"缁撴潫鏃ユ湡\"\r\n            @change=\"handleDateChange\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n          <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-card class=\"table-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>鎵ц璁板綍鍒楄〃</span>\r\n          <el-button type=\"warning\" icon=\"Download\" @click=\"handleExport\">瀵煎嚭</el-button>\r\n        </div>\r\n      </template>\r\n\r\n      <el-table\r\n        v-loading=\"loading\"\r\n        :data=\"executionList\"\r\n        border\r\n        stripe\r\n      >\r\n        <el-table-column label=\"鎵ц缂栧彿\" prop=\"executionNo\" width=\"120\" align=\"center\" />\r\n        <el-table-column label=\"璁″垝鍚嶇О\" prop=\"planName\" min-width=\"200\" show-overflow-tooltip />\r\n        <el-table-column label=\"鎵ц浜篭" prop=\"executorName\" width=\"100\" align=\"center\" />\r\n        <el-table-column label=\"寮€濮嬫椂闂碶" prop=\"startTime\" width=\"160\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            {{ parseTime(scope.row.startTime) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"瀹屾垚鏃堕棿\" prop=\"endTime\" width=\"160\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            {{ scope.row.endTime ? parseTime(scope.row.endTime) : '-' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"鑰楁椂\" prop=\"duration\" width=\"100\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            {{ formatDuration(scope.row.duration) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"鎵ц鐘舵€乗" prop=\"status\" width=\"100\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getStatusType(scope.row.status)\">\r\n              {{ getStatusLabel(scope.row.status) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"鎵ц缁撴灉\" prop=\"result\" width=\"100\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            <el-tag v-if=\"scope.row.result\" :type=\"scope.row.result === 'success' ? 'success' : 'danger'\">\r\n              {{ scope.row.result === 'success' ? '鎴愬姛' : '澶辫触' }}\r\n            </el-tag>\r\n            <span v-else>-</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"鎿嶄綔\" width=\"200\" align=\"center\" fixed=\"right\">\r\n          <template #default=\"scope\">\r\n            <el-button link type=\"primary\" size=\"small\" @click=\"handleDetail(scope.row)\">\r\n              鏌ョ湅璇︽儏\r\n            </el-button>\r\n            <el-button\r\n              v-if=\"scope.row.status === 'executing'\"\r\n              link type=\"success\" size=\"small\"\r\n              @click=\"handleComplete(scope.row)\"\r\n            >\r\n              瀹屾垚鎵ц\r\n            </el-button>\r\n            <el-button\r\n              v-if=\"scope.row.status === 'executing'\"\r\n              link type=\"danger\" size=\"small\"\r\n              @click=\"handleAbort(scope.row)\"\r\n            >\r\n              涓鎵ц\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 鍒嗛〉 -->\r\n      <pagination\r\n        v-show=\"total > 0\"\r\n        :total=\"total\"\r\n        v-model:page=\"queryParams.pageNum\"\r\n        v-model:limit=\"queryParams.pageSize\"\r\n        @pagination=\"getList\"\r\n      />\r\n    </el-card>\r\n\r\n    <!-- 瀹屾垚鎵ц瀵硅瘽妗?-->\r\n    <el-dialog v-model=\"completeDialogVisible\" title=\"瀹屾垚鎵ц\" width=\"600px\">\r\n      <el-form ref=\"completeFormRef\" :model=\"completeForm\" :rules=\"completeRules\" label-width=\"100px\">\r\n        <el-form-item label=\"鎵ц缁撴灉\" prop=\"result\">\r\n          <el-radio-group v-model=\"completeForm.result\">\r\n            <el-radio label=\"success\">鎴愬姛</el-radio>\r\n            <el-radio label=\"failed\">澶辫触</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"鎵ц璇存槑\" prop=\"description\">\r\n          <el-input\r\n            v-model=\"completeForm.description\"\r\n            type=\"textarea\"\r\n            :rows=\"4\"\r\n            placeholder=\"璇疯緭鍏ユ墽琛岃鏄嶾"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"鍙戠幇闂\" prop=\"issues\">\r\n          <el-input\r\n            v-model=\"completeForm.issues\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"濡傛湁闂璇锋弿杩癨"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"澶勭悊鎺柦\" prop=\"actions\">\r\n          <el-input\r\n            v-model=\"completeForm.actions\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"閲囧彇鐨勫鐞嗘帾鏂絓"\r\n          />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <el-button @click=\"completeDialogVisible = false\">鍙栨秷</el-button>\r\n        <el-button type=\"primary\" @click=\"submitComplete\">纭畾</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport { maintenancePlanApi } from '@/api/maintenance/plan'\r\nimport { parseTime } from '@/utils'\r\n\r\n// 鐘舵€乗r\nconst loading = ref(false)\r\nconst executionList = ref([])\r\nconst total = ref(0)\r\nconst dateRange = ref([])\r\nconst completeDialogVisible = ref(false)\r\nconst currentExecution = ref(null)\r\n\r\n// 鏌ヨ鍙傛暟\r\nconst queryParams = reactive({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  planName: '',\r\n  executorName: '',\r\n  status: '',\r\n  startTime: '',\r\n  endTime: ''\r\n})\r\n\r\n// 瀹屾垚琛ㄥ崟\r\nconst completeFormRef = ref()\r\nconst completeForm = reactive({\r\n  result: 'success',\r\n  description: '',\r\n  issues: '',\r\n  actions: ''\r\n})\r\n\r\nconst completeRules = {\r\n  result: [{ required: true, message: '璇烽€夋嫨鎵ц缁撴灉', trigger: 'change' }],\r\n  description: [{ required: true, message: '璇疯緭鍏ユ墽琛岃鏄?, trigger: 'blur' }]\r\n}\r\n\r\n// 妯℃嫙鏁版嵁\r\nconst mockData = [\r\n  {\r\n    id: 1,\r\n    executionNo: 'EX202501001',\r\n    planName: '1妤兼殩閫氱郴缁熸湀搴︿繚鍏?,\r\n    executorName: '寮犱笁',\r\n    startTime: new Date('2025-01-15 09:00:00'),\r\n    endTime: new Date('2025-01-15 11:30:00'),\r\n    duration: 150, // 鍒嗛挓\r\n    status: 'completed',\r\n    result: 'success'\r\n  },\r\n  {\r\n    id: 2,\r\n    executionNo: 'EX202501002',\r\n    planName: '閰嶇數鏌滃搴︽淇?,\r\n    executorName: '鏉庡洓',\r\n    startTime: new Date('2025-01-16 14:00:00'),\r\n    endTime: null,\r\n    duration: 0,\r\n    status: 'executing',\r\n    result: null\r\n  }\r\n]\r\n\r\n// 鑾峰彇鍒楄〃\r\nconst getList = async () => {\r\n  loading.value = true\r\n  try {\r\n    // 妯℃嫙API璋冪敤\r\n    setTimeout(() => {\r\n      executionList.value = mockData\r\n      total.value = mockData.length\r\n      loading.value = false\r\n    }, 500)\r\n  } catch (error) {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 鎼滅储\r\nconst handleQuery = () => {\r\n  queryParams.pageNum = 1\r\n  getList()\r\n}\r\n\r\n// 閲嶇疆\r\nconst resetQuery = () => {\r\n  queryParams.planName = ''\r\n  queryParams.executorName = ''\r\n  queryParams.status = ''\r\n  queryParams.startTime = ''\r\n  queryParams.endTime = ''\r\n  dateRange.value = []\r\n  handleQuery()\r\n}\r\n\r\n// 鏃ユ湡鍙樻洿\r\nconst handleDateChange = (value) => {\r\n  if (value) {\r\n    queryParams.startTime = value[0]\r\n    queryParams.endTime = value[1]\r\n  } else {\r\n    queryParams.startTime = ''\r\n    queryParams.endTime = ''\r\n  }\r\n}\r\n\r\n// 鏌ョ湅璇︽儏\r\nconst handleDetail = (row) => {\r\n  ElMessage.info('鏌ョ湅鎵ц璇︽儏锛? + row.executionNo)\r\n}\r\n\r\n// 瀹屾垚鎵ц\r\nconst handleComplete = (row) => {\r\n  currentExecution.value = row\r\n  completeForm.result = 'success'\r\n  completeForm.description = ''\r\n  completeForm.issues = ''\r\n  completeForm.actions = ''\r\n  completeDialogVisible.value = true\r\n}\r\n\r\n// 鎻愪氦瀹屾垚\r\nconst submitComplete = async () => {\r\n  await completeFormRef.value?.validate()\r\n  \r\n  try {\r\n    // await maintenancePlanApi.completeExecution(currentExecution.value.id, completeForm)\r\n    ElMessage.success('鎵ц瀹屾垚')\r\n    completeDialogVisible.value = false\r\n    getList()\r\n  } catch (error) {\r\n    console.error('瀹屾垚鎵ц澶辫触:', error)\r\n  }\r\n}\r\n\r\n// 涓鎵ц\r\nconst handleAbort = async (row) => {\r\n  await ElMessageBox.confirm('纭畾涓姝ゆ鎵ц锛?, '璀﹀憡', { type: 'warning' })\r\n  \r\n  try {\r\n    // await maintenancePlanApi.abortExecution(row.id)\r\n    ElMessage.success('宸蹭腑姝㈡墽琛?)\r\n    getList()\r\n  } catch (error) {\r\n    console.error('涓澶辫触:', error)\r\n  }\r\n}\r\n\r\n// 瀵煎嚭\r\nconst handleExport = async () => {\r\n  await ElMessageBox.confirm('纭畾瀵煎嚭鎵ц璁板綍锛?, '纭', { type: 'info' })\r\n  \r\n  try {\r\n    // const res = await maintenancePlanApi.exportExecution(queryParams)\r\n    ElMessage.success('瀵煎嚭鎴愬姛')\r\n  } catch (error) {\r\n    console.error('瀵煎嚭澶辫触:', error)\r\n  }\r\n}\r\n\r\n// 鏍煎紡鍖栨椂闀縗r\nconst formatDuration = (minutes) => {\r\n  if (!minutes) return '-'\r\n  const hours = Math.floor(minutes / 60)\r\n  const mins = minutes % 60\r\n  return hours > 0 ? `${hours}灏忔椂${mins}鍒嗛挓` : `${mins}鍒嗛挓`\r\n}\r\n\r\n// 鐘舵€佹爣绛綷r\nconst getStatusLabel = (status) => {\r\n  const map = { executing: '鎵ц涓?, completed: '宸插畬鎴?, aborted: '宸蹭腑姝? }\r\n  return map[status] || status\r\n}\r\n\r\nconst getStatusType = (status) => {\r\n  const map = { executing: '', completed: 'success', aborted: 'danger' }\r\n  return map[status] || ''\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(() => {\r\n  getList()\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.maintenance-execution-list {\r\n  padding: 20px;\r\n  \r\n  .search-card {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .table-card {\r\n    .card-header {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n    }\r\n  }\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\form.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'reactive' is defined but never used. Allowed unused vars must match /^_/u.","line":228,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":228,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'getMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":233,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":233,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'exportMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":235,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":235,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鎼滅储鍖哄煙 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"璁″垝鍚嶇О\" prop=\"title\">\r\n        <el-input\r\n          v-model=\"queryParams.title\"\r\n          placeholder=\"璇疯緭鍏ヨ鍒掑悕绉癨"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"妤煎眰\" prop=\"floor\">\r\n        <el-select v-model=\"queryParams.floor\" placeholder=\"璇烽€夋嫨妤煎眰\" clearable>\r\n          <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"\" />\r\n          <el-option label=\"1妤糪" value=\"1\" />\r\n          <el-option label=\"2妤糪" value=\"2\" />\r\n          <el-option label=\"3妤糪" value=\"3\" />\r\n          <el-option label=\"4妤糪" value=\"4\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"MOP绫诲埆\" prop=\"mopCategory\">\r\n        <el-select v-model=\"queryParams.mopCategory\" placeholder=\"璇烽€夋嫨绫诲埆\" clearable>\r\n          <el-option label=\"鍏ㄩ儴\" value=\"\" />\r\n          <el-option label=\"鏃ュ父缁存姢\" value=\"daily\" />\r\n          <el-option label=\"瀹氭湡淇濆吇\" value=\"regular\" />\r\n          <el-option label=\"鏈堝害妫€淇甛" value=\"monthly\" />\r\n          <el-option label=\"瀛ｅ害妫€淇甛" value=\"quarterly\" />\r\n          <el-option label=\"骞村害妫€淇甛" value=\"annual\" />\r\n          <el-option label=\"搴旀€ョ淮淇甛" value=\"emergency\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"瀹℃牳鐘舵€乗" prop=\"approvalStatus\">\r\n        <el-select v-model=\"queryParams.approvalStatus\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option label=\"鍏ㄩ儴\" value=\"\" />\r\n          <el-option label=\"鑽夌\" value=\"draft\" />\r\n          <el-option label=\"寰呭鏍竆" value=\"pending\" />\r\n          <el-option label=\"宸叉壒鍑哱" value=\"approved\" />\r\n          <el-option label=\"宸叉嫆缁漒" value=\"rejected\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"鎵ц鐘舵€乗" prop=\"executionStatus\">\r\n        <el-select v-model=\"queryParams.executionStatus\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option label=\"鍏ㄩ儴\" value=\"\" />\r\n          <el-option label=\"寰呮墽琛孿" value=\"pending\" />\r\n          <el-option label=\"鎵ц涓璡" value=\"executing\" />\r\n          <el-option label=\"宸插畬鎴怽" value=\"completed\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"鏃堕棿鑼冨洿\" prop=\"dateRange\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          value-format=\"YYYY-MM-DD\"\r\n          type=\"daterange\"\r\n          range-separator=\"-\"\r\n          start-placeholder=\"寮€濮嬫棩鏈焅"\r\n          end-placeholder=\"缁撴潫鏃ユ湡\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 宸ュ叿鏍?-->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Plus\"\r\n          @click=\"handleAdd\"\r\n          v-hasPermi=\"['business:maintenance:add']\"\r\n        >鏂板缓缁翠繚璁″垝</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"info\"\r\n          plain\r\n          icon=\"CopyDocument\"\r\n          @click=\"handleCopyLast\"\r\n          v-hasPermi=\"['business:maintenance:add']\"\r\n        >澶嶅埗涓婃璁″垝</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"Download\"\r\n          @click=\"handleExport\"\r\n          v-hasPermi=\"['business:maintenance:export']\"\r\n        >瀵煎嚭</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table v-loading=\"loading\" :data=\"maintenanceList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"ID\" align=\"center\" prop=\"planId\" width=\"80\" />\r\n      <el-table-column label=\"鏍囬\" align=\"center\" prop=\"title\" min-width=\"200\" show-overflow-tooltip />\r\n      <el-table-column label=\"妤煎眰\" align=\"center\" prop=\"floor\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-tag>{{ scope.row.floor === 5 ? '鍏ㄩ儴' : scope.row.floor + '妤? }}</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鐗堟湰\" align=\"center\" prop=\"version\" width=\"80\" />\r\n      <el-table-column label=\"MOP绫诲埆\" align=\"center\" prop=\"mopCategory\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"mop_category\" :value=\"scope.row.mopCategory\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鍛ㄦ湡\" align=\"center\" prop=\"executionCycle\" width=\"100\" />\r\n      <el-table-column label=\"瀹℃牳鐘舵€乗" align=\"center\" prop=\"approvalStatus\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <el-tag \r\n            :type=\"getApprovalStatusType(scope.row.approvalStatus)\"\r\n            disable-transitions\r\n          >\r\n            {{ getApprovalStatusLabel(scope.row.approvalStatus) }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鐘舵€乗" align=\"center\" prop=\"executionStatus\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <el-tag \r\n            :type=\"getExecutionStatusType(scope.row.executionStatus)\"\r\n            disable-transitions\r\n          >\r\n            {{ getExecutionStatusLabel(scope.row.executionStatus) }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"瀹℃牳浜篭" align=\"center\" prop=\"approverName\" width=\"100\" />\r\n      <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          <span>{{ parseTime(scope.row.createTime) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"涓嬫鎵ц鏃堕棿\" align=\"center\" prop=\"nextExecutionTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          <span>{{ parseTime(scope.row.nextExecutionTime) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"240\" fixed=\"right\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"View\"\r\n            @click=\"handleView(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:query']\"\r\n          >璇︽儏</el-button>\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"Edit\"\r\n            @click=\"handleUpdate(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:edit']\"\r\n            v-if=\"scope.row.approvalStatus === 'draft'\"\r\n          >缂栬緫</el-button>\r\n          <el-button\r\n            link\r\n            type=\"success\"\r\n            icon=\"Check\"\r\n            @click=\"handleSubmitApproval(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:edit']\"\r\n            v-if=\"scope.row.approvalStatus === 'draft'\"\r\n          >鎻愪氦瀹℃牳</el-button>\r\n          <el-button\r\n            link\r\n            type=\"warning\"\r\n            icon=\"Document\"\r\n            @click=\"handleGenerateTicket(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:edit']\"\r\n            v-if=\"scope.row.approvalStatus === 'approved' && scope.row.executionStatus === 'pending'\"\r\n          >鐢熸垚宸ュ崟</el-button>\r\n          <el-button\r\n            link\r\n            type=\"danger\"\r\n            icon=\"Delete\"\r\n            @click=\"handleDelete(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:remove']\"\r\n            v-if=\"scope.row.approvalStatus === 'draft'\"\r\n          >鍒犻櫎</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total > 0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 鎻愪氦瀹℃牳瀵硅瘽妗?-->\r\n    <el-dialog v-model=\"approvalDialog\" title=\"鎻愪氦瀹℃牳\" width=\"500px\" append-to-body>\r\n      <el-form ref=\"approvalRef\" :model=\"approvalForm\" :rules=\"approvalRules\" label-width=\"80px\">\r\n        <el-form-item label=\"瀹℃牳浜篭" prop=\"approverId\">\r\n          <el-select v-model=\"approvalForm.approverId\" placeholder=\"璇烽€夋嫨瀹℃牳浜篭">\r\n            <el-option\r\n              v-for=\"item in approverList\"\r\n              :key=\"item.userId\"\r\n              :label=\"item.nickName\"\r\n              :value=\"item.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n          <el-input v-model=\"approvalForm.remark\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ娉╘" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"approvalDialog = false\">鍙栨秷</el-button>\r\n          <el-button type=\"primary\" @click=\"submitApproval\">纭畾</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"Maintenance\">\r\nimport { ref, reactive, onMounted, getCurrentInstance } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { parseTime } from '@/utils/ruoyi'\r\nimport { \r\n  listMaintenance,\r\n  getMaintenance,\r\n  delMaintenance,\r\n  exportMaintenance,\r\n  submitApproval as submitApprovalApi,\r\n  getApproverList,\r\n  copyLastPlan,\r\n  generateTicket\r\n} from '@/api/business/maintenance'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\n\r\n// 鏁版嵁瀹氫箟\r\nconst loading = ref(false)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst maintenanceList = ref([])\r\nconst dateRange = ref([])\r\nconst approvalDialog = ref(false)\r\nconst approverList = ref([])\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { mop_category } = proxy.useDict('mop_category')\r\n\r\n// 鏌ヨ鍙傛暟\r\nconst queryParams = ref({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  title: undefined,\r\n  floor: undefined,\r\n  mopCategory: undefined,\r\n  approvalStatus: undefined,\r\n  executionStatus: undefined\r\n})\r\n\r\n// 瀹℃牳琛ㄥ崟\r\nconst approvalForm = ref({\r\n  planId: undefined,\r\n  approverId: undefined,\r\n  remark: undefined\r\n})\r\n\r\n// 瀹℃牳琛ㄥ崟鏍￠獙瑙勫垯\r\nconst approvalRules = {\r\n  approverId: [\r\n    { required: true, message: \"璇烽€夋嫨瀹℃牳浜篭", trigger: \"change\" }\r\n  ]\r\n}\r\n\r\n// 鑾峰彇鍒楄〃\r\nfunction getList() {\r\n  loading.value = true\r\n  listMaintenance(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    maintenanceList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n// 鎼滅储\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n// 閲嶇疆鎼滅储\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n// 澶氶€夋閫変腑鏁版嵁\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.planId)\r\n  single.value = selection.length !== 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n// 鏂板\r\nfunction handleAdd() {\r\n  router.push('/business/maintenance/create')\r\n}\r\n\r\n// 澶嶅埗涓婃璁″垝\r\nfunction handleCopyLast() {\r\n  proxy.$modal.confirm('鏄惁澶嶅埗涓婃缁翠繚璁″垝锛?).then(() => {\r\n    // 鑾峰彇鏈€鏂扮殑璁″垝\r\n    listMaintenance({ pageNum: 1, pageSize: 1 }).then(response => {\r\n      if (response.rows && response.rows.length > 0) {\r\n        const lastPlan = response.rows[0]\r\n        copyLastPlan(lastPlan.planId).then(() => {\r\n          proxy.$modal.msgSuccess(\"澶嶅埗鎴愬姛\")\r\n          getList()\r\n        })\r\n      } else {\r\n        proxy.$modal.msgWarning(\"娌℃湁鍙鍒剁殑璁″垝\")\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\n// 鏌ョ湅璇︽儏\r\nfunction handleView(row) {\r\n  router.push('/business/maintenance/detail/' + row.planId)\r\n}\r\n\r\n// 淇敼\r\nfunction handleUpdate(row) {\r\n  router.push('/business/maintenance/edit/' + row.planId)\r\n}\r\n\r\n// 鎻愪氦瀹℃牳\r\nfunction handleSubmitApproval(row) {\r\n  approvalForm.value = {\r\n    planId: row.planId,\r\n    approverId: undefined,\r\n    remark: undefined\r\n  }\r\n  // 鑾峰彇瀹℃牳浜哄垪琛╘r\n  getApproverList().then(response => {\r\n    approverList.value = response.data\r\n    approvalDialog.value = true\r\n  })\r\n}\r\n\r\n// 纭鎻愪氦瀹℃牳\r\nfunction submitApproval() {\r\n  proxy.$refs[\"approvalRef\"].validate(valid => {\r\n    if (valid) {\r\n      submitApprovalApi(approvalForm.value.planId, approvalForm.value.approverId).then(() => {\r\n        proxy.$modal.msgSuccess(\"鎻愪氦瀹℃牳鎴愬姛\")\r\n        approvalDialog.value = false\r\n        getList()\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n// 鐢熸垚宸ュ崟\r\nfunction handleGenerateTicket(row) {\r\n  proxy.$modal.confirm('纭鐢熸垚宸ュ崟鍚楋紵').then(() => {\r\n    generateTicket(row.planId).then(() => {\r\n      proxy.$modal.msgSuccess(\"宸ュ崟鐢熸垚鎴愬姛\")\r\n      getList()\r\n    })\r\n  })\r\n}\r\n\r\n// 鍒犻櫎\r\nfunction handleDelete(row) {\r\n  const planIds = row.planId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎缁翠繚璁″垝缂栧彿涓篭"' + planIds + '\"鐨勬暟鎹」锛?).then(() => {\r\n    return delMaintenance(planIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  })\r\n}\r\n\r\n// 瀵煎嚭\r\nfunction handleExport() {\r\n  proxy.download('business/maintenance/export', {\r\n    ...queryParams.value\r\n  }, `maintenance_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n// 鑾峰彇瀹℃牳鐘舵€佺被鍨媆r\nfunction getApprovalStatusType(status) {\r\n  const statusMap = {\r\n    'draft': 'info',\r\n    'pending': 'warning',\r\n    'approved': 'success',\r\n    'rejected': 'danger'\r\n  }\r\n  return statusMap[status] || 'info'\r\n}\r\n\r\n// 鑾峰彇瀹℃牳鐘舵€佹爣绛綷r\nfunction getApprovalStatusLabel(status) {\r\n  const statusMap = {\r\n    'draft': '鑽夌',\r\n    'pending': '寰呭鏍?,\r\n    'approved': '宸叉壒鍑?,\r\n    'rejected': '宸叉嫆缁?\r\n  }\r\n  return statusMap[status] || status\r\n}\r\n\r\n// 鑾峰彇鎵ц鐘舵€佺被鍨媆r\nfunction getExecutionStatusType(status) {\r\n  const statusMap = {\r\n    'pending': 'warning',\r\n    'executing': 'primary',\r\n    'completed': 'success',\r\n    'cancelled': 'info'\r\n  }\r\n  return statusMap[status] || 'info'\r\n}\r\n\r\n// 鑾峰彇鎵ц鐘舵€佹爣绛綷r\nfunction getExecutionStatusLabel(status) {\r\n  const statusMap = {\r\n    'pending': '寰呮墽琛?,\r\n    'executing': '鎵ц涓?,\r\n    'completed': '宸插畬鎴?,\r\n    'cancelled': '宸插彇娑?\r\n  }\r\n  return statusMap[status] || status\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(() => {\r\n  getList()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.mb8 {\r\n  margin-bottom: 8px;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\plan\\detail.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\plan\\form.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getNotifyUserList' is defined but never used. Allowed unused vars must match /^_/u.","line":259,"column":93,"nodeType":"Identifier","messageId":"unusedVar","endLine":259,"endColumn":110},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":434,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":434,"endColumn":52},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":439,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":439,"endColumn":49}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-card>\r\n      <template #header>\r\n        <span>{{ title }}</span>\r\n        <el-button \r\n          v-if=\"!planId && !isCopy\"\r\n          link\r\n          type=\"primary\"\r\n          style=\"float: right\"\r\n          @click=\"handleCopyLast\"\r\n        >\r\n          澶嶅埗涓婃璁″垝\r\n        </el-button>\r\n      </template>\r\n\r\n      <el-form \r\n        ref=\"maintenanceRef\" \r\n        :model=\"form\" \r\n        :rules=\"rules\" \r\n        label-width=\"140px\"\r\n        :disabled=\"loading\"\r\n      >\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鏍囬\" prop=\"title\">\r\n              <el-input v-model=\"form.title\" placeholder=\"璇疯緭鍏ユ爣棰榎" maxlength=\"100\" show-word-limit />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <el-form-item label=\"妤煎眰缂栧彿\" prop=\"floor\">\r\n              <el-select v-model=\"form.floor\" placeholder=\"璇烽€夋嫨妤煎眰\">\r\n                <el-option label=\"1妤糪" value=\"1\" />\r\n                <el-option label=\"2妤糪" value=\"2\" />\r\n                <el-option label=\"3妤糪" value=\"3\" />\r\n                <el-option label=\"4妤糪" value=\"4\" />\r\n                <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"all\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <el-form-item label=\"鐗堟湰\" prop=\"version\">\r\n              <el-input v-model=\"form.version\" placeholder=\"濡傦細V1.0\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-divider content-position=\"left\">MOP淇℃伅</el-divider>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"MOP绫诲埆\" prop=\"mopCategory\">\r\n              <el-select v-model=\"form.mopCategory\" placeholder=\"璇烽€夋嫨\">\r\n                <el-option\r\n                  v-for=\"dict in mop_category\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"鎵ц鍛ㄦ湡\" prop=\"executionCycle\">\r\n              <el-input-number\r\n                v-model=\"form.executionFrequency\"\r\n                :min=\"1\"\r\n                :max=\"365\"\r\n                placeholder=\"棰戞\"\r\n                style=\"width: 100px\"\r\n              />\r\n              <el-select \r\n                v-model=\"form.executionUnit\" \r\n                placeholder=\"鍗曚綅\"\r\n                style=\"width: 100px; margin-left: 10px\"\r\n              >\r\n                <el-option label=\"娆?鏈圽" value=\"monthly\" />\r\n                <el-option label=\"娆?瀛" value=\"quarterly\" />\r\n                <el-option label=\"娆?骞碶" value=\"yearly\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"瀹℃牳浜篭" prop=\"approverId\">\r\n              <el-select v-model=\"form.approverId\" placeholder=\"璇烽€夋嫨瀹℃牳浜篭">\r\n                <el-option\r\n                  v-for=\"user in approverList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"MOP鍚嶇О\" prop=\"mopName\">\r\n              <el-input v-model=\"form.mopName\" placeholder=\"璇疯緭鍏OP鍚嶇О\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"閫氱煡鐩稿叧浜哄憳\" prop=\"notifyUsers\">\r\n              <el-select \r\n                v-model=\"form.notifyUsers\" \r\n                multiple \r\n                placeholder=\"璇烽€夋嫨閫氱煡浜哄憳\"\r\n              >\r\n                <el-option\r\n                  v-for=\"user in userList\"\r\n                  :key=\"user.userId\"\r\n                  :label=\"user.nickName\"\r\n                  :value=\"user.userId\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item label=\"MOP鐩殑\" prop=\"mopPurpose\">\r\n          <el-input\r\n            v-model=\"form.mopPurpose\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"璇疯鏄庣淮淇濈洰鐨刓"\r\n            maxlength=\"500\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n\r\n        <el-divider content-position=\"left\">鎵ц淇℃伅</el-divider>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸ュ叿浠〃\" prop=\"tools\">\r\n              <el-input\r\n                v-model=\"form.tools\"\r\n                type=\"textarea\"\r\n                :rows=\"2\"\r\n                placeholder=\"鍒椾妇鎵€闇€宸ュ叿\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鏉愭枡\" prop=\"materials\">\r\n              <el-input\r\n                v-model=\"form.materials\"\r\n                type=\"textarea\"\r\n                :rows=\"2\"\r\n                placeholder=\"鍒椾妇鎵€闇€鏉愭枡\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"瀹夊叏锛圥PE锛塡" prop=\"safety\">\r\n              <el-input\r\n                v-model=\"form.safety\"\r\n                type=\"textarea\"\r\n                :rows=\"2\"\r\n                placeholder=\"涓汉闃叉姢瑁呭瑕佹眰\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鐗规畩宸ュ叿\" prop=\"specialTools\">\r\n              <el-input\r\n                v-model=\"form.specialTools\"\r\n                type=\"textarea\"\r\n                :rows=\"2\"\r\n                placeholder=\"鎵€闇€閰嶄欢\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item label=\"鎵ц姝ラ\" prop=\"steps\">\r\n          <editor v-model=\"form.steps\" :min-height=\"192\"/>\r\n        </el-form-item>\r\n\r\n        <!-- 鍒涘缓琛ㄦ牸鍔熻兘 -->\r\n        <el-form-item label=\"鍒涘缓琛ㄦ牸\">\r\n          <el-row :gutter=\"10\">\r\n            <el-col :span=\"4\">\r\n              <el-input-number v-model=\"tableRows\" :min=\"1\" :max=\"20\" placeholder=\"琛屾暟\" />\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n              <el-input-number v-model=\"tableCols\" :min=\"1\" :max=\"10\" placeholder=\"鍒楁暟\" />\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n              <el-button type=\"primary\" @click=\"generateTable\">鐢熸垚琛ㄦ牸</el-button>\r\n            </el-col>\r\n          </el-row>\r\n          <div v-if=\"tableData.length > 0\" class=\"table-editor\">\r\n            <el-table :data=\"tableData\" border style=\"margin-top: 10px\">\r\n              <el-table-column\r\n                v-for=\"(col, index) in tableCols\"\r\n                :key=\"index\"\r\n                :prop=\"`col${index}`\"\r\n                :label=\"`鍒?{index + 1}`\"\r\n              >\r\n                <template #default=\"scope\">\r\n                  <el-input v-model=\"scope.row[`col${index}`]\" />\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n          </div>\r\n        </el-form-item>\r\n\r\n        <el-row :gutter=\"20\">\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸℃缁撴灉\" prop=\"inspectionResult\">\r\n              <el-input\r\n                v-model=\"form.inspectionResult\"\r\n                type=\"textarea\"\r\n                :rows=\"3\"\r\n                placeholder=\"宸℃缁撴灉璁板綍\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n              <el-input\r\n                v-model=\"form.remark\"\r\n                type=\"textarea\"\r\n                :rows=\"3\"\r\n                placeholder=\"澶囨敞淇℃伅\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <el-form-item label=\"鎵ц瀹℃牳浜篭" prop=\"executorId\">\r\n          <el-select v-model=\"form.executorId\" placeholder=\"璇烽€夋嫨鎵ц瀹℃牳浜篭">\r\n            <el-option\r\n              v-for=\"user in approverList\"\r\n              :key=\"user.userId\"\r\n              :label=\"user.nickName\"\r\n              :value=\"user.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"loading\">\r\n            纭?瀹歕r\n          </el-button>\r\n          <el-button @click=\"handleCancel\">鍙?娑?/el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"MaintenanceForm\">\r\nimport { getMaintenance, addMaintenance, updateMaintenance, getLatestPlan, getApproverList, getNotifyUserList } from \"@/api/business/maintenance\";\r\nimport { listUser } from \"@/api/system/user\";\r\nimport Editor from '@/components/Editor';\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst router = useRouter();\r\nconst route = useRoute();\r\n\r\n// 鑾峰彇璁″垝ID锛堢紪杈戞ā寮忥級\r\nconst planId = route.params && route.params.id;\r\nconst copyId = route.query && route.query.copy;\r\n\r\nconst loading = ref(false);\r\nconst isCopy = ref(false);\r\nconst userList = ref([]);\r\nconst approverList = ref([]);\r\nconst tableRows = ref(6);\r\nconst tableCols = ref(7);\r\nconst tableData = ref([]);\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { mop_category } = proxy.useDict('mop_category');\r\n\r\n// 椤甸潰鏍囬\r\nconst title = computed(() => {\r\n  if (planId) return \"淇敼缁翠繚璁″垝\";\r\n  if (isCopy.value) return \"澶嶅埗缁翠繚璁″垝\";\r\n  return \"鏂板缓缁翠繚璁″垝\";\r\n});\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({\r\n  planId: undefined,\r\n  title: '',\r\n  floor: '',\r\n  version: 'V1.0',\r\n  mopCategory: '',\r\n  executionFrequency: 1,\r\n  executionUnit: 'monthly',\r\n  executionCycle: '',\r\n  approverId: undefined,\r\n  mopName: '',\r\n  mopPurpose: '',\r\n  notifyUsers: [],\r\n  tools: '',\r\n  materials: '',\r\n  safety: '',\r\n  specialTools: '',\r\n  steps: '',\r\n  inspectionResult: '',\r\n  remark: '',\r\n  executorId: undefined,\r\n  approvalStatus: 'draft',\r\n  executionStatus: 'pending'\r\n});\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst rules = {\r\n  title: [\r\n    { required: true, message: '璇疯緭鍏ユ爣棰?, trigger: 'blur' },\r\n    { min: 5, max: 100, message: '鏍囬闀垮害鍦?5 鍒?100 涓瓧绗?, trigger: 'blur' }\r\n  ],\r\n  floor: [\r\n    { required: true, message: '璇烽€夋嫨妤煎眰', trigger: 'change' }\r\n  ],\r\n  version: [\r\n    { required: true, message: '璇疯緭鍏ョ増鏈彿', trigger: 'blur' },\r\n    { pattern: /^V\\d+\\.\\d+(\\.\\d+)?$/, message: '鐗堟湰鍙锋牸寮忓簲涓?V1.0 鎴?V1.0.1', trigger: 'blur' }\r\n  ],\r\n  mopCategory: [\r\n    { required: true, message: '璇烽€夋嫨MOP绫诲埆', trigger: 'change' }\r\n  ],\r\n  approverId: [\r\n    { required: true, message: '璇烽€夋嫨瀹℃牳浜?, trigger: 'change' }\r\n  ],\r\n  mopName: [\r\n    { required: true, message: '璇疯緭鍏OP鍚嶇О', trigger: 'blur' }\r\n  ],\r\n  mopPurpose: [\r\n    { required: true, message: '璇疯鏄嶮OP鐩殑', trigger: 'blur' }\r\n  ],\r\n  steps: [\r\n    { required: true, message: '璇疯緭鍏ユ墽琛屾楠?, trigger: 'blur' }\r\n  ]\r\n};\r\n\r\n/** 鑾峰彇璁″垝璇︽儏 */\r\nfunction getPlanDetail(id) {\r\n  loading.value = true;\r\n  getMaintenance(id).then(response => {\r\n    form.value = response.data;\r\n    // 澶勭悊鎵ц鍛ㄦ湡\r\n    if (form.value.executionCycle) {\r\n      const match = form.value.executionCycle.match(/(\\d+)(.+)/);\r\n      if (match) {\r\n        form.value.executionFrequency = parseInt(match[1]);\r\n        form.value.executionUnit = match[2];\r\n      }\r\n    }\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 澶嶅埗璁″垝 */\r\nfunction copyPlan(id) {\r\n  loading.value = true;\r\n  getMaintenance(id).then(response => {\r\n    const data = response.data;\r\n    delete data.planId;\r\n    form.value = {\r\n      ...data,\r\n      title: data.title + '(澶嶅埗)',\r\n      version: incrementVersion(data.version),\r\n      approvalStatus: 'draft',\r\n      executionStatus: 'pending',\r\n      remark: `[澶嶅埗鑷鍒?${id}锛屽鍒舵椂闂达細${proxy.parseTime(new Date())}]\\n${data.remark || ''}`\r\n    };\r\n    isCopy.value = true;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 澶嶅埗涓婃璁″垝 */\r\nfunction handleCopyLast() {\r\n  getLatestPlan().then(response => {\r\n    if (!response.data) {\r\n      proxy.$modal.msgWarning('娌℃湁鍙鍒剁殑璁″垝');\r\n      return;\r\n    }\r\n    \r\n    proxy.$modal.confirm(`鏄惁澶嶅埗璁″垝\"${response.data.title}\"锛焋).then(() => {\r\n      copyPlan(response.data.planId);\r\n      proxy.$modal.msgSuccess('宸插鍒朵笂娆¤鍒?);\r\n    }).catch(() => {});\r\n  });\r\n}\r\n\r\n/** 鐗堟湰鍙烽€掑 */\r\nfunction incrementVersion(version) {\r\n  const match = version.match(/^V(\\d+)\\.(\\d+)(?:\\.(\\d+))?$/);\r\n  if (match) {\r\n    const major = parseInt(match[1]);\r\n    const minor = parseInt(match[2]);\r\n    const patch = match[3] ? parseInt(match[3]) + 1 : 1;\r\n    return `V${major}.${minor}.${patch}`;\r\n  }\r\n  return 'V1.1';\r\n}\r\n\r\n/** 鐢熸垚琛ㄦ牸 */\r\nfunction generateTable() {\r\n  tableData.value = [];\r\n  for (let i = 0; i < tableRows.value; i++) {\r\n    const row = {};\r\n    for (let j = 0; j < tableCols.value; j++) {\r\n      row[`col${j}`] = '';\r\n    }\r\n    tableData.value.push(row);\r\n  }\r\n  proxy.$modal.msgSuccess('琛ㄦ牸宸茬敓鎴?);\r\n}\r\n\r\n/** 鎻愪氦琛ㄥ崟 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"maintenanceRef\"].validate(valid => {\r\n    if (valid) {\r\n      // 缁勫悎鎵ц鍛ㄦ湡\r\n      form.value.executionCycle = `${form.value.executionFrequency}${form.value.executionUnit}`;\r\n      \r\n      // 澶勭悊琛ㄦ牸鏁版嵁\r\n      if (tableData.value.length > 0) {\r\n        form.value.steps += '\\n' + JSON.stringify(tableData.value);\r\n      }\r\n      \r\n      if (form.value.planId != undefined) {\r\n        updateMaintenance(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\");\r\n          router.push('/business/maintenance/plan');\r\n        });\r\n      } else {\r\n        addMaintenance(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\");\r\n          router.push('/business/maintenance/plan');\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n/** 鍙栨秷 */\r\nfunction handleCancel() {\r\n  proxy.$modal.confirm('纭畾瑕佸彇娑堝悧锛熸湭淇濆瓨鐨勬暟鎹皢涓㈠け').then(() => {\r\n    router.push('/business/maintenance/plan');\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍒楄〃 */\r\nfunction getUserList() {\r\n  listUser({ status: '0' }).then(response => {\r\n    userList.value = response.rows;\r\n  });\r\n}\r\n\r\n/** 鑾峰彇瀹℃牳浜哄垪琛?*/\r\nfunction getApproversList() {\r\n  getApproverList().then(response => {\r\n    approverList.value = response.rows;\r\n  });\r\n}\r\n\r\n/** 鍒濆鍖?*/\r\nonMounted(() => {\r\n  getUserList();\r\n  getApproversList();\r\n  \r\n  if (planId) {\r\n    getPlanDetail(planId);\r\n  } else if (copyId) {\r\n    copyPlan(copyId);\r\n  }\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.table-editor {\r\n  margin-top: 20px;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\plan\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":287,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":287,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'addMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":287,"column":59,"nodeType":"Identifier","messageId":"unusedVar","endLine":287,"endColumn":73},{"ruleId":"no-unused-vars","severity":1,"message":"'updateMaintenance' is defined but never used. Allowed unused vars must match /^_/u.","line":287,"column":75,"nodeType":"Identifier","messageId":"unusedVar","endLine":287,"endColumn":92},{"ruleId":"no-unused-vars","severity":1,"message":"'getLatestPlan' is defined but never used. Allowed unused vars must match /^_/u.","line":288,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":288,"endColumn":37},{"ruleId":"no-unused-vars","severity":1,"message":"'open' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":297,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":297,"endColumn":11},{"ruleId":"no-unused-vars","severity":1,"message":"'title' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":306,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":306,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'form' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":337,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":337,"endColumn":26},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":453,"column":81,"nodeType":"Identifier","messageId":"unusedVar","endLine":453,"endColumn":89},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":475,"column":79,"nodeType":"Identifier","messageId":"unusedVar","endLine":475,"endColumn":87},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":481,"column":78,"nodeType":"Identifier","messageId":"unusedVar","endLine":481,"endColumn":86}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鎼滅储琛ㄥ崟 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"鏍囬\" prop=\"title\">\r\n        <el-input\r\n          v-model=\"queryParams.title\"\r\n          placeholder=\"璇疯緭鍏ヨ鍒掓爣棰榎"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"妤煎眰\" prop=\"floor\">\r\n        <el-select v-model=\"queryParams.floor\" placeholder=\"璇烽€夋嫨妤煎眰\" clearable>\r\n          <el-option label=\"1妤糪" value=\"1\" />\r\n          <el-option label=\"2妤糪" value=\"2\" />\r\n          <el-option label=\"3妤糪" value=\"3\" />\r\n          <el-option label=\"4妤糪" value=\"4\" />\r\n          <el-option label=\"鍏ㄩ儴妤煎眰\" value=\"all\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"MOP绫诲埆\" prop=\"mopCategory\">\r\n        <el-select v-model=\"queryParams.mopCategory\" placeholder=\"璇烽€夋嫨绫诲埆\" clearable>\r\n          <el-option\r\n            v-for=\"dict in mop_category\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"瀹℃牳鐘舵€乗" prop=\"approvalStatus\">\r\n        <el-select v-model=\"queryParams.approvalStatus\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option\r\n            v-for=\"dict in approval_status\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"鎵ц鐘舵€乗" prop=\"executionStatus\">\r\n        <el-select v-model=\"queryParams.executionStatus\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option\r\n            v-for=\"dict in execution_status\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"璁″垝鏃堕棿\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          type=\"daterange\"\r\n          range-separator=\"鑷砛"\r\n          start-placeholder=\"寮€濮嬫棩鏈焅"\r\n          end-placeholder=\"缁撴潫鏃ユ湡\"\r\n          value-format=\"YYYY-MM-DD\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 鎿嶄綔宸ュ叿鏍?-->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Plus\"\r\n          @click=\"handleAdd\"\r\n          v-hasPermi=\"['business:maintenance:add']\"\r\n        >鏂板缓璁″垝</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"DocumentCopy\"\r\n          @click=\"handleCopyLast\"\r\n          v-hasPermi=\"['business:maintenance:add']\"\r\n        >澶嶅埗涓婃</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"Edit\"\r\n          :disabled=\"single\"\r\n          @click=\"handleUpdate\"\r\n          v-hasPermi=\"['business:maintenance:edit']\"\r\n        >淇敼</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"danger\"\r\n          plain\r\n          icon=\"Delete\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleDelete\"\r\n          v-hasPermi=\"['business:maintenance:remove']\"\r\n        >鍒犻櫎</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"warning\"\r\n          plain\r\n          icon=\"Download\"\r\n          @click=\"handleExport\"\r\n          v-hasPermi=\"['business:maintenance:export']\"\r\n        >瀵煎嚭</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"info\"\r\n          plain\r\n          icon=\"Calendar\"\r\n          @click=\"handleCalendar\"\r\n        >鏃ュ巻瑙嗗浘</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table v-loading=\"loading\" :data=\"maintenanceList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"璁″垝缂栧彿\" align=\"center\" prop=\"planNo\" width=\"120\" />\r\n      <el-table-column label=\"鏍囬\" align=\"left\" prop=\"title\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"妤煎眰\" align=\"center\" prop=\"floor\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-tag>{{ getFloorLabel(scope.row.floor) }}</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鐗堟湰\" align=\"center\" prop=\"version\" width=\"80\" />\r\n      <el-table-column label=\"MOP绫诲埆\" align=\"center\" prop=\"mopCategory\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"mop_category\" :value=\"scope.row.mopCategory\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鍛ㄦ湡\" align=\"center\" prop=\"executionCycle\" width=\"100\" />\r\n      <el-table-column label=\"瀹℃牳鐘舵€乗" align=\"center\" prop=\"approvalStatus\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"approval_status\" :value=\"scope.row.approvalStatus\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎵ц鐘舵€乗" align=\"center\" prop=\"executionStatus\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"execution_status\" :value=\"scope.row.executionStatus\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"瀹℃牳浜篭" align=\"center\" prop=\"approverName\" width=\"100\" />\r\n      <el-table-column label=\"涓嬫鎵ц\" align=\"center\" prop=\"nextExecutionTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          <span v-if=\"scope.row.nextExecutionTime\">\r\n            {{ parseTime(scope.row.nextExecutionTime, '{y}-{m}-{d} {h}:{i}') }}\r\n            <el-tag v-if=\"isUpcoming(scope.row.nextExecutionTime)\" type=\"warning\" size=\"small\">鍗冲皢鍒版湡</el-tag>\r\n          </span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          {{ parseTime(scope.row.createTime) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"240\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"View\"\r\n            @click=\"handleView(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:query']\"\r\n          >鏌ョ湅</el-button>\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"Edit\"\r\n            @click=\"handleUpdate(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:edit']\"\r\n            v-if=\"scope.row.approvalStatus !== 'approved'\"\r\n          >淇敼</el-button>\r\n          <el-button\r\n            link\r\n            type=\"success\"\r\n            icon=\"DocumentCopy\"\r\n            @click=\"handleCopy(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:add']\"\r\n          >澶嶅埗</el-button>\r\n          <el-button\r\n            link\r\n            type=\"warning\"\r\n            icon=\"Promotion\"\r\n            @click=\"handleSubmit(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:edit']\"\r\n            v-if=\"scope.row.approvalStatus === 'draft'\"\r\n          >鎻愪氦</el-button>\r\n          <el-button\r\n            link\r\n            type=\"success\"\r\n            icon=\"Select\"\r\n            @click=\"handleApprove(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:approve']\"\r\n            v-if=\"scope.row.approvalStatus === 'pending' && canApprove\"\r\n          >瀹℃牳</el-button>\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"VideoPlay\"\r\n            @click=\"handleExecute(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:execute']\"\r\n            v-if=\"scope.row.approvalStatus === 'approved' && scope.row.executionStatus === 'pending'\"\r\n          >鎵ц</el-button>\r\n          <el-button\r\n            link\r\n            type=\"warning\"\r\n            icon=\"Tickets\"\r\n            @click=\"handleGenerateTicket(scope.row)\"\r\n            v-hasPermi=\"['business:maintenance:ticket']\"\r\n            v-if=\"scope.row.approvalStatus === 'approved'\"\r\n          >鐢熸垚宸ュ崟</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    \r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total>0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 鎻愪氦瀹℃牳瀵硅瘽妗?-->\r\n    <el-dialog title=\"鎻愪氦瀹℃牳\" v-model=\"submitOpen\" width=\"500px\" append-to-body>\r\n      <el-form ref=\"submitRef\" :model=\"submitForm\" :rules=\"submitRules\" label-width=\"80px\">\r\n        <el-form-item label=\"瀹℃牳浜篭" prop=\"approverId\">\r\n          <el-select v-model=\"submitForm.approverId\" placeholder=\"璇烽€夋嫨瀹℃牳浜篭">\r\n            <el-option\r\n              v-for=\"user in approverList\"\r\n              :key=\"user.userId\"\r\n              :label=\"user.nickName\"\r\n              :value=\"user.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n          <el-input v-model=\"submitForm.remark\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ娉╘"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitForApproval\">纭?瀹?/el-button>\r\n          <el-button @click=\"submitOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 瀹℃牳瀵硅瘽妗?-->\r\n    <el-dialog title=\"瀹℃牳缁翠繚璁″垝\" v-model=\"approveOpen\" width=\"500px\" append-to-body>\r\n      <el-form ref=\"approveRef\" :model=\"approveForm\" :rules=\"approveRules\" label-width=\"80px\">\r\n        <el-form-item label=\"瀹℃牳缁撴灉\" prop=\"result\">\r\n          <el-radio-group v-model=\"approveForm.result\">\r\n            <el-radio label=\"approved\">閫氳繃</el-radio>\r\n            <el-radio label=\"rejected\">鎷掔粷</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"瀹℃牳鎰忚\" prop=\"comment\">\r\n          <el-input v-model=\"approveForm.comment\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ鏍告剰瑙乗"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitApprovalResult\">纭?瀹?/el-button>\r\n          <el-button @click=\"approveOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"MaintenancePlan\">\r\nimport { listMaintenance, getMaintenance, delMaintenance, addMaintenance, updateMaintenance, \r\n         copyLastPlan, getLatestPlan, submitApproval, approvePlan, rejectPlan, \r\n         generateTicket, startExecution, getApproverList } from \"@/api/business/maintenance\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst router = useRouter();\r\n\r\nconst maintenanceList = ref([]);\r\n// 鐢ㄤ簬缂撳瓨璁″垝鍒楄〃鐨勫紩鐢紝渚涘鍒舵渶鍚庝竴娆¤鍒掔瓑鎿嶄綔\r\nconst planList = ref([]);\r\nconst open = ref(false);\r\nconst submitOpen = ref(false);\r\nconst approveOpen = ref(false);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst title = ref(\"\");\r\nconst dateRange = ref([]);\r\nconst approverList = ref([]);\r\nconst canApprove = ref(false);\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { mop_category, approval_status, execution_status } = proxy.useDict('mop_category', 'approval_status', 'execution_status');\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    title: undefined,\r\n    floor: undefined,\r\n    mopCategory: undefined,\r\n    approvalStatus: undefined,\r\n    executionStatus: undefined\r\n  },\r\n  submitForm: {\r\n    planId: undefined,\r\n    approverId: undefined,\r\n    remark: ''\r\n  },\r\n  approveForm: {\r\n    planId: undefined,\r\n    result: 'approved',\r\n    comment: ''\r\n  }\r\n});\r\n\r\nconst { queryParams, form, submitForm, approveForm } = toRefs(data);\r\n\r\n// 琛ㄥ崟楠岃瘉\r\nconst submitRules = {\r\n  approverId: [{ required: true, message: \"璇烽€夋嫨瀹℃牳浜篭", trigger: \"change\" }]\r\n};\r\nconst approveRules = {\r\n  result: [{ required: true, message: \"璇烽€夋嫨瀹℃牳缁撴灉\", trigger: \"change\" }],\r\n  comment: [{ required: true, message: \"璇疯緭鍏ュ鏍告剰瑙乗", trigger: \"blur\" }]\r\n};\r\n\r\n/** 鏌ヨ缁翠繚璁″垝鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  let params = proxy.addDateRange(queryParams.value, dateRange.value);\r\n  listMaintenance(params).then(response => {\r\n    maintenanceList.value = response.rows;\r\n  planList.value = [...response.rows];\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 鑾峰彇妤煎眰鏍囩 */\r\nfunction getFloorLabel(floor) {\r\n  const labels = {\r\n    '1': '1妤?,\r\n    '2': '2妤?,\r\n    '3': '3妤?,\r\n    '4': '4妤?,\r\n    'all': '鍏ㄩ儴妤煎眰'\r\n  };\r\n  return labels[floor] || floor;\r\n}\r\n\r\n/** 鍒ゆ柇鏄惁鍗冲皢鍒版湡 */\r\nfunction isUpcoming(time) {\r\n  if (!time) return false;\r\n  const now = new Date();\r\n  const target = new Date(time);\r\n  const diff = target - now;\r\n  return diff > 0 && diff < 48 * 60 * 60 * 1000; // 48灏忔椂鍐匼r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = [];\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.planId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  router.push('/business/maintenance/plan/form');\r\n}\r\n\r\n/** 澶嶅埗涓婃璁″垝 */\r\nfunction handleCopyLast() {\r\n  // 鏌ユ壘鏈€鍚庝竴娆＄殑璁″垝\r\n  if (planList.value.length > 0) {\r\n    const lastPlan = planList.value.sort((a, b) => new Date(b.createTime) - new Date(a.createTime))[0];\r\n    router.push('/business/maintenance/plan/form?copy=' + lastPlan.planId);\r\n  } else {\r\n    proxy.$modal.msgWarning(\"鏆傛棤鍙鍒剁殑缁翠繚璁″垝\");\r\n  }\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  const planId = row.planId || ids.value[0];\r\n  router.push('/business/maintenance/plan/form/' + planId);\r\n}\r\n\r\n/** 鏌ョ湅璇︽儏 */\r\nfunction handleView(row) {\r\n  router.push('/business/maintenance/plan/detail/' + row.planId);\r\n}\r\n\r\n/** 澶嶅埗璁″垝 */\r\nfunction handleCopy(row) {\r\n  proxy.$modal.confirm('鏄惁澶嶅埗璇ョ淮淇濊鍒掞紵').then(() => {\r\n    return copyLastPlan(row.planId);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"澶嶅埗鎴愬姛\");\r\n    getList();\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鎻愪氦瀹℃牳 */\r\nfunction handleSubmit(row) {\r\n  getApproverList().then(response => {\r\n    approverList.value = response.rows;\r\n    submitForm.value.planId = row.planId;\r\n    submitForm.value.approverId = undefined;\r\n    submitForm.value.remark = '';\r\n    submitOpen.value = true;\r\n  });\r\n}\r\n\r\n/** 纭鎻愪氦瀹℃牳 */\r\nfunction submitForApproval() {\r\n  proxy.$refs[\"submitRef\"].validate(valid => {\r\n    if (valid) {\r\n      submitApproval(submitForm.value.planId, submitForm.value.approverId).then(response => {\r\n        proxy.$modal.msgSuccess(\"鎻愪氦鎴愬姛\");\r\n        submitOpen.value = false;\r\n        getList();\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n/** 瀹℃牳鎿嶄綔 */\r\nfunction handleApprove(row) {\r\n  approveForm.value.planId = row.planId;\r\n  approveForm.value.result = 'approved';\r\n  approveForm.value.comment = '';\r\n  approveOpen.value = true;\r\n}\r\n\r\n/** 鎻愪氦瀹℃牳缁撴灉 */\r\nfunction submitApprovalResult() {\r\n  proxy.$refs[\"approveRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (approveForm.value.result === 'approved') {\r\n        approvePlan(approveForm.value.planId, approveForm.value.comment).then(response => {\r\n          proxy.$modal.msgSuccess(\"瀹℃牳閫氳繃\");\r\n          approveOpen.value = false;\r\n          getList();\r\n        });\r\n      } else {\r\n        rejectPlan(approveForm.value.planId, approveForm.value.comment).then(response => {\r\n          proxy.$modal.msgSuccess(\"瀹℃牳鎷掔粷\");\r\n          approveOpen.value = false;\r\n          getList();\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n/** 鎵ц璁″垝 */\r\nfunction handleExecute(row) {\r\n  proxy.$modal.confirm('纭寮€濮嬫墽琛岃缁翠繚璁″垝鍚楋紵').then(() => {\r\n    return startExecution(row.planId);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"宸插紑濮嬫墽琛孿");\r\n    getList();\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鐢熸垚宸ュ崟 */\r\nfunction handleGenerateTicket(row) {\r\n  proxy.$modal.confirm('纭鐢熸垚缁翠繚宸ュ崟鍚楋紵').then(() => {\r\n    return generateTicket(row.planId);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"宸ュ崟鐢熸垚鎴愬姛\");\r\n    getList();\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const planIds = row.planId || ids.value;\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎缁翠繚璁″垝缂栧彿涓篭"' + planIds + '\"鐨勬暟鎹」锛?).then(function() {\r\n    return delMaintenance(planIds);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\");\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download('business/maintenance/export', {\r\n    ...queryParams.value\r\n  }, `maintenance_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/** 鏃ュ巻瑙嗗浘 */\r\nfunction handleCalendar() {\r\n  router.push('/business/maintenance/calendar');\r\n}\r\n\r\n// 鍒濆鍖朶r\nonMounted(() => {\r\n  getList();\r\n  // 妫€鏌ユ槸鍚︽湁瀹℃牳鏉冮檺\r\n  canApprove.value = proxy.$auth.hasPermi('business:maintenance:approve');\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\maintenance\\plan\\submit.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":77,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":77,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<!-- src/views/maintenance/plan/submit.vue -->\r\n<template>\r\n  <div class=\"maintenance-plan-submit\">\r\n    <el-card>\r\n      <template #header>\r\n        鎻愪氦缁翠繚璁″垝瀹℃牳\r\n      </template>\r\n\r\n      <el-form ref=\"formRef\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\r\n        <el-form-item label=\"璁″垝鍚嶇О\">\r\n          {{ plan.title }}\r\n        </el-form-item>\r\n        <el-form-item label=\"瀹℃牳浜篭" prop=\"approverId\">\r\n          <el-select v-model=\"form.approverId\" placeholder=\"璇烽€夋嫨瀹℃牳浜篭">\r\n            <el-option\r\n              v-for=\"user in approverList\"\r\n              :key=\"user.id\"\r\n              :label=\"user.name\"\r\n              :value=\"user.id\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"鎻愪氦璇存槑\" prop=\"comment\">\r\n          <el-input\r\n            v-model=\"form.comment\"\r\n            type=\"textarea\"\r\n            :rows=\"4\"\r\n            placeholder=\"璇疯緭鍏ユ彁浜よ鏄嶾"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleSubmit\" :loading=\"loading\">\r\n            鎻愪氦瀹℃牳\r\n          </el-button>\r\n          <el-button @click=\"handleCancel\">鍙栨秷</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { ElMessage } from 'element-plus'\r\nimport { maintenancePlanApi } from '@/api/maintenance/plan'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\nconst loading = ref(false)\r\nconst plan = ref({})\r\nconst formRef = ref()\r\n\r\nconst form = reactive({\r\n  approverId: null,\r\n  comment: ''\r\n})\r\n\r\nconst rules = {\r\n  approverId: [\r\n    { required: true, message: '璇烽€夋嫨瀹℃牳浜?, trigger: 'change' }\r\n  ]\r\n}\r\n\r\n// 妯℃嫙绠＄悊鍛樺垪琛╘r\nconst approverList = ref([\r\n  { id: 1, name: '绠＄悊鍛?' },\r\n  { id: 2, name: '绠＄悊鍛?' }\r\n])\r\n\r\n// 鍔犺浇璁″垝淇℃伅\r\nconst loadPlan = async () => {\r\n  try {\r\n    const res = await maintenancePlanApi.get(route.params.id)\r\n    plan.value = res.data\r\n  } catch (error) {\r\n    ElMessage.error('鍔犺浇璁″垝淇℃伅澶辫触')\r\n    router.back()\r\n  }\r\n}\r\n\r\n// 鎻愪氦瀹℃牳\r\nconst handleSubmit = async () => {\r\n  await formRef.value?.validate()\r\n  \r\n  loading.value = true\r\n  try {\r\n    await maintenancePlanApi.submitApproval(route.params.id, form.approverId)\r\n    ElMessage.success('鎻愪氦瀹℃牳鎴愬姛')\r\n    router.push('/maintenance/plan')\r\n  } catch (error) {\r\n    console.error('鎻愪氦澶辫触:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 鍙栨秷\r\nconst handleCancel = () => {\r\n  router.back()\r\n}\r\n\r\nonMounted(() => {\r\n  loadPlan()\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.maintenance-plan-submit {\r\n  padding: 20px;\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\ticket\\components\\AssignDialog.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'onMounted' is defined but never used. Allowed unused vars must match /^_/u.","line":79,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":79,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<!-- src/views/ticket/components/AssignDialog.vue -->\r\n<template>\r\n  <el-dialog \r\n    v-model=\"dialogVisible\" \r\n    title=\"宸ュ崟鎸囨淳\" \r\n    width=\"500px\"\r\n    append-to-body\r\n  >\r\n    <div v-if=\"ticketIds.length > 0\" class=\"ticket-info\">\r\n      <el-alert \r\n        :title=\"`鎮ㄦ鍦ㄦ寚娲?${ticketIds.length} 涓伐鍗昤\" \r\n        type=\"info\" \r\n        :closable=\"false\"\r\n      />\r\n    </div>\r\n\r\n    <el-form ref=\"formRef\" :model=\"form\" :rules=\"rules\" label-width=\"100px\" style=\"margin-top: 20px\">\r\n      <el-form-item label=\"鎸囨淳缁橽" prop=\"assigneeId\">\r\n        <el-select \r\n          v-model=\"form.assigneeId\" \r\n          placeholder=\"璇烽€夋嫨宸ョ▼甯圽"\r\n          filterable\r\n        >\r\n          <el-option\r\n            v-for=\"user in engineerList\"\r\n            :key=\"user.id\"\r\n            :label=\"`${user.name} (${user.role})`\"\r\n            :value=\"user.id\"\r\n          >\r\n            <span style=\"float: left\">{{ user.name }}</span>\r\n            <span style=\"float: right; color: #8492a6; font-size: 13px\">\r\n              {{ user.workload || 0 }} 涓緟澶勭悊\r\n            </span>\r\n          </el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"浼樺厛绾" prop=\"priority\">\r\n        <el-radio-group v-model=\"form.priority\">\r\n          <el-radio label=\"high\">楂樹紭鍏堢骇</el-radio>\r\n          <el-radio label=\"medium\">涓紭鍏堢骇</el-radio>\r\n          <el-radio label=\"low\">浣庝紭鍏堢骇</el-radio>\r\n          <el-radio label=\"keep\">淇濇寔鍘熶紭鍏堢骇</el-radio>\r\n        </el-radio-group>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"鎸囨淳璇存槑\" prop=\"comment\">\r\n        <el-input\r\n          v-model=\"form.comment\"\r\n          type=\"textarea\"\r\n          :rows=\"3\"\r\n          placeholder=\"璇疯緭鍏ユ寚娲捐鏄庯紙鍙€夛級\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"閫氱煡鏂瑰紡\" prop=\"notifyMethod\">\r\n        <el-checkbox-group v-model=\"form.notifyMethod\">\r\n          <el-checkbox label=\"system\">绯荤粺閫氱煡</el-checkbox>\r\n          <el-checkbox label=\"email\">閭欢閫氱煡</el-checkbox>\r\n          <el-checkbox label=\"sms\">鐭俊閫氱煡</el-checkbox>\r\n        </el-checkbox-group>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"绔嬪嵆閫氱煡\" prop=\"notifyNow\">\r\n        <el-switch v-model=\"form.notifyNow\" />\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <template #footer>\r\n      <el-button @click=\"handleCancel\">鍙栨秷</el-button>\r\n      <el-button type=\"primary\" @click=\"handleConfirm\" :loading=\"loading\">\r\n        纭畾鎸囨淳\r\n      </el-button>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { ticketApi } from '@/api/ticket'\r\nimport { userApi } from '@/api/system/user'\r\n\r\nconst emit = defineEmits(['success'])\r\n\r\nconst dialogVisible = ref(false)\r\nconst loading = ref(false)\r\nconst formRef = ref()\r\nconst ticketIds = ref([])\r\nconst engineerList = ref([])\r\n\r\nconst form = reactive({\r\n  assigneeId: undefined,\r\n  priority: 'keep',\r\n  comment: '',\r\n  notifyMethod: ['system'],\r\n  notifyNow: true\r\n})\r\n\r\nconst rules = {\r\n  assigneeId: [\r\n    { required: true, message: '璇烽€夋嫨鎸囨淳宸ョ▼甯?, trigger: 'change' }\r\n  ]\r\n}\r\n\r\n// 鎵撳紑瀵硅瘽妗哱r\nconst open = async (ids) => {\r\n  ticketIds.value = ids || []\r\n  dialogVisible.value = true\r\n  reset()\r\n  await loadEngineerList()\r\n}\r\n\r\n// 鍔犺浇宸ョ▼甯堝垪琛╘r\nconst loadEngineerList = async () => {\r\n  try {\r\n    // 鑾峰彇宸ョ▼甯堝垪琛╘r\n    const res = await userApi.list({ role: 'engineer' })\r\n    engineerList.value = res.data || []\r\n    \r\n    // 鑾峰彇姣忎釜宸ョ▼甯堢殑宸ヤ綔閲廫r\n    for (const engineer of engineerList.value) {\r\n      const workloadRes = await ticketApi.getWorkload(engineer.id)\r\n      engineer.workload = workloadRes.data || 0\r\n    }\r\n  } catch (error) {\r\n    console.error('鍔犺浇宸ョ▼甯堝垪琛ㄥけ璐?', error)\r\n    engineerList.value = [\r\n      { id: 1, name: '寮犱笁', role: '杩愮淮宸ョ▼甯?, workload: 3 },\r\n      { id: 2, name: '鏉庡洓', role: '杩愮淮宸ョ▼甯?, workload: 5 },\r\n      { id: 3, name: '鐜嬩簲', role: '宸℃鍛?, workload: 2 }\r\n    ]\r\n  }\r\n}\r\n\r\n// 纭鎸囨淳\r\nconst handleConfirm = async () => {\r\n  await formRef.value?.validate()\r\n  \r\n  loading.value = true\r\n  try {\r\n// 鏋勫缓鎸囨淳鏁版嵁\r\n    const assignData = {\r\n      ticketIds: ticketIds.value,\r\n      assigneeId: form.assigneeId,\r\n      comment: form.comment,\r\n      notifyMethod: form.notifyMethod,\r\n      notifyNow: form.notifyNow\r\n    }\r\n    \r\n    // 濡傛灉閫夋嫨浜嗕慨鏀逛紭鍏堢骇\r\n    if (form.priority !== 'keep') {\r\n      assignData.priority = form.priority\r\n    }\r\n    \r\n    // 璋冪敤鎵归噺鎸囨淳鎺ュ彛\r\n    await ticketApi.batchAssign(assignData)\r\n    \r\n    ElMessage.success(`鎴愬姛鎸囨淳 ${ticketIds.value.length} 涓伐鍗昤)\r\n    dialogVisible.value = false\r\n    emit('success')\r\n  } catch (error) {\r\n    console.error('鎸囨淳澶辫触:', error)\r\n    ElMessage.error('鎸囨淳澶辫触锛岃閲嶈瘯')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 鍙栨秷\r\nconst handleCancel = () => {\r\n  dialogVisible.value = false\r\n  reset()\r\n}\r\n\r\n// 閲嶇疆琛ㄥ崟\r\nconst reset = () => {\r\nform.assigneeId = undefined\r\n  form.priority = 'keep'\r\n  form.comment = ''\r\n  form.notifyMethod = ['system']\r\n  form.notifyNow = true\r\n  formRef.value?.resetFields()\r\n}\r\n\r\n// 鏆撮湶鏂规硶\r\ndefineExpose({\r\n  open\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.ticket-info {\r\n  margin-bottom: 20px;\r\n}\r\n</style>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\ticket\\components\\TicketForm.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":264,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":264,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'submitForm' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":326,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":326,"endColumn":17},{"ruleId":"no-unused-vars","severity":1,"message":"'cancel' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":347,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":347,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <el-dialog \r\n    :title=\"dialogTitle\" \r\n    v-model=\"dialogVisible\"\r\n    width=\"800px\" \r\n    append-to-body\r\n    :close-on-click-modal=\"false\"\r\n  >\r\n    <el-form \r\n      ref=\"formRef\" \r\n      :model=\"form\" \r\n      :rules=\"rules\" \r\n      :disabled=\"mode === 'view'\"\r\n      label-width=\"100px\"\r\n    >\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"宸ュ崟鏍囬\" prop=\"title\">\r\n            <el-input v-model=\"form.title\" placeholder=\"璇疯緭鍏ュ伐鍗曟爣棰榎" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"浼樺厛绾" prop=\"priority\">\r\n            <el-select v-model=\"form.priority\" placeholder=\"璇烽€夋嫨浼樺厛绾">\r\n              <el-option\r\n                v-for=\"item in Object.values(TICKET_PRIORITY)\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      \r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"浣跨敤妯℃澘\" prop=\"templateId\" v-if=\"mode === 'create'\">\r\n            <el-select \r\n              v-model=\"form.templateId\" \r\n              placeholder=\"閫夋嫨妯℃澘锛堝彲閫夛級\"\r\n              clearable\r\n              @change=\"handleTemplateChange\"\r\n            >\r\n              <el-option\r\n                v-for=\"item in templates\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.id\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"澶勭悊鏃堕檺\" prop=\"deadline\">\r\n            <el-date-picker\r\n              v-model=\"form.deadline\"\r\n              type=\"datetime\"\r\n              placeholder=\"閫夋嫨澶勭悊鏃堕檺\"\r\n              :disabled=\"true\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-form-item label=\"鏁呴殰鎻忚堪\" prop=\"description\">\r\n        <el-input\r\n          v-model=\"form.description\"\r\n          type=\"textarea\"\r\n          :rows=\"4\"\r\n          placeholder=\"璇疯缁嗘弿杩版晠闅滄儏鍐礬"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"鎶ヤ慨浜篭" prop=\"reporterName\">\r\n            <el-input v-model=\"form.reporterName\" placeholder=\"璇疯緭鍏ユ姤淇汉濮撳悕\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"鑱旂郴鐢佃瘽\" prop=\"reporterPhone\">\r\n            <el-input v-model=\"form.reporterPhone\" placeholder=\"璇疯緭鍏ヨ仈绯荤數璇漒" />\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"鏁呴殰璁惧\" prop=\"equipmentName\">\r\n            <el-input v-model=\"form.equipmentName\" placeholder=\"璇疯緭鍏ユ晠闅滆澶囧悕绉癨" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"璁惧涓撲笟\" prop=\"equipmentSpecialty\">\r\n            <el-select v-model=\"form.equipmentSpecialty\" placeholder=\"璇烽€夋嫨璁惧涓撲笟\">\r\n              <el-option\r\n                v-for=\"item in EQUIPMENT_SPECIALTY\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-form-item label=\"璁惧浣嶇疆\" prop=\"location\">\r\n        <el-input v-model=\"form.location\" placeholder=\"璇疯緭鍏ヨ澶囦綅缃紙濡傦細1妤兼満鎴匡級\" />\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"鏁呴殰鏃堕棿\" prop=\"faultTime\">\r\n        <el-date-picker\r\n          v-model=\"form.faultTime\"\r\n          type=\"datetime\"\r\n          placeholder=\"閫夋嫨鏁呴殰鍙戠幇鏃堕棿\"\r\n          value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"搴旀€ュ缃甛" prop=\"emergencyMeasure\">\r\n        <el-input\r\n          v-model=\"form.emergencyMeasure\"\r\n          type=\"textarea\"\r\n          :rows=\"3\"\r\n          placeholder=\"璇锋弿杩板簲鎬ュ缃柟娉昞"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"闄勪欢\" prop=\"attachments\">\r\n        <el-upload\r\n          :action=\"uploadUrl\"\r\n          :headers=\"uploadHeaders\"\r\n          :file-list=\"fileList\"\r\n          :on-success=\"handleUploadSuccess\"\r\n          :on-remove=\"handleRemove\"\r\n          :before-upload=\"beforeUpload\"\r\n          multiple\r\n          :limit=\"5\"\r\n        >\r\n          <el-button type=\"primary\">鐐瑰嚮涓婁紶</el-button>\r\n          <template #tip>\r\n            <div class=\"el-upload__tip\">鏀寔jpg/png/pdf鏂囦欢锛屽崟涓枃浠朵笉瓒呰繃10MB</div>\r\n          </template>\r\n<!-- src/views/ticket/components/TicketForm.vue -->\r\n\r\n        </el-upload>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"閫氱煡宸ョ▼甯圽" prop=\"notifyEngineer\">\r\n        <el-switch v-model=\"form.notifyEngineer\" />\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    \r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, watch } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { ticketApi, ticketTemplateApi } from '@/api/ticket'\r\nimport { TICKET_PRIORITY, EQUIPMENT_SPECIALTY } from '../constants'\r\nimport { getToken } from '@/utils/auth'\r\n\r\nconst emit = defineEmits(['success'])\r\n\r\nconst dialogVisible = ref(false)\r\nconst mode = ref('create') // create, edit, view\r\nconst loading = ref(false)\r\nconst formRef = ref()\r\nconst templates = ref([])\r\nconst fileList = ref([])\r\n\r\nconst form = reactive({\r\n  id: undefined,\r\n  title: '',\r\n  priority: 'medium',\r\n  templateId: undefined,\r\n  description: '',\r\n  reporterName: '',\r\n  reporterPhone: '',\r\n  equipmentName: '',\r\n  equipmentSpecialty: undefined,\r\n  location: '',\r\n  faultTime: undefined,\r\n  emergencyMeasure: '',\r\n  attachments: [],\r\n  notifyEngineer: false,\r\n  deadline: undefined\r\n})\r\n\r\nconst rules = {\r\n  title: [\r\n    { required: true, message: '璇疯緭鍏ュ伐鍗曟爣棰?, trigger: 'blur' },\r\n    { min: 5, max: 100, message: '鏍囬闀垮害鍦?5 鍒?100 涓瓧绗?, trigger: 'blur' }\r\n  ],\r\n  priority: [\r\n    { required: true, message: '璇烽€夋嫨浼樺厛绾?, trigger: 'change' }\r\n  ],\r\n  description: [\r\n    { required: true, message: '璇疯緭鍏ユ晠闅滄弿杩?, trigger: 'blur' }\r\n  ],\r\n  reporterName: [\r\n    { required: true, message: '璇疯緭鍏ユ姤淇汉濮撳悕', trigger: 'blur' }\r\n  ],\r\n  reporterPhone: [\r\n    { required: true, message: '璇疯緭鍏ヨ仈绯荤數璇?, trigger: 'blur' },\r\n    { pattern: /^1[3-9]\\d{9}$/, message: '璇疯緭鍏ユ纭殑鎵嬫満鍙?, trigger: 'blur' }\r\n  ],\r\n  equipmentName: [\r\n    { required: true, message: '璇疯緭鍏ユ晠闅滆澶囧悕绉?, trigger: 'blur' }\r\n  ],\r\n  equipmentSpecialty: [\r\n    { required: true, message: '璇烽€夋嫨璁惧涓撲笟', trigger: 'change' }\r\n  ],\r\n  location: [\r\n    { required: true, message: '璇疯緭鍏ヨ澶囦綅缃?, trigger: 'blur' }\r\n  ]\r\n}\r\n\r\nconst dialogTitle = computed(() => {\r\n  const titles = {\r\n    create: '鏂板缓宸ュ崟',\r\n    edit: '淇敼宸ュ崟',\r\n    view: '宸ュ崟璇︽儏'\r\n  }\r\n  return titles[mode.value]\r\n})\r\n\r\nconst uploadUrl = computed(() => {\r\n  return `${import.meta.env.VITE_APP_BASE_API}/common/upload`\r\n})\r\n\r\nconst uploadHeaders = computed(() => {\r\n  return {\r\n    Authorization: 'Bearer ' + getToken()\r\n  }\r\n})\r\n\r\n// 鐩戝惉浼樺厛绾у彉鍖栵紝鑷姩璁＄畻澶勭悊鏃堕檺\r\nwatch(() => form.priority, (val) => {\r\n  if (val) {\r\n    const priority = TICKET_PRIORITY[val.toUpperCase()]\r\n    if (priority) {\r\n      const deadline = new Date()\r\n      deadline.setHours(deadline.getHours() + priority.limit)\r\n      form.deadline = deadline\r\n    }\r\n  }\r\n})\r\n\r\n// 鎵撳紑瀵硅瘽妗哱r\nconst open = async (id, openMode = 'create') => {\r\ndialogVisible.value = true\r\n  mode.value = openMode\r\n  reset()\r\n  \r\n  // 鍔犺浇妯℃澘鍒楄〃\r\n  if (mode.value === 'create') {\r\ntry {\r\n      const res = await ticketTemplateApi.list()\r\n      templates.value = res.data || []\r\n    } catch (error) {\r\n      templates.value = []\r\n    }\r\n  }\r\n  \r\n  // 鍔犺浇宸ュ崟璇︽儏\r\n  if (id) {\r\n    loading.value = true\r\n    try {\r\n      const res = await ticketApi.get(id)\r\n      Object.assign(form, res.data)\r\n      fileList.value = res.data.attachments || []\r\n    } finally {\r\n      loading.value = false\r\n    }\r\n  }\r\n}\r\n\r\n// 閫夋嫨妯℃澘\r\nconst handleTemplateChange = async (templateId) => {\r\n  if (!templateId) return\r\n  \r\n  const res = await ticketTemplateApi.get(templateId)\r\n  const template = res.data\r\n  \r\n  // 濉厖妯℃澘鏁版嵁\r\n  form.title = template.title\r\n  form.priority = template.priority\r\n  form.description = template.description\r\n  form.equipmentSpecialty = template.equipmentSpecialty\r\n  form.emergencyMeasure = template.emergencyMeasure\r\n}\r\n\r\n// 鏂囦欢涓婁紶鎴愬姛\r\nconst handleUploadSuccess = (response, file) => {\r\n  if (response.code === 200) {\r\n    form.attachments.push({\r\n      name: file.name,\r\n      url: response.data.url\r\n    })\r\n  }\r\n}\r\n\r\n// 鏂囦欢绉婚櫎\r\nconst handleRemove = (file) => {\r\n  const index = form.attachments.findIndex(item => item.url === file.url)\r\n  if (index !== -1) {\r\n    form.attachments.splice(index, 1)\r\n  }\r\n}\r\n\r\n// 涓婁紶鍓嶆牎楠孿r\nconst beforeUpload = (file) => {\r\n  const isLt10M = file.size / 1024 / 1024 < 10\r\n  if (!isLt10M) {\r\n    ElMessage.error('涓婁紶鏂囦欢澶у皬涓嶈兘瓒呰繃 10MB!')\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\n// 鎻愪氦琛ㄥ崟\r\nconst submitForm = async () => {\r\n  await formRef.value?.validate()\r\n  \r\n  loading.value = true\r\n  try {\r\n    if (form.id) {\r\n      await ticketApi.update(form.id, form)\r\n      ElMessage.success('淇敼鎴愬姛')\r\n    } else {\r\n      await ticketApi.create(form)\r\n      ElMessage.success('鏂板缓鎴愬姛')\r\n    }\r\n    \r\ndialogVisible.value = false\r\n    emit('success')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 鍙栨秷\r\nconst cancel = () => {\r\ndialogVisible.value = false\r\n  reset()\r\n}\r\n\r\n// 閲嶇疆琛ㄥ崟\r\nconst reset = () => {\r\n  form.id = undefined\r\n  form.title = ''\r\n  form.priority = 'medium'\r\n  form.templateId = undefined\r\n  form.description = ''\r\n  form.reporterName = ''\r\n  form.reporterPhone = ''\r\n  form.equipmentName = ''\r\n  form.equipmentSpecialty = undefined\r\n  form.location = ''\r\n  form.faultTime = undefined\r\n  form.emergencyMeasure = ''\r\n  form.attachments = []\r\n  form.notifyEngineer = false\r\n  form.deadline = undefined\r\n  fileList.value = []\r\n  formRef.value?.resetFields()\r\n}\r\n\r\ndefineExpose({\r\n  open\r\n})\r\n</script>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\ticket\\constants.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\ticket\\detail.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'updateTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":262,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":33},{"ruleId":"no-unused-vars","severity":1,"message":"'listUser' is defined but never used. Allowed unused vars must match /^_/u.","line":263,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":263,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":320,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":320,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-card v-loading=\"loading\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span class=\"title\">宸ュ崟璇︽儏 - {{ form.ticketNo }}</span>\r\n          <div class=\"header-buttons\">\r\n            <el-button link type=\"primary\" icon=\"Refresh\" @click=\"getDetail\">鍒锋柊</el-button>\r\n            <el-button link type=\"primary\" icon=\"Close\" @click=\"handleClose\">鍏抽棴</el-button>\r\n          </div>\r\n        </div>\r\n      </template>\r\n\r\n      <!-- 鍩虹淇℃伅 -->\r\n      <el-descriptions :column=\"3\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">鍩虹淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"宸ュ崟缂栧彿\">\r\n          <span class=\"text-primary\">{{ form.ticketNo }}</span>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"宸ュ崟鐘舵€乗">\r\n          <dict-tag :options=\"ticket_status\" :value=\"form.status\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"浼樺厛绾">\r\n          <dict-tag :options=\"ticket_priority\" :value=\"form.priority\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"宸ュ崟鏍囬\" :span=\"3\">\r\n          {{ form.title }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"澶勭悊鏃堕檺\">\r\n          <el-countdown \r\n            v-if=\"form.status !== 'completed' && form.status !== 'closed'\"\r\n            :value=\"form.deadline\" \r\n            format=\"HH:mm:ss\"\r\n            @finish=\"handleTimeout\"\r\n          />\r\n          <span v-else>{{ parseTime(form.deadline) }}</span>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鍓╀綑鏃堕棿\">\r\n          <el-tag :type=\"getTimeoutType()\">{{ getRemainTime() }}</el-tag>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎸囨淳缁橽">\r\n          {{ form.assigneeName || '鏈寚娲? }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 鎶ヤ慨淇℃伅 -->\r\n      <el-descriptions :column=\"2\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">鎶ヤ慨淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"鎶ヤ慨浜篭">\r\n          {{ form.reporter }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鑱旂郴鐢佃瘽\">\r\n          {{ form.reporterPhone || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鎶ヤ慨鏃堕棿\">\r\n          {{ parseTime(form.createTime) }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鍙戠幇鏃堕棿\">\r\n          {{ parseTime(form.discoveryTime) }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 鏁呴殰淇℃伅 -->\r\n      <el-descriptions :column=\"2\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">鏁呴殰淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"鏁呴殰璁惧\">\r\n          {{ form.equipment }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"璁惧涓撲笟\">\r\n          <dict-tag :options=\"equipment_specialty\" :value=\"form.specialty\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"璁惧浣嶇疆\" :span=\"2\">\r\n          {{ form.location || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"鏁呴殰鎻忚堪\" :span=\"2\">\r\n          <div class=\"description-content\">{{ form.description }}</div>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"搴旀€ュ缃甛" :span=\"2\">\r\n          <div class=\"description-content\">{{ form.emergencyAction || '鏃? }}</div>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 澶勭悊淇℃伅 -->\r\n      <el-descriptions :column=\"2\" border class=\"margin-bottom\" v-if=\"form.status !== 'pending'\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">澶勭悊淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"澶勭悊浜篭">\r\n          {{ form.handlerName || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"寮€濮嬫椂闂碶">\r\n          {{ parseTime(form.startTime) || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"澶勭悊鏂规硶\" :span=\"2\">\r\n          <div class=\"description-content\">{{ form.solution || '澶勭悊涓?..' }}</div>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"瀹屾垚鏃堕棿\" v-if=\"form.status === 'completed' || form.status === 'closed'\">\r\n          {{ parseTime(form.completeTime) }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"澶勭悊鑰楁椂\" v-if=\"form.status === 'completed' || form.status === 'closed'\">\r\n          {{ form.duration || '-' }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 闄勪欢淇℃伅 -->\r\n      <el-descriptions :column=\"1\" border class=\"margin-bottom\" v-if=\"form.attachments\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">闄勪欢淇℃伅</span>\r\n        </template>\r\n        <el-descriptions-item label=\"闄勪欢鍒楄〃\">\r\n          <div class=\"attachment-list\">\r\n            <div v-for=\"(file, index) in attachmentList\" :key=\"index\" class=\"attachment-item\">\r\n              <el-link :href=\"file.url\" target=\"_blank\" :underline=\"false\">\r\n                <el-icon><Document /></el-icon>\r\n                {{ file.name }}\r\n              </el-link>\r\n            </div>\r\n          </div>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 鎿嶄綔鏃ュ織 -->\r\n      <el-descriptions :column=\"1\" border class=\"margin-bottom\">\r\n        <template #title>\r\n          <span class=\"descriptions-title\">鎿嶄綔鏃ュ織</span>\r\n        </template>\r\n        <el-descriptions-item label=\"\">\r\n          <el-timeline>\r\n            <el-timeline-item\r\n              v-for=\"(log, index) in logList\"\r\n              :key=\"index\"\r\n              :timestamp=\"parseTime(log.createTime)\"\r\n              placement=\"top\"\r\n              :type=\"log.type\"\r\n            >\r\n              <div class=\"log-content\">\r\n                <span class=\"log-user\">{{ log.userName }}</span>\r\n                <span class=\"log-action\">{{ log.action }}</span>\r\n                <div class=\"log-remark\" v-if=\"log.remark\">澶囨敞锛歿{ log.remark }}</div>\r\n              </div>\r\n            </el-timeline-item>\r\n          </el-timeline>\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 鎿嶄綔鎸夐挳 -->\r\n      <div class=\"action-buttons\">\r\n        <el-button \r\n          type=\"primary\" \r\n          icon=\"Edit\" \r\n          @click=\"handleEdit\"\r\n          v-hasPermi=\"['business:ticket:edit']\"\r\n          v-if=\"form.status !== 'closed'\"\r\n        >缂栬緫</el-button>\r\n        \r\n        <el-button \r\n          type=\"success\" \r\n          icon=\"User\" \r\n          @click=\"handleAssign\"\r\n          v-hasPermi=\"['business:ticket:edit']\"\r\n          v-if=\"form.status === 'pending'\"\r\n        >鎸囨淳</el-button>\r\n        \r\n        <el-button \r\n          type=\"warning\" \r\n          icon=\"VideoPlay\" \r\n          @click=\"handleStart\"\r\n          v-hasPermi=\"['business:ticket:edit']\"\r\n          v-if=\"form.status === 'assigned'\"\r\n        >寮€濮嬪鐞?/el-button>\r\n        \r\n        <el-button \r\n          type=\"success\" \r\n          icon=\"CircleCheck\" \r\n          @click=\"handleComplete\"\r\n          v-hasPermi=\"['business:ticket:edit']\"\r\n          v-if=\"form.status === 'processing'\"\r\n        >瀹屾垚宸ュ崟</el-button>\r\n        \r\n        <el-button \r\n          type=\"danger\" \r\n          icon=\"CircleClose\" \r\n          @click=\"handleCloseTicket\"\r\n          v-hasPermi=\"['business:ticket:edit']\"\r\n          v-if=\"form.status === 'completed'\"\r\n        >鍏抽棴宸ュ崟</el-button>\r\n        \r\n        <el-button \r\n          type=\"info\" \r\n          icon=\"Printer\" \r\n          @click=\"handlePrint\"\r\n        >鎵撳嵃</el-button>\r\n        \r\n        <el-button \r\n          icon=\"Back\" \r\n          @click=\"handleClose\"\r\n        >杩斿洖</el-button>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 鎸囨淳瀵硅瘽妗?-->\r\n    <el-dialog title=\"鎸囨淳宸ュ崟\" v-model=\"assignOpen\" width=\"500px\" append-to-body>\r\n      <el-form ref=\"assignRef\" :model=\"assignForm\" :rules=\"assignRules\" label-width=\"80px\">\r\n        <el-form-item label=\"鎸囨淳缁橽" prop=\"assigneeId\">\r\n          <el-select v-model=\"assignForm.assigneeId\" placeholder=\"璇烽€夋嫨澶勭悊浜哄憳\">\r\n            <el-option\r\n              v-for=\"user in userList\"\r\n              :key=\"user.userId\"\r\n              :label=\"user.nickName\"\r\n              :value=\"user.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n          <el-input v-model=\"assignForm.remark\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ娉╘"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitAssign\">纭?瀹?/el-button>\r\n          <el-button @click=\"assignOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 瀹屾垚瀵硅瘽妗?-->\r\n    <el-dialog title=\"瀹屾垚宸ュ崟\" v-model=\"completeOpen\" width=\"600px\" append-to-body>\r\n      <el-form ref=\"completeRef\" :model=\"completeForm\" :rules=\"completeRules\" label-width=\"100px\">\r\n        <el-form-item label=\"澶勭悊鏂规硶\" prop=\"solution\">\r\n          <el-input v-model=\"completeForm.solution\" type=\"textarea\" :rows=\"4\" placeholder=\"璇疯緭鍏ュ鐞嗘柟娉昞"/>\r\n        </el-form-item>\r\n        <el-form-item label=\"澶勭悊缁撴灉\" prop=\"result\">\r\n          <el-radio-group v-model=\"completeForm.result\">\r\n            <el-radio label=\"resolved\">宸茶В鍐?/el-radio>\r\n            <el-radio label=\"temporary\">涓存椂澶勭悊</el-radio>\r\n            <el-radio label=\"transferred\">杞叾浠栭儴闂?/el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n          <el-input v-model=\"completeForm.remark\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ娉╘"/>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitComplete\">纭?瀹?/el-button>\r\n          <el-button @click=\"completeOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"TicketDetail\">\r\nimport { getCurrentInstance, ref, onMounted } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { getTicket, updateTicket } from \"@/api/business/ticket\"\r\nimport { listUser } from \"@/api/system/user\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\nconst ticketId = route.params.ticketId || route.params.id\r\nconst loading = ref(false)\r\nconst assignOpen = ref(false)\r\nconst completeOpen = ref(false)\r\nconst userList = ref([])\r\nconst logList = ref([])\r\nconst attachmentList = ref([])\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { ticket_status, ticket_priority, equipment_specialty } = proxy.useDict('ticket_status', 'ticket_priority', 'equipment_specialty')\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({})\r\nconst assignForm = ref({\r\n  assigneeId: undefined,\r\n  remark: ''\r\n})\r\nconst completeForm = ref({\r\n  solution: '',\r\n  result: 'resolved',\r\n  remark: ''\r\n})\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst assignRules = {\r\n  assigneeId: [{ required: true, message: \"璇烽€夋嫨澶勭悊浜哄憳\", trigger: \"change\" }]\r\n}\r\nconst completeRules = {\r\n  solution: [{ required: true, message: \"璇疯緭鍏ュ鐞嗘柟娉昞", trigger: \"blur\" }],\r\n  result: [{ required: true, message: \"璇烽€夋嫨澶勭悊缁撴灉\", trigger: \"change\" }]\r\n}\r\n\r\n/** 鑾峰彇宸ュ崟璇︽儏 */\r\nasync function getDetail() {\r\n  if (!ticketId) return\r\n  loading.value = true\r\n  try {\r\n    const res = await getTicket(ticketId)\r\n    const data = res?.data || res\r\n    form.value = data\r\n    logList.value = (data.logs || []).map(l => ({\r\n      createTime: l.createTime,\r\n      userName: l.userName,\r\n      action: l.action,\r\n      remark: l.remark,\r\n      type: l.type || 'primary'\r\n    }))\r\n    attachmentList.value = (data.attachments || []).map(f => ({\r\n      name: f.name || f.fileName,\r\n      url: f.url || f.fileUrl\r\n    }))\r\n  } catch (e) {\r\n    proxy.$modal && proxy.$modal.msgError('鑾峰彇宸ュ崟璇︽儏澶辫触')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n/** 鑾峰彇鍓╀綑鏃堕棿 */\r\nfunction getRemainTime() {\r\n  if (!form.value.deadline || form.value.status === 'completed' || form.value.status === 'closed') {\r\n    return '-'\r\n  }\r\n  const now = new Date()\r\n  const deadline = new Date(form.value.deadline)\r\n  const diff = deadline - now\r\n  \r\n  if (diff <= 0) {\r\n    return '宸茶秴鏃?\r\n  }\r\n  \r\n  const hours = Math.floor(diff / (1000 * 60 * 60))\r\n  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60))\r\n  return `${hours}灏忔椂${minutes}鍒嗛挓`\r\n}\r\n\r\n/** 鑾峰彇瓒呮椂绫诲瀷 */\r\nfunction getTimeoutType() {\r\n  const remain = getRemainTime()\r\n  if (remain === '宸茶秴鏃?) return 'danger'\r\n  if (remain.includes('灏忔椂') && parseInt(remain) < 2) return 'warning'\r\n  return 'success'\r\n}\r\n\r\n/** 瓒呮椂澶勭悊 */\r\nfunction handleTimeout() {\r\n  proxy.$modal.msgWarning(\"宸ュ崟宸茶秴鏃讹紝璇峰敖蹇鐞哱")\r\n}\r\n\r\n/** 缂栬緫 */\r\nfunction handleEdit() {\r\n  router.push(`/business/ticket/edit/${ticketId}?from=detail`)\r\n}\r\n\r\n/** 鎸囨淳 */\r\nfunction handleAssign() {\r\n  assignForm.value = {\r\n    assigneeId: undefined,\r\n    remark: ''\r\n  }\r\n  assignOpen.value = true\r\n  getUserList()\r\n}\r\n\r\n/** 鎻愪氦鎸囨淳 */\r\nfunction submitAssign() {\r\n  proxy.$refs[\"assignRef\"].validate(valid => {\r\n    if (valid) {\r\n      proxy.$modal.msgSuccess(\"鎸囨淳鎴愬姛\")\r\n      assignOpen.value = false\r\n      form.value.status = 'assigned'\r\n      getDetail()\r\n    }\r\n  })\r\n}\r\n\r\n/** 寮€濮嬪鐞?*/\r\nfunction handleStart() {\r\n  proxy.$modal.confirm('纭寮€濮嬪鐞嗚宸ュ崟鍚楋紵').then(() => {\r\n    proxy.$modal.msgSuccess(\"宸插紑濮嬪鐞哱")\r\n    form.value.status = 'processing'\r\n    getDetail()\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀹屾垚宸ュ崟 */\r\nfunction handleComplete() {\r\n  completeForm.value = {\r\n    solution: '',\r\n    result: 'resolved',\r\n    remark: ''\r\n  }\r\n  completeOpen.value = true\r\n}\r\n\r\n/** 鎻愪氦瀹屾垚 */\r\nfunction submitComplete() {\r\n  proxy.$refs[\"completeRef\"].validate(valid => {\r\n    if (valid) {\r\n      proxy.$modal.msgSuccess(\"宸ュ崟宸插畬鎴怽")\r\n      completeOpen.value = false\r\n      form.value.status = 'completed'\r\n      getDetail()\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍏抽棴宸ュ崟 */\r\nfunction handleCloseTicket() {\r\n  proxy.$modal.confirm('纭鍏抽棴璇ュ伐鍗曞悧锛?).then(() => {\r\n    proxy.$modal.msgSuccess(\"宸ュ崟宸插叧闂璡")\r\n    form.value.status = 'closed'\r\n    getDetail()\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 鎵撳嵃 */\r\nfunction handlePrint() {\r\n  window.print()\r\n}\r\n\r\n/** 杩斿洖 */\r\nfunction handleClose() {\r\n  router.back()\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍒楄〃 */\r\nfunction getUserList() {\r\n  userList.value = [\r\n    { userId: 1, nickName: '寮犱笁' },\r\n    { userId: 2, nickName: '鏉庡洓' },\r\n    { userId: 3, nickName: '鐜嬩簲' }\r\n  ]\r\n}\r\n\r\nonMounted(() => {\r\n  getDetail()\r\n  getUserList()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  \r\n  .title {\r\n    font-size: 16px;\r\n    font-weight: bold;\r\n  }\r\n}\r\n\r\n.margin-bottom {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.descriptions-title {\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  color: #303133;\r\n}\r\n\r\n.description-content {\r\n  white-space: pre-wrap;\r\n  word-break: break-all;\r\n}\r\n\r\n.text-primary {\r\n  color: #409EFF;\r\n  font-weight: bold;\r\n}\r\n\r\n.attachment-list {\r\n  .attachment-item {\r\n    margin-bottom: 5px;\r\n  }\r\n}\r\n\r\n.log-content {\r\n  .log-user {\r\n    font-weight: bold;\r\n    margin-right: 10px;\r\n  }\r\n  .log-remark {\r\n    margin-top: 5px;\r\n    color: #909399;\r\n    font-size: 12px;\r\n  }\r\n}\r\n\r\n.action-buttons {\r\n  margin-top: 20px;\r\n  text-align: center;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #EBEEF5;\r\n}\r\n\r\n@media print {\r\n  .action-buttons {\r\n    display: none;\r\n  }\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\ticket\\form.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'getTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":175,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":175,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'listUser' is defined but never used. Allowed unused vars must match /^_/u.","line":176,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":176,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'ticket_status' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":186,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":186,"endColumn":60},{"ruleId":"no-unused-vars","severity":1,"message":"'val' is defined but never used. Allowed unused args must match /^_/u.","line":283,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":283,"endColumn":34},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":321,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":321,"endColumn":47},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":326,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":326,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-form ref=\"ticketRef\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\r\n      <!-- 鍩虹淇℃伅 -->\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"宸ュ崟鏍囬\" prop=\"title\">\r\n            <el-input v-model=\"form.title\" placeholder=\"璇疯緭鍏ュ伐鍗曟爣棰榎" maxlength=\"100\" show-word-limit />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"浼樺厛绾" prop=\"priority\">\r\n            <el-select v-model=\"form.priority\" placeholder=\"璇烽€夋嫨浼樺厛绾" @change=\"handlePriorityChange\">\r\n              <el-option\r\n                v-for=\"dict in ticket_priority\"\r\n                :key=\"dict.value\"\r\n                :label=\"dict.label\"\r\n                :value=\"dict.value\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"鎶ヤ慨浜篭" prop=\"reporter\">\r\n            <el-input v-model=\"form.reporter\" placeholder=\"璇疯緭鍏ユ姤淇汉濮撳悕\" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"澶勭悊鏃堕檺\">\r\n            <el-input v-model=\"timeLimit\" disabled>\r\n              <template #append>\r\n                <el-tag :type=\"getPriorityType(form.priority)\">{{ getDeadline() }}</el-tag>\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <!-- 鏁呴殰淇℃伅 -->\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"鏁呴殰璁惧\" prop=\"equipment\">\r\n            <el-input v-model=\"form.equipment\" placeholder=\"璇疯緭鍏ユ晠闅滆澶囧悕绉癨" />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"璁惧涓撲笟\" prop=\"specialty\">\r\n            <el-select v-model=\"form.specialty\" placeholder=\"璇烽€夋嫨璁惧涓撲笟\">\r\n              <el-option\r\n                v-for=\"dict in equipment_specialty\"\r\n                :key=\"dict.value\"\r\n                :label=\"dict.label\"\r\n                :value=\"dict.value\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"鏁呴殰鎻忚堪\" prop=\"description\">\r\n            <el-input\r\n              v-model=\"form.description\"\r\n              type=\"textarea\"\r\n              :rows=\"4\"\r\n              placeholder=\"璇疯缁嗘弿杩拌澶囨晠闅滅姸鍐靛強浣嶇疆\"\r\n              maxlength=\"500\"\r\n              show-word-limit\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"鍙戠幇鏃堕棿\" prop=\"discoveryTime\">\r\n            <el-date-picker\r\n              v-model=\"form.discoveryTime\"\r\n              type=\"datetime\"\r\n              placeholder=\"閫夋嫨鏁呴殰鍙戠幇鏃堕棿\"\r\n              format=\"YYYY-MM-DD HH:mm:ss\"\r\n              value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n              :default-time=\"defaultTime\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item label=\"鎸囨淳缁橽" prop=\"assigneeId\">\r\n            <el-select v-model=\"form.assigneeId\" placeholder=\"璇烽€夋嫨澶勭悊浜哄憳\" clearable>\r\n              <el-option\r\n                v-for=\"user in userList\"\r\n                :key=\"user.userId\"\r\n                :label=\"user.nickName\"\r\n                :value=\"user.userId\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"搴旀€ュ缃甛" prop=\"emergencyAction\">\r\n            <el-input\r\n              v-model=\"form.emergencyAction\"\r\n              type=\"textarea\"\r\n              :rows=\"3\"\r\n              placeholder=\"璇疯緭鍏ュ簲鎬ュ缃柟娉昞"\r\n              maxlength=\"300\"\r\n              show-word-limit\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <!-- 浣跨敤宸ュ崟妯℃澘 -->\r\n      <el-row v-if=\"!ticketId\">\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"閫夋嫨妯℃澘\">\r\n            <el-select v-model=\"templateId\" placeholder=\"鍙€夋嫨宸ュ崟妯℃澘蹇€熷～鍏匼" clearable @change=\"handleTemplateChange\">\r\n              <el-option\r\n                v-for=\"template in templateList\"\r\n                :key=\"template.templateId\"\r\n                :label=\"template.templateName\"\r\n                :value=\"template.templateId\"\r\n              />\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <!-- 闄勪欢涓婁紶 -->\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"闄勪欢涓婁紶\">\r\n            <file-upload\r\n              v-model=\"form.attachments\"\r\n              :limit=\"5\"\r\n              :fileSize=\"10\"\r\n              :fileType='[\"jpg\", \"jpeg\", \"png\", \"gif\", \"mp4\", \"avi\"]'\r\n              :isShowTip=\"true\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n\r\n      <!-- 閫氱煡璁剧疆 -->\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"閫氱煡璁剧疆\">\r\n            <el-checkbox v-model=\"form.notifyEngineer\">閫氱煡涓撲笟宸ョ▼甯?/el-checkbox>\r\n            <el-checkbox v-model=\"form.notifySms\">鐭俊閫氱煡</el-checkbox>\r\n            <el-checkbox v-model=\"form.notifyEmail\">閭欢閫氱煡</el-checkbox>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n\r\n    <!-- 鎸夐挳缁?-->\r\n    <div class=\"form-footer\">\r\n      <el-button @click=\"handleCancel\">鍙?娑?/el-button>\r\n      <el-button type=\"primary\" @click=\"submitForm\" v-hasPermi=\"['business:ticket:add']\" v-if=\"!ticketId\">纭?瀹?/el-button>\r\n      <el-button type=\"primary\" @click=\"submitForm\" v-hasPermi=\"['business:ticket:edit']\" v-else>纭?瀹?/el-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"TicketForm\">\r\nimport { getCurrentInstance, ref, computed, onMounted } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { getTicket, addTicket, updateTicket } from \"@/api/business/ticket\"\r\nimport { listUser } from \"@/api/system/user\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\n\r\n// 鑾峰彇宸ュ崟ID锛堢紪杈戞ā寮忥級\r\nconst ticketId = route.params && route.params.id\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { ticket_priority, equipment_specialty, ticket_status } = proxy.useDict('ticket_priority', 'equipment_specialty', 'ticket_status')\r\n\r\n// 琛ㄥ崟鏁版嵁\r\nconst form = ref({\r\n  ticketId: undefined,\r\n  ticketNo: undefined,\r\n  title: '',\r\n  priority: 'medium',\r\n  status: 'pending',\r\n  reporter: '',\r\n  equipment: '',\r\n  specialty: '',\r\n  description: '',\r\n  discoveryTime: '',\r\n  deadline: '',\r\n  assigneeId: undefined,\r\n  emergencyAction: '',\r\n  attachments: '',\r\n  notifyEngineer: false,\r\n  notifySms: false,\r\n  notifyEmail: false\r\n})\r\n\r\n// 楠岃瘉瑙勫垯\r\nconst rules = {\r\n  title: [\r\n    { required: true, message: '宸ュ崟鏍囬涓嶈兘涓虹┖', trigger: 'blur' },\r\n    { min: 5, max: 100, message: '鏍囬闀垮害鍦?5 鍒?100 涓瓧绗?, trigger: 'blur' }\r\n  ],\r\n  priority: [\r\n    { required: true, message: '璇烽€夋嫨浼樺厛绾?, trigger: 'change' }\r\n  ],\r\n  reporter: [\r\n    { required: true, message: '鎶ヤ慨浜轰笉鑳戒负绌?, trigger: 'blur' }\r\n  ],\r\n  equipment: [\r\n    { required: true, message: '鏁呴殰璁惧涓嶈兘涓虹┖', trigger: 'blur' }\r\n  ],\r\n  specialty: [\r\n    { required: true, message: '璇烽€夋嫨璁惧涓撲笟', trigger: 'change' }\r\n  ],\r\n  description: [\r\n    { required: true, message: '鏁呴殰鎻忚堪涓嶈兘涓虹┖', trigger: 'blur' },\r\n    { min: 10, max: 500, message: '鎻忚堪闀垮害鍦?10 鍒?500 涓瓧绗?, trigger: 'blur' }\r\n  ],\r\n  discoveryTime: [\r\n    { required: true, message: '璇烽€夋嫨鍙戠幇鏃堕棿', trigger: 'change' }\r\n  ]\r\n}\r\n\r\n// 鍏朵粬鏁版嵁\r\nconst userList = ref([])\r\nconst templateList = ref([\r\n  { templateId: 1, templateName: '绌鸿皟婕忔按', title: '绌鸿皟婕忔按澶勭悊', priority: 'low', specialty: 'hvac', description: '绌鸿皟鍐呮満婕忔按', emergencyAction: '鏀剧疆鎺ユ按瀹瑰櫒' },\r\n  { templateId: 2, templateName: 'UPS鏁呴殰', title: 'UPS鐢垫睜鏁呴殰', priority: 'high', specialty: 'power', description: 'UPS鍛婅', emergencyAction: '妫€鏌PS鐘舵€? },\r\n  { templateId: 3, templateName: '娓╁害鍛婅', title: '鏈烘埧娓╁害杩囬珮', priority: 'high', specialty: 'hvac', description: '娓╁害瓒呮爣', emergencyAction: '寮€鍚鐢ㄧ┖璋? }\r\n])\r\nconst templateId = ref(undefined)\r\nconst defaultTime = ref([new Date(2000, 0, 1, 0, 0, 0), new Date(2000, 0, 1, 23, 59, 59)])\r\n\r\n// 璁＄畻澶勭悊鏃堕檺\r\nconst timeLimit = computed(() => {\r\n  const limits = {\r\n    high: '4灏忔椂',\r\n    medium: '8灏忔椂',\r\n    low: '24灏忔椂'\r\n  }\r\n  return limits[form.value.priority] || ''\r\n})\r\n\r\n/** 鑾峰彇澶勭悊鎴鏃堕棿 */\r\nfunction getDeadline() {\r\n  if (!form.value.discoveryTime) return ''\r\n  \r\n  const hours = {\r\n    high: 4,\r\n    medium: 8,\r\n    low: 24\r\n  }[form.value.priority] || 24\r\n  \r\n  const deadline = new Date(form.value.discoveryTime)\r\n  deadline.setHours(deadline.getHours() + hours)\r\n  \r\n  return proxy.parseTime(deadline, '{y}-{m}-{d} {h}:{i}')\r\n}\r\n\r\n/** 鑾峰彇浼樺厛绾ф爣绛剧被鍨?*/\r\nfunction getPriorityType(priority) {\r\n  const types = {\r\n    high: 'danger',\r\n    medium: 'warning',\r\n    low: 'info'\r\n  }\r\n  return types[priority] || 'info'\r\n}\r\n\r\n/** 浼樺厛绾у彉鍖栧鐞?*/\r\nfunction handlePriorityChange(val) {\r\n  // 閲嶆柊璁＄畻鎴鏃堕棿\r\n  if (form.value.discoveryTime) {\r\n    form.value.deadline = getDeadline()\r\n  }\r\n}\r\n\r\n/** 閫夋嫨妯℃澘 */\r\nfunction handleTemplateChange(templateId) {\r\n  if (!templateId) {\r\n    return\r\n  }\r\n  \r\n  proxy.$modal.confirm('鏄惁浣跨敤璇ユā鏉垮～鍏呰〃鍗曪紵').then(() => {\r\n    // 鑾峰彇妯℃澘鏁版嵁骞跺～鍏匼r\n    const template = templateList.value.find(t => t.templateId === templateId)\r\n    if (template) {\r\n      form.value.title = template.title\r\n      form.value.priority = template.priority\r\n      form.value.specialty = template.specialty\r\n      form.value.description = template.description\r\n      form.value.emergencyAction = template.emergencyAction\r\n      \r\n      proxy.$modal.msgSuccess(\"宸插簲鐢ㄦā鏉縗")\r\n    }\r\n  }).catch(() => {\r\n    templateId.value = undefined\r\n  })\r\n}\r\n\r\n/** 鎻愪氦琛ㄥ崟 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"ticketRef\"].validate(valid => {\r\n    if (valid) {\r\n      // 璁剧疆鎴鏃堕棿\r\n      form.value.deadline = getDeadline()\r\n      \r\n      if (form.value.ticketId != undefined) {\r\n        updateTicket(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          router.push('/business/ticket')\r\n        })\r\n      } else {\r\n        addTicket(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          router.push('/business/ticket')\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍙栨秷 */\r\nfunction handleCancel() {\r\n  proxy.$modal.confirm('纭畾瑕佸彇娑堝悧锛熸湭淇濆瓨鐨勬暟鎹皢涓㈠け').then(() => {\r\n    router.push('/business/ticket')\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 鑾峰彇鐢ㄦ埛鍒楄〃 */\r\nfunction getUserList() {\r\n  // Mock鏁版嵁\r\n  userList.value = [\r\n    { userId: 1, nickName: '寮犱笁' },\r\n    { userId: 2, nickName: '鏉庡洓' },\r\n    { userId: 3, nickName: '鐜嬩簲' }\r\n  ]\r\n}\r\n\r\n/** 鑾峰彇宸ュ崟璇︽儏 */\r\nfunction getTicketInfo(id) {\r\n  // Mock鏁版嵁\r\n  form.value = {\r\n    ticketId: id,\r\n    ticketNo: 'TK202501001',\r\n    title: '绌鸿皟婕忔按澶勭悊',\r\n    priority: 'high',\r\n    status: 'pending',\r\n    reporter: '寮犱笁',\r\n    equipment: '绌鸿皟01',\r\n    specialty: 'hvac',\r\n    description: '绌鸿皟鍐呮満婕忔按锛屽湴闈㈡湁绉按',\r\n    discoveryTime: proxy.parseTime(new Date()),\r\n    emergencyAction: '宸叉斁缃帴姘村鍣?\r\n  }\r\n}\r\n\r\n/** 鍒濆鍖?*/\r\nonMounted(() => {\r\n  getUserList()\r\n  \r\n  if (ticketId) {\r\n    getTicketInfo(ticketId)\r\n  } else {\r\n    // 鏂板缓鏃惰缃粯璁ゅ€糪r\n    form.value.discoveryTime = proxy.parseTime(new Date())\r\n  }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.form-footer {\r\n  margin-top: 30px;\r\n  text-align: center;\r\n  padding-top: 20px;\r\n  border-top: 1px solid #e8e8e8;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\ticket\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'listTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":266,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":266,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'getTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":266,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":266,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'delTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":266,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":266,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'addTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":266,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":266,"endColumn":53},{"ruleId":"no-unused-vars","severity":1,"message":"'updateTicket' is defined but never used. Allowed unused vars must match /^_/u.","line":266,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":266,"endColumn":67},{"ruleId":"no-unused-vars","severity":1,"message":"'assignTickets' is defined but never used. Allowed unused vars must match /^_/u.","line":266,"column":69,"nodeType":"Identifier","messageId":"unusedVar","endLine":266,"endColumn":82},{"ruleId":"no-unused-vars","severity":1,"message":"'listUser' is defined but never used. Allowed unused vars must match /^_/u.","line":267,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":267,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鎼滅储琛ㄥ崟 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"宸ュ崟缂栧彿\" prop=\"ticketNo\">\r\n        <el-input\r\n          v-model=\"queryParams.ticketNo\"\r\n          placeholder=\"璇疯緭鍏ュ伐鍗曠紪鍙穃"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"鏍囬\" prop=\"title\">\r\n        <el-input\r\n          v-model=\"queryParams.title\"\r\n          placeholder=\"璇疯緭鍏ユ爣棰榎"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n        <el-select v-model=\"queryParams.status\" placeholder=\"璇烽€夋嫨鐘舵€乗" clearable>\r\n          <el-option\r\n            v-for=\"dict in ticket_status\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"浼樺厛绾" prop=\"priority\">\r\n        <el-select v-model=\"queryParams.priority\" placeholder=\"璇烽€夋嫨浼樺厛绾" clearable>\r\n          <el-option label=\"楂榎" value=\"high\" />\r\n          <el-option label=\"涓璡" value=\"medium\" />\r\n          <el-option label=\"浣嶾" value=\"low\" />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"鍒涘缓鏃堕棿\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          value-format=\"YYYY-MM-DD\"\r\n          type=\"daterange\"\r\n          range-separator=\"-\"\r\n          start-placeholder=\"寮€濮嬫棩鏈焅"\r\n          end-placeholder=\"缁撴潫鏃ユ湡\"\r\n        ></el-date-picker>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 鎿嶄綔鎸夐挳 -->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Plus\"\r\n          @click=\"handleAdd\"\r\n          v-hasPermi=\"['business:ticket:add']\"\r\n        >鏂板</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"Edit\"\r\n          :disabled=\"single\"\r\n          @click=\"handleUpdate\"\r\n          v-hasPermi=\"['business:ticket:edit']\"\r\n        >淇敼</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"danger\"\r\n          plain\r\n          icon=\"Delete\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleDelete\"\r\n          v-hasPermi=\"['business:ticket:remove']\"\r\n        >鍒犻櫎</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"info\"\r\n          plain\r\n          icon=\"User\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleBatchAssign\"\r\n          v-hasPermi=\"['business:ticket:assign']\"\r\n        >鎵归噺鎸囨淳</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"warning\"\r\n          plain\r\n          icon=\"Download\"\r\n          @click=\"handleExport\"\r\n          v-hasPermi=\"['business:ticket:export']\"\r\n        >瀵煎嚭</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table v-loading=\"loading\" :data=\"ticketList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"宸ュ崟缂栧彿\" align=\"center\" prop=\"ticketNo\" width=\"120\" />\r\n      <el-table-column label=\"鏍囬\" align=\"center\" prop=\"title\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"status\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"ticket_status\" :value=\"scope.row.status\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"浼樺厛绾" align=\"center\" prop=\"priority\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-tag \r\n            :type=\"scope.row.priority === 'high' ? 'danger' : scope.row.priority === 'medium' ? 'warning' : 'info'\"\r\n          >\r\n            {{ getPriorityLabel(scope.row.priority) }}\r\n          </el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎶ヤ慨浜篭" align=\"center\" prop=\"reporter\" width=\"100\" />\r\n      <el-table-column label=\"鏁呴殰璁惧\" align=\"center\" prop=\"equipment\" width=\"120\" />\r\n      <el-table-column label=\"璁惧涓撲笟\" align=\"center\" prop=\"specialty\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"equipment_specialty\" :value=\"scope.row.specialty\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎸囨淳缁橽" align=\"center\" prop=\"assigneeName\" width=\"100\" />\r\n      <el-table-column label=\"澶勭悊鏃堕檺\" align=\"center\" prop=\"deadline\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          <span>{{ parseTime(scope.row.deadline) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          <span>{{ parseTime(scope.row.createTime) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"200\">\r\n        <template #default=\"scope\">\r\n          <el-button link type=\"primary\" icon=\"View\" @click=\"handleView(scope.row)\" v-hasPermi=\"['business:ticket:query']\">鏌ョ湅</el-button>\r\n          <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['business:ticket:edit']\">淇敼</el-button>\r\n          <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['business:ticket:remove']\">鍒犻櫎</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    \r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total>0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 娣诲姞鎴栦慨鏀瑰伐鍗曞璇濇 -->\r\n    <el-dialog :title=\"title\" v-model=\"open\" width=\"800px\" append-to-body>\r\n      <el-form ref=\"ticketRef\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宸ュ崟鏍囬\" prop=\"title\">\r\n              <el-input v-model=\"form.title\" placeholder=\"璇疯緭鍏ュ伐鍗曟爣棰榎" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"浼樺厛绾" prop=\"priority\">\r\n              <el-select v-model=\"form.priority\" placeholder=\"璇烽€夋嫨浼樺厛绾">\r\n                <el-option label=\"楂榎" value=\"high\" />\r\n                <el-option label=\"涓璡" value=\"medium\" />\r\n                <el-option label=\"浣嶾" value=\"low\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎶ヤ慨浜篭" prop=\"reporter\">\r\n              <el-input v-model=\"form.reporter\" placeholder=\"璇疯緭鍏ユ姤淇汉\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鏁呴殰璁惧\" prop=\"equipment\">\r\n              <el-input v-model=\"form.equipment\" placeholder=\"璇疯緭鍏ユ晠闅滆澶嘰" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"璁惧涓撲笟\" prop=\"specialty\">\r\n              <el-select v-model=\"form.specialty\" placeholder=\"璇烽€夋嫨璁惧涓撲笟\">\r\n                <el-option label=\"鏆栭€歕" value=\"hvac\" />\r\n                <el-option label=\"閰嶇數\" value=\"power\" />\r\n                <el-option label=\"娑堥槻\" value=\"fire\" />\r\n                <el-option label=\"寮辩數\" value=\"weak\" />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鍙戠幇鏃堕棿\" prop=\"discoveryTime\">\r\n              <el-date-picker\r\n                v-model=\"form.discoveryTime\"\r\n                type=\"datetime\"\r\n                placeholder=\"閫夋嫨鏁呴殰鍙戠幇鏃堕棿\"\r\n                format=\"YYYY-MM-DD HH:mm:ss\"\r\n                value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n              />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"24\">\r\n            <el-form-item label=\"鏁呴殰鎻忚堪\" prop=\"description\">\r\n              <el-input v-model=\"form.description\" type=\"textarea\" :rows=\"4\" placeholder=\"璇疯緭鍏ユ晠闅滄弿杩癨" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"24\">\r\n            <el-form-item label=\"搴旀€ュ缃甛" prop=\"emergencyAction\">\r\n              <el-input v-model=\"form.emergencyAction\" type=\"textarea\" :rows=\"3\" placeholder=\"璇疯緭鍏ュ簲鎬ュ缃柟娉昞" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n          <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 鎵归噺鎸囨淳瀵硅瘽妗?-->\r\n    <el-dialog title=\"鎵归噺鎸囨淳\" v-model=\"assignOpen\" width=\"400px\" append-to-body>\r\n      <el-form ref=\"assignRef\" :model=\"assignForm\" label-width=\"80px\">\r\n        <el-form-item label=\"鎸囨淳缁橽" prop=\"userId\">\r\n          <el-select v-model=\"assignForm.userId\" placeholder=\"璇烽€夋嫨澶勭悊浜篭">\r\n            <el-option\r\n              v-for=\"user in userList\"\r\n              :key=\"user.userId\"\r\n              :label=\"user.nickName\"\r\n              :value=\"user.userId\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitAssign\">纭?瀹?/el-button>\r\n          <el-button @click=\"assignOpen = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"Ticket\">\r\nimport { ref, reactive, getCurrentInstance, toRefs } from 'vue'\r\nimport { parseTime } from '@/utils/ruoyi'\r\nimport { listTicket, getTicket, delTicket, addTicket, updateTicket, assignTickets } from \"@/api/business/ticket\"\r\nimport { listUser } from \"@/api/system/user\"\r\nimport { useRouter, useRoute } from 'vue-router'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst { ticket_status, equipment_specialty } = proxy.useDict('ticket_status', 'equipment_specialty')\r\n\r\nconst ticketList = ref([])\r\nconst open = ref(false)\r\nconst assignOpen = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst dateRange = ref([])\r\nconst userList = ref([])\r\n\r\n// Mock鏁版嵁瀛樺偍\r\nconst mockTickets = ref([\r\n  { ticketId: 1, ticketNo: 'TK202501001', title: '绌鸿皟婕忔按澶勭悊', status: 'pending', priority: 'high', equipment: '绌鸿皟01', reporter: '寮犱笁', specialty: 'hvac', createTime: '2024-01-20 10:00:00', deadline: '2024-01-21 10:00:00' },\r\n  { ticketId: 2, ticketNo: 'TK202501002', title: 'UPS鐢垫睜鏇存崲', status: 'processing', priority: 'medium', equipment: 'UPS-A', reporter: '鐜嬩簲', assigneeName: '璧靛叚', specialty: 'power', createTime: '2024-01-20 11:00:00', deadline: '2024-01-21 11:00:00' },\r\n  { ticketId: 3, ticketNo: 'TK202501003', title: '娑堥槻绯荤粺妫€娴?, status: 'completed', priority: 'low', equipment: '鐑熸劅鍣?, reporter: '鏉庡洓', assigneeName: '閽变竷', specialty: 'fire', createTime: '2024-01-19 09:00:00', deadline: '2024-01-20 09:00:00' }\r\n])\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  assignForm: {\r\n    userId: undefined\r\n  },\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    ticketNo: undefined,\r\n    title: undefined,\r\n    status: undefined,\r\n    priority: undefined,\r\n    equipment: undefined,\r\n    reporter: undefined\r\n  },\r\n  rules: {\r\n    title: [{ required: true, message: \"宸ュ崟鏍囬涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    priority: [{ required: true, message: \"浼樺厛绾т笉鑳戒负绌篭", trigger: \"change\" }],\r\n    reporter: [{ required: true, message: \"鎶ヤ慨浜轰笉鑳戒负绌篭", trigger: \"blur\" }],\r\n    equipment: [{ required: true, message: \"鏁呴殰璁惧涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    description: [{ required: true, message: \"鏁呴殰鎻忚堪涓嶈兘涓虹┖\", trigger: \"blur\" }]\r\n  }\r\n})\r\n\r\nconst { queryParams, form, assignForm, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ宸ュ崟鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  \r\n  // 浣跨敤Mock鏁版嵁骞跺簲鐢ㄨ繃婊r\n  setTimeout(() => {\r\n    let filteredData = [...mockTickets.value]\r\n    \r\n    // 搴旂敤鎼滅储杩囨护\r\n    if (queryParams.value.ticketNo) {\r\n      filteredData = filteredData.filter(item => \r\n        item.ticketNo.toLowerCase().includes(queryParams.value.ticketNo.toLowerCase())\r\n      )\r\n    }\r\n    if (queryParams.value.title) {\r\n      filteredData = filteredData.filter(item => \r\n        item.title.includes(queryParams.value.title)\r\n      )\r\n    }\r\n    if (queryParams.value.status) {\r\n      filteredData = filteredData.filter(item => \r\n        item.status === queryParams.value.status\r\n      )\r\n    }\r\n    if (queryParams.value.priority) {\r\n      filteredData = filteredData.filter(item => \r\n        item.priority === queryParams.value.priority\r\n      )\r\n    }\r\n    \r\n    ticketList.value = filteredData\r\n    total.value = filteredData.length\r\n    loading.value = false\r\n  }, 300)\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    ticketId: undefined,\r\n    ticketNo: undefined,\r\n    title: undefined,\r\n    priority: 'medium',\r\n    status: 'pending',\r\n    reporter: undefined,\r\n    equipment: undefined,\r\n    specialty: undefined,\r\n    description: undefined,\r\n    emergencyAction: undefined,\r\n    discoveryTime: undefined\r\n  }\r\n  proxy.resetForm(\"ticketRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.ticketId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 鏌ョ湅鎸夐挳鎿嶄綔 */\r\nfunction handleView(row) {\r\n  const ticketId = row.ticketId || ids.value[0]\r\n  router.push(`/business/ticket/detail/${ticketId}`)\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  open.value = true\r\n  title.value = \"娣诲姞宸ュ崟\"\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const ticketId = row.ticketId || ids.value[0]\r\n  const ticket = mockTickets.value.find(t => t.ticketId === ticketId)\r\n  if (ticket) {\r\n    form.value = { ...ticket }\r\n    open.value = true\r\n    title.value = \"淇敼宸ュ崟\"\r\n  }\r\n}\r\n\r\n// 鑻ラ€氳繃 /business/ticket/edit/:ticketId 杩涘叆锛岃嚜鍔ㄦ墦寮€缂栬緫寮圭獥\r\nif (route.name === 'TicketEdit' && route.params.ticketId) {\r\n  const tid = Number(route.params.ticketId)\r\n  const ticket = mockTickets.value.find(t => t.ticketId === tid)\r\n  if (ticket) {\r\n    form.value = { ...ticket }\r\n    open.value = true\r\n    title.value = '淇敼宸ュ崟'\r\n  } else {\r\n    // 鎵句笉鍒板垯鍥炲垪琛╘r\n    router.replace('/business/ticket/list')\r\n  }\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"ticketRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.ticketId != undefined) {\r\n        // 淇敼\r\n        const index = mockTickets.value.findIndex(t => t.ticketId === form.value.ticketId)\r\n        if (index > -1) {\r\n          mockTickets.value[index] = { ...form.value }\r\n        }\r\n        proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n      } else {\r\n        // 鏂板\r\n        const newTicket = {\r\n          ...form.value,\r\n          ticketId: Date.now(),\r\n          ticketNo: 'TK' + Date.now(),\r\n          status: 'pending',\r\n          createTime: parseTime(new Date()),\r\n          deadline: parseTime(new Date(Date.now() + 24*60*60*1000))\r\n        }\r\n        mockTickets.value.push(newTicket)\r\n        proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n      }\r\n      open.value = false\r\n      getList()\r\n      // 鑻ユ潵婧愪负璇︽儏椤碉紝淇濆瓨鍚庤烦鍥炶鎯匼r\n      if (route.query.from === 'detail' && form.value.ticketId) {\r\n        router.replace(`/business/ticket/detail/${form.value.ticketId}`)\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const ticketIds = row.ticketId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎宸ュ崟缂栧彿涓篭"' + ticketIds + '\"鐨勬暟鎹」锛?).then(function() {\r\n    // 浠嶮ock鏁版嵁涓垹闄r\n    mockTickets.value = mockTickets.value.filter(t => !ticketIds.includes(t.ticketId))\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 鎵归噺鎸囨淳鎸夐挳鎿嶄綔 */\r\nfunction handleBatchAssign() {\r\n  assignForm.value.userId = undefined\r\n  assignOpen.value = true\r\n  // Mock鐢ㄦ埛鍒楄〃\r\n  userList.value = [\r\n    { userId: 1, nickName: '寮犱笁' },\r\n    { userId: 2, nickName: '鏉庡洓' },\r\n    { userId: 3, nickName: '鐜嬩簲' }\r\n  ]\r\n}\r\n\r\n/** 鎻愪氦鎸囨淳 */\r\nfunction submitAssign() {\r\n  if (!assignForm.value.userId) {\r\n    proxy.$modal.msgWarning(\"璇烽€夋嫨澶勭悊浜篭")\r\n    return\r\n  }\r\n  const user = userList.value.find(u => u.userId === assignForm.value.userId)\r\n  ids.value.forEach(id => {\r\n    const ticket = mockTickets.value.find(t => t.ticketId === id)\r\n    if (ticket) {\r\n      ticket.assigneeName = user.nickName\r\n      ticket.status = 'assigned'\r\n    }\r\n  })\r\n  proxy.$modal.msgSuccess(\"鎸囨淳鎴愬姛\")\r\n  assignOpen.value = false\r\n  getList()\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.$modal.msgSuccess(\"瀵煎嚭鍔熻兘寰呭疄鐜癨")\r\n}\r\n\r\n/** 鑾峰彇浼樺厛绾ф爣绛?*/\r\nfunction getPriorityLabel(priority) {\r\n  const map = {\r\n    high: '楂?,\r\n    medium: '涓?, \r\n    low: '浣?\r\n  }\r\n  return map[priority] || priority\r\n}\r\n\r\ngetList()\r\n</script>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\business\\ticket\\template.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":420,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":420,"endColumn":49},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":426,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":426,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <!-- 鎼滅储琛ㄥ崟 -->\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"妯℃澘鍚嶇О\" prop=\"templateName\">\r\n        <el-input\r\n          v-model=\"queryParams.templateName\"\r\n          placeholder=\"璇疯緭鍏ユā鏉垮悕绉癨"\r\n          clearable\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"鏁呴殰绫诲瀷\" prop=\"faultType\">\r\n        <el-select v-model=\"queryParams.faultType\" placeholder=\"璇烽€夋嫨\" clearable>\r\n          <el-option\r\n            v-for=\"dict in fault_type\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"璁惧涓撲笟\" prop=\"specialty\">\r\n        <el-select v-model=\"queryParams.specialty\" placeholder=\"璇烽€夋嫨\" clearable>\r\n          <el-option\r\n            v-for=\"dict in equipment_specialty\"\r\n            :key=\"dict.value\"\r\n            :label=\"dict.label\"\r\n            :value=\"dict.value\"\r\n          />\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 鎿嶄綔宸ュ叿鏍?-->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Plus\"\r\n          @click=\"handleAdd\"\r\n          v-hasPermi=\"['business:ticket:template:add']\"\r\n        >鏂板妯℃澘</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"Edit\"\r\n          :disabled=\"single\"\r\n          @click=\"handleUpdate\"\r\n          v-hasPermi=\"['business:ticket:template:edit']\"\r\n        >淇敼</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"danger\"\r\n          plain\r\n          icon=\"Delete\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleDelete\"\r\n          v-hasPermi=\"['business:ticket:template:remove']\"\r\n        >鍒犻櫎</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"warning\"\r\n          plain\r\n          icon=\"Download\"\r\n          @click=\"handleExport\"\r\n          v-hasPermi=\"['business:ticket:template:export']\"\r\n        >瀵煎嚭</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <!-- 鏁版嵁琛ㄦ牸 -->\r\n    <el-table v-loading=\"loading\" :data=\"templateList\" @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n      <el-table-column label=\"妯℃澘缂栧彿\" align=\"center\" prop=\"templateNo\" width=\"120\" />\r\n      <el-table-column label=\"妯℃澘鍚嶇О\" align=\"center\" prop=\"templateName\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"鏁呴殰绫诲瀷\" align=\"center\" prop=\"faultType\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"fault_type\" :value=\"scope.row.faultType\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"榛樿浼樺厛绾" align=\"center\" prop=\"priority\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"ticket_priority\" :value=\"scope.row.priority\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"璁惧涓撲笟\" align=\"center\" prop=\"specialty\" width=\"100\">\r\n        <template #default=\"scope\">\r\n          <dict-tag :options=\"equipment_specialty\" :value=\"scope.row.specialty\"/>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"浣跨敤娆℃暟\" align=\"center\" prop=\"useCount\" width=\"90\">\r\n        <template #default=\"scope\">\r\n          <el-tag>{{ scope.row.useCount }}娆?/el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"status\" width=\"80\">\r\n        <template #default=\"scope\">\r\n          <el-switch\r\n            v-model=\"scope.row.status\"\r\n            active-value=\"0\"\r\n            inactive-value=\"1\"\r\n            @change=\"handleStatusChange(scope.row)\"\r\n          ></el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"160\">\r\n        <template #default=\"scope\">\r\n          {{ parseTime(scope.row.createTime) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\" width=\"180\">\r\n        <template #default=\"scope\">\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"View\"\r\n            @click=\"handleView(scope.row)\"\r\n            v-hasPermi=\"['business:ticket:template:query']\"\r\n          >鏌ョ湅</el-button>\r\n          <el-button\r\n            link\r\n            type=\"primary\"\r\n            icon=\"Edit\"\r\n            @click=\"handleUpdate(scope.row)\"\r\n            v-hasPermi=\"['business:ticket:template:edit']\"\r\n          >淇敼</el-button>\r\n          <el-button\r\n            link\r\n            type=\"danger\"\r\n            icon=\"Delete\"\r\n            @click=\"handleDelete(scope.row)\"\r\n            v-hasPermi=\"['business:ticket:template:remove']\"\r\n          >鍒犻櫎</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 鍒嗛〉 -->\r\n    <pagination\r\n      v-show=\"total > 0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n\r\n    <!-- 娣诲姞鎴栦慨鏀瑰璇濇 -->\r\n    <el-dialog :title=\"title\" v-model=\"open\" width=\"700px\" append-to-body>\r\n      <el-form ref=\"templateRef\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"妯℃澘鍚嶇О\" prop=\"templateName\">\r\n              <el-input v-model=\"form.templateName\" placeholder=\"璇疯緭鍏ユā鏉垮悕绉癨" maxlength=\"50\" show-word-limit />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鏁呴殰绫诲瀷\" prop=\"faultType\">\r\n              <el-select v-model=\"form.faultType\" placeholder=\"璇烽€夋嫨鏁呴殰绫诲瀷\">\r\n                <el-option\r\n                  v-for=\"dict in fault_type\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"榛樿浼樺厛绾" prop=\"priority\">\r\n              <el-radio-group v-model=\"form.priority\">\r\n                <el-radio\r\n                  v-for=\"dict in ticket_priority\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.value\"\r\n                >{{ dict.label }}</el-radio>\r\n              </el-radio-group>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"璁惧涓撲笟\" prop=\"specialty\">\r\n              <el-select v-model=\"form.specialty\" placeholder=\"璇烽€夋嫨\">\r\n                <el-option\r\n                  v-for=\"dict in equipment_specialty\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n                />\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-form-item label=\"榛樿鏍囬\" prop=\"defaultTitle\">\r\n          <el-input v-model=\"form.defaultTitle\" placeholder=\"璇疯緭鍏ラ粯璁ゆ爣棰榎" />\r\n        </el-form-item>\r\n        <el-form-item label=\"鏁呴殰鎻忚堪\" prop=\"defaultDescription\">\r\n          <el-input\r\n            v-model=\"form.defaultDescription\"\r\n            type=\"textarea\"\r\n            :rows=\"4\"\r\n            placeholder=\"璇疯緭鍏ラ粯璁ゆ晠闅滄弿杩癨"\r\n            maxlength=\"500\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"搴旀€ュ缃甛" prop=\"defaultEmergencyAction\">\r\n          <el-input\r\n            v-model=\"form.defaultEmergencyAction\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"璇疯緭鍏ラ粯璁ゅ簲鎬ュ缃柟娉昞"\r\n            maxlength=\"300\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"澶勭悊鏂规\" prop=\"defaultSolution\">\r\n          <el-input\r\n            v-model=\"form.defaultSolution\"\r\n            type=\"textarea\"\r\n            :rows=\"4\"\r\n            placeholder=\"璇疯緭鍏ラ粯璁ゅ鐞嗘柟妗圽"\r\n            maxlength=\"500\"\r\n            show-word-limit\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n          <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ娉╘" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n          <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 鏌ョ湅璇︽儏瀵硅瘽妗?-->\r\n    <el-dialog title=\"妯℃澘璇︽儏\" v-model=\"detailOpen\" width=\"700px\" append-to-body>\r\n      <el-descriptions :column=\"2\" border>\r\n        <el-descriptions-item label=\"妯℃澘缂栧彿\">{{ detail.templateNo }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"妯℃澘鍚嶇О\">{{ detail.templateName }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鏁呴殰绫诲瀷\">\r\n          <dict-tag :options=\"fault_type\" :value=\"detail.faultType\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"榛樿浼樺厛绾">\r\n          <dict-tag :options=\"ticket_priority\" :value=\"detail.priority\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"璁惧涓撲笟\">\r\n          <dict-tag :options=\"equipment_specialty\" :value=\"detail.specialty\"/>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"浣跨敤娆℃暟\">{{ detail.useCount }}娆?/el-descriptions-item>\r\n        <el-descriptions-item label=\"榛樿鏍囬\" :span=\"2\">{{ detail.defaultTitle }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鏁呴殰鎻忚堪\" :span=\"2\">{{ detail.defaultDescription }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"搴旀€ュ缃甛" :span=\"2\">{{ detail.defaultEmergencyAction }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"澶勭悊鏂规\" :span=\"2\">{{ detail.defaultSolution }}</el-descriptions-item>\r\n        <el-descriptions-item label=\"鍒涘缓鏃堕棿\" :span=\"2\">{{ parseTime(detail.createTime) }}</el-descriptions-item>\r\n      </el-descriptions>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button @click=\"detailOpen = false\">鍏?闂?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"TicketTemplate\">\r\nimport { listTemplate, getTemplate, delTemplate, addTemplate, updateTemplate, changeTemplateStatus } from \"@/api/business/ticketTemplate\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\n\r\nconst templateList = ref([]);\r\nconst open = ref(false);\r\nconst detailOpen = ref(false);\r\nconst loading = ref(true);\r\nconst showSearch = ref(true);\r\nconst ids = ref([]);\r\nconst single = ref(true);\r\nconst multiple = ref(true);\r\nconst total = ref(0);\r\nconst title = ref(\"\");\r\nconst detail = ref({});\r\n\r\n// 瀛楀吀鏁版嵁\r\nconst { ticket_priority, equipment_specialty, fault_type } = proxy.useDict('ticket_priority', 'equipment_specialty', 'fault_type');\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    templateName: undefined,\r\n    faultType: undefined,\r\n    specialty: undefined\r\n  },\r\n  rules: {\r\n    templateName: [\r\n      { required: true, message: \"妯℃澘鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" },\r\n      { min: 2, max: 50, message: \"妯℃澘鍚嶇О闀垮害鍦?2 鍒?50 涓瓧绗", trigger: \"blur\" }\r\n    ],\r\n    faultType: [\r\n      { required: true, message: \"璇烽€夋嫨鏁呴殰绫诲瀷\", trigger: \"change\" }\r\n    ],\r\n    priority: [\r\n      { required: true, message: \"璇烽€夋嫨榛樿浼樺厛绾", trigger: \"change\" }\r\n    ],\r\n    specialty: [\r\n      { required: true, message: \"璇烽€夋嫨璁惧涓撲笟\", trigger: \"change\" }\r\n    ],\r\n    defaultTitle: [\r\n      { required: true, message: \"榛樿鏍囬涓嶈兘涓虹┖\", trigger: \"blur\" }\r\n    ],\r\n    defaultDescription: [\r\n      { required: true, message: \"鏁呴殰鎻忚堪涓嶈兘涓虹┖\", trigger: \"blur\" }\r\n    ]\r\n  }\r\n});\r\n\r\nconst { queryParams, form, rules } = toRefs(data);\r\n\r\n/** 鏌ヨ妯℃澘鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true;\r\n  listTemplate(queryParams.value).then(response => {\r\n    templateList.value = response.rows;\r\n    total.value = response.total;\r\n    loading.value = false;\r\n  });\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false;\r\n  reset();\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    templateId: undefined,\r\n    templateNo: undefined,\r\n    templateName: undefined,\r\n    faultType: undefined,\r\n    priority: 'medium',\r\n    specialty: undefined,\r\n    defaultTitle: undefined,\r\n    defaultDescription: undefined,\r\n    defaultEmergencyAction: undefined,\r\n    defaultSolution: undefined,\r\n    useCount: 0,\r\n    status: \"0\",\r\n    remark: undefined\r\n  };\r\n  proxy.resetForm(\"templateRef\");\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1;\r\n  getList();\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\");\r\n  handleQuery();\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.templateId);\r\n  single.value = selection.length != 1;\r\n  multiple.value = !selection.length;\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset();\r\n  open.value = true;\r\n  title.value = \"娣诲姞宸ュ崟妯℃澘\";\r\n}\r\n\r\n/** 鏌ョ湅璇︽儏 */\r\nfunction handleView(row) {\r\n  getTemplate(row.templateId).then(response => {\r\n    detail.value = response.data;\r\n    detailOpen.value = true;\r\n  });\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset();\r\n  const templateId = row.templateId || ids.value[0];\r\n  getTemplate(templateId).then(response => {\r\n    form.value = response.data;\r\n    open.value = true;\r\n    title.value = \"淇敼宸ュ崟妯℃澘\";\r\n  });\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"templateRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.templateId != undefined) {\r\n        updateTemplate(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      } else {\r\n        addTemplate(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\");\r\n          open.value = false;\r\n          getList();\r\n        });\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const templateIds = row.templateId || ids.value;\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎宸ュ崟妯℃澘缂栧彿涓篭"' + templateIds + '\"鐨勬暟鎹」锛?).then(function() {\r\n    return delTemplate(templateIds);\r\n  }).then(() => {\r\n    getList();\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\");\r\n  }).catch(() => {});\r\n}\r\n\r\n/** 鐘舵€佷慨鏀?*/\r\nfunction handleStatusChange(row) {\r\n  let text = row.status === \"0\" ? \"鍚敤\" : \"鍋滅敤\";\r\n  proxy.$modal.confirm('纭瑕乗"' + text + '\"\"' + row.templateName + '\"妯℃澘鍚楋紵').then(function() {\r\n    return changeTemplateStatus(row.templateId, row.status);\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(text + \"鎴愬姛\");\r\n  }).catch(function() {\r\n    row.status = row.status === \"0\" ? \"1\" : \"0\";\r\n  });\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download('business/ticket/template/export', {\r\n    ...queryParams.value\r\n  }, `template_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\ngetList();\r\n</script>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\error\\401.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\error\\404.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\login.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\cache\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\cache\\list.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":187,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":187,"endColumn":46},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":215,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":215,"endColumn":40},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":240,"column":24,"nodeType":"Identifier","messageId":"unusedVar","endLine":240,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-row :gutter=\"10\">\r\n      <el-col :span=\"8\">\r\n        <el-card style=\"height: calc(100vh - 125px)\">\r\n          <template #header>\r\n            <Collection style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">缂撳瓨鍒楄〃</span>\r\n            <el-button\r\n              style=\"float: right; padding: 3px 0\"\r\n              link\r\n              type=\"primary\"\r\n              icon=\"Refresh\"\r\n              @click=\"refreshCacheNames()\"\r\n            ></el-button>\r\n          </template>\r\n          <el-table\r\n            v-loading=\"loading\"\r\n            :data=\"cacheNames\"\r\n            :height=\"tableHeight\"\r\n            highlight-current-row\r\n            @row-click=\"getCacheKeys\"\r\n            style=\"width: 100%\"\r\n          >\r\n            <el-table-column\r\n              label=\"搴忓彿\"\r\n              width=\"60\"\r\n              type=\"index\"\r\n            ></el-table-column>\r\n\r\n            <el-table-column\r\n              label=\"缂撳瓨鍚嶇О\"\r\n              align=\"center\"\r\n              prop=\"cacheName\"\r\n              :show-overflow-tooltip=\"true\"\r\n              :formatter=\"nameFormatter\"\r\n            ></el-table-column>\r\n\r\n            <el-table-column\r\n              label=\"澶囨敞\"\r\n              align=\"center\"\r\n              prop=\"remark\"\r\n              :show-overflow-tooltip=\"true\"\r\n            />\r\n            <el-table-column\r\n              label=\"鎿嶄綔\"\r\n              width=\"60\"\r\n              align=\"center\"\r\n              class-name=\"small-padding fixed-width\"\r\n            >\r\n              <template #default=\"scope\">\r\n                <el-button\r\n                  link\r\n                  type=\"primary\"\r\n                  icon=\"Delete\"\r\n                  @click=\"handleClearCacheName(scope.row)\"\r\n                ></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <el-col :span=\"8\">\r\n        <el-card style=\"height: calc(100vh - 125px)\">\r\n          <template #header>\r\n            <Key style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">閿悕鍒楄〃</span>\r\n            <el-button\r\n              style=\"float: right; padding: 3px 0\"\r\n              link\r\n              type=\"primary\"\r\n              icon=\"Refresh\"\r\n              @click=\"refreshCacheKeys()\"\r\n            ></el-button>\r\n          </template>\r\n          <el-table\r\n            v-loading=\"subLoading\"\r\n            :data=\"cacheKeys\"\r\n            :height=\"tableHeight\"\r\n            highlight-current-row\r\n            @row-click=\"handleCacheValue\"\r\n            style=\"width: 100%\"\r\n          >\r\n            <el-table-column\r\n              label=\"搴忓彿\"\r\n              width=\"60\"\r\n              type=\"index\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n              label=\"缂撳瓨閿悕\"\r\n              align=\"center\"\r\n              :show-overflow-tooltip=\"true\"\r\n              :formatter=\"keyFormatter\"\r\n            >\r\n            </el-table-column>\r\n            <el-table-column\r\n              label=\"鎿嶄綔\"\r\n              width=\"60\"\r\n              align=\"center\"\r\n              class-name=\"small-padding fixed-width\"\r\n            >\r\n              <template #default=\"scope\">\r\n                <el-button\r\n                  link\r\n                  type=\"primary\"\r\n                  icon=\"Delete\"\r\n                  @click=\"handleClearCacheKey(scope.row)\"\r\n                ></el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </el-card>\r\n      </el-col>\r\n\r\n      <el-col :span=\"8\">\r\n        <el-card :bordered=\"false\" style=\"height: calc(100vh - 125px)\">\r\n          <template #header>\r\n            <Document style=\"width: 1em; height: 1em; vertical-align: middle;\" /> <span style=\"vertical-align: middle;\">缂撳瓨鍐呭</span>\r\n            <el-button\r\n              style=\"float: right; padding: 3px 0\"\r\n              link\r\n              type=\"primary\"\r\n              icon=\"Refresh\"\r\n              @click=\"handleClearCacheAll()\"\r\n              >娓呯悊鍏ㄩ儴</el-button\r\n            >\r\n          </template>\r\n          <el-form :model=\"cacheForm\">\r\n            <el-row :gutter=\"32\">\r\n              <el-col :offset=\"1\" :span=\"22\">\r\n                <el-form-item label=\"缂撳瓨鍚嶇О:\" prop=\"cacheName\">\r\n                  <el-input v-model=\"cacheForm.cacheName\" :readOnly=\"true\" />\r\n                </el-form-item>\r\n              </el-col>\r\n              <el-col :offset=\"1\" :span=\"22\">\r\n                <el-form-item label=\"缂撳瓨閿悕:\" prop=\"cacheKey\">\r\n                  <el-input v-model=\"cacheForm.cacheKey\" :readOnly=\"true\" />\r\n                </el-form-item>\r\n              </el-col>\r\n              <el-col :offset=\"1\" :span=\"22\">\r\n                <el-form-item label=\"缂撳瓨鍐呭:\" prop=\"cacheValue\">\r\n                  <el-input\r\n                    v-model=\"cacheForm.cacheValue\"\r\n                    type=\"textarea\"\r\n                    :rows=\"8\"\r\n                    :readOnly=\"true\"\r\n                  />\r\n                </el-form-item>\r\n              </el-col>\r\n            </el-row>\r\n          </el-form>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"CacheList\">\r\nimport { listCacheName, listCacheKey, getCacheValue, clearCacheName, clearCacheKey, clearCacheAll } from \"@/api/monitor/cache\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst cacheNames = ref([])\r\nconst cacheKeys = ref([])\r\nconst cacheForm = ref({})\r\nconst loading = ref(true)\r\nconst subLoading = ref(false)\r\nconst nowCacheName = ref(\"\")\r\nconst tableHeight = ref(window.innerHeight - 200)\r\n\r\n/** 鏌ヨ缂撳瓨鍚嶇О鍒楄〃 */\r\nfunction getCacheNames() {\r\n  loading.value = true\r\n  listCacheName().then(response => {\r\n    cacheNames.value = response.data\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鍒锋柊缂撳瓨鍚嶇О鍒楄〃 */\r\nfunction refreshCacheNames() {\r\n  getCacheNames()\r\n  proxy.$modal.msgSuccess(\"鍒锋柊缂撳瓨鍒楄〃鎴愬姛\")\r\n}\r\n\r\n/** 娓呯悊鎸囧畾鍚嶇О缂撳瓨 */\r\nfunction handleClearCacheName(row) {\r\n  clearCacheName(row.cacheName).then(response => {\r\n    proxy.$modal.msgSuccess(\"娓呯悊缂撳瓨鍚嶇О[\" + row.cacheName + \"]鎴愬姛\")\r\n    getCacheKeys()\r\n  })\r\n}\r\n\r\n/** 鏌ヨ缂撳瓨閿悕鍒楄〃 */\r\nfunction getCacheKeys(row) {\r\n  const cacheName = row !== undefined ? row.cacheName : nowCacheName.value\r\n  if (cacheName === \"\") {\r\n    return\r\n  }\r\n  subLoading.value = true\r\n  listCacheKey(cacheName).then(response => {\r\n    cacheKeys.value = response.data\r\n    subLoading.value = false\r\n    nowCacheName.value = cacheName\r\n  })\r\n}\r\n\r\n/** 鍒锋柊缂撳瓨閿悕鍒楄〃 */\r\nfunction refreshCacheKeys() {\r\n  getCacheKeys()\r\n  proxy.$modal.msgSuccess(\"鍒锋柊閿悕鍒楄〃鎴愬姛\")\r\n}\r\n\r\n/** 娓呯悊鎸囧畾閿悕缂撳瓨 */\r\nfunction handleClearCacheKey(cacheKey) {\r\n  clearCacheKey(cacheKey).then(response => {\r\n    proxy.$modal.msgSuccess(\"娓呯悊缂撳瓨閿悕[\" + cacheKey + \"]鎴愬姛\")\r\n    getCacheKeys()\r\n  })\r\n}\r\n\r\n/** 鍒楄〃鍓嶇紑鍘婚櫎 */\r\nfunction nameFormatter(row) {\r\n  return row.cacheName.replace(\":\", \"\")\r\n}\r\n\r\n/** 閿悕鍓嶇紑鍘婚櫎 */\r\nfunction keyFormatter(cacheKey) {\r\n  return cacheKey.replace(nowCacheName.value, \"\")\r\n}\r\n\r\n/** 鏌ヨ缂撳瓨鍐呭璇︾粏 */\r\nfunction handleCacheValue(cacheKey) {\r\n  getCacheValue(nowCacheName.value, cacheKey).then(response => {\r\n    cacheForm.value = response.data\r\n  })\r\n}\r\n\r\n/** 娓呯悊鍏ㄩ儴缂撳瓨 */\r\nfunction handleClearCacheAll() {\r\n  clearCacheAll().then(response => {\r\n    proxy.$modal.msgSuccess(\"娓呯悊鍏ㄩ儴缂撳瓨鎴愬姛\")\r\n  })\r\n}\r\n\r\ngetCacheNames()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\druid\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\job\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'column' is defined but never used. Allowed unused args must match /^_/u.","line":337,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":337,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'handleCommand' is defined but never used. Allowed unused vars must match /^_/u.","line":382,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":382,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":467,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":467,"endColumn":44},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":473,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":473,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n         <el-form-item label=\"浠诲姟鍚嶇О\" prop=\"jobName\">\r\n            <el-input\r\n               v-model=\"queryParams.jobName\"\r\n               placeholder=\"璇疯緭鍏ヤ换鍔″悕绉癨"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"浠诲姟缁勫悕\" prop=\"jobGroup\">\r\n            <el-select v-model=\"queryParams.jobGroup\" placeholder=\"璇烽€夋嫨浠诲姟缁勫悕\" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_job_group\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"浠诲姟鐘舵€乗" prop=\"status\">\r\n            <el-select v-model=\"queryParams.status\" placeholder=\"璇烽€夋嫨浠诲姟鐘舵€乗" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_job_status\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['monitor:job:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['monitor:job:edit']\"\r\n            >淇敼</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['monitor:job:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['monitor:job:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"info\"\r\n               plain\r\n               icon=\"Operation\"\r\n               @click=\"handleJobLog\"\r\n               v-hasPermi=\"['monitor:job:query']\"\r\n            >鏃ュ織</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"jobList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"浠诲姟缂栧彿\" width=\"100\" align=\"center\" prop=\"jobId\" />\r\n         <el-table-column label=\"浠诲姟鍚嶇О\" align=\"center\" prop=\"jobName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"浠诲姟缁勫悕\" align=\"center\" prop=\"jobGroup\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_job_group\" :value=\"scope.row.jobGroup\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"璋冪敤鐩爣瀛楃涓瞈" align=\"center\" prop=\"invokeTarget\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"cron鎵ц琛ㄨ揪寮廫" align=\"center\" prop=\"cronExpression\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鐘舵€乗" align=\"center\">\r\n            <template #default=\"scope\">\r\n               <el-switch\r\n                  v-model=\"scope.row.status\"\r\n                  active-value=\"0\"\r\n                  inactive-value=\"1\"\r\n                  @change=\"handleStatusChange(scope.row)\"\r\n               ></el-switch>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" width=\"200\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-tooltip content=\"淇敼\" placement=\"top\">\r\n                  <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['monitor:job:edit']\"></el-button>\r\n               </el-tooltip>\r\n               <el-tooltip content=\"鍒犻櫎\" placement=\"top\">\r\n                  <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['monitor:job:remove']\"></el-button>\r\n               </el-tooltip>\r\n               <el-tooltip content=\"鎵ц涓€娆" placement=\"top\">\r\n                  <el-button link type=\"primary\" icon=\"CaretRight\" @click=\"handleRun(scope.row)\" v-hasPermi=\"['monitor:job:changeStatus']\"></el-button>\r\n               </el-tooltip>\r\n               <el-tooltip content=\"浠诲姟璇︾粏\" placement=\"top\">\r\n                  <el-button link type=\"primary\" icon=\"View\" @click=\"handleView(scope.row)\" v-hasPermi=\"['monitor:job:query']\"></el-button>\r\n               </el-tooltip>\r\n               <el-tooltip content=\"璋冨害鏃ュ織\" placement=\"top\">\r\n                  <el-button link type=\"primary\" icon=\"Operation\" @click=\"handleJobLog(scope.row)\" v-hasPermi=\"['monitor:job:query']\"></el-button>\r\n               </el-tooltip>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀瑰畾鏃朵换鍔″璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"820px\" append-to-body>\r\n         <el-form ref=\"jobRef\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"浠诲姟鍚嶇О\" prop=\"jobName\">\r\n                     <el-input v-model=\"form.jobName\" placeholder=\"璇疯緭鍏ヤ换鍔″悕绉癨" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"浠诲姟鍒嗙粍\" prop=\"jobGroup\">\r\n                     <el-select v-model=\"form.jobGroup\" placeholder=\"璇烽€夋嫨\">\r\n                        <el-option\r\n                           v-for=\"dict in sys_job_group\"\r\n                           :key=\"dict.value\"\r\n                           :label=\"dict.label\"\r\n                           :value=\"dict.value\"\r\n                        ></el-option>\r\n                     </el-select>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item prop=\"invokeTarget\">\r\n                     <template #label>\r\n                        <span>\r\n                           璋冪敤鏂规硶\r\n                           <el-tooltip placement=\"top\">\r\n                              <template #content>\r\n                                 <div>\r\n                                    Bean璋冪敤绀轰緥锛歳yTask.ryParams('ry')\r\n                                    <br />Class绫昏皟鐢ㄧず渚嬶細com.ruoyi.quartz.task.RyTask.ryParams('ry')\r\n                                    <br />鍙傛暟璇存槑锛氭敮鎸佸瓧绗︿覆锛屽竷灏旂被鍨嬶紝闀挎暣鍨嬶紝娴偣鍨嬶紝鏁村瀷\r\n                                 </div>\r\n                              </template>\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                        </span>\r\n                     </template>\r\n                     <el-input v-model=\"form.invokeTarget\" placeholder=\"璇疯緭鍏ヨ皟鐢ㄧ洰鏍囧瓧绗︿覆\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"cron琛ㄨ揪寮廫" prop=\"cronExpression\">\r\n                     <el-input v-model=\"form.cronExpression\" placeholder=\"璇疯緭鍏ron鎵ц琛ㄨ揪寮廫">\r\n                        <template #append>\r\n                           <el-button type=\"primary\" @click=\"handleShowCron\">\r\n                              鐢熸垚琛ㄨ揪寮廫r\n                              <i class=\"el-icon-time el-icon--right\"></i>\r\n                           </el-button>\r\n                        </template>\r\n                     </el-input>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\" v-if=\"form.jobId !== undefined\">\r\n                  <el-form-item label=\"鐘舵€乗">\r\n                     <el-radio-group v-model=\"form.status\">\r\n                        <el-radio\r\n                           v-for=\"dict in sys_job_status\"\r\n                           :key=\"dict.value\"\r\n                           :value=\"dict.value\"\r\n                        >{{ dict.label }}</el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鎵ц绛栫暐\" prop=\"misfirePolicy\">\r\n                     <el-radio-group v-model=\"form.misfirePolicy\">\r\n                        <el-radio-button value=\"1\">绔嬪嵆鎵ц</el-radio-button>\r\n                        <el-radio-button value=\"2\">鎵ц涓€娆?/el-radio-button>\r\n                        <el-radio-button value=\"3\">鏀惧純鎵ц</el-radio-button>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鏄惁骞跺彂\" prop=\"concurrent\">\r\n                     <el-radio-group v-model=\"form.concurrent\">\r\n                        <el-radio-button value=\"0\">鍏佽</el-radio-button>\r\n                        <el-radio-button value=\"1\">绂佹</el-radio-button>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n\r\n     <el-dialog title=\"Cron琛ㄨ揪寮忕敓鎴愬櫒\" v-model=\"openCron\" append-to-body destroy-on-close>\r\n       <crontab ref=\"crontabRef\" @hide=\"openCron=false\" @fill=\"crontabFill\" :expression=\"expression\"></crontab>\r\n     </el-dialog>\r\n\r\n      <!-- 浠诲姟鏃ュ織璇︾粏 -->\r\n      <el-dialog title=\"浠诲姟璇︾粏\" v-model=\"openView\" width=\"700px\" append-to-body>\r\n         <el-form :model=\"form\" label-width=\"120px\">\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"浠诲姟缂栧彿锛歕">{{ form.jobId }}</el-form-item>\r\n                  <el-form-item label=\"浠诲姟鍚嶇О锛歕">{{ form.jobName }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"浠诲姟鍒嗙粍锛歕">{{ jobGroupFormat(form) }}</el-form-item>\r\n                  <el-form-item label=\"鍒涘缓鏃堕棿锛歕">{{ form.createTime }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"cron琛ㄨ揪寮忥細\">{{ form.cronExpression }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"涓嬫鎵ц鏃堕棿锛歕">{{ parseTime(form.nextValidTime) }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"璋冪敤鐩爣鏂规硶锛歕">{{ form.invokeTarget }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"浠诲姟鐘舵€侊細\">\r\n                     <div v-if=\"form.status == 0\">姝ｅ父</div>\r\n                     <div v-else-if=\"form.status == 1\">鏆傚仠</div>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鏄惁骞跺彂锛歕">\r\n                     <div v-if=\"form.concurrent == 0\">鍏佽</div>\r\n                     <div v-else-if=\"form.concurrent == 1\">绂佹</div>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鎵ц绛栫暐锛歕">\r\n                     <div v-if=\"form.misfirePolicy == 0\">榛樿绛栫暐</div>\r\n                     <div v-else-if=\"form.misfirePolicy == 1\">绔嬪嵆鎵ц</div>\r\n                     <div v-else-if=\"form.misfirePolicy == 2\">鎵ц涓€娆?/div>\r\n                     <div v-else-if=\"form.misfirePolicy == 3\">鏀惧純鎵ц</div>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button @click=\"openView = false\">鍏?闂?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Job\">\r\nimport Crontab from '@/components/Crontab'\r\nimport { listJob, getJob, delJob, addJob, updateJob, runJob, changeJobStatus } from \"@/api/monitor/job\"\r\n\r\nconst router = useRouter()\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_job_group, sys_job_status } = proxy.useDict(\"sys_job_group\", \"sys_job_status\")\r\n\r\nconst jobList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst openView = ref(false)\r\nconst openCron = ref(false)\r\nconst expression = ref(\"\")\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    jobName: undefined,\r\n    jobGroup: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    jobName: [{ required: true, message: \"浠诲姟鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    invokeTarget: [{ required: true, message: \"璋冪敤鐩爣瀛楃涓蹭笉鑳戒负绌篭", trigger: \"blur\" }],\r\n    cronExpression: [{ required: true, message: \"cron鎵ц琛ㄨ揪寮忎笉鑳戒负绌篭", trigger: \"change\" }]\r\n  }\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ瀹氭椂浠诲姟鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listJob(queryParams.value).then(response => {\r\n    jobList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 浠诲姟缁勫悕瀛楀吀缈昏瘧 */\r\nfunction jobGroupFormat(row, column) {\r\n  return proxy.selectDictLabel(sys_job_group.value, row.jobGroup)\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    jobId: undefined,\r\n    jobName: undefined,\r\n    jobGroup: undefined,\r\n    invokeTarget: undefined,\r\n    cronExpression: undefined,\r\n    misfirePolicy: 1,\r\n    concurrent: 1,\r\n    status: \"0\"\r\n  }\r\n  proxy.resetForm(\"jobRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n// 澶氶€夋閫変腑鏁版嵁\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.jobId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n// 鏇村鎿嶄綔瑙﹀彂\r\nfunction handleCommand(command, row) {\r\n  switch (command) {\r\n    case \"handleRun\":\r\n      handleRun(row)\r\n      break\r\n    case \"handleView\":\r\n      handleView(row)\r\n      break\r\n    case \"handleJobLog\":\r\n      handleJobLog(row)\r\n      break\r\n    default:\r\n      break\r\n  }\r\n}\r\n\r\n// 浠诲姟鐘舵€佷慨鏀筡r\nfunction handleStatusChange(row) {\r\n  let text = row.status === \"0\" ? \"鍚敤\" : \"鍋滅敤\"\r\n  proxy.$modal.confirm('纭瑕乗"' + text + '\"\"' + row.jobName + '\"浠诲姟鍚?').then(function () {\r\n    return changeJobStatus(row.jobId, row.status)\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(text + \"鎴愬姛\")\r\n  }).catch(function () {\r\n    row.status = row.status === \"0\" ? \"1\" : \"0\"\r\n  })\r\n}\r\n\r\n/* 绔嬪嵆鎵ц涓€娆?*/\r\nfunction handleRun(row) {\r\n  proxy.$modal.confirm('纭瑕佺珛鍗虫墽琛屼竴娆"' + row.jobName + '\"浠诲姟鍚?').then(function () {\r\n    return runJob(row.jobId, row.jobGroup)\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"鎵ц鎴愬姛\")})\r\n  .catch(() => {})\r\n}\r\n\r\n/** 浠诲姟璇︾粏淇℃伅 */\r\nfunction handleView(row) {\r\n  getJob(row.jobId).then(response => {\r\n    form.value = response.data\r\n    openView.value = true\r\n  })\r\n}\r\n\r\n/** cron琛ㄨ揪寮忔寜閽搷浣?*/\r\nfunction handleShowCron() {\r\n  expression.value = form.value.cronExpression\r\n  openCron.value = true\r\n}\r\n\r\n/** 纭畾鍚庡洖浼犲€?*/\r\nfunction crontabFill(value) {\r\n  form.value.cronExpression = value\r\n}\r\n\r\n/** 浠诲姟鏃ュ織鍒楄〃鏌ヨ */\r\nfunction handleJobLog(row) {\r\n  const jobId = row.jobId || 0\r\n  router.push('/monitor/job-log/index/' + jobId)\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  open.value = true\r\n  title.value = \"娣诲姞浠诲姟\"\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const jobId = row.jobId || ids.value\r\n  getJob(jobId).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼浠诲姟\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"jobRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.jobId != undefined) {\r\n        updateJob(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addJob(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const jobIds = row.jobId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎瀹氭椂浠诲姟缂栧彿涓篭"' + jobIds + '\"鐨勬暟鎹」?').then(function () {\r\n    return delJob(jobIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"monitor/job/export\", {\r\n    ...queryParams.value,\r\n  }, `job_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\job\\log.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'rules' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":201,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":201,"endColumn":33},{"ruleId":"no-unused-vars","severity":1,"message":"'row' is defined but never used. Allowed unused args must match /^_/u.","line":245,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":245,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n         <el-form-item label=\"浠诲姟鍚嶇О\" prop=\"jobName\">\r\n            <el-input\r\n               v-model=\"queryParams.jobName\"\r\n               placeholder=\"璇疯緭鍏ヤ换鍔″悕绉癨"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"浠诲姟缁勫悕\" prop=\"jobGroup\">\r\n            <el-select\r\n               v-model=\"queryParams.jobGroup\"\r\n               placeholder=\"璇烽€夋嫨浠诲姟缁勫悕\"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_job_group\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鎵ц鐘舵€乗" prop=\"status\">\r\n            <el-select\r\n               v-model=\"queryParams.status\"\r\n               placeholder=\"璇烽€夋嫨鎵ц鐘舵€乗"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_common_status\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鎵ц鏃堕棿\" style=\"width: 308px\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"寮€濮嬫棩鏈焅"\r\n               end-placeholder=\"缁撴潫鏃ユ湡\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['monitor:job:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               @click=\"handleClean\"\r\n               v-hasPermi=\"['monitor:job:remove']\"\r\n            >娓呯┖</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['monitor:job:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button \r\n               type=\"warning\" \r\n               plain \r\n               icon=\"Close\"\r\n               @click=\"handleClose\"\r\n            >鍏抽棴</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"jobLogList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"鏃ュ織缂栧彿\" width=\"80\" align=\"center\" prop=\"jobLogId\" />\r\n         <el-table-column label=\"浠诲姟鍚嶇О\" align=\"center\" prop=\"jobName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"浠诲姟缁勫悕\" align=\"center\" prop=\"jobGroup\" :show-overflow-tooltip=\"true\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_job_group\" :value=\"scope.row.jobGroup\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"璋冪敤鐩爣瀛楃涓瞈" align=\"center\" prop=\"invokeTarget\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鏃ュ織淇℃伅\" align=\"center\" prop=\"jobMessage\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鎵ц鐘舵€乗" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_common_status\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎵ц鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"View\" @click=\"handleView(scope.row)\" v-hasPermi=\"['monitor:job:query']\">璇︾粏</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 璋冨害鏃ュ織璇︾粏 -->\r\n      <el-dialog title=\"璋冨害鏃ュ織璇︾粏\" v-model=\"open\" width=\"700px\" append-to-body>\r\n         <el-form :model=\"form\" label-width=\"100px\">\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鏃ュ織搴忓彿锛歕">{{ form.jobLogId }}</el-form-item>\r\n                  <el-form-item label=\"浠诲姟鍚嶇О锛歕">{{ form.jobName }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"浠诲姟鍒嗙粍锛歕">{{ form.jobGroup }}</el-form-item>\r\n                  <el-form-item label=\"鎵ц鏃堕棿锛歕">{{ form.createTime }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"璋冪敤鏂规硶锛歕">{{ form.invokeTarget }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"鏃ュ織淇℃伅锛歕">{{ form.jobMessage }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"鎵ц鐘舵€侊細\">\r\n                     <div v-if=\"form.status == 0\">姝ｅ父</div>\r\n                     <div v-else-if=\"form.status == 1\">澶辫触</div>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"寮傚父淇℃伅锛歕" v-if=\"form.status == 1\">{{ form.exceptionInfo }}</el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button @click=\"open = false\">鍏?闂?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"JobLog\">\r\nimport { getJob } from \"@/api/monitor/job\"\r\nimport { listJobLog, delJobLog, cleanJobLog } from \"@/api/monitor/jobLog\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_common_status, sys_job_group } = proxy.useDict(\"sys_common_status\", \"sys_job_group\")\r\n\r\nconst jobLogList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst dateRange = ref([])\r\nconst route = useRoute()\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    dictName: undefined,\r\n    dictType: undefined,\r\n    status: undefined\r\n  }\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ璋冨害鏃ュ織鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listJobLog(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    jobLogList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n// 杩斿洖鎸夐挳\r\nfunction handleClose() {\r\n  const obj = { path: \"/monitor/job\" }\r\n  proxy.$tab.closeOpenPage(obj)\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n// 澶氶€夋閫変腑鏁版嵁\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.jobLogId)\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 璇︾粏鎸夐挳鎿嶄綔 */\r\nfunction handleView(row) {\r\n  open.value = true\r\n  form.value = row\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎璋冨害鏃ュ織缂栧彿涓篭"' + ids.value + '\"鐨勬暟鎹」?').then(function () {\r\n    return delJobLog(ids.value)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 娓呯┖鎸夐挳鎿嶄綔 */\r\nfunction handleClean() {\r\n  proxy.$modal.confirm(\"鏄惁纭娓呯┖鎵€鏈夎皟搴︽棩蹇楁暟鎹」?\").then(function () {\r\n    return cleanJobLog()\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"娓呯┖鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"monitor/jobLog/export\", {\r\n    ...queryParams.value,\r\n  }, `job_log_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n(() => {\r\n  const jobId = route.params && route.params.jobId\r\n  if (jobId !== undefined && jobId != 0) {\r\n    getJob(jobId).then(response => {\r\n      queryParams.value.jobName = response.data.jobName\r\n      queryParams.value.jobGroup = response.data.jobGroup\r\n      getList()\r\n    })\r\n  } else {\r\n    getList()\r\n  }\r\n})()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\logininfor\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'prop' is defined but never used. Allowed unused args must match /^_/u.","line":188,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":188,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'order' is defined but never used. Allowed unused args must match /^_/u.","line":188,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":188,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n         <el-form-item label=\"鐧诲綍鍦板潃\" prop=\"ipaddr\">\r\n            <el-input\r\n               v-model=\"queryParams.ipaddr\"\r\n               placeholder=\"璇疯緭鍏ョ櫥褰曞湴鍧€\"\r\n               clearable\r\n               style=\"width: 240px;\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐢ㄦ埛鍚嶇О\" prop=\"userName\">\r\n            <el-input\r\n               v-model=\"queryParams.userName\"\r\n               placeholder=\"璇疯緭鍏ョ敤鎴峰悕绉癨"\r\n               clearable\r\n               style=\"width: 240px;\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select\r\n               v-model=\"queryParams.status\"\r\n               placeholder=\"鐧诲綍鐘舵€乗"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_common_status\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鐧诲綍鏃堕棿\" style=\"width: 308px\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"寮€濮嬫棩鏈焅"\r\n               end-placeholder=\"缁撴潫鏃ユ湡\"\r\n               :default-time=\"[new Date(2000, 1, 1, 0, 0, 0), new Date(2000, 1, 1, 23, 59, 59)]\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['monitor:logininfor:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               @click=\"handleClean\"\r\n               v-hasPermi=\"['monitor:logininfor:remove']\"\r\n            >娓呯┖</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Unlock\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUnlock\"\r\n               v-hasPermi=\"['monitor:logininfor:unlock']\"\r\n            >瑙ｉ攣</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['monitor:logininfor:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table ref=\"logininforRef\" v-loading=\"loading\" :data=\"logininforList\" @selection-change=\"handleSelectionChange\" :default-sort=\"defaultSort\" @sort-change=\"handleSortChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"璁块棶缂栧彿\" align=\"center\" prop=\"infoId\" />\r\n         <el-table-column label=\"鐢ㄦ埛鍚嶇О\" align=\"center\" prop=\"userName\" :show-overflow-tooltip=\"true\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\" />\r\n         <el-table-column label=\"鍦板潃\" align=\"center\" prop=\"ipaddr\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鐧诲綍鍦扮偣\" align=\"center\" prop=\"loginLocation\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鎿嶄綔绯荤粺\" align=\"center\" prop=\"os\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"娴忚鍣╘" align=\"center\" prop=\"browser\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鐧诲綍鐘舵€乗" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_common_status\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎻忚堪\" align=\"center\" prop=\"msg\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"璁块棶鏃堕棿\" align=\"center\" prop=\"loginTime\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.loginTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Logininfor\">\r\nimport { list, delLogininfor, cleanLogininfor, unlockLogininfor } from \"@/api/monitor/logininfor\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_common_status } = proxy.useDict(\"sys_common_status\")\r\n\r\nconst logininforList = ref([])\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst selectName = ref(\"\")\r\nconst total = ref(0)\r\nconst dateRange = ref([])\r\nconst defaultSort = ref({ prop: \"loginTime\", order: \"descending\" })\r\n\r\n// 鏌ヨ鍙傛暟\r\nconst queryParams = ref({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  ipaddr: undefined,\r\n  userName: undefined,\r\n  status: undefined,\r\n  orderByColumn: undefined,\r\n  isAsc: undefined\r\n})\r\n\r\n/** 鏌ヨ鐧诲綍鏃ュ織鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  list(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    logininforList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  queryParams.value.pageNum = 1\r\n  proxy.$refs[\"logininforRef\"].sort(defaultSort.value.prop, defaultSort.value.order)\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.infoId)\r\n  multiple.value = !selection.length\r\n  single.value = selection.length != 1\r\n  selectName.value = selection.map(item => item.userName)\r\n}\r\n\r\n/** 鎺掑簭瑙﹀彂浜嬩欢 */\r\nfunction handleSortChange(column, prop, order) {\r\n  queryParams.value.orderByColumn = column.prop\r\n  queryParams.value.isAsc = column.order\r\n  getList()\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const infoIds = row.infoId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎璁块棶缂栧彿涓篭"' + infoIds + '\"鐨勬暟鎹」?').then(function () {\r\n    return delLogininfor(infoIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 娓呯┖鎸夐挳鎿嶄綔 */\r\nfunction handleClean() {\r\n  proxy.$modal.confirm(\"鏄惁纭娓呯┖鎵€鏈夌櫥褰曟棩蹇楁暟鎹」?\").then(function () {\r\n    return cleanLogininfor()\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"娓呯┖鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瑙ｉ攣鎸夐挳鎿嶄綔 */\r\nfunction handleUnlock() {\r\n  const username = selectName.value\r\n  proxy.$modal.confirm('鏄惁纭瑙ｉ攣鐢ㄦ埛\"' + username + '\"鏁版嵁椤?').then(function () {\r\n    return unlockLogininfor(username)\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"鐢ㄦ埛\" + username + \"瑙ｉ攣鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"monitor/logininfor/export\", {\r\n    ...queryParams.value,\r\n  }, `logininfor_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\online\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\operlog\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'single' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":211,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":211,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'title' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":214,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":214,"endColumn":12},{"ruleId":"no-unused-vars","severity":1,"message":"'column' is defined but never used. Allowed unused args must match /^_/u.","line":244,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":244,"endColumn":32},{"ruleId":"no-unused-vars","severity":1,"message":"'prop' is defined but never used. Allowed unused args must match /^_/u.","line":269,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":269,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'order' is defined but never used. Allowed unused args must match /^_/u.","line":269,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":269,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n         <el-form-item label=\"鎿嶄綔鍦板潃\" prop=\"operIp\">\r\n            <el-input\r\n               v-model=\"queryParams.operIp\"\r\n               placeholder=\"璇疯緭鍏ユ搷浣滃湴鍧€\"\r\n               clearable\r\n               style=\"width: 240px;\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"绯荤粺妯″潡\" prop=\"title\">\r\n            <el-input\r\n               v-model=\"queryParams.title\"\r\n               placeholder=\"璇疯緭鍏ョ郴缁熸ā鍧梊"\r\n               clearable\r\n               style=\"width: 240px;\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鎿嶄綔浜哄憳\" prop=\"operName\">\r\n            <el-input\r\n               v-model=\"queryParams.operName\"\r\n               placeholder=\"璇疯緭鍏ユ搷浣滀汉鍛榎"\r\n               clearable\r\n               style=\"width: 240px;\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"绫诲瀷\" prop=\"businessType\">\r\n            <el-select\r\n               v-model=\"queryParams.businessType\"\r\n               placeholder=\"鎿嶄綔绫诲瀷\"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_oper_type\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select\r\n               v-model=\"queryParams.status\"\r\n               placeholder=\"鎿嶄綔鐘舵€乗"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_common_status\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鎿嶄綔鏃堕棿\" style=\"width: 308px\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"寮€濮嬫棩鏈焅"\r\n               end-placeholder=\"缁撴潫鏃ユ湡\"\r\n               :default-time=\"[new Date(2000, 1, 1, 0, 0, 0), new Date(2000, 1, 1, 23, 59, 59)]\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['monitor:operlog:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               @click=\"handleClean\"\r\n               v-hasPermi=\"['monitor:operlog:remove']\"\r\n            >娓呯┖</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['monitor:operlog:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table ref=\"operlogRef\" v-loading=\"loading\" :data=\"operlogList\" @selection-change=\"handleSelectionChange\" :default-sort=\"defaultSort\" @sort-change=\"handleSortChange\">\r\n         <el-table-column type=\"selection\" width=\"50\" align=\"center\" />\r\n         <el-table-column label=\"鏃ュ織缂栧彿\" align=\"center\" prop=\"operId\" />\r\n         <el-table-column label=\"绯荤粺妯″潡\" align=\"center\" prop=\"title\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鎿嶄綔绫诲瀷\" align=\"center\" prop=\"businessType\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_oper_type\" :value=\"scope.row.businessType\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔浜哄憳\" align=\"center\" width=\"110\" prop=\"operName\" :show-overflow-tooltip=\"true\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\" />\r\n         <el-table-column label=\"鎿嶄綔鍦板潃\" align=\"center\" prop=\"operIp\" width=\"130\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鎿嶄綔鐘舵€乗" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_common_status\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔鏃ユ湡\" align=\"center\" prop=\"operTime\" width=\"180\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.operTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"娑堣€楁椂闂碶" align=\"center\" prop=\"costTime\" width=\"110\" :show-overflow-tooltip=\"true\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\">\r\n            <template #default=\"scope\">\r\n               <span>{{ scope.row.costTime }}姣</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"View\" @click=\"handleView(scope.row, scope.index)\" v-hasPermi=\"['monitor:operlog:query']\">璇︾粏</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 鎿嶄綔鏃ュ織璇︾粏 -->\r\n      <el-dialog title=\"鎿嶄綔鏃ュ織璇︾粏\" v-model=\"open\" width=\"800px\" append-to-body>\r\n         <el-form :model=\"form\" label-width=\"100px\">\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鎿嶄綔妯″潡锛歕">{{ form.title }} / {{ typeFormat(form) }}</el-form-item>\r\n                  <el-form-item\r\n                    label=\"鐧诲綍淇℃伅锛歕"\r\n                  >{{ form.operName }} / {{ form.operIp }} / {{ form.operLocation }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"璇锋眰鍦板潃锛歕">{{ form.operUrl }}</el-form-item>\r\n                  <el-form-item label=\"璇锋眰鏂瑰紡锛歕">{{ form.requestMethod }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"鎿嶄綔鏂规硶锛歕">{{ form.method }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"璇锋眰鍙傛暟锛歕">{{ form.operParam }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"杩斿洖鍙傛暟锛歕">{{ form.jsonResult }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"8\">\r\n                  <el-form-item label=\"鎿嶄綔鐘舵€侊細\">\r\n                     <div v-if=\"form.status === 0\">姝ｅ父</div>\r\n                     <div v-else-if=\"form.status === 1\">澶辫触</div>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"8\">\r\n                  <el-form-item label=\"娑堣€楁椂闂达細\">{{ form.costTime }}姣</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"8\">\r\n                  <el-form-item label=\"鎿嶄綔鏃堕棿锛歕">{{ parseTime(form.operTime) }}</el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"寮傚父淇℃伅锛歕" v-if=\"form.status === 1\">{{ form.errorMsg }}</el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button @click=\"open = false\">鍏?闂?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Operlog\">\r\nimport { list, delOperlog, cleanOperlog } from \"@/api/monitor/operlog\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_oper_type, sys_common_status } = proxy.useDict(\"sys_oper_type\", \"sys_common_status\")\r\n\r\nconst operlogList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst dateRange = ref([])\r\nconst defaultSort = ref({ prop: \"operTime\", order: \"descending\" })\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    operIp: undefined,\r\n    title: undefined,\r\n    operName: undefined,\r\n    businessType: undefined,\r\n    status: undefined\r\n  }\r\n})\r\n\r\nconst { queryParams, form } = toRefs(data)\r\n\r\n/** 鏌ヨ鐧诲綍鏃ュ織 */\r\nfunction getList() {\r\n  loading.value = true\r\n  list(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    operlogList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鎿嶄綔鏃ュ織绫诲瀷瀛楀吀缈昏瘧 */\r\nfunction typeFormat(row, column) {\r\n  return proxy.selectDictLabel(sys_oper_type.value, row.businessType)\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  queryParams.value.pageNum = 1\r\n  proxy.$refs[\"operlogRef\"].sort(defaultSort.value.prop, defaultSort.value.order)\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.operId)\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 鎺掑簭瑙﹀彂浜嬩欢 */\r\nfunction handleSortChange(column, prop, order) {\r\n  queryParams.value.orderByColumn = column.prop\r\n  queryParams.value.isAsc = column.order\r\n  getList()\r\n}\r\n\r\n/** 璇︾粏鎸夐挳鎿嶄綔 */\r\nfunction handleView(row) {\r\n  open.value = true\r\n  form.value = row\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const operIds = row.operId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎鏃ュ織缂栧彿涓篭"' + operIds + '\"鐨勬暟鎹」?').then(function () {\r\n    return delOperlog(operIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 娓呯┖鎸夐挳鎿嶄綔 */\r\nfunction handleClean() {\r\n  proxy.$modal.confirm(\"鏄惁纭娓呯┖鎵€鏈夋搷浣滄棩蹇楁暟鎹」?\").then(function () {\r\n    return cleanOperlog()\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"娓呯┖鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"monitor/operlog/export\",{\r\n    ...queryParams.value,\r\n  }, `config_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\monitor\\server\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\redirect\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\register.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'res' is defined but never used. Allowed unused args must match /^_/u.","line":98,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":98,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"register\">\r\n    <el-form ref=\"registerRef\" :model=\"registerForm\" :rules=\"registerRules\" class=\"register-form\">\r\n      <h3 class=\"title\">{{ title }}</h3>\r\n      <el-form-item prop=\"username\">\r\n        <el-input v-model=\"registerForm.username\" type=\"text\" size=\"large\" auto-complete=\"off\" placeholder=\"璐﹀彿\">\r\n          <template #prefix><svg-icon icon-class=\"user\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"password\">\r\n        <el-input v-model=\"registerForm.password\" type=\"password\" size=\"large\" auto-complete=\"off\" placeholder=\"瀵嗙爜\"\r\n          @keyup.enter=\"handleRegister\">\r\n          <template #prefix><svg-icon icon-class=\"password\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"confirmPassword\">\r\n        <el-input v-model=\"registerForm.confirmPassword\" type=\"password\" size=\"large\" auto-complete=\"off\"\r\n          placeholder=\"纭瀵嗙爜\" @keyup.enter=\"handleRegister\">\r\n          <template #prefix><svg-icon icon-class=\"password\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"code\" v-if=\"captchaEnabled\">\r\n        <el-input size=\"large\" v-model=\"registerForm.code\" auto-complete=\"off\" placeholder=\"楠岃瘉鐮乗" style=\"width: 63%\"\r\n          @keyup.enter=\"handleRegister\">\r\n          <template #prefix><svg-icon icon-class=\"validCode\" class=\"el-input__icon input-icon\" /></template>\r\n        </el-input>\r\n        <div class=\"register-code\">\r\n          <img :src=\"codeUrl\" @click=\"getCode\" class=\"register-code-img\" />\r\n        </div>\r\n      </el-form-item>\r\n      <el-form-item style=\"width:100%;\">\r\n        <el-button :loading=\"loading\" size=\"large\" type=\"primary\" style=\"width:100%;\" @click.prevent=\"handleRegister\">\r\n          <span v-if=\"!loading\">娉?鍐?/span>\r\n          <span v-else>娉?鍐?涓?..</span>\r\n        </el-button>\r\n        <div style=\"float: right;\">\r\n          <router-link class=\"link-type\" :to=\"'/login'\">浣跨敤宸叉湁璐︽埛鐧诲綍</router-link>\r\n        </div>\r\n      </el-form-item>\r\n    </el-form>\r\n    <!--  搴曢儴  -->\r\n    <div class=\"el-register-footer\">\r\n      <span>Copyright 漏 2018-2025 ruoyi.vip All Rights Reserved.</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ElMessageBox } from \"element-plus\"\r\nimport { getCodeImg, register } from \"@/api/login\"\r\n\r\nconst title = import.meta.env.VITE_APP_TITLE\r\nconst router = useRouter()\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst registerForm = ref({\r\n  username: \"\",\r\n  password: \"\",\r\n  confirmPassword: \"\",\r\n  code: \"\",\r\n  uuid: \"\"\r\n})\r\n\r\nconst equalToPassword = (rule, value, callback) => {\r\n  if (registerForm.value.password !== value) {\r\n    callback(new Error(\"涓ゆ杈撳叆鐨勫瘑鐮佷笉涓€鑷碶"))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nconst registerRules = {\r\n  username: [\r\n    { required: true, trigger: \"blur\", message: \"璇疯緭鍏ユ偍鐨勮处鍙穃" },\r\n    { min: 2, max: 20, message: \"鐢ㄦ埛璐﹀彿闀垮害蹇呴』浠嬩簬 2 鍜?20 涔嬮棿\", trigger: \"blur\" }\r\n  ],\r\n  password: [\r\n    { required: true, trigger: \"blur\", message: \"璇疯緭鍏ユ偍鐨勫瘑鐮乗" },\r\n    { min: 5, max: 20, message: \"鐢ㄦ埛瀵嗙爜闀垮害蹇呴』浠嬩簬 5 鍜?20 涔嬮棿\", trigger: \"blur\" },\r\n    // 鍏佽闄ゆ寚瀹氱壒娈婂瓧绗﹀鐨勪换鎰忓瓧绗︼紙鍘婚櫎澶氫綑杞箟锛塡r\n    { pattern: /^[^<>\"'|\\\\]+$/, message: \"涓嶈兘鍖呭惈闈炴硶瀛楃锛? > \\\" ' \\\\ |\", trigger: \"blur\" }\r\n  ],\r\n  confirmPassword: [\r\n    { required: true, trigger: \"blur\", message: \"璇峰啀娆¤緭鍏ユ偍鐨勫瘑鐮乗" },\r\n    { required: true, validator: equalToPassword, trigger: \"blur\" }\r\n  ],\r\n  code: [{ required: true, trigger: \"change\", message: \"璇疯緭鍏ラ獙璇佺爜\" }]\r\n}\r\n\r\nconst codeUrl = ref(\"\")\r\nconst loading = ref(false)\r\nconst captchaEnabled = ref(true)\r\n\r\nfunction handleRegister() {\r\n  proxy.$refs.registerRef.validate(valid => {\r\n    if (valid) {\r\n      loading.value = true\r\n      register(registerForm.value).then(res => {\r\n        const username = registerForm.value.username\r\n        ElMessageBox.alert(\"<font color='red'>鎭枩浣狅紝鎮ㄧ殑璐﹀彿 \" + username + \" 娉ㄥ唽鎴愬姛锛?/font>\", \"绯荤粺鎻愮ず\", {\r\n          dangerouslyUseHTMLString: true,\r\n          type: \"success\",\r\n        }).then(() => {\r\n          router.push(\"/login\")\r\n        }).catch(() => { })\r\n      }).catch(() => {\r\n        loading.value = false\r\n        if (captchaEnabled.value) {\r\n          getCode()\r\n        }\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\nfunction getCode() {\r\n  getCodeImg().then(res => {\r\n    captchaEnabled.value = res.captchaEnabled === undefined ? true : res.captchaEnabled\r\n    if (captchaEnabled.value) {\r\n      codeUrl.value = \"data:image/gif;base64,\" + res.img\r\n      registerForm.value.uuid = res.uuid\r\n    }\r\n  })\r\n}\r\n\r\ngetCode()\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n.register {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  height: 100%;\r\n  background-image: url(\"../assets/images/login-background.jpg\");\r\n  background-size: cover;\r\n}\r\n\r\n.title {\r\n  margin: 0px auto 30px auto;\r\n  text-align: center;\r\n  color: #707070;\r\n}\r\n\r\n.register-form {\r\n  border-radius: 6px;\r\n  background: #ffffff;\r\n  width: 400px;\r\n  padding: 25px 25px 5px 25px;\r\n\r\n  .el-input {\r\n    height: 40px;\r\n\r\n    input {\r\n      height: 40px;\r\n    }\r\n  }\r\n\r\n  .input-icon {\r\n    height: 39px;\r\n    width: 14px;\r\n    margin-left: 0px;\r\n  }\r\n}\r\n\r\n.register-tip {\r\n  font-size: 13px;\r\n  text-align: center;\r\n  color: #bfbfbf;\r\n}\r\n\r\n.register-code {\r\n  width: 33%;\r\n  height: 40px;\r\n  float: right;\r\n\r\n  img {\r\n    cursor: pointer;\r\n    vertical-align: middle;\r\n  }\r\n}\r\n\r\n.el-register-footer {\r\n  height: 40px;\r\n  line-height: 40px;\r\n  position: fixed;\r\n  bottom: 0;\r\n  width: 100%;\r\n  text-align: center;\r\n  color: #fff;\r\n  font-family: Arial;\r\n  font-size: 12px;\r\n  letter-spacing: 1px;\r\n}\r\n\r\n.register-code-img {\r\n  height: 40px;\r\n  padding-left: 12px;\r\n}\r\n</style>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\config\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":274,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":274,"endColumn":47},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":280,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":280,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n         <el-form-item label=\"鍙傛暟鍚嶇О\" prop=\"configName\">\r\n            <el-input\r\n               v-model=\"queryParams.configName\"\r\n               placeholder=\"璇疯緭鍏ュ弬鏁板悕绉癨"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鍙傛暟閿悕\" prop=\"configKey\">\r\n            <el-input\r\n               v-model=\"queryParams.configKey\"\r\n               placeholder=\"璇疯緭鍏ュ弬鏁伴敭鍚峔"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"绯荤粺鍐呯疆\" prop=\"configType\">\r\n            <el-select v-model=\"queryParams.configType\" placeholder=\"绯荤粺鍐呯疆\" clearable style=\"width: 240px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_yes_no\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鍒涘缓鏃堕棿\" style=\"width: 308px;\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"寮€濮嬫棩鏈焅"\r\n               end-placeholder=\"缁撴潫鏃ユ湡\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:config:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:config:edit']\"\r\n            >淇敼</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:config:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['system:config:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Refresh\"\r\n               @click=\"handleRefreshCache\"\r\n               v-hasPermi=\"['system:config:remove']\"\r\n            >鍒锋柊缂撳瓨</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"configList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"鍙傛暟涓婚敭\" align=\"center\" prop=\"configId\" />\r\n         <el-table-column label=\"鍙傛暟鍚嶇О\" align=\"center\" prop=\"configName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鍙傛暟閿悕\" align=\"center\" prop=\"configKey\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鍙傛暟閿€糪" align=\"center\" prop=\"configValue\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"绯荤粺鍐呯疆\" align=\"center\" prop=\"configType\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_yes_no\" :value=\"scope.row.configType\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"澶囨敞\" align=\"center\" prop=\"remark\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" width=\"150\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:config:edit']\" >淇敼</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:config:remove']\">鍒犻櫎</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀瑰弬鏁伴厤缃璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"500px\" append-to-body>\r\n         <el-form ref=\"configRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-form-item label=\"鍙傛暟鍚嶇О\" prop=\"configName\">\r\n               <el-input v-model=\"form.configName\" placeholder=\"璇疯緭鍏ュ弬鏁板悕绉癨" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鍙傛暟閿悕\" prop=\"configKey\">\r\n               <el-input v-model=\"form.configKey\" placeholder=\"璇疯緭鍏ュ弬鏁伴敭鍚峔" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鍙傛暟閿€糪" prop=\"configValue\">\r\n               <el-input v-model=\"form.configValue\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ弬鏁伴敭鍊糪" />\r\n            </el-form-item>\r\n            <el-form-item label=\"绯荤粺鍐呯疆\" prop=\"configType\">\r\n               <el-radio-group v-model=\"form.configType\">\r\n                  <el-radio\r\n                     v-for=\"dict in sys_yes_no\"\r\n                     :key=\"dict.value\"\r\n                     :value=\"dict.value\"\r\n                  >{{ dict.label }}</el-radio>\r\n               </el-radio-group>\r\n            </el-form-item>\r\n            <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n               <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ唴瀹筡" />\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Config\">\r\nimport { listConfig, getConfig, delConfig, addConfig, updateConfig, refreshCache } from \"@/api/system/config\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_yes_no } = proxy.useDict(\"sys_yes_no\")\r\n\r\nconst configList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst dateRange = ref([])\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    configName: undefined,\r\n    configKey: undefined,\r\n    configType: undefined\r\n  },\r\n  rules: {\r\n    configName: [{ required: true, message: \"鍙傛暟鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    configKey: [{ required: true, message: \"鍙傛暟閿悕涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    configValue: [{ required: true, message: \"鍙傛暟閿€间笉鑳戒负绌篭", trigger: \"blur\" }]\r\n  }\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ鍙傛暟鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listConfig(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    configList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    configId: undefined,\r\n    configName: undefined,\r\n    configKey: undefined,\r\n    configValue: undefined,\r\n    configType: \"Y\",\r\n    remark: undefined\r\n  }\r\n  proxy.resetForm(\"configRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.configId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  open.value = true\r\n  title.value = \"娣诲姞鍙傛暟\"\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const configId = row.configId || ids.value\r\n  getConfig(configId).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼鍙傛暟\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"configRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.configId != undefined) {\r\n        updateConfig(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addConfig(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const configIds = row.configId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎鍙傛暟缂栧彿涓篭"' + configIds + '\"鐨勬暟鎹」锛?).then(function () {\r\n    return delConfig(configIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/config/export\", {\r\n    ...queryParams.value\r\n  }, `config_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/** 鍒锋柊缂撳瓨鎸夐挳鎿嶄綔 */\r\nfunction handleRefreshCache() {\r\n  refreshCache().then(() => {\r\n    proxy.$modal.msgSuccess(\"鍒锋柊缂撳瓨鎴愬姛\")\r\n  })\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\dept\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":256,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":256,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":262,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":262,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n         <el-form-item label=\"閮ㄩ棬鍚嶇О\" prop=\"deptName\">\r\n            <el-input\r\n               v-model=\"queryParams.deptName\"\r\n               placeholder=\"璇疯緭鍏ラ儴闂ㄥ悕绉癨"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select v-model=\"queryParams.status\" placeholder=\"閮ㄩ棬鐘舵€乗" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_normal_disable\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:dept:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"info\"\r\n               plain\r\n               icon=\"Sort\"\r\n               @click=\"toggleExpandAll\"\r\n            >灞曞紑/鎶樺彔</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table\r\n         v-if=\"refreshTable\"\r\n         v-loading=\"loading\"\r\n         :data=\"deptList\"\r\n         row-key=\"deptId\"\r\n         :default-expand-all=\"isExpandAll\"\r\n         :tree-props=\"{ children: 'children', hasChildren: 'hasChildren' }\"\r\n      >\r\n         <el-table-column prop=\"deptName\" label=\"閮ㄩ棬鍚嶇О\" width=\"260\"></el-table-column>\r\n         <el-table-column prop=\"orderNum\" label=\"鎺掑簭\" width=\"200\"></el-table-column>\r\n         <el-table-column prop=\"status\" label=\"鐘舵€乗" width=\"100\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"200\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:dept:edit']\">淇敼</el-button>\r\n               <el-button link type=\"primary\" icon=\"Plus\" @click=\"handleAdd(scope.row)\" v-hasPermi=\"['system:dept:add']\">鏂板</el-button>\r\n               <el-button v-if=\"scope.row.parentId != 0\" link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:dept:remove']\">鍒犻櫎</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀归儴闂ㄥ璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"600px\" append-to-body>\r\n         <el-form ref=\"deptRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-row>\r\n               <el-col :span=\"24\" v-if=\"form.parentId !== 0\">\r\n                  <el-form-item label=\"涓婄骇閮ㄩ棬\" prop=\"parentId\">\r\n                     <el-tree-select\r\n                        v-model=\"form.parentId\"\r\n                        :data=\"deptOptions\"\r\n                        :props=\"{ value: 'deptId', label: 'deptName', children: 'children' }\"\r\n                        value-key=\"deptId\"\r\n                        placeholder=\"閫夋嫨涓婄骇閮ㄩ棬\"\r\n                        check-strictly\r\n                     />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"閮ㄩ棬鍚嶇О\" prop=\"deptName\">\r\n                     <el-input v-model=\"form.deptName\" placeholder=\"璇疯緭鍏ラ儴闂ㄥ悕绉癨" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鏄剧ず鎺掑簭\" prop=\"orderNum\">\r\n                     <el-input-number v-model=\"form.orderNum\" controls-position=\"right\" :min=\"0\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"璐熻矗浜篭" prop=\"leader\">\r\n                     <el-input v-model=\"form.leader\" placeholder=\"璇疯緭鍏ヨ礋璐ｄ汉\" maxlength=\"20\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鑱旂郴鐢佃瘽\" prop=\"phone\">\r\n                     <el-input v-model=\"form.phone\" placeholder=\"璇疯緭鍏ヨ仈绯荤數璇漒" maxlength=\"11\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"閭\" prop=\"email\">\r\n                     <el-input v-model=\"form.email\" placeholder=\"璇疯緭鍏ラ偖绠盶" maxlength=\"50\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"閮ㄩ棬鐘舵€乗">\r\n                     <el-radio-group v-model=\"form.status\">\r\n                        <el-radio\r\n                           v-for=\"dict in sys_normal_disable\"\r\n                           :key=\"dict.value\"\r\n                           :value=\"dict.value\"\r\n                        >{{ dict.label }}</el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Dept\">\r\nimport { listDept, getDept, delDept, addDept, updateDept, listDeptExcludeChild } from \"@/api/system/dept\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\")\r\n\r\nconst deptList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst title = ref(\"\")\r\nconst deptOptions = ref([])\r\nconst isExpandAll = ref(true)\r\nconst refreshTable = ref(true)\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    deptName: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    parentId: [{ required: true, message: \"涓婄骇閮ㄩ棬涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    deptName: [{ required: true, message: \"閮ㄩ棬鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    orderNum: [{ required: true, message: \"鏄剧ず鎺掑簭涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    email: [{ type: \"email\", message: \"璇疯緭鍏ユ纭殑閭鍦板潃\", trigger: [\"blur\", \"change\"] }],\r\n    phone: [{ pattern: /^1[3|4|5|6|7|8|9][0-9]\\d{8}$/, message: \"璇疯緭鍏ユ纭殑鎵嬫満鍙风爜\", trigger: \"blur\" }]\r\n  },\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ閮ㄩ棬鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listDept(queryParams.value).then(response => {\r\n    deptList.value = proxy.handleTree(response.data, \"deptId\")\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    deptId: undefined,\r\n    parentId: undefined,\r\n    deptName: undefined,\r\n    orderNum: 0,\r\n    leader: undefined,\r\n    phone: undefined,\r\n    email: undefined,\r\n    status: \"0\"\r\n  }\r\n  proxy.resetForm(\"deptRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd(row) {\r\n  reset()\r\n  listDept().then(response => {\r\n    deptOptions.value = proxy.handleTree(response.data, \"deptId\")\r\n  })\r\n  if (row != undefined) {\r\n    form.value.parentId = row.deptId\r\n  }\r\n  open.value = true\r\n  title.value = \"娣诲姞閮ㄩ棬\"\r\n}\r\n\r\n/** 灞曞紑/鎶樺彔鎿嶄綔 */\r\nfunction toggleExpandAll() {\r\n  refreshTable.value = false\r\n  isExpandAll.value = !isExpandAll.value\r\n  nextTick(() => {\r\n    refreshTable.value = true\r\n  })\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  listDeptExcludeChild(row.deptId).then(response => {\r\n    deptOptions.value = proxy.handleTree(response.data, \"deptId\")\r\n  })\r\n  getDept(row.deptId).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼閮ㄩ棬\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"deptRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.deptId != undefined) {\r\n        updateDept(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addDept(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎鍚嶇О涓篭"' + row.deptName + '\"鐨勬暟鎹」?').then(function() {\r\n    return delDept(row.deptId)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\dict\\data.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":323,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":323,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":330,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":330,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n         <el-form-item label=\"瀛楀吀鍚嶇О\" prop=\"dictType\">\r\n            <el-select v-model=\"queryParams.dictType\" style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"item in typeOptions\"\r\n                  :key=\"item.dictId\"\r\n                  :label=\"item.dictName\"\r\n                  :value=\"item.dictType\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"瀛楀吀鏍囩\" prop=\"dictLabel\">\r\n            <el-input\r\n               v-model=\"queryParams.dictLabel\"\r\n               placeholder=\"璇疯緭鍏ュ瓧鍏告爣绛綷"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select v-model=\"queryParams.status\" placeholder=\"鏁版嵁鐘舵€乗" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_normal_disable\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:dict:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:dict:edit']\"\r\n            >淇敼</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:dict:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['system:dict:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Close\"\r\n               @click=\"handleClose\"\r\n            >鍏抽棴</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"dataList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"瀛楀吀缂栫爜\" align=\"center\" prop=\"dictCode\" />\r\n         <el-table-column label=\"瀛楀吀鏍囩\" align=\"center\" prop=\"dictLabel\">\r\n            <template #default=\"scope\">\r\n               <span v-if=\"(scope.row.listClass == '' || scope.row.listClass == 'default') && (scope.row.cssClass == '' || scope.row.cssClass == null)\">{{ scope.row.dictLabel }}</span>\r\n               <el-tag v-else :type=\"scope.row.listClass == 'primary' ? '' : scope.row.listClass\" :class=\"scope.row.cssClass\">{{ scope.row.dictLabel }}</el-tag>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"瀛楀吀閿€糪" align=\"center\" prop=\"dictValue\" />\r\n         <el-table-column label=\"瀛楀吀鎺掑簭\" align=\"center\" prop=\"dictSort\" />\r\n         <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"澶囨敞\" align=\"center\" prop=\"remark\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" width=\"160\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:dict:edit']\">淇敼</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:dict:remove']\">鍒犻櫎</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀瑰弬鏁伴厤缃璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"500px\" append-to-body>\r\n         <el-form ref=\"dataRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-form-item label=\"瀛楀吀绫诲瀷\">\r\n               <el-input v-model=\"form.dictType\" :disabled=\"true\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鏁版嵁鏍囩\" prop=\"dictLabel\">\r\n               <el-input v-model=\"form.dictLabel\" placeholder=\"璇疯緭鍏ユ暟鎹爣绛綷" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鏁版嵁閿€糪" prop=\"dictValue\">\r\n               <el-input v-model=\"form.dictValue\" placeholder=\"璇疯緭鍏ユ暟鎹敭鍊糪" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鏍峰紡灞炴€" prop=\"cssClass\">\r\n               <el-input v-model=\"form.cssClass\" placeholder=\"璇疯緭鍏ユ牱寮忓睘鎬" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鏄剧ず鎺掑簭\" prop=\"dictSort\">\r\n               <el-input-number v-model=\"form.dictSort\" controls-position=\"right\" :min=\"0\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鍥炴樉鏍峰紡\" prop=\"listClass\">\r\n               <el-select v-model=\"form.listClass\">\r\n                  <el-option\r\n                     v-for=\"item in listClassOptions\"\r\n                     :key=\"item.value\"\r\n                     :label=\"item.label + '(' + item.value + ')'\"\r\n                     :value=\"item.value\"\r\n                  ></el-option>\r\n               </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n               <el-radio-group v-model=\"form.status\">\r\n                  <el-radio\r\n                     v-for=\"dict in sys_normal_disable\"\r\n                     :key=\"dict.value\"\r\n                     :value=\"dict.value\"\r\n                  >{{ dict.label }}</el-radio>\r\n               </el-radio-group>\r\n            </el-form-item>\r\n            <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n               <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ唴瀹筡"></el-input>\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Data\">\r\nimport useDictStore from '@/store/modules/dict'\r\nimport { optionselect as getDictOptionselect, getType } from \"@/api/system/dict/type\"\r\nimport { listData, getData, delData, addData, updateData } from \"@/api/system/dict/data\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\")\r\n\r\nconst dataList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst defaultDictType = ref(\"\")\r\nconst typeOptions = ref([])\r\nconst route = useRoute()\r\n// 鏁版嵁鏍囩鍥炴樉鏍峰紡\r\nconst listClassOptions = ref([\r\n  { value: \"default\", label: \"榛樿\" }, \r\n  { value: \"primary\", label: \"涓昏\" }, \r\n  { value: \"success\", label: \"鎴愬姛\" },\r\n  { value: \"info\", label: \"淇℃伅\" },\r\n  { value: \"warning\", label: \"璀﹀憡\" },\r\n  { value: \"danger\", label: \"鍗遍櫓\" }\r\n])\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    dictType: undefined,\r\n    dictLabel: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    dictLabel: [{ required: true, message: \"鏁版嵁鏍囩涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    dictValue: [{ required: true, message: \"鏁版嵁閿€间笉鑳戒负绌篭", trigger: \"blur\" }],\r\n    dictSort: [{ required: true, message: \"鏁版嵁椤哄簭涓嶈兘涓虹┖\", trigger: \"blur\" }]\r\n  }\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ瀛楀吀绫诲瀷璇︾粏 */\r\nfunction getTypes(dictId) {\r\n  getType(dictId).then(response => {\r\n    queryParams.value.dictType = response.data.dictType\r\n    defaultDictType.value = response.data.dictType\r\n    getList()\r\n  })\r\n}\r\n\r\n/** 鏌ヨ瀛楀吀绫诲瀷鍒楄〃 */\r\nfunction getTypeList() {\r\n  getDictOptionselect().then(response => {\r\n    typeOptions.value = response.data\r\n  })\r\n}\r\n\r\n/** 鏌ヨ瀛楀吀鏁版嵁鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listData(queryParams.value).then(response => {\r\n    dataList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    dictCode: undefined,\r\n    dictLabel: undefined,\r\n    dictValue: undefined,\r\n    cssClass: undefined,\r\n    listClass: \"default\",\r\n    dictSort: 0,\r\n    status: \"0\",\r\n    remark: undefined\r\n  }\r\n  proxy.resetForm(\"dataRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 杩斿洖鎸夐挳鎿嶄綔 */\r\nfunction handleClose() {\r\n  const obj = { path: \"/system/dict\" }\r\n  proxy.$tab.closeOpenPage(obj)\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\")\r\n  queryParams.value.dictType = defaultDictType.value\r\n  handleQuery()\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  open.value = true\r\n  title.value = \"娣诲姞瀛楀吀鏁版嵁\"\r\n  form.value.dictType = queryParams.value.dictType\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.dictCode)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const dictCode = row.dictCode || ids.value\r\n  getData(dictCode).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼瀛楀吀鏁版嵁\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"dataRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.dictCode != undefined) {\r\n        updateData(form.value).then(response => {\r\n          useDictStore().removeDict(queryParams.value.dictType)\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addData(form.value).then(response => {\r\n          useDictStore().removeDict(queryParams.value.dictType)\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const dictCodes = row.dictCode || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎瀛楀吀缂栫爜涓篭"' + dictCodes + '\"鐨勬暟鎹」锛?).then(function() {\r\n    return delData(dictCodes)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n    useDictStore().removeDict(queryParams.value.dictType)\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/dict/data/export\", {\r\n    ...queryParams.value\r\n  }, `dict_data_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\ngetTypes(route.params && route.params.dictId)\r\ngetTypeList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\dict\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":280,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":280,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":286,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":286,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n         <el-form-item label=\"瀛楀吀鍚嶇О\" prop=\"dictName\">\r\n            <el-input\r\n               v-model=\"queryParams.dictName\"\r\n               placeholder=\"璇疯緭鍏ュ瓧鍏稿悕绉癨"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"瀛楀吀绫诲瀷\" prop=\"dictType\">\r\n            <el-input\r\n               v-model=\"queryParams.dictType\"\r\n               placeholder=\"璇疯緭鍏ュ瓧鍏哥被鍨媆"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select\r\n               v-model=\"queryParams.status\"\r\n               placeholder=\"瀛楀吀鐘舵€乗"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_normal_disable\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鍒涘缓鏃堕棿\" style=\"width: 308px\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"寮€濮嬫棩鏈焅"\r\n               end-placeholder=\"缁撴潫鏃ユ湡\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:dict:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:dict:edit']\"\r\n            >淇敼</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:dict:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['system:dict:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Refresh\"\r\n               @click=\"handleRefreshCache\"\r\n               v-hasPermi=\"['system:dict:remove']\"\r\n            >鍒锋柊缂撳瓨</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"typeList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"瀛楀吀缂栧彿\" align=\"center\" prop=\"dictId\" />\r\n         <el-table-column label=\"瀛楀吀鍚嶇О\" align=\"center\" prop=\"dictName\" :show-overflow-tooltip=\"true\"/>\r\n         <el-table-column label=\"瀛楀吀绫诲瀷\" align=\"center\" :show-overflow-tooltip=\"true\">\r\n            <template #default=\"scope\">\r\n               <router-link :to=\"'/system/dict-data/index/' + scope.row.dictId\" class=\"link-type\">\r\n                  <span>{{ scope.row.dictType }}</span>\r\n               </router-link>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"澶囨敞\" align=\"center\" prop=\"remark\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" width=\"160\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:dict:edit']\">淇敼</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:dict:remove']\">鍒犻櫎</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀瑰弬鏁伴厤缃璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"500px\" append-to-body>\r\n         <el-form ref=\"dictRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-form-item label=\"瀛楀吀鍚嶇О\" prop=\"dictName\">\r\n               <el-input v-model=\"form.dictName\" placeholder=\"璇疯緭鍏ュ瓧鍏稿悕绉癨" />\r\n            </el-form-item>\r\n            <el-form-item label=\"瀛楀吀绫诲瀷\" prop=\"dictType\">\r\n               <el-input v-model=\"form.dictType\" placeholder=\"璇疯緭鍏ュ瓧鍏哥被鍨媆" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n               <el-radio-group v-model=\"form.status\">\r\n                  <el-radio\r\n                     v-for=\"dict in sys_normal_disable\"\r\n                     :key=\"dict.value\"\r\n                     :value=\"dict.value\"\r\n                  >{{ dict.label }}</el-radio>\r\n               </el-radio-group>\r\n            </el-form-item>\r\n            <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n               <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ唴瀹筡"></el-input>\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Dict\">\r\nimport useDictStore from '@/store/modules/dict'\r\nimport { listType, getType, delType, addType, updateType, refreshCache } from \"@/api/system/dict/type\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\")\r\n\r\nconst typeList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst dateRange = ref([])\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    dictName: undefined,\r\n    dictType: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    dictName: [{ required: true, message: \"瀛楀吀鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    dictType: [{ required: true, message: \"瀛楀吀绫诲瀷涓嶈兘涓虹┖\", trigger: \"blur\" }]\r\n  },\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ瀛楀吀绫诲瀷鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listType(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    typeList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    dictId: undefined,\r\n    dictName: undefined,\r\n    dictType: undefined,\r\n    status: \"0\",\r\n    remark: undefined\r\n  }\r\n  proxy.resetForm(\"dictRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  open.value = true\r\n  title.value = \"娣诲姞瀛楀吀绫诲瀷\"\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.dictId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const dictId = row.dictId || ids.value\r\n  getType(dictId).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼瀛楀吀绫诲瀷\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"dictRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.dictId != undefined) {\r\n        updateType(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addType(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const dictIds = row.dictId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎瀛楀吀缂栧彿涓篭"' + dictIds + '\"鐨勬暟鎹」锛?).then(function() {\r\n    return delType(dictIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/dict/type/export\", {\r\n    ...queryParams.value\r\n  }, `dict_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/** 鍒锋柊缂撳瓨鎸夐挳鎿嶄綔 */\r\nfunction handleRefreshCache() {\r\n  refreshCache().then(() => {\r\n    proxy.$modal.msgSuccess(\"鍒锋柊鎴愬姛\")\r\n    useDictStore().cleanDict()\r\n  })\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\menu\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":425,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":425,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":431,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":431,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n         <el-form-item label=\"鑿滃崟鍚嶇О\" prop=\"menuName\">\r\n            <el-input\r\n               v-model=\"queryParams.menuName\"\r\n               placeholder=\"璇疯緭鍏ヨ彍鍗曞悕绉癨"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select v-model=\"queryParams.status\" placeholder=\"鑿滃崟鐘舵€乗" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_normal_disable\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:menu:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button \r\n               type=\"info\"\r\n               plain\r\n               icon=\"Sort\"\r\n               @click=\"toggleExpandAll\"\r\n            >灞曞紑/鎶樺彔</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table\r\n         v-if=\"refreshTable\"\r\n         v-loading=\"loading\"\r\n         :data=\"menuList\"\r\n         row-key=\"menuId\"\r\n         :default-expand-all=\"isExpandAll\"\r\n         :tree-props=\"{ children: 'children', hasChildren: 'hasChildren' }\"\r\n      >\r\n         <el-table-column prop=\"menuName\" label=\"鑿滃崟鍚嶇О\" :show-overflow-tooltip=\"true\" width=\"160\"></el-table-column>\r\n         <el-table-column prop=\"icon\" label=\"鍥炬爣\" align=\"center\" width=\"100\">\r\n            <template #default=\"scope\">\r\n               <svg-icon :icon-class=\"scope.row.icon\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column prop=\"orderNum\" label=\"鎺掑簭\" width=\"60\"></el-table-column>\r\n         <el-table-column prop=\"perms\" label=\"鏉冮檺鏍囪瘑\" :show-overflow-tooltip=\"true\"></el-table-column>\r\n         <el-table-column prop=\"component\" label=\"缁勪欢璺緞\" :show-overflow-tooltip=\"true\"></el-table-column>\r\n         <el-table-column prop=\"status\" label=\"鐘舵€乗" width=\"80\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" width=\"160\" prop=\"createTime\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" width=\"210\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:menu:edit']\">淇敼</el-button>\r\n               <el-button link type=\"primary\" icon=\"Plus\" @click=\"handleAdd(scope.row)\" v-hasPermi=\"['system:menu:add']\">鏂板</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:menu:remove']\">鍒犻櫎</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀硅彍鍗曞璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"680px\" append-to-body>\r\n         <el-form ref=\"menuRef\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\r\n            <el-row>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"涓婄骇鑿滃崟\">\r\n                     <el-tree-select\r\n                        v-model=\"form.parentId\"\r\n                        :data=\"menuOptions\"\r\n                        :props=\"{ value: 'menuId', label: 'menuName', children: 'children' }\"\r\n                        value-key=\"menuId\"\r\n                        placeholder=\"閫夋嫨涓婄骇鑿滃崟\"\r\n                        check-strictly\r\n                     />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"鑿滃崟绫诲瀷\" prop=\"menuType\">\r\n                     <el-radio-group v-model=\"form.menuType\">\r\n                        <el-radio value=\"M\">鐩綍</el-radio>\r\n                        <el-radio value=\"C\">鑿滃崟</el-radio>\r\n                        <el-radio value=\"F\">鎸夐挳</el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType != 'F'\">\r\n                  <el-form-item label=\"鑿滃崟鍥炬爣\" prop=\"icon\">\r\n                     <el-popover\r\n                        placement=\"bottom-start\"\r\n                        :width=\"540\"\r\n                        trigger=\"click\"\r\n                     >\r\n                        <template #reference>\r\n                           <el-input v-model=\"form.icon\" placeholder=\"鐐瑰嚮閫夋嫨鍥炬爣\" @blur=\"showSelectIcon\" readonly>\r\n                              <template #prefix>\r\n                                 <svg-icon\r\n                                    v-if=\"form.icon\"\r\n                                    :icon-class=\"form.icon\"\r\n                                    class=\"el-input__icon\"\r\n                                    style=\"height: 32px;width: 16px;\"\r\n                                 />\r\n                                 <el-icon v-else style=\"height: 32px;width: 16px;\"><search /></el-icon>\r\n                              </template>\r\n                           </el-input>\r\n                        </template>\r\n                        <icon-select ref=\"iconSelectRef\" @selected=\"selected\" :active-icon=\"form.icon\" />\r\n                     </el-popover>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鏄剧ず鎺掑簭\" prop=\"orderNum\">\r\n                     <el-input-number v-model=\"form.orderNum\" controls-position=\"right\" :min=\"0\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鑿滃崟鍚嶇О\" prop=\"menuName\">\r\n                     <el-input v-model=\"form.menuName\" placeholder=\"璇疯緭鍏ヨ彍鍗曞悕绉癨" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType == 'C'\">\r\n                  <el-form-item prop=\"routeName\">\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"榛樿涓嶅～鍒欏拰璺敱鍦板潃鐩稿悓锛氬鍦板潃涓猴細`user`锛屽垯鍚嶇О涓篳User`锛堟敞鎰忥細鍥犱负router浼氬垹闄ゅ悕绉扮浉鍚岃矾鐢憋紝涓洪伩鍏嶅悕瀛楃殑鍐茬獊锛岀壒娈婃儏鍐典笅璇疯嚜瀹氫箟锛屼繚璇佸敮涓€鎬э級\" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           璺敱鍚嶇О\r\n                        </span>\r\n                     </template>\r\n                     <el-input v-model=\"form.routeName\" placeholder=\"璇疯緭鍏ヨ矾鐢卞悕绉癨" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType != 'F'\">\r\n                  <el-form-item>\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"閫夋嫨鏄閾惧垯璺敱鍦板潃闇€瑕佷互`http(s)://`寮€澶碶" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>鏄惁澶栭摼\r\n                        </span>\r\n                     </template>\r\n                     <el-radio-group v-model=\"form.isFrame\">\r\n                        <el-radio value=\"0\">鏄?/el-radio>\r\n                        <el-radio value=\"1\">鍚?/el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType != 'F'\">\r\n                  <el-form-item prop=\"path\">\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"璁块棶鐨勮矾鐢卞湴鍧€锛屽锛歚user`锛屽澶栫綉鍦板潃闇€鍐呴摼璁块棶鍒欎互`http(s)://`寮€澶碶" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           璺敱鍦板潃\r\n                        </span>\r\n                     </template>\r\n                     <el-input v-model=\"form.path\" placeholder=\"璇疯緭鍏ヨ矾鐢卞湴鍧€\" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType == 'C'\">\r\n                  <el-form-item prop=\"component\">\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"璁块棶鐨勭粍浠惰矾寰勶紝濡傦細`system/user/index`锛岄粯璁ゅ湪`views`鐩綍涓媆" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           缁勪欢璺緞\r\n                        </span>\r\n                     </template>\r\n                     <el-input v-model=\"form.component\" placeholder=\"璇疯緭鍏ョ粍浠惰矾寰刓" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType != 'M'\">\r\n                  <el-form-item>\r\n                     <el-input v-model=\"form.perms\" placeholder=\"璇疯緭鍏ユ潈闄愭爣璇哱" maxlength=\"100\" />\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"鎺у埗鍣ㄤ腑瀹氫箟鐨勬潈闄愬瓧绗︼紝濡傦細@PreAuthorize(`@ss.hasPermi('system:user:list')`)\" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           鏉冮檺瀛楃\r\n                        </span>\r\n                     </template>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType == 'C'\">\r\n                  <el-form-item>\r\n                     <el-input v-model=\"form.query\" placeholder=\"璇疯緭鍏ヨ矾鐢卞弬鏁癨" maxlength=\"255\" />\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content='璁块棶璺敱鐨勯粯璁や紶閫掑弬鏁帮紝濡傦細`{\"id\": 1, \"name\": \"ry\"}`' placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           璺敱鍙傛暟\r\n                        </span>\r\n                     </template>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType == 'C'\">\r\n                  <el-form-item>\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"閫夋嫨鏄垯浼氳`keep-alive`缂撳瓨锛岄渶瑕佸尮閰嶇粍浠剁殑`name`鍜屽湴鍧€淇濇寔涓€鑷碶" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           鏄惁缂撳瓨\r\n                        </span>\r\n                     </template>\r\n                     <el-radio-group v-model=\"form.isCache\">\r\n                        <el-radio value=\"0\">缂撳瓨</el-radio>\r\n                        <el-radio value=\"1\">涓嶇紦瀛?/el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\" v-if=\"form.menuType != 'F'\">\r\n                  <el-form-item>\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"閫夋嫨闅愯棌鍒欒矾鐢卞皢涓嶄細鍑虹幇鍦ㄤ晶杈规爮锛屼絾浠嶇劧鍙互璁块棶\" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           鏄剧ず鐘舵€乗r\n                        </span>\r\n                     </template>\r\n                     <el-radio-group v-model=\"form.visible\">\r\n                        <el-radio\r\n                           v-for=\"dict in sys_show_hide\"\r\n                           :key=\"dict.value\"\r\n                           :value=\"dict.value\"\r\n                        >{{ dict.label }}</el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item>\r\n                     <template #label>\r\n                        <span>\r\n                           <el-tooltip content=\"閫夋嫨鍋滅敤鍒欒矾鐢卞皢涓嶄細鍑虹幇鍦ㄤ晶杈规爮锛屼篃涓嶈兘琚闂甛" placement=\"top\">\r\n                              <el-icon><question-filled /></el-icon>\r\n                           </el-tooltip>\r\n                           鑿滃崟鐘舵€乗r\n                        </span>\r\n                     </template>\r\n                     <el-radio-group v-model=\"form.status\">\r\n                        <el-radio\r\n                           v-for=\"dict in sys_normal_disable\"\r\n                           :key=\"dict.value\"\r\n                           :value=\"dict.value\"\r\n                        >{{ dict.label }}</el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Menu\">\r\nimport { addMenu, delMenu, getMenu, listMenu, updateMenu } from \"@/api/system/menu\"\r\nimport SvgIcon from \"@/components/SvgIcon\"\r\nimport IconSelect from \"@/components/IconSelect\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_show_hide, sys_normal_disable } = proxy.useDict(\"sys_show_hide\", \"sys_normal_disable\")\r\n\r\nconst menuList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst title = ref(\"\")\r\nconst menuOptions = ref([])\r\nconst isExpandAll = ref(false)\r\nconst refreshTable = ref(true)\r\nconst iconSelectRef = ref(null)\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    menuName: undefined,\r\n    visible: undefined\r\n  },\r\n  rules: {\r\n    menuName: [{ required: true, message: \"鑿滃崟鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    orderNum: [{ required: true, message: \"鑿滃崟椤哄簭涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    path: [{ required: true, message: \"璺敱鍦板潃涓嶈兘涓虹┖\", trigger: \"blur\" }]\r\n  },\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ鑿滃崟鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listMenu(queryParams.value).then(response => {\r\n    menuList.value = proxy.handleTree(response.data, \"menuId\")\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鏌ヨ鑿滃崟涓嬫媺鏍戠粨鏋?*/\r\nfunction getTreeselect() {\r\n  menuOptions.value = []\r\n  listMenu().then(response => {\r\n    const menu = { menuId: 0, menuName: \"涓荤被鐩甛", children: [] }\r\n    menu.children = proxy.handleTree(response.data, \"menuId\")\r\n    menuOptions.value.push(menu)\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    menuId: undefined,\r\n    parentId: 0,\r\n    menuName: undefined,\r\n    icon: undefined,\r\n    menuType: \"M\",\r\n    orderNum: undefined,\r\n    isFrame: \"1\",\r\n    isCache: \"0\",\r\n    visible: \"0\",\r\n    status: \"0\"\r\n  }\r\n  proxy.resetForm(\"menuRef\")\r\n}\r\n\r\n/** 灞曠ず涓嬫媺鍥炬爣 */\r\nfunction showSelectIcon() {\r\n  iconSelectRef.value.reset()\r\n}\r\n\r\n/** 閫夋嫨鍥炬爣 */\r\nfunction selected(name) {\r\n  form.value.icon = name\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd(row) {\r\n  reset()\r\n  getTreeselect()\r\n  if (row != null && row.menuId) {\r\n    form.value.parentId = row.menuId\r\n  } else {\r\n    form.value.parentId = 0\r\n  }\r\n  open.value = true\r\n  title.value = \"娣诲姞鑿滃崟\"\r\n}\r\n\r\n/** 灞曞紑/鎶樺彔鎿嶄綔 */\r\nfunction toggleExpandAll() {\r\n  refreshTable.value = false\r\n  isExpandAll.value = !isExpandAll.value\r\n  nextTick(() => {\r\n    refreshTable.value = true\r\n  })\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nasync function handleUpdate(row) {\r\n  reset()\r\n  await getTreeselect()\r\n  getMenu(row.menuId).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼鑿滃崟\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"menuRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.menuId != undefined) {\r\n        updateMenu(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addMenu(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎鍚嶇О涓篭"' + row.menuName + '\"鐨勬暟鎹」?').then(function() {\r\n    return delMenu(row.menuId)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\notice\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":264,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":264,"endColumn":47},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":270,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":270,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n         <el-form-item label=\"鍏憡鏍囬\" prop=\"noticeTitle\">\r\n            <el-input\r\n               v-model=\"queryParams.noticeTitle\"\r\n               placeholder=\"璇疯緭鍏ュ叕鍛婃爣棰榎"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鎿嶄綔浜哄憳\" prop=\"createBy\">\r\n            <el-input\r\n               v-model=\"queryParams.createBy\"\r\n               placeholder=\"璇疯緭鍏ユ搷浣滀汉鍛榎"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"绫诲瀷\" prop=\"noticeType\">\r\n            <el-select v-model=\"queryParams.noticeType\" placeholder=\"鍏憡绫诲瀷\" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_notice_type\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:notice:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:notice:edit']\"\r\n            >淇敼</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:notice:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"noticeList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"搴忓彿\" align=\"center\" prop=\"noticeId\" width=\"100\" />\r\n         <el-table-column\r\n            label=\"鍏憡鏍囬\"\r\n            align=\"center\"\r\n            prop=\"noticeTitle\"\r\n            :show-overflow-tooltip=\"true\"\r\n         />\r\n         <el-table-column label=\"鍏憡绫诲瀷\" align=\"center\" prop=\"noticeType\" width=\"100\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_notice_type\" :value=\"scope.row.noticeType\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"status\" width=\"100\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_notice_status\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鍒涘缓鑰匼" align=\"center\" prop=\"createBy\" width=\"100\" />\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"100\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime, '{y}-{m}-{d}') }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:notice:edit']\">淇敼</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:notice:remove']\" >鍒犻櫎</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀瑰叕鍛婂璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"780px\" append-to-body>\r\n         <el-form ref=\"noticeRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-row>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鍏憡鏍囬\" prop=\"noticeTitle\">\r\n                     <el-input v-model=\"form.noticeTitle\" placeholder=\"璇疯緭鍏ュ叕鍛婃爣棰榎" />\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"12\">\r\n                  <el-form-item label=\"鍏憡绫诲瀷\" prop=\"noticeType\">\r\n                     <el-select v-model=\"form.noticeType\" placeholder=\"璇烽€夋嫨\">\r\n                        <el-option\r\n                           v-for=\"dict in sys_notice_type\"\r\n                           :key=\"dict.value\"\r\n                           :label=\"dict.label\"\r\n                           :value=\"dict.value\"\r\n                        ></el-option>\r\n                     </el-select>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"鐘舵€乗">\r\n                     <el-radio-group v-model=\"form.status\">\r\n                        <el-radio\r\n                           v-for=\"dict in sys_notice_status\"\r\n                           :key=\"dict.value\"\r\n                           :value=\"dict.value\"\r\n                        >{{ dict.label }}</el-radio>\r\n                     </el-radio-group>\r\n                  </el-form-item>\r\n               </el-col>\r\n               <el-col :span=\"24\">\r\n                  <el-form-item label=\"鍐呭\">\r\n                    <editor v-model=\"form.noticeContent\" :min-height=\"192\"/>\r\n                  </el-form-item>\r\n               </el-col>\r\n            </el-row>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Notice\">\r\nimport { listNotice, getNotice, delNotice, addNotice, updateNotice } from \"@/api/system/notice\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_notice_status, sys_notice_type } = proxy.useDict(\"sys_notice_status\", \"sys_notice_type\")\r\n\r\nconst noticeList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    noticeTitle: undefined,\r\n    createBy: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    noticeTitle: [{ required: true, message: \"鍏憡鏍囬涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    noticeType: [{ required: true, message: \"鍏憡绫诲瀷涓嶈兘涓虹┖\", trigger: \"change\" }]\r\n  },\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ鍏憡鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listNotice(queryParams.value).then(response => {\r\n    noticeList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    noticeId: undefined,\r\n    noticeTitle: undefined,\r\n    noticeType: undefined,\r\n    noticeContent: undefined,\r\n    status: \"0\"\r\n  }\r\n  proxy.resetForm(\"noticeRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.noticeId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  open.value = true\r\n  title.value = \"娣诲姞鍏憡\"\r\n}\r\n\r\n/**淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const noticeId = row.noticeId || ids.value\r\n  getNotice(noticeId).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼鍏憡\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"noticeRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.noticeId != undefined) {\r\n        updateNotice(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addNotice(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const noticeIds = row.noticeId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎鍏憡缂栧彿涓篭"' + noticeIds + '\"鐨勬暟鎹」锛?).then(function() {\r\n    return delNotice(noticeIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\post\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":252,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":252,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":258,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":258,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n         <el-form-item label=\"宀椾綅缂栫爜\" prop=\"postCode\">\r\n            <el-input\r\n               v-model=\"queryParams.postCode\"\r\n               placeholder=\"璇疯緭鍏ュ矖浣嶇紪鐮乗"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"宀椾綅鍚嶇О\" prop=\"postName\">\r\n            <el-input\r\n               v-model=\"queryParams.postName\"\r\n               placeholder=\"璇疯緭鍏ュ矖浣嶅悕绉癨"\r\n               clearable\r\n               style=\"width: 200px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select v-model=\"queryParams.status\" placeholder=\"宀椾綅鐘舵€乗" clearable style=\"width: 200px\">\r\n               <el-option\r\n                  v-for=\"dict in sys_normal_disable\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:post:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:post:edit']\"\r\n            >淇敼</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:post:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['system:post:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"postList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"宀椾綅缂栧彿\" align=\"center\" prop=\"postId\" />\r\n         <el-table-column label=\"宀椾綅缂栫爜\" align=\"center\" prop=\"postCode\" />\r\n         <el-table-column label=\"宀椾綅鍚嶇О\" align=\"center\" prop=\"postName\" />\r\n         <el-table-column label=\"宀椾綅鎺掑簭\" align=\"center\" prop=\"postSort\" />\r\n         <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" width=\"180\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:post:edit']\">淇敼</el-button>\r\n               <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:post:remove']\">鍒犻櫎</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀瑰矖浣嶅璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"500px\" append-to-body>\r\n         <el-form ref=\"postRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <el-form-item label=\"宀椾綅鍚嶇О\" prop=\"postName\">\r\n               <el-input v-model=\"form.postName\" placeholder=\"璇疯緭鍏ュ矖浣嶅悕绉癨" />\r\n            </el-form-item>\r\n            <el-form-item label=\"宀椾綅缂栫爜\" prop=\"postCode\">\r\n               <el-input v-model=\"form.postCode\" placeholder=\"璇疯緭鍏ョ紪鐮佸悕绉癨" />\r\n            </el-form-item>\r\n            <el-form-item label=\"宀椾綅椤哄簭\" prop=\"postSort\">\r\n               <el-input-number v-model=\"form.postSort\" controls-position=\"right\" :min=\"0\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"宀椾綅鐘舵€乗" prop=\"status\">\r\n               <el-radio-group v-model=\"form.status\">\r\n                  <el-radio\r\n                     v-for=\"dict in sys_normal_disable\"\r\n                     :key=\"dict.value\"\r\n                     :value=\"dict.value\"\r\n                  >{{ dict.label }}</el-radio>\r\n               </el-radio-group>\r\n            </el-form-item>\r\n            <el-form-item label=\"澶囨敞\" prop=\"remark\">\r\n               <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ唴瀹筡" />\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Post\">\r\nimport { listPost, addPost, delPost, getPost, updatePost } from \"@/api/system/post\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\")\r\n\r\nconst postList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    postCode: undefined,\r\n    postName: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    postName: [{ required: true, message: \"宀椾綅鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    postCode: [{ required: true, message: \"宀椾綅缂栫爜涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    postSort: [{ required: true, message: \"宀椾綅椤哄簭涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n  }\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ宀椾綅鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listPost(queryParams.value).then(response => {\r\n    postList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 琛ㄥ崟閲嶇疆 */\r\nfunction reset() {\r\n  form.value = {\r\n    postId: undefined,\r\n    postCode: undefined,\r\n    postName: undefined,\r\n    postSort: 0,\r\n    status: \"0\",\r\n    remark: undefined\r\n  }\r\n  proxy.resetForm(\"postRef\")\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.postId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  open.value = true\r\n  title.value = \"娣诲姞宀椾綅\"\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const postId = row.postId || ids.value\r\n  getPost(postId).then(response => {\r\n    form.value = response.data\r\n    open.value = true\r\n    title.value = \"淇敼宀椾綅\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"postRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.postId != undefined) {\r\n        updatePost(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addPost(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const postIds = row.postId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎宀椾綅缂栧彿涓篭"' + postIds + '\"鐨勬暟鎹」锛?).then(function() {\r\n    return delPost(postIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/post/export\", {\r\n    ...queryParams.value\r\n  }, `post_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\role\\authUser.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'row' is defined but never used. Allowed unused args must match /^_/u.","line":167,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":167,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" v-show=\"showSearch\" :inline=\"true\">\r\n         <el-form-item label=\"鐢ㄦ埛鍚嶇О\" prop=\"userName\">\r\n            <el-input\r\n               v-model=\"queryParams.userName\"\r\n               placeholder=\"璇疯緭鍏ョ敤鎴峰悕绉癨"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鎵嬫満鍙风爜\" prop=\"phonenumber\">\r\n            <el-input\r\n               v-model=\"queryParams.phonenumber\"\r\n               placeholder=\"璇疯緭鍏ユ墜鏈哄彿鐮乗"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"openSelectUser\"\r\n               v-hasPermi=\"['system:role:add']\"\r\n            >娣诲姞鐢ㄦ埛</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"CircleClose\"\r\n               :disabled=\"multiple\"\r\n               @click=\"cancelAuthUserAll\"\r\n               v-hasPermi=\"['system:role:remove']\"\r\n            >鎵归噺鍙栨秷鎺堟潈</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button \r\n               type=\"warning\" \r\n               plain \r\n               icon=\"Close\"\r\n               @click=\"handleClose\"\r\n            >鍏抽棴</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <el-table v-loading=\"loading\" :data=\"userList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"鐢ㄦ埛鍚嶇О\" prop=\"userName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鐢ㄦ埛鏄电О\" prop=\"nickName\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"閭\" prop=\"email\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鎵嬫満\" prop=\"phonenumber\" :show-overflow-tooltip=\"true\" />\r\n         <el-table-column label=\"鐘舵€乗" align=\"center\" prop=\"status\">\r\n            <template #default=\"scope\">\r\n               <dict-tag :options=\"sys_normal_disable\" :value=\"scope.row.status\" />\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n               <el-button link type=\"primary\" icon=\"CircleClose\" @click=\"cancelAuthUser(scope.row)\" v-hasPermi=\"['system:role:remove']\">鍙栨秷鎺堟潈</el-button>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n      <select-user ref=\"selectRef\" :roleId=\"queryParams.roleId\" @ok=\"handleQuery\" />\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"AuthUser\">\r\nimport selectUser from \"./selectUser\"\r\nimport { allocatedUserList, authUserCancel, authUserCancelAll } from \"@/api/system/role\"\r\n\r\nconst route = useRoute()\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\")\r\n\r\nconst userList = ref([])\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst userIds = ref([])\r\n\r\nconst queryParams = reactive({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  roleId: route.params.roleId,\r\n  userName: undefined,\r\n  phonenumber: undefined,\r\n})\r\n\r\n/** 鏌ヨ鎺堟潈鐢ㄦ埛鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  allocatedUserList(queryParams).then(response => {\r\n    userList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 杩斿洖鎸夐挳 */\r\nfunction handleClose() {\r\n  const obj = { path: \"/system/role\" }\r\n  proxy.$tab.closeOpenPage(obj)\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  userIds.value = selection.map(item => item.userId)\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 鎵撳紑鎺堟潈鐢ㄦ埛琛ㄥ脊绐?*/\r\nfunction openSelectUser() {\r\n  proxy.$refs[\"selectRef\"].show()\r\n}\r\n\r\n/** 鍙栨秷鎺堟潈鎸夐挳鎿嶄綔 */\r\nfunction cancelAuthUser(row) {\r\n  proxy.$modal.confirm('纭瑕佸彇娑堣鐢ㄦ埛\"' + row.userName + '\"瑙掕壊鍚楋紵').then(function () {\r\n    return authUserCancel({ userId: row.userId, roleId: queryParams.roleId })\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍙栨秷鎺堟潈鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 鎵归噺鍙栨秷鎺堟潈鎸夐挳鎿嶄綔 */\r\nfunction cancelAuthUserAll(row) {\r\n  const roleId = queryParams.roleId\r\n  const uIds = userIds.value.join(\",\")\r\n  proxy.$modal.confirm(\"鏄惁鍙栨秷閫変腑鐢ㄦ埛鎺堟潈鏁版嵁椤?\").then(function () {\r\n    return authUserCancelAll({ roleId: roleId, userIds: uIds })\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍙栨秷鎺堟潈鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\role\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'handleCommand' is defined but never used. Allowed unused vars must match /^_/u.","line":360,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":360,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":515,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":515,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":522,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":522,"endColumn":42},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":569,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":569,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <el-form :model=\"queryParams\" ref=\"queryRef\" v-show=\"showSearch\" :inline=\"true\" label-width=\"68px\">\r\n         <el-form-item label=\"瑙掕壊鍚嶇О\" prop=\"roleName\">\r\n            <el-input\r\n               v-model=\"queryParams.roleName\"\r\n               placeholder=\"璇疯緭鍏ヨ鑹插悕绉癨"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鏉冮檺瀛楃\" prop=\"roleKey\">\r\n            <el-input\r\n               v-model=\"queryParams.roleKey\"\r\n               placeholder=\"璇疯緭鍏ユ潈闄愬瓧绗"\r\n               clearable\r\n               style=\"width: 240px\"\r\n               @keyup.enter=\"handleQuery\"\r\n            />\r\n         </el-form-item>\r\n         <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n            <el-select\r\n               v-model=\"queryParams.status\"\r\n               placeholder=\"瑙掕壊鐘舵€乗"\r\n               clearable\r\n               style=\"width: 240px\"\r\n            >\r\n               <el-option\r\n                  v-for=\"dict in sys_normal_disable\"\r\n                  :key=\"dict.value\"\r\n                  :label=\"dict.label\"\r\n                  :value=\"dict.value\"\r\n               />\r\n            </el-select>\r\n         </el-form-item>\r\n         <el-form-item label=\"鍒涘缓鏃堕棿\" style=\"width: 308px\">\r\n            <el-date-picker\r\n               v-model=\"dateRange\"\r\n               value-format=\"YYYY-MM-DD\"\r\n               type=\"daterange\"\r\n               range-separator=\"-\"\r\n               start-placeholder=\"寮€濮嬫棩鏈焅"\r\n               end-placeholder=\"缁撴潫鏃ユ湡\"\r\n            ></el-date-picker>\r\n         </el-form-item>\r\n         <el-form-item>\r\n            <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n            <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n         </el-form-item>\r\n      </el-form>\r\n      <el-row :gutter=\"10\" class=\"mb8\">\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"primary\"\r\n               plain\r\n               icon=\"Plus\"\r\n               @click=\"handleAdd\"\r\n               v-hasPermi=\"['system:role:add']\"\r\n            >鏂板</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"success\"\r\n               plain\r\n               icon=\"Edit\"\r\n               :disabled=\"single\"\r\n               @click=\"handleUpdate\"\r\n               v-hasPermi=\"['system:role:edit']\"\r\n            >淇敼</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"danger\"\r\n               plain\r\n               icon=\"Delete\"\r\n               :disabled=\"multiple\"\r\n               @click=\"handleDelete\"\r\n               v-hasPermi=\"['system:role:remove']\"\r\n            >鍒犻櫎</el-button>\r\n         </el-col>\r\n         <el-col :span=\"1.5\">\r\n            <el-button\r\n               type=\"warning\"\r\n               plain\r\n               icon=\"Download\"\r\n               @click=\"handleExport\"\r\n               v-hasPermi=\"['system:role:export']\"\r\n            >瀵煎嚭</el-button>\r\n         </el-col>\r\n         <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n      </el-row>\r\n\r\n      <!-- 琛ㄦ牸鏁版嵁 -->\r\n      <el-table v-loading=\"loading\" :data=\"roleList\" @selection-change=\"handleSelectionChange\">\r\n         <el-table-column type=\"selection\" width=\"55\" align=\"center\" />\r\n         <el-table-column label=\"瑙掕壊缂栧彿\" prop=\"roleId\" width=\"120\" />\r\n         <el-table-column label=\"瑙掕壊鍚嶇О\" prop=\"roleName\" :show-overflow-tooltip=\"true\" width=\"150\" />\r\n         <el-table-column label=\"鏉冮檺瀛楃\" prop=\"roleKey\" :show-overflow-tooltip=\"true\" width=\"150\" />\r\n         <el-table-column label=\"鏄剧ず椤哄簭\" prop=\"roleSort\" width=\"100\" />\r\n         <el-table-column label=\"鐘舵€乗" align=\"center\" width=\"100\">\r\n            <template #default=\"scope\">\r\n               <el-switch\r\n                  v-model=\"scope.row.status\"\r\n                  active-value=\"0\"\r\n                  inactive-value=\"1\"\r\n                  @change=\"handleStatusChange(scope.row)\"\r\n               ></el-switch>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column label=\"鎿嶄綔\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template #default=\"scope\">\r\n              <el-tooltip content=\"淇敼\" placement=\"top\" v-if=\"scope.row.roleId !== 1\">\r\n                <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\" v-hasPermi=\"['system:role:edit']\"></el-button>\r\n              </el-tooltip>\r\n              <el-tooltip content=\"鍒犻櫎\" placement=\"top\" v-if=\"scope.row.roleId !== 1\">\r\n                <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['system:role:remove']\"></el-button>\r\n              </el-tooltip>\r\n              <el-tooltip content=\"鏁版嵁鏉冮檺\" placement=\"top\" v-if=\"scope.row.roleId !== 1\">\r\n                <el-button link type=\"primary\" icon=\"CircleCheck\" @click=\"handleDataScope(scope.row)\" v-hasPermi=\"['system:role:edit']\"></el-button>\r\n              </el-tooltip>\r\n              <el-tooltip content=\"鍒嗛厤鐢ㄦ埛\" placement=\"top\" v-if=\"scope.row.roleId !== 1\">\r\n                <el-button link type=\"primary\" icon=\"User\" @click=\"handleAuthUser(scope.row)\" v-hasPermi=\"['system:role:edit']\"></el-button>\r\n              </el-tooltip>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination\r\n         v-show=\"total > 0\"\r\n         :total=\"total\"\r\n         v-model:page=\"queryParams.pageNum\"\r\n         v-model:limit=\"queryParams.pageSize\"\r\n         @pagination=\"getList\"\r\n      />\r\n\r\n      <!-- 娣诲姞鎴栦慨鏀硅鑹查厤缃璇濇 -->\r\n      <el-dialog :title=\"title\" v-model=\"open\" width=\"500px\" append-to-body>\r\n         <el-form ref=\"roleRef\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\r\n            <el-form-item label=\"瑙掕壊鍚嶇О\" prop=\"roleName\">\r\n               <el-input v-model=\"form.roleName\" placeholder=\"璇疯緭鍏ヨ鑹插悕绉癨" />\r\n            </el-form-item>\r\n            <el-form-item prop=\"roleKey\">\r\n               <template #label>\r\n                  <span>\r\n                     <el-tooltip content=\"鎺у埗鍣ㄤ腑瀹氫箟鐨勬潈闄愬瓧绗︼紝濡傦細@PreAuthorize(`@ss.hasRole('admin')`)\" placement=\"top\">\r\n                        <el-icon><question-filled /></el-icon>\r\n                     </el-tooltip>\r\n                     鏉冮檺瀛楃\r\n                  </span>\r\n               </template>\r\n               <el-input v-model=\"form.roleKey\" placeholder=\"璇疯緭鍏ユ潈闄愬瓧绗" />\r\n            </el-form-item>\r\n            <el-form-item label=\"瑙掕壊椤哄簭\" prop=\"roleSort\">\r\n               <el-input-number v-model=\"form.roleSort\" controls-position=\"right\" :min=\"0\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鐘舵€乗">\r\n               <el-radio-group v-model=\"form.status\">\r\n                  <el-radio\r\n                     v-for=\"dict in sys_normal_disable\"\r\n                     :key=\"dict.value\"\r\n                     :value=\"dict.value\"\r\n                  >{{ dict.label }}</el-radio>\r\n               </el-radio-group>\r\n            </el-form-item>\r\n            <el-form-item label=\"鑿滃崟鏉冮檺\">\r\n               <el-checkbox v-model=\"menuExpand\" @change=\"handleCheckedTreeExpand($event, 'menu')\">灞曞紑/鎶樺彔</el-checkbox>\r\n               <el-checkbox v-model=\"menuNodeAll\" @change=\"handleCheckedTreeNodeAll($event, 'menu')\">鍏ㄩ€?鍏ㄤ笉閫?/el-checkbox>\r\n               <el-checkbox v-model=\"form.menuCheckStrictly\" @change=\"handleCheckedTreeConnect($event, 'menu')\">鐖跺瓙鑱斿姩</el-checkbox>\r\n               <el-tree\r\n                  class=\"tree-border\"\r\n                  :data=\"menuOptions\"\r\n                  show-checkbox\r\n                  ref=\"menuRef\"\r\n                  node-key=\"id\"\r\n                  :check-strictly=\"!form.menuCheckStrictly\"\r\n                  empty-text=\"鍔犺浇涓紝璇风◢鍊橽"\r\n                  :props=\"{ label: 'label', children: 'children' }\"\r\n               ></el-tree>\r\n            </el-form-item>\r\n            <el-form-item label=\"澶囨敞\">\r\n               <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ唴瀹筡"></el-input>\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n\r\n      <!-- 鍒嗛厤瑙掕壊鏁版嵁鏉冮檺瀵硅瘽妗?-->\r\n      <el-dialog :title=\"title\" v-model=\"openDataScope\" width=\"500px\" append-to-body>\r\n         <el-form :model=\"form\" label-width=\"80px\">\r\n            <el-form-item label=\"瑙掕壊鍚嶇О\">\r\n               <el-input v-model=\"form.roleName\" :disabled=\"true\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鏉冮檺瀛楃\">\r\n               <el-input v-model=\"form.roleKey\" :disabled=\"true\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"鏉冮檺鑼冨洿\">\r\n               <el-select v-model=\"form.dataScope\" @change=\"dataScopeSelectChange\">\r\n                  <el-option\r\n                     v-for=\"item in dataScopeOptions\"\r\n                     :key=\"item.value\"\r\n                     :label=\"item.label\"\r\n                     :value=\"item.value\"\r\n                  ></el-option>\r\n               </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"鏁版嵁鏉冮檺\" v-show=\"form.dataScope == 2\">\r\n               <el-checkbox v-model=\"deptExpand\" @change=\"handleCheckedTreeExpand($event, 'dept')\">灞曞紑/鎶樺彔</el-checkbox>\r\n               <el-checkbox v-model=\"deptNodeAll\" @change=\"handleCheckedTreeNodeAll($event, 'dept')\">鍏ㄩ€?鍏ㄤ笉閫?/el-checkbox>\r\n               <el-checkbox v-model=\"form.deptCheckStrictly\" @change=\"handleCheckedTreeConnect($event, 'dept')\">鐖跺瓙鑱斿姩</el-checkbox>\r\n               <el-tree\r\n                  class=\"tree-border\"\r\n                  :data=\"deptOptions\"\r\n                  show-checkbox\r\n                  default-expand-all\r\n                  ref=\"deptRef\"\r\n                  node-key=\"id\"\r\n                  :check-strictly=\"!form.deptCheckStrictly\"\r\n                  empty-text=\"鍔犺浇涓紝璇风◢鍊橽"\r\n                  :props=\"{ label: 'label', children: 'children' }\"\r\n               ></el-tree>\r\n            </el-form-item>\r\n         </el-form>\r\n         <template #footer>\r\n            <div class=\"dialog-footer\">\r\n               <el-button type=\"primary\" @click=\"submitDataScope\">纭?瀹?/el-button>\r\n               <el-button @click=\"cancelDataScope\">鍙?娑?/el-button>\r\n            </div>\r\n         </template>\r\n      </el-dialog>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"Role\">\r\nimport { addRole, changeRoleStatus, dataScope, delRole, getRole, listRole, updateRole, deptTreeSelect } from \"@/api/system/role\"\r\nimport { roleMenuTreeselect, treeselect as menuTreeselect } from \"@/api/system/menu\"\r\n\r\nconst router = useRouter()\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_normal_disable } = proxy.useDict(\"sys_normal_disable\")\r\n\r\nconst roleList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst dateRange = ref([])\r\nconst menuOptions = ref([])\r\nconst menuExpand = ref(false)\r\nconst menuNodeAll = ref(false)\r\nconst deptExpand = ref(true)\r\nconst deptNodeAll = ref(false)\r\nconst deptOptions = ref([])\r\nconst openDataScope = ref(false)\r\nconst menuRef = ref(null)\r\nconst deptRef = ref(null)\r\n\r\n/** 鏁版嵁鑼冨洿閫夐」*/\r\nconst dataScopeOptions = ref([\r\n  { value: \"1\", label: \"鍏ㄩ儴鏁版嵁鏉冮檺\" },\r\n  { value: \"2\", label: \"鑷畾鏁版嵁鏉冮檺\" },\r\n  { value: \"3\", label: \"鏈儴闂ㄦ暟鎹潈闄怽" },\r\n  { value: \"4\", label: \"鏈儴闂ㄥ強浠ヤ笅鏁版嵁鏉冮檺\" },\r\n  { value: \"5\", label: \"浠呮湰浜烘暟鎹潈闄怽" }\r\n])\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    roleName: undefined,\r\n    roleKey: undefined,\r\n    status: undefined\r\n  },\r\n  rules: {\r\n    roleName: [{ required: true, message: \"瑙掕壊鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    roleKey: [{ required: true, message: \"鏉冮檺瀛楃涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    roleSort: [{ required: true, message: \"瑙掕壊椤哄簭涓嶈兘涓虹┖\", trigger: \"blur\" }]\r\n  },\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 鏌ヨ瑙掕壊鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listRole(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    roleList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  handleQuery()\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const roleIds = row.roleId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎瑙掕壊缂栧彿涓篭"' + roleIds + '\"鐨勬暟鎹」?').then(function () {\r\n    return delRole(roleIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/role/export\", {\r\n    ...queryParams.value,\r\n  }, `role_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.roleId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 瑙掕壊鐘舵€佷慨鏀?*/\r\nfunction handleStatusChange(row) {\r\n  let text = row.status === \"0\" ? \"鍚敤\" : \"鍋滅敤\"\r\n  proxy.$modal.confirm('纭瑕乗"' + text + '\"\"' + row.roleName + '\"瑙掕壊鍚?').then(function () {\r\n    return changeRoleStatus(row.roleId, row.status)\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(text + \"鎴愬姛\")\r\n  }).catch(function () {\r\n    row.status = row.status === \"0\" ? \"1\" : \"0\"\r\n  })\r\n}\r\n\r\n/** 鏇村鎿嶄綔 */\r\nfunction handleCommand(command, row) {\r\n  switch (command) {\r\n    case \"handleDataScope\":\r\n      handleDataScope(row)\r\n      break\r\n    case \"handleAuthUser\":\r\n      handleAuthUser(row)\r\n      break\r\n    default:\r\n      break\r\n  }\r\n}\r\n\r\n/** 鍒嗛厤鐢ㄦ埛 */\r\nfunction handleAuthUser(row) {\r\n  router.push(\"/system/role-auth/user/\" + row.roleId)\r\n}\r\n\r\n/** 鏌ヨ鑿滃崟鏍戠粨鏋?*/\r\nfunction getMenuTreeselect() {\r\n  menuTreeselect().then(response => {\r\n    menuOptions.value = response.data\r\n  })\r\n}\r\n\r\n/** 鎵€鏈夐儴闂ㄨ妭鐐规暟鎹?*/\r\nfunction getDeptAllCheckedKeys() {\r\n  // 鐩墠琚€変腑鐨勯儴闂ㄨ妭鐐筡r\n  let checkedKeys = deptRef.value.getCheckedKeys()\r\n  // 鍗婇€変腑鐨勯儴闂ㄨ妭鐐筡r\n  let halfCheckedKeys = deptRef.value.getHalfCheckedKeys()\r\n  checkedKeys.unshift.apply(checkedKeys, halfCheckedKeys)\r\n  return checkedKeys\r\n}\r\n\r\n/** 閲嶇疆鏂板鐨勮〃鍗曚互鍙婂叾浠栨暟鎹? */\r\nfunction reset() {\r\n  if (menuRef.value != undefined) {\r\n    menuRef.value.setCheckedKeys([])\r\n  }\r\n  menuExpand.value = false\r\n  menuNodeAll.value = false\r\n  deptExpand.value = true\r\n  deptNodeAll.value = false\r\n  form.value = {\r\n    roleId: undefined,\r\n    roleName: undefined,\r\n    roleKey: undefined,\r\n    roleSort: 0,\r\n    status: \"0\",\r\n    menuIds: [],\r\n    deptIds: [],\r\n    menuCheckStrictly: true,\r\n    deptCheckStrictly: true,\r\n    remark: undefined\r\n  }\r\n  proxy.resetForm(\"roleRef\")\r\n}\r\n\r\n/** 娣诲姞瑙掕壊 */\r\nfunction handleAdd() {\r\n  reset()\r\n  getMenuTreeselect()\r\n  open.value = true\r\n  title.value = \"娣诲姞瑙掕壊\"\r\n}\r\n\r\n/** 淇敼瑙掕壊 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const roleId = row.roleId || ids.value\r\n  const roleMenu = getRoleMenuTreeselect(roleId)\r\n  getRole(roleId).then(response => {\r\n    form.value = response.data\r\n    form.value.roleSort = Number(form.value.roleSort)\r\n    open.value = true\r\n    nextTick(() => {\r\n      roleMenu.then((res) => {\r\n        let checkedKeys = res.checkedKeys\r\n        checkedKeys.forEach((v) => {\r\n          nextTick(() => {\r\n            menuRef.value.setChecked(v, true, false)\r\n          })\r\n        })\r\n      })\r\n    })\r\n  })\r\n  title.value = \"淇敼瑙掕壊\"\r\n}\r\n\r\n/** 鏍规嵁瑙掕壊ID鏌ヨ鑿滃崟鏍戠粨鏋?*/\r\nfunction getRoleMenuTreeselect(roleId) {\r\n  return roleMenuTreeselect(roleId).then(response => {\r\n    menuOptions.value = response.menus\r\n    return response\r\n  })\r\n}\r\n\r\n/** 鏍规嵁瑙掕壊ID鏌ヨ閮ㄩ棬鏍戠粨鏋?*/\r\nfunction getDeptTree(roleId) {\r\n  return deptTreeSelect(roleId).then(response => {\r\n    deptOptions.value = response.depts\r\n    return response\r\n  })\r\n}\r\n\r\n/** 鏍戞潈闄愶紙灞曞紑/鎶樺彔锛?/\r\nfunction handleCheckedTreeExpand(value, type) {\r\n  if (type == \"menu\") {\r\n    let treeList = menuOptions.value\r\n    for (let i = 0; i < treeList.length; i++) {\r\n      menuRef.value.store.nodesMap[treeList[i].id].expanded = value\r\n    }\r\n  } else if (type == \"dept\") {\r\n    let treeList = deptOptions.value\r\n    for (let i = 0; i < treeList.length; i++) {\r\n      deptRef.value.store.nodesMap[treeList[i].id].expanded = value\r\n    }\r\n  }\r\n}\r\n\r\n/** 鏍戞潈闄愶紙鍏ㄩ€?鍏ㄤ笉閫夛級 */\r\nfunction handleCheckedTreeNodeAll(value, type) {\r\n  if (type == \"menu\") {\r\n    menuRef.value.setCheckedNodes(value ? menuOptions.value : [])\r\n  } else if (type == \"dept\") {\r\n    deptRef.value.setCheckedNodes(value ? deptOptions.value : [])\r\n  }\r\n}\r\n\r\n/** 鏍戞潈闄愶紙鐖跺瓙鑱斿姩锛?*/\r\nfunction handleCheckedTreeConnect(value, type) {\r\n  if (type == \"menu\") {\r\n    form.value.menuCheckStrictly = value ? true : false\r\n  } else if (type == \"dept\") {\r\n    form.value.deptCheckStrictly = value ? true : false\r\n  }\r\n}\r\n\r\n/** 鎵€鏈夎彍鍗曡妭鐐规暟鎹?*/\r\nfunction getMenuAllCheckedKeys() {\r\n  // 鐩墠琚€変腑鐨勮彍鍗曡妭鐐筡r\n  let checkedKeys = menuRef.value.getCheckedKeys()\r\n  // 鍗婇€変腑鐨勮彍鍗曡妭鐐筡r\n  let halfCheckedKeys = menuRef.value.getHalfCheckedKeys()\r\n  checkedKeys.unshift.apply(checkedKeys, halfCheckedKeys)\r\n  return checkedKeys\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"roleRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.roleId != undefined) {\r\n        form.value.menuIds = getMenuAllCheckedKeys()\r\n        updateRole(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        form.value.menuIds = getMenuAllCheckedKeys()\r\n        addRole(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 閫夋嫨瑙掕壊鏉冮檺鑼冨洿瑙﹀彂 */\r\nfunction dataScopeSelectChange(value) {\r\n  if (value !== \"2\") {\r\n    deptRef.value.setCheckedKeys([])\r\n  }\r\n}\r\n\r\n/** 鍒嗛厤鏁版嵁鏉冮檺鎿嶄綔 */\r\nfunction handleDataScope(row) {\r\n  reset()\r\n  const deptTreeSelect = getDeptTree(row.roleId)\r\n  getRole(row.roleId).then(response => {\r\n    form.value = response.data\r\n    openDataScope.value = true\r\n    nextTick(() => {\r\n      deptTreeSelect.then(res => {\r\n        nextTick(() => {\r\n          if (deptRef.value) {\r\n            deptRef.value.setCheckedKeys(res.checkedKeys)\r\n          }\r\n        })\r\n      })\r\n    })\r\n  })\r\n  title.value = \"鍒嗛厤鏁版嵁鏉冮檺\"\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳锛堟暟鎹潈闄愶級 */\r\nfunction submitDataScope() {\r\n  if (form.value.roleId != undefined) {\r\n    form.value.deptIds = getDeptAllCheckedKeys()\r\n    dataScope(form.value).then(response => {\r\n      proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n      openDataScope.value = false\r\n      getList()\r\n    })\r\n  }\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳锛堟暟鎹潈闄愶級*/\r\nfunction cancelDataScope() {\r\n  openDataScope.value = false\r\n  reset()\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\role\\selectUser.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\user\\authRole.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":98,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":98,"endColumn":66}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <div class=\"app-container\">\r\n      <h4 class=\"form-header h4\">鍩烘湰淇℃伅</h4>\r\n      <el-form :model=\"form\" label-width=\"80px\">\r\n         <el-row>\r\n            <el-col :span=\"8\" :offset=\"2\">\r\n               <el-form-item label=\"鐢ㄦ埛鏄电О\" prop=\"nickName\">\r\n                  <el-input v-model=\"form.nickName\" disabled />\r\n               </el-form-item>\r\n            </el-col>\r\n            <el-col :span=\"8\" :offset=\"2\">\r\n               <el-form-item label=\"鐧诲綍璐﹀彿\" prop=\"userName\">\r\n                  <el-input v-model=\"form.userName\" disabled />\r\n               </el-form-item>\r\n            </el-col>\r\n         </el-row>\r\n      </el-form>\r\n\r\n      <h4 class=\"form-header h4\">瑙掕壊淇℃伅</h4>\r\n      <el-table v-loading=\"loading\" :row-key=\"getRowKey\" @row-click=\"clickRow\" ref=\"roleRef\" @selection-change=\"handleSelectionChange\" :data=\"roles.slice((pageNum - 1) * pageSize, pageNum * pageSize)\">\r\n         <el-table-column label=\"搴忓彿\" width=\"55\" type=\"index\" align=\"center\">\r\n            <template #default=\"scope\">\r\n               <span>{{ (pageNum - 1) * pageSize + scope.$index + 1 }}</span>\r\n            </template>\r\n         </el-table-column>\r\n         <el-table-column type=\"selection\" :reserve-selection=\"true\" :selectable=\"checkSelectable\" width=\"55\"></el-table-column>\r\n         <el-table-column label=\"瑙掕壊缂栧彿\" align=\"center\" prop=\"roleId\" />\r\n         <el-table-column label=\"瑙掕壊鍚嶇О\" align=\"center\" prop=\"roleName\" />\r\n         <el-table-column label=\"鏉冮檺瀛楃\" align=\"center\" prop=\"roleKey\" />\r\n         <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template #default=\"scope\">\r\n               <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n         </el-table-column>\r\n      </el-table>\r\n\r\n      <pagination v-show=\"total > 0\" :total=\"total\" v-model:page=\"pageNum\" v-model:limit=\"pageSize\" />\r\n\r\n      <el-form label-width=\"100px\">\r\n         <div style=\"text-align: center;margin-left:-120px;margin-top:30px;\">\r\n            <el-button type=\"primary\" @click=\"submitForm()\">鎻愪氦</el-button>\r\n            <el-button @click=\"close()\">杩斿洖</el-button>\r\n         </div>\r\n      </el-form>\r\n   </div>\r\n</template>\r\n\r\n<script setup name=\"AuthRole\">\r\nimport { getAuthRole, updateAuthRole } from \"@/api/system/user\"\r\n\r\nconst route = useRoute()\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst loading = ref(true)\r\nconst total = ref(0)\r\nconst pageNum = ref(1)\r\nconst pageSize = ref(10)\r\nconst roleIds = ref([])\r\nconst roles = ref([])\r\nconst form = ref({\r\n  nickName: undefined,\r\n  userName: undefined,\r\n  userId: undefined\r\n})\r\n\r\n/** 鍗曞嚮閫変腑琛屾暟鎹?*/\r\nfunction clickRow(row) {\r\n  if (checkSelectable(row)) {\r\n    proxy.$refs[\"roleRef\"].toggleRowSelection(row)\r\n  }\r\n}\r\n\r\n/** 澶氶€夋閫変腑鏁版嵁 */\r\nfunction handleSelectionChange(selection) {\r\n  roleIds.value = selection.map(item => item.roleId)\r\n}\r\n\r\n/** 淇濆瓨閫変腑鐨勬暟鎹紪鍙?*/\r\nfunction getRowKey(row) {\r\n  return row.roleId\r\n}\r\n\r\n// 妫€鏌ヨ鑹茬姸鎬乗r\nfunction checkSelectable(row) {\r\n  return row.status === \"0\" ? true : false\r\n}\r\n\r\n/** 鍏抽棴鎸夐挳 */\r\nfunction close() {\r\n  const obj = { path: \"/system/user\" }\r\n  proxy.$tab.closeOpenPage(obj)\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  const userId = form.value.userId\r\n  const rIds = roleIds.value.join(\",\")\r\n  updateAuthRole({ userId: userId, roleIds: rIds }).then(response => {\r\n    proxy.$modal.msgSuccess(\"鎺堟潈鎴愬姛\")\r\n    close()\r\n  })\r\n}\r\n\r\n(() => {\r\n  const userId = route.params && route.params.userId\r\n  if (userId) {\r\n    loading.value = true\r\n    getAuthRole(userId).then(response => {\r\n      form.value = response.user\r\n      roles.value = response.roles\r\n      total.value = roles.value.length\r\n      nextTick(() => {\r\n        roles.value.forEach(row => {\r\n          if (row.flag) {\r\n            proxy.$refs[\"roleRef\"].toggleRowSelection(row)\r\n          }\r\n        })\r\n      })\r\n      loading.value = false\r\n    })\r\n  }\r\n})()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\user\\index.vue","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'no-useless-escape').","line":311,"column":5,"severity":1,"nodeType":null,"fix":{"range":[14626,14671],"text":" "}},{"ruleId":"no-unused-vars","severity":1,"message":"'handleCommand' is defined but never used. Allowed unused vars must match /^_/u.","line":414,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":414,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":448,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":448,"endColumn":50},{"ruleId":"no-unused-vars","severity":1,"message":"'event' is defined but never used. Allowed unused args must match /^_/u.","line":475,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":475,"endColumn":40},{"ruleId":"no-unused-vars","severity":1,"message":"'file' is defined but never used. Allowed unused args must match /^_/u.","line":475,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":475,"endColumn":46},{"ruleId":"no-unused-vars","severity":1,"message":"'fileList' is defined but never used. Allowed unused args must match /^_/u.","line":475,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":475,"endColumn":56},{"ruleId":"no-unused-vars","severity":1,"message":"'fileList' is defined but never used. Allowed unused args must match /^_/u.","line":480,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":480,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'file' is defined but never used. Allowed unused args must match /^_/u.","line":485,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":485,"endColumn":31},{"ruleId":"no-unused-vars","severity":1,"message":"'fileList' is defined but never used. Allowed unused args must match /^_/u.","line":485,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":485,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'fileList' is defined but never used. Allowed unused args must match /^_/u.","line":490,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":490,"endColumn":52},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":567,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":567,"endColumn":45},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":573,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":573,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":1,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-row :gutter=\"20\">\r\n      <splitpanes :horizontal=\"appStore.device === 'mobile'\" class=\"default-theme\">\r\n        <!--閮ㄩ棬鏁版嵁-->\r\n        <pane size=\"16\">\r\n          <el-col>\r\n            <div class=\"head-container\">\r\n              <el-input v-model=\"deptName\" placeholder=\"璇疯緭鍏ラ儴闂ㄥ悕绉癨" clearable prefix-icon=\"Search\"\r\n                style=\"margin-bottom: 20px\" />\r\n            </div>\r\n            <div class=\"head-container\">\r\n              <el-tree :data=\"deptOptions\" :props=\"{ label: 'label', children: 'children' }\"\r\n                :expand-on-click-node=\"false\" :filter-node-method=\"filterNode\" ref=\"deptTreeRef\" node-key=\"id\"\r\n                highlight-current default-expand-all @node-click=\"handleNodeClick\" />\r\n            </div>\r\n          </el-col>\r\n        </pane>\r\n        <!--鐢ㄦ埛鏁版嵁-->\r\n        <pane size=\"84\">\r\n          <el-col>\r\n            <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n              <el-form-item label=\"鐢ㄦ埛鍚嶇О\" prop=\"userName\">\r\n                <el-input v-model=\"queryParams.userName\" placeholder=\"璇疯緭鍏ョ敤鎴峰悕绉癨" clearable style=\"width: 240px\"\r\n                  @keyup.enter=\"handleQuery\" />\r\n              </el-form-item>\r\n              <el-form-item label=\"鎵嬫満鍙风爜\" prop=\"phonenumber\">\r\n                <el-input v-model=\"queryParams.phonenumber\" placeholder=\"璇疯緭鍏ユ墜鏈哄彿鐮乗" clearable style=\"width: 240px\"\r\n                  @keyup.enter=\"handleQuery\" />\r\n              </el-form-item>\r\n              <el-form-item label=\"鐘舵€乗" prop=\"status\">\r\n                <el-select v-model=\"queryParams.status\" placeholder=\"鐢ㄦ埛鐘舵€乗" clearable style=\"width: 240px\">\r\n                  <el-option v-for=\"dict in sys_normal_disable\" :key=\"dict.value\" :label=\"dict.label\"\r\n                    :value=\"dict.value\" />\r\n                </el-select>\r\n              </el-form-item>\r\n              <el-form-item label=\"鍒涘缓鏃堕棿\" style=\"width: 308px\">\r\n                <el-date-picker v-model=\"dateRange\" value-format=\"YYYY-MM-DD\" type=\"daterange\" range-separator=\"-\"\r\n                  start-placeholder=\"寮€濮嬫棩鏈焅" end-placeholder=\"缁撴潫鏃ユ湡\"></el-date-picker>\r\n              </el-form-item>\r\n              <el-form-item>\r\n                <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n                <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n\r\n            <el-row :gutter=\"10\" class=\"mb8\">\r\n              <el-col :span=\"1.5\">\r\n                <el-button type=\"primary\" plain icon=\"Plus\" @click=\"handleAdd\"\r\n                  v-hasPermi=\"['system:user:add']\">鏂板</el-button>\r\n              </el-col>\r\n              <el-col :span=\"1.5\">\r\n                <el-button type=\"success\" plain icon=\"Edit\" :disabled=\"single\" @click=\"handleUpdate\"\r\n                  v-hasPermi=\"['system:user:edit']\">淇敼</el-button>\r\n              </el-col>\r\n              <el-col :span=\"1.5\">\r\n                <el-button type=\"danger\" plain icon=\"Delete\" :disabled=\"multiple\" @click=\"handleDelete\"\r\n                  v-hasPermi=\"['system:user:remove']\">鍒犻櫎</el-button>\r\n              </el-col>\r\n              <el-col :span=\"1.5\">\r\n                <el-button type=\"info\" plain icon=\"Upload\" @click=\"handleImport\"\r\n                  v-hasPermi=\"['system:user:import']\">瀵煎叆</el-button>\r\n              </el-col>\r\n              <el-col :span=\"1.5\">\r\n                <el-button type=\"warning\" plain icon=\"Download\" @click=\"handleExport\"\r\n                  v-hasPermi=\"['system:user:export']\">瀵煎嚭</el-button>\r\n              </el-col>\r\n              <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\" :columns=\"columns\"></right-toolbar>\r\n            </el-row>\r\n\r\n            <el-table v-loading=\"loading\" :data=\"userList\" @selection-change=\"handleSelectionChange\">\r\n              <el-table-column type=\"selection\" width=\"50\" align=\"center\" />\r\n              <el-table-column label=\"鐢ㄦ埛缂栧彿\" align=\"center\" key=\"userId\" prop=\"userId\" v-if=\"columns.userId.visible\" />\r\n              <el-table-column label=\"鐢ㄦ埛鍚嶇О\" align=\"center\" key=\"userName\" prop=\"userName\"\r\n                v-if=\"columns.userName.visible\" :show-overflow-tooltip=\"true\" />\r\n              <el-table-column label=\"鐢ㄦ埛鏄电О\" align=\"center\" key=\"nickName\" prop=\"nickName\"\r\n                v-if=\"columns.nickName.visible\" :show-overflow-tooltip=\"true\" />\r\n              <el-table-column label=\"閮ㄩ棬\" align=\"center\" key=\"deptName\" prop=\"dept.deptName\"\r\n                v-if=\"columns.deptName.visible\" :show-overflow-tooltip=\"true\" />\r\n              <el-table-column label=\"鎵嬫満鍙风爜\" align=\"center\" key=\"phonenumber\" prop=\"phonenumber\"\r\n                v-if=\"columns.phonenumber.visible\" width=\"120\" />\r\n              <el-table-column label=\"鐘舵€乗" align=\"center\" key=\"status\" v-if=\"columns.status.visible\">\r\n                <template #default=\"scope\">\r\n                  <el-switch v-model=\"scope.row.status\" active-value=\"0\" inactive-value=\"1\"\r\n                    @change=\"handleStatusChange(scope.row)\"></el-switch>\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" v-if=\"columns.createTime.visible\"\r\n                width=\"160\">\r\n                <template #default=\"scope\">\r\n                  <span>{{ parseTime(scope.row.createTime) }}</span>\r\n                </template>\r\n              </el-table-column>\r\n              <el-table-column label=\"鎿嶄綔\" align=\"center\" width=\"150\" class-name=\"small-padding fixed-width\">\r\n                <template #default=\"scope\">\r\n                  <el-tooltip content=\"淇敼\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                    <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleUpdate(scope.row)\"\r\n                      v-hasPermi=\"['system:user:edit']\"></el-button>\r\n                  </el-tooltip>\r\n                  <el-tooltip content=\"鍒犻櫎\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                    <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\"\r\n                      v-hasPermi=\"['system:user:remove']\"></el-button>\r\n                  </el-tooltip>\r\n                  <el-tooltip content=\"閲嶇疆瀵嗙爜\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                    <el-button link type=\"primary\" icon=\"Key\" @click=\"handleResetPwd(scope.row)\"\r\n                      v-hasPermi=\"['system:user:resetPwd']\"></el-button>\r\n                  </el-tooltip>\r\n                  <el-tooltip content=\"鍒嗛厤瑙掕壊\" placement=\"top\" v-if=\"scope.row.userId !== 1\">\r\n                    <el-button link type=\"primary\" icon=\"CircleCheck\" @click=\"handleAuthRole(scope.row)\"\r\n                      v-hasPermi=\"['system:user:edit']\"></el-button>\r\n                  </el-tooltip>\r\n                </template>\r\n              </el-table-column>\r\n            </el-table>\r\n            <pagination v-show=\"total > 0\" :total=\"total\" v-model:page=\"queryParams.pageNum\"\r\n              v-model:limit=\"queryParams.pageSize\" @pagination=\"getList\" />\r\n          </el-col>\r\n        </pane>\r\n      </splitpanes>\r\n    </el-row>\r\n\r\n    <!-- 娣诲姞鎴栦慨鏀圭敤鎴烽厤缃璇濇 -->\r\n    <el-dialog :title=\"title\" v-model=\"open\" width=\"600px\" append-to-body>\r\n      <el-form :model=\"form\" :rules=\"rules\" ref=\"userRef\" label-width=\"80px\">\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鐢ㄦ埛鏄电О\" prop=\"nickName\">\r\n              <el-input v-model=\"form.nickName\" placeholder=\"璇疯緭鍏ョ敤鎴锋樀绉癨" maxlength=\"30\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"褰掑睘閮ㄩ棬\" prop=\"deptId\">\r\n              <el-tree-select v-model=\"form.deptId\" :data=\"enabledDeptOptions\"\r\n                :props=\"{ value: 'id', label: 'label', children: 'children' }\" value-key=\"id\" placeholder=\"璇烽€夋嫨褰掑睘閮ㄩ棬\"\r\n                clearable check-strictly />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鎵嬫満鍙风爜\" prop=\"phonenumber\">\r\n              <el-input v-model=\"form.phonenumber\" placeholder=\"璇疯緭鍏ユ墜鏈哄彿鐮乗" maxlength=\"11\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"閭\" prop=\"email\">\r\n              <el-input v-model=\"form.email\" placeholder=\"璇疯緭鍏ラ偖绠盶" maxlength=\"50\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item v-if=\"form.userId == undefined\" label=\"鐢ㄦ埛鍚嶇О\" prop=\"userName\">\r\n              <el-input v-model=\"form.userName\" placeholder=\"璇疯緭鍏ョ敤鎴峰悕绉癨" maxlength=\"30\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item v-if=\"form.userId == undefined\" label=\"鐢ㄦ埛瀵嗙爜\" prop=\"password\">\r\n              <el-input v-model=\"form.password\" placeholder=\"璇疯緭鍏ョ敤鎴峰瘑鐮乗" type=\"password\" maxlength=\"20\" show-password />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鐢ㄦ埛鎬у埆\">\r\n              <el-select v-model=\"form.sex\" placeholder=\"璇烽€夋嫨\">\r\n                <el-option v-for=\"dict in sys_user_sex\" :key=\"dict.value\" :label=\"dict.label\"\r\n                  :value=\"dict.value\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"鐘舵€乗">\r\n              <el-radio-group v-model=\"form.status\">\r\n                <el-radio v-for=\"dict in sys_normal_disable\" :key=\"dict.value\" :value=\"dict.value\">{{ dict.label\r\n                  }}</el-radio>\r\n              </el-radio-group>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"宀椾綅\">\r\n              <el-select v-model=\"form.postIds\" multiple placeholder=\"璇烽€夋嫨\">\r\n                <el-option v-for=\"item in postOptions\" :key=\"item.postId\" :label=\"item.postName\" :value=\"item.postId\"\r\n                  :disabled=\"item.status == 1\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"瑙掕壊\">\r\n              <el-select v-model=\"form.roleIds\" multiple placeholder=\"璇烽€夋嫨\">\r\n                <el-option v-for=\"item in roleOptions\" :key=\"item.roleId\" :label=\"item.roleName\" :value=\"item.roleId\"\r\n                  :disabled=\"item.status == 1\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"24\">\r\n            <el-form-item label=\"澶囨敞\">\r\n              <el-input v-model=\"form.remark\" type=\"textarea\" placeholder=\"璇疯緭鍏ュ唴瀹筡"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitForm\">纭?瀹?/el-button>\r\n          <el-button @click=\"cancel\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n\r\n    <!-- 鐢ㄦ埛瀵煎叆瀵硅瘽妗?-->\r\n    <el-dialog :title=\"upload.title\" v-model=\"upload.open\" width=\"400px\" append-to-body>\r\n      <el-upload ref=\"uploadRef\" :limit=\"1\" accept=\".xlsx, .xls\" :headers=\"upload.headers\"\r\n        :action=\"upload.url + '?updateSupport=' + upload.updateSupport\" :disabled=\"upload.isUploading\"\r\n        :on-progress=\"handleFileUploadProgress\" :on-success=\"handleFileSuccess\" :on-change=\"handleFileChange\"\r\n        :on-remove=\"handleFileRemove\" :auto-upload=\"false\" drag>\r\n        <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\r\n        <div class=\"el-upload__text\">灏嗘枃浠舵嫋鍒版澶勶紝鎴?em>鐐瑰嚮涓婁紶</em></div>\r\n        <template #tip>\r\n          <div class=\"el-upload__tip text-center\">\r\n            <div class=\"el-upload__tip\">\r\n              <el-checkbox v-model=\"upload.updateSupport\" />鏄惁鏇存柊宸茬粡瀛樺湪鐨勭敤鎴锋暟鎹甛r\n            </div>\r\n            <span>浠呭厑璁稿鍏ls銆亁lsx鏍煎紡鏂囦欢銆?/span>\r\n            <el-link type=\"primary\" :underline=\"false\" style=\"font-size: 12px; vertical-align: baseline\"\r\n              @click=\"importTemplate\">涓嬭浇妯℃澘</el-link>\r\n          </div>\r\n        </template>\r\n      </el-upload>\r\n      <template #footer>\r\n        <div class=\"dialog-footer\">\r\n          <el-button type=\"primary\" @click=\"submitFileForm\">纭?瀹?/el-button>\r\n          <el-button @click=\"upload.open = false\">鍙?娑?/el-button>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"User\">\r\nimport { getToken } from \"@/utils/auth\"\r\nimport useAppStore from '@/store/modules/app'\r\nimport { changeUserStatus, listUser, resetUserPwd, delUser, getUser, updateUser, addUser, deptTreeSelect } from \"@/api/system/user\"\r\nimport { Splitpanes, Pane } from \"splitpanes\"\r\nimport \"splitpanes/dist/splitpanes.css\"\r\n\r\nconst router = useRouter()\r\nconst appStore = useAppStore()\r\nconst { proxy } = getCurrentInstance()\r\nconst { sys_normal_disable, sys_user_sex } = proxy.useDict(\"sys_normal_disable\", \"sys_user_sex\")\r\n\r\nconst userList = ref([])\r\nconst open = ref(false)\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst title = ref(\"\")\r\nconst dateRange = ref([])\r\nconst deptName = ref(\"\")\r\nconst deptOptions = ref(undefined)\r\nconst enabledDeptOptions = ref(undefined)\r\nconst initPassword = ref(undefined)\r\nconst postOptions = ref([])\r\nconst roleOptions = ref([])\r\n/*** 鐢ㄦ埛瀵煎叆鍙傛暟 */\r\nconst upload = reactive({\r\n  // 鏄惁鏄剧ず寮瑰嚭灞傦紙鐢ㄦ埛瀵煎叆锛塡r\n  open: false,\r\n  // 寮瑰嚭灞傛爣棰橈紙鐢ㄦ埛瀵煎叆锛塡r\n  title: \"\",\r\n  // 鏄惁绂佺敤涓婁紶\r\n  isUploading: false,\r\n  // 鏄惁鏇存柊宸茬粡瀛樺湪鐨勭敤鎴锋暟鎹甛r\n  updateSupport: 0,\r\n  // 璁剧疆涓婁紶鐨勮姹傚ご閮╘r\n  headers: { Authorization: \"Bearer \" + getToken() },\r\n  // 涓婁紶鐨勫湴鍧€\r\n  url: import.meta.env.VITE_APP_BASE_API + \"/system/user/importData\"\r\n})\r\n// 鍒楁樉闅愪俊鎭痋r\nconst columns = ref({\r\n  userId: { label: '鐢ㄦ埛缂栧彿', visible: true },\r\n  userName: { label: '鐢ㄦ埛鍚嶇О', visible: true },\r\n  nickName: { label: '鐢ㄦ埛鏄电О', visible: true },\r\n  deptName: { label: '閮ㄩ棬', visible: true },\r\n  phonenumber: { label: '鎵嬫満鍙风爜', visible: true },\r\n  status: { label: '鐘舵€?, visible: true },\r\n  createTime: { label: '鍒涘缓鏃堕棿', visible: true }\r\n})\r\n\r\nconst data = reactive({\r\n  form: {},\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    userName: undefined,\r\n    phonenumber: undefined,\r\n    status: undefined,\r\n    deptId: undefined\r\n  },\r\n  rules: {\r\n    userName: [{ required: true, message: \"鐢ㄦ埛鍚嶇О涓嶈兘涓虹┖\", trigger: \"blur\" }, { min: 2, max: 20, message: \"鐢ㄦ埛鍚嶇О闀垮害蹇呴』浠嬩簬 2 鍜?20 涔嬮棿\", trigger: \"blur\" }],\r\n    nickName: [{ required: true, message: \"鐢ㄦ埛鏄电О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n    // eslint-disable-next-line no-useless-escape\r\n    password: [{ required: true, message: \"鐢ㄦ埛瀵嗙爜涓嶈兘涓虹┖\", trigger: \"blur\" }, { min: 5, max: 20, message: \"鐢ㄦ埛瀵嗙爜闀垮害蹇呴』浠嬩簬 5 鍜?20 涔嬮棿\", trigger: \"blur\" }, { pattern: /^[^<>\"'|\\\\]+$/, message: \"涓嶈兘鍖呭惈闈炴硶瀛楃锛? > \\\" ' \\\\ |\", trigger: \"blur\" }],\r\n    email: [{ type: \"email\", message: \"璇疯緭鍏ユ纭殑閭鍦板潃\", trigger: [\"blur\", \"change\"] }],\r\n    phonenumber: [{ pattern: /^1[3|4|5|6|7|8|9][0-9]\\d{8}$/, message: \"璇疯緭鍏ユ纭殑鎵嬫満鍙风爜\", trigger: \"blur\" }]\r\n  }\r\n})\r\n\r\nconst { queryParams, form, rules } = toRefs(data)\r\n\r\n/** 閫氳繃鏉′欢杩囨护鑺傜偣  */\r\nconst filterNode = (value, data) => {\r\n  if (!value) return true\r\n  return data.label.indexOf(value) !== -1\r\n}\r\n\r\n/** 鏍规嵁鍚嶇О绛涢€夐儴闂ㄦ爲 */\r\nwatch(deptName, val => {\r\n  proxy.$refs[\"deptTreeRef\"].filter(val)\r\n})\r\n\r\n/** 鏌ヨ鐢ㄦ埛鍒楄〃 */\r\nfunction getList() {\r\n  loading.value = true\r\n  listUser(proxy.addDateRange(queryParams.value, dateRange.value)).then(res => {\r\n    loading.value = false\r\n    userList.value = res.rows\r\n    total.value = res.total\r\n  })\r\n}\r\n\r\n/** 鏌ヨ閮ㄩ棬涓嬫媺鏍戠粨鏋?*/\r\nfunction getDeptTree() {\r\n  deptTreeSelect().then(response => {\r\n    deptOptions.value = response.data\r\n    enabledDeptOptions.value = filterDisabledDept(JSON.parse(JSON.stringify(response.data)))\r\n  })\r\n}\r\n\r\n/** 杩囨护绂佺敤鐨勯儴闂?*/\r\nfunction filterDisabledDept(deptList) {\r\n  return deptList.filter(dept => {\r\n    if (dept.disabled) {\r\n      return false\r\n    }\r\n    if (dept.children && dept.children.length) {\r\n      dept.children = filterDisabledDept(dept.children)\r\n    }\r\n    return true\r\n  })\r\n}\r\n\r\n/** 鑺傜偣鍗曞嚮浜嬩欢 */\r\nfunction handleNodeClick(data) {\r\n  queryParams.value.deptId = data.id\r\n  handleQuery()\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  queryParams.value.deptId = undefined\r\n  proxy.$refs.deptTreeRef.setCurrentKey(null)\r\n  handleQuery()\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const userIds = row.userId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎鐢ㄦ埛缂栧彿涓篭"' + userIds + '\"鐨勬暟鎹」锛?).then(function () {\r\n    return delUser(userIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => { })\r\n}\r\n\r\n/** 瀵煎嚭鎸夐挳鎿嶄綔 */\r\nfunction handleExport() {\r\n  proxy.download(\"system/user/export\", {\r\n    ...queryParams.value,\r\n  }, `user_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/** 鐢ㄦ埛鐘舵€佷慨鏀? */\r\nfunction handleStatusChange(row) {\r\n  let text = row.status === \"0\" ? \"鍚敤\" : \"鍋滅敤\"\r\n  proxy.$modal.confirm('纭瑕乗"' + text + '\"\"' + row.userName + '\"鐢ㄦ埛鍚?').then(function () {\r\n    return changeUserStatus(row.userId, row.status)\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(text + \"鎴愬姛\")\r\n  }).catch(function () {\r\n    row.status = row.status === \"0\" ? \"1\" : \"0\"\r\n  })\r\n}\r\n\r\n/** 鏇村鎿嶄綔 */\r\nfunction handleCommand(command, row) {\r\n  switch (command) {\r\n    case \"handleResetPwd\":\r\n      handleResetPwd(row)\r\n      break\r\n    case \"handleAuthRole\":\r\n      handleAuthRole(row)\r\n      break\r\n    default:\r\n      break\r\n  }\r\n}\r\n\r\n/** 璺宠浆瑙掕壊鍒嗛厤 */\r\nfunction handleAuthRole(row) {\r\n  const userId = row.userId\r\n  router.push(\"/system/user-auth/role/\" + userId)\r\n}\r\n\r\n/** 閲嶇疆瀵嗙爜鎸夐挳鎿嶄綔 */\r\nfunction handleResetPwd(row) {\r\n  proxy.$prompt('璇疯緭鍏"' + row.userName + '\"鐨勬柊瀵嗙爜', \"鎻愮ず\", {\r\n    confirmButtonText: \"纭畾\",\r\n    cancelButtonText: \"鍙栨秷\",\r\n    closeOnClickModal: false,\r\n    inputPattern: /^.{5,20}$/,\r\n    inputErrorMessage: \"鐢ㄦ埛瀵嗙爜闀垮害蹇呴』浠嬩簬 5 鍜?20 涔嬮棿\",\r\n    inputValidator: (value) => {\r\n      // 鍏佽闄や互涓嬪瓧绗﹀: < > \" ' | \\\r\n      if (/[<>\"'|\\\\]/.test(value)) {\r\n        return \"涓嶈兘鍖呭惈闈炴硶瀛楃锛? > \\\" ' \\\\ |\"\r\n      }\r\n    },\r\n  }).then(({ value }) => {\r\n    resetUserPwd(row.userId, value).then(response => {\r\n      proxy.$modal.msgSuccess(\"淇敼鎴愬姛锛屾柊瀵嗙爜鏄細\" + value)\r\n    })\r\n  }).catch(() => { })\r\n}\r\n\r\n/** 閫夋嫨鏉℃暟  */\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.userId)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 瀵煎叆鎸夐挳鎿嶄綔 */\r\nfunction handleImport() {\r\n  upload.title = \"鐢ㄦ埛瀵煎叆\"\r\n  upload.open = true\r\n  upload.selectedFile = null\r\n}\r\n\r\n/** 涓嬭浇妯℃澘鎿嶄綔 */\r\nfunction importTemplate() {\r\n  proxy.download(\"system/user/importTemplate\", {\r\n  }, `user_template_${new Date().getTime()}.xlsx`)\r\n}\r\n\r\n/**鏂囦欢涓婁紶涓鐞?*/\r\nconst handleFileUploadProgress = (event, file, fileList) => {\r\n  upload.isUploading = true\r\n}\r\n\r\n/** 鏂囦欢閫夋嫨澶勭悊 */\r\nconst handleFileChange = (file, fileList) => {\r\n  upload.selectedFile = file\r\n}\r\n\r\n/** 鏂囦欢鍒犻櫎澶勭悊 */\r\nconst handleFileRemove = (file, fileList) => {\r\n  upload.selectedFile = null\r\n}\r\n\r\n/** 鏂囦欢涓婁紶鎴愬姛澶勭悊 */\r\nconst handleFileSuccess = (response, file, fileList) => {\r\n  upload.open = false\r\n  upload.isUploading = false\r\n  proxy.$refs[\"uploadRef\"].handleRemove(file)\r\n  proxy.$alert(\"<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>\" + response.msg + \"</div>\", \"瀵煎叆缁撴灉\", { dangerouslyUseHTMLString: true })\r\n  getList()\r\n}\r\n\r\n/** 鎻愪氦涓婁紶鏂囦欢 */\r\nfunction submitFileForm() {\r\n  const file = upload.selectedFile\r\n  if (!file || file.length === 0 || !file.name.toLowerCase().endsWith('.xls') && !file.name.toLowerCase().endsWith('.xlsx')) {\r\n    proxy.$modal.msgError(\"璇烽€夋嫨鍚庣紑涓?鈥渪ls鈥濇垨鈥渪lsx鈥濈殑鏂囦欢銆俓")\r\n    return\r\n  }\r\n  proxy.$refs[\"uploadRef\"].submit()\r\n}\r\n\r\n/** 閲嶇疆鎿嶄綔琛ㄥ崟 */\r\nfunction reset() {\r\n  form.value = {\r\n    userId: undefined,\r\n    deptId: undefined,\r\n    userName: undefined,\r\n    nickName: undefined,\r\n    password: undefined,\r\n    phonenumber: undefined,\r\n    email: undefined,\r\n    sex: undefined,\r\n    status: \"0\",\r\n    remark: undefined,\r\n    postIds: [],\r\n    roleIds: []\r\n  }\r\n  proxy.resetForm(\"userRef\")\r\n}\r\n\r\n/** 鍙栨秷鎸夐挳 */\r\nfunction cancel() {\r\n  open.value = false\r\n  reset()\r\n}\r\n\r\n/** 鏂板鎸夐挳鎿嶄綔 */\r\nfunction handleAdd() {\r\n  reset()\r\n  getUser().then(response => {\r\n    postOptions.value = response.posts\r\n    roleOptions.value = response.roles\r\n    open.value = true\r\n    title.value = \"娣诲姞鐢ㄦ埛\"\r\n    form.value.password = initPassword.value\r\n  })\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleUpdate(row) {\r\n  reset()\r\n  const userId = row.userId || ids.value\r\n  getUser(userId).then(response => {\r\n    form.value = response.data\r\n    postOptions.value = response.posts\r\n    roleOptions.value = response.roles\r\n    form.value.postIds = response.postIds\r\n    form.value.roleIds = response.roleIds\r\n    open.value = true\r\n    title.value = \"淇敼鐢ㄦ埛\"\r\n    // 淇 ref 璁块棶闇€鍔?.value\r\n    form.value.password = \"\"\r\n  })\r\n}\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submitForm() {\r\n  proxy.$refs[\"userRef\"].validate(valid => {\r\n    if (valid) {\r\n      if (form.value.userId != undefined) {\r\n        updateUser(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      } else {\r\n        addUser(form.value).then(response => {\r\n          proxy.$modal.msgSuccess(\"鏂板鎴愬姛\")\r\n          open.value = false\r\n          getList()\r\n        })\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  getDeptTree()\r\n  getList()\r\n  proxy.getConfigKey(\"sys.user.initPassword\").then(response => {\r\n    initPassword.value = response.msg\r\n  })\r\n})\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\user\\profile\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\user\\profile\\resetPwd.vue","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'no-useless-escape').","line":40,"column":3,"severity":1,"nodeType":null,"fix":{"range":[1293,1338],"text":" "}},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":49,"column":62,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":70}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":1,"source":"<template>\r\n  <el-form ref=\"pwdRef\" :model=\"user\" :rules=\"rules\" label-width=\"80px\">\r\n    <el-form-item label=\"鏃у瘑鐮乗" prop=\"oldPassword\">\r\n      <el-input v-model=\"user.oldPassword\" placeholder=\"璇疯緭鍏ユ棫瀵嗙爜\" type=\"password\" show-password />\r\n    </el-form-item>\r\n    <el-form-item label=\"鏂板瘑鐮乗" prop=\"newPassword\">\r\n      <el-input v-model=\"user.newPassword\" placeholder=\"璇疯緭鍏ユ柊瀵嗙爜\" type=\"password\" show-password />\r\n    </el-form-item>\r\n    <el-form-item label=\"纭瀵嗙爜\" prop=\"confirmPassword\">\r\n      <el-input v-model=\"user.confirmPassword\" placeholder=\"璇风‘璁ゆ柊瀵嗙爜\" type=\"password\" show-password />\r\n    </el-form-item>\r\n    <el-form-item>\r\n      <el-button type=\"primary\" @click=\"submit\">淇濆瓨</el-button>\r\n      <el-button type=\"danger\" @click=\"close\">鍏抽棴</el-button>\r\n    </el-form-item>\r\n  </el-form>\r\n</template>\r\n\r\n<script setup>\r\nimport { updateUserPwd } from \"@/api/system/user\"\r\n\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst user = reactive({\r\n  oldPassword: undefined,\r\n  newPassword: undefined,\r\n  confirmPassword: undefined\r\n})\r\n\r\nconst equalToPassword = (rule, value, callback) => {\r\n  if (user.newPassword !== value) {\r\n    callback(new Error(\"涓ゆ杈撳叆鐨勫瘑鐮佷笉涓€鑷碶"))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nconst rules = ref({\r\n  oldPassword: [{ required: true, message: \"鏃у瘑鐮佷笉鑳戒负绌篭", trigger: \"blur\" }],\r\n  // eslint-disable-next-line no-useless-escape\r\n  newPassword: [{ required: true, message: \"鏂板瘑鐮佷笉鑳戒负绌篭", trigger: \"blur\" }, { min: 6, max: 20, message: \"闀垮害鍦?6 鍒?20 涓瓧绗", trigger: \"blur\" }, { pattern: /^[^<>\"'|\\\\]+$/, message: \"涓嶈兘鍖呭惈闈炴硶瀛楃锛? > \\\" ' \\\\ |\", trigger: \"blur\" }],\r\n  confirmPassword: [{ required: true, message: \"纭瀵嗙爜涓嶈兘涓虹┖\", trigger: \"blur\" }, { required: true, validator: equalToPassword, trigger: \"blur\" }]\r\n})\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submit() {\r\n  proxy.$refs.pwdRef.validate(valid => {\r\n    if (valid) {\r\n      updateUserPwd(user.oldPassword, user.newPassword).then(response => {\r\n        proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍏抽棴鎸夐挳 */\r\nfunction close() {\r\n  proxy.$tab.closePage()\r\n}\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\user\\profile\\userAvatar.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\system\\user\\profile\\userInfo.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":47,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":50}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n   <el-form ref=\"userRef\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n      <el-form-item label=\"鐢ㄦ埛鏄电О\" prop=\"nickName\">\r\n         <el-input v-model=\"form.nickName\" maxlength=\"30\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"鎵嬫満鍙风爜\" prop=\"phonenumber\">\r\n         <el-input v-model=\"form.phonenumber\" maxlength=\"11\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"閭\" prop=\"email\">\r\n         <el-input v-model=\"form.email\" maxlength=\"50\" />\r\n      </el-form-item>\r\n      <el-form-item label=\"鎬у埆\">\r\n         <el-radio-group v-model=\"form.sex\">\r\n            <el-radio value=\"0\">鐢?/el-radio>\r\n            <el-radio value=\"1\">濂?/el-radio>\r\n         </el-radio-group>\r\n      </el-form-item>\r\n      <el-form-item>\r\n      <el-button type=\"primary\" @click=\"submit\">淇濆瓨</el-button>\r\n      <el-button type=\"danger\" @click=\"close\">鍏抽棴</el-button>\r\n      </el-form-item>\r\n   </el-form>\r\n</template>\r\n\r\n<script setup>\r\nimport { updateUserProfile } from \"@/api/system/user\"\r\n\r\nconst props = defineProps({\r\n  user: {\r\n    type: Object\r\n  }\r\n})\r\n\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst form = ref({})\r\nconst rules = ref({\r\n  nickName: [{ required: true, message: \"鐢ㄦ埛鏄电О涓嶈兘涓虹┖\", trigger: \"blur\" }],\r\n  email: [{ required: true, message: \"閭鍦板潃涓嶈兘涓虹┖\", trigger: \"blur\" }, { type: \"email\", message: \"璇疯緭鍏ユ纭殑閭鍦板潃\", trigger: [\"blur\", \"change\"] }],\r\n  phonenumber: [{ required: true, message: \"鎵嬫満鍙风爜涓嶈兘涓虹┖\", trigger: \"blur\" }, { pattern: /^1[3|4|5|6|7|8|9][0-9]\\d{8}$/, message: \"璇疯緭鍏ユ纭殑鎵嬫満鍙风爜\", trigger: \"blur\" }],\r\n})\r\n\r\n/** 鎻愪氦鎸夐挳 */\r\nfunction submit() {\r\n  proxy.$refs.userRef.validate(valid => {\r\n    if (valid) {\r\n      updateUserProfile(form.value).then(response => {\r\n        proxy.$modal.msgSuccess(\"淇敼鎴愬姛\")\r\n        props.user.phonenumber = form.value.phonenumber\r\n        props.user.email = form.value.email\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n/** 鍏抽棴鎸夐挳 */\r\nfunction close() {\r\n  proxy.$tab.closePage()\r\n}\r\n\r\n// 鍥炴樉褰撳墠鐧诲綍鐢ㄦ埛淇℃伅\r\nwatch(() => props.user, user => {\r\n  if (user) {\r\n    form.value = { nickName: user.nickName, phonenumber: user.phonenumber, email: user.email, sex: user.sex }\r\n  }\r\n},{ immediate: true })\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\build\\CodeTypeDialog.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\build\\DraggableItem.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\build\\IconsDialog.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\build\\RightPanel.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'node' is defined but never used. Allowed unused args must match /^_/u.","line":578,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":578,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'store' is defined but never used. Allowed unused args must match /^_/u.","line":630,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":630,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"right-board\">\r\n    <el-tabs v-model=\"currentTab\" stretch class=\"center-tabs\">\r\n      <el-tab-pane label=\"缁勪欢灞炴€" name=\"field\" />\r\n      <el-tab-pane label=\"琛ㄥ崟灞炴€" name=\"form\" />\r\n    </el-tabs>\r\n    <div class=\"field-box\">\r\n      <a class=\"document-link\" target=\"_blank\" :href=\"documentLink\" title=\"鏌ョ湅缁勪欢鏂囨。\">\r\n        <el-icon>\r\n          <Link />\r\n        </el-icon>\r\n      </a>\r\n      <el-scrollbar class=\"right-scrollbar\">\r\n        <!-- 缁勪欢灞炴€?-->\r\n        <el-form v-show=\"currentTab === 'field' && showField\" size=\"default\" label-width=\"90px\" label-position=\"top\"\r\n          style=\"\">\r\n          <el-form-item v-if=\"activeData.changeTag\" label=\"缁勪欢绫诲瀷\">\r\n            <el-select v-model=\"activeData.tagIcon\" placeholder=\"璇烽€夋嫨缁勪欢绫诲瀷\" :style=\"{ width: '100%' }\"\r\n              @change=\"tagChange\">\r\n              <el-option-group v-for=\"group in tagList\" :key=\"group.label\" :label=\"group.label\">\r\n                <el-option v-for=\"item in group.options\" :key=\"item.label\" :label=\"item.label\" :value=\"item.tagIcon\">\r\n                  <svg-icon class=\"node-icon\" :icon-class=\"item.tagIcon\" style=\"margin-right: 10px;\" />\r\n                  <span> {{ item.label }}</span>\r\n                </el-option>\r\n              </el-option-group>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.vModel !== undefined\" label=\"瀛楁鍚峔">\r\n            <el-input v-model=\"activeData.vModel\" placeholder=\"璇疯緭鍏ュ瓧娈靛悕锛坴-model锛塡" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.componentName !== undefined\" label=\"缁勪欢鍚峔">\r\n            {{ activeData.componentName }}\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.label !== undefined\" label=\"鏍囬\">\r\n            <el-input v-model=\"activeData.label\" placeholder=\"璇疯緭鍏ユ爣棰榎" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.placeholder !== undefined\" label=\"鍗犱綅鎻愮ず\">\r\n            <el-input v-model=\"activeData.placeholder\" placeholder=\"璇疯緭鍏ュ崰浣嶆彁绀篭" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['start-placeholder'] !== undefined\" label=\"寮€濮嬪崰浣峔">\r\n            <el-input v-model=\"activeData['start-placeholder']\" placeholder=\"璇疯緭鍏ュ崰浣嶆彁绀篭" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['end-placeholder'] !== undefined\" label=\"缁撴潫鍗犱綅\">\r\n            <el-input v-model=\"activeData['end-placeholder']\" placeholder=\"璇疯緭鍏ュ崰浣嶆彁绀篭" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.span !== undefined\" label=\"琛ㄥ崟鏍呮牸\">\r\n            <el-slider v-model=\"activeData.span\" :max=\"24\" :min=\"1\" :marks=\"{ 12: '' }\" @change=\"spanChange\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.layout === 'rowFormItem'\" label=\"鏍呮牸闂撮殧\">\r\n            <el-input-number v-model=\"activeData.gutter\" :min=\"0\" placeholder=\"鏍呮牸闂撮殧\" />\r\n          </el-form-item>\r\n\r\n          <el-form-item v-if=\"activeData.justify !== undefined\" label=\"姘村钩鎺掑垪\">\r\n            <el-select v-model=\"activeData.justify\" placeholder=\"璇烽€夋嫨姘村钩鎺掑垪\" :style=\"{ width: '100%' }\">\r\n              <el-option v-for=\"(item, index) in justifyOptions\" :key=\"index\" :label=\"item.label\" :value=\"item.value\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.align !== undefined\" label=\"鍨傜洿鎺掑垪\">\r\n            <el-radio-group v-model=\"activeData.align\">\r\n              <el-radio-button label=\"top\" />\r\n              <el-radio-button label=\"middle\" />\r\n              <el-radio-button label=\"bottom\" />\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.labelWidth !== undefined\" label=\"鏍囩瀹藉害\">\r\n            <el-input v-model.number=\"activeData.labelWidth\" type=\"number\" placeholder=\"璇疯緭鍏ユ爣绛惧搴" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.style && activeData.style.width !== undefined\" label=\"缁勪欢瀹藉害\">\r\n            <el-input v-model=\"activeData.style.width\" placeholder=\"璇疯緭鍏ョ粍浠跺搴" clearable />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.vModel !== undefined\" label=\"榛樿鍊糪">\r\n            <el-input :value=\"setDefaultValue(activeData.defaultValue)\" placeholder=\"璇疯緭鍏ラ粯璁ゅ€糪"\r\n              @input=\"onDefaultValueInput\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-checkbox-group'\" label=\"鑷冲皯搴旈€塡">\r\n            <el-input-number :value=\"activeData.min\" :min=\"0\" placeholder=\"鑷冲皯搴旈€塡"\r\n              @input=\"$set(activeData, 'min', $event ? $event : undefined)\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-checkbox-group'\" label=\"鏈€澶氬彲閫塡">\r\n            <el-input-number :value=\"activeData.max\" :min=\"0\" placeholder=\"鏈€澶氬彲閫塡"\r\n              @input=\"$set(activeData, 'max', $event ? $event : undefined)\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.prepend !== undefined\" label=\"鍓嶇紑\">\r\n            <el-input v-model=\"activeData.prepend\" placeholder=\"璇疯緭鍏ュ墠缂€\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.append !== undefined\" label=\"鍚庣紑\">\r\n            <el-input v-model=\"activeData.append\" placeholder=\"璇疯緭鍏ュ悗缂€\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['prefix-icon'] !== undefined\" label=\"鍓嶅浘鏍嘰">\r\n            <el-input v-model=\"activeData['prefix-icon']\" placeholder=\"璇疯緭鍏ュ墠鍥炬爣鍚嶇О\">\r\n              <template #append>\r\n                <el-button icon=\"Pointer\" @click=\"openIconsDialog('prefix-icon')\">\r\n                  閫夋嫨\r\n                </el-button>\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['suffix-icon'] !== undefined\" label=\"鍚庡浘鏍嘰">\r\n            <el-input v-model=\"activeData['suffix-icon']\" placeholder=\"璇疯緭鍏ュ悗鍥炬爣鍚嶇О\">\r\n              <template #append>\r\n                <el-button icon=\"Pointer\" @click=\"openIconsDialog('suffix-icon')\">\r\n                  閫夋嫨\r\n                </el-button>\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-cascader'\" label=\"閫夐」鍒嗛殧绗">\r\n            <el-input v-model=\"activeData.separator\" placeholder=\"璇疯緭鍏ラ€夐」鍒嗛殧绗" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.autosize !== undefined\" label=\"鏈€灏忚鏁癨">\r\n            <el-input-number v-model=\"activeData.autosize.minRows\" :min=\"1\" placeholder=\"鏈€灏忚鏁癨" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.autosize !== undefined\" label=\"鏈€澶ц鏁癨">\r\n            <el-input-number v-model=\"activeData.autosize.maxRows\" :min=\"1\" placeholder=\"鏈€澶ц鏁癨" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.min !== undefined\" label=\"鏈€灏忓€糪">\r\n            <el-input-number v-model=\"activeData.min\" placeholder=\"鏈€灏忓€糪" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.max !== undefined\" label=\"鏈€澶у€糪">\r\n            <el-input-number v-model=\"activeData.max\" placeholder=\"鏈€澶у€糪" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.step !== undefined\" label=\"姝ラ暱\">\r\n            <el-input-number v-model=\"activeData.step\" placeholder=\"姝ユ暟\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-input-number'\" label=\"绮惧害\">\r\n            <el-input-number v-model=\"activeData.precision\" :min=\"0\" placeholder=\"绮惧害\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-input-number'\" label=\"鎸夐挳浣嶇疆\">\r\n            <el-radio-group v-model=\"activeData['controls-position']\">\r\n              <el-radio-button label=\"\">\r\n                榛樿\r\n              </el-radio-button>\r\n              <el-radio-button label=\"right\">\r\n                鍙充晶\r\n              </el-radio-button>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.maxlength !== undefined\" label=\"鏈€澶氳緭鍏">\r\n            <el-input v-model=\"activeData.maxlength\" placeholder=\"璇疯緭鍏ュ瓧绗﹂暱搴">\r\n              <template #append>涓瓧绗?/template>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['active-text'] !== undefined\" label=\"寮€鍚彁绀篭">\r\n            <el-input v-model=\"activeData['active-text']\" placeholder=\"璇疯緭鍏ュ紑鍚彁绀篭" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['inactive-text'] !== undefined\" label=\"鍏抽棴鎻愮ず\">\r\n            <el-input v-model=\"activeData['inactive-text']\" placeholder=\"璇疯緭鍏ュ叧闂彁绀篭" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['active-value'] !== undefined\" label=\"寮€鍚€糪">\r\n            <el-input :value=\"setDefaultValue(activeData['active-value'])\" placeholder=\"璇疯緭鍏ュ紑鍚€糪"\r\n              @input=\"onSwitchValueInput($event, 'active-value')\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['inactive-value'] !== undefined\" label=\"鍏抽棴鍊糪">\r\n            <el-input :value=\"setDefaultValue(activeData['inactive-value'])\" placeholder=\"璇疯緭鍏ュ叧闂€糪"\r\n              @input=\"onSwitchValueInput($event, 'inactive-value')\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.type !== undefined && 'el-date-picker' === activeData.tag\" label=\"鏃堕棿绫诲瀷\">\r\n            <el-select v-model=\"activeData.type\" placeholder=\"璇烽€夋嫨鏃堕棿绫诲瀷\" :style=\"{ width: '100%' }\"\r\n              @change=\"dateTypeChange\">\r\n              <el-option v-for=\"(item, index) in dateOptions\" :key=\"index\" :label=\"item.label\" :value=\"item.value\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.name !== undefined\" label=\"鏂囦欢瀛楁鍚峔">\r\n            <el-input v-model=\"activeData.name\" placeholder=\"璇疯緭鍏ヤ笂浼犳枃浠跺瓧娈靛悕\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.accept !== undefined\" label=\"鏂囦欢绫诲瀷\">\r\n            <el-select v-model=\"activeData.accept\" placeholder=\"璇烽€夋嫨鏂囦欢绫诲瀷\" :style=\"{ width: '100%' }\" clearable>\r\n              <el-option label=\"鍥剧墖\" value=\"image/*\" />\r\n              <el-option label=\"瑙嗛\" value=\"video/*\" />\r\n              <el-option label=\"闊抽\" value=\"audio/*\" />\r\n              <el-option label=\"excel\" value=\".xls,.xlsx\" />\r\n              <el-option label=\"word\" value=\".doc,.docx\" />\r\n              <el-option label=\"pdf\" value=\".pdf\" />\r\n              <el-option label=\"txt\" value=\".txt\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.fileSize !== undefined\" label=\"鏂囦欢澶у皬\">\r\n            <el-input v-model.number=\"activeData.fileSize\" placeholder=\"璇疯緭鍏ユ枃浠跺ぇ灏廫">\r\n              <template #append>\r\n                <el-select v-model=\"activeData.sizeUnit\" :style=\"{ width: '66px' }\">\r\n                  <el-option label=\"KB\" value=\"KB\" />\r\n                  <el-option label=\"MB\" value=\"MB\" />\r\n                  <el-option label=\"GB\" value=\"GB\" />\r\n                </el-select>\r\n              </template>\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.action !== undefined\" label=\"涓婁紶鍦板潃\">\r\n            <el-input v-model=\"activeData.action\" placeholder=\"璇疯緭鍏ヤ笂浼犲湴鍧€\" clearable />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['list-type'] !== undefined\" label=\"鍒楄〃绫诲瀷\">\r\n            <el-radio-group v-model=\"activeData['list-type']\" size=\"small\">\r\n              <el-radio-button label=\"text\">\r\n                text\r\n              </el-radio-button>\r\n              <el-radio-button label=\"picture\">\r\n                picture\r\n              </el-radio-button>\r\n              <el-radio-button label=\"picture-card\">\r\n                picture-card\r\n              </el-radio-button>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.buttonText !== undefined\" v-show=\"'picture-card' !== activeData['list-type']\"\r\n            label=\"鎸夐挳鏂囧瓧\">\r\n            <el-input v-model=\"activeData.buttonText\" placeholder=\"璇疯緭鍏ユ寜閽枃瀛梊" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['range-separator'] !== undefined\" label=\"鍒嗛殧绗">\r\n            <el-input v-model=\"activeData['range-separator']\" placeholder=\"璇疯緭鍏ュ垎闅旂\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['picker-options'] !== undefined\" label=\"鏃堕棿娈礬">\r\n            <el-input v-model=\"activeData['picker-options'].selectableRange\" placeholder=\"璇疯緭鍏ユ椂闂存\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.format !== undefined\" label=\"鏃堕棿鏍煎紡\">\r\n            <el-input :value=\"activeData.format\" placeholder=\"璇疯緭鍏ユ椂闂存牸寮廫" @input=\"setTimeValue($event)\" />\r\n          </el-form-item>\r\n          <template v-if=\"['el-checkbox-group', 'el-radio-group', 'el-select'].indexOf(activeData.tag) > -1\">\r\n            <el-divider>閫夐」</el-divider>\r\n            <draggable :list=\"activeData.options\" :animation=\"340\" group=\"selectItem\" handle=\".option-drag\"\r\n              item-key=\"label\">\r\n              <template #item=\"{ element, index }\">\r\n                <div :key=\"index\" class=\"select-item\">\r\n                  <div class=\"select-line-icon option-drag\">\r\n                    <i class=\"el-icon-s-operation\" />\r\n                  </div>\r\n                  <el-input v-model=\"element.label\" placeholder=\"閫夐」鍚峔" size=\"small\" />\r\n                  <el-input placeholder=\"閫夐」鍊糪" size=\"small\" :value=\"element.value\"\r\n                    @input=\"setOptionValue(element, $event)\" />\r\n                  <div class=\"close-btn select-line-icon\" @click=\"activeData.options.splice(index, 1)\">\r\n                    <el-icon>\r\n                      <Remove />\r\n                    </el-icon>\r\n                  </div>\r\n                </div>\r\n              </template>\r\n            </draggable>\r\n            <div>\r\n              <el-button icon=\"CirclePlus\" style=\"margin-left: 8px; margin-top: 10px;\" text bg type=\"primary\"\r\n                @click=\"addSelectItem\">\r\n                娣诲姞閫夐」\r\n              </el-button>\r\n            </div>\r\n            <el-divider />\r\n          </template>\r\n\r\n          <template v-if=\"['el-cascader'].indexOf(activeData.tag) > -1\">\r\n            <el-divider>閫夐」</el-divider>\r\n            <el-form-item label=\"鏁版嵁绫诲瀷\">\r\n              <el-radio-group v-model=\"activeData.dataType\" size=\"small\">\r\n                <el-radio-button label=\"dynamic\">\r\n                  鍔ㄦ€佹暟鎹甛r\n                </el-radio-button>\r\n                <el-radio-button label=\"static\">\r\n                  闈欐€佹暟鎹甛r\n                </el-radio-button>\r\n              </el-radio-group>\r\n            </el-form-item>\r\n\r\n            <template v-if=\"activeData.dataType === 'dynamic'\">\r\n              <el-form-item label=\"鏍囩閿悕\">\r\n                <el-input v-model=\"activeData.labelKey\" placeholder=\"璇疯緭鍏ユ爣绛鹃敭鍚峔" />\r\n              </el-form-item>\r\n              <el-form-item label=\"鍊奸敭鍚峔">\r\n                <el-input v-model=\"activeData.valueKey\" placeholder=\"璇疯緭鍏ュ€奸敭鍚峔" />\r\n              </el-form-item>\r\n              <el-form-item label=\"瀛愮骇閿悕\">\r\n                <el-input v-model=\"activeData.childrenKey\" placeholder=\"璇疯緭鍏ュ瓙绾ч敭鍚峔" />\r\n              </el-form-item>\r\n            </template>\r\n\r\n            <el-tree v-if=\"activeData.dataType === 'static'\" draggable :data=\"activeData.options\" node-key=\"id\"\r\n              :expand-on-click-node=\"false\" :render-content=\"renderContent\" />\r\n            <div v-if=\"activeData.dataType === 'static'\">\r\n              <el-button icon=\"CirclePlus\" style=\"margin-left: 0; margin-top: 10px;\" type=\"primary\" text bg\r\n                @click=\"addTreeItem\">\r\n                娣诲姞鐖剁骇\r\n              </el-button>\r\n            </div>\r\n            <el-divider />\r\n          </template>\r\n\r\n          <el-form-item v-if=\"activeData.optionType !== undefined\" label=\"閫夐」鏍峰紡\">\r\n            <el-radio-group v-model=\"activeData.optionType\">\r\n              <el-radio-button label=\"default\">\r\n                榛樿\r\n              </el-radio-button>\r\n              <el-radio-button label=\"button\">\r\n                鎸夐挳\r\n              </el-radio-button>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['active-color'] !== undefined\" label=\"寮€鍚鑹瞈">\r\n            <el-color-picker v-model=\"activeData['active-color']\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['inactive-color'] !== undefined\" label=\"鍏抽棴棰滆壊\">\r\n            <el-color-picker v-model=\"activeData['inactive-color']\" />\r\n          </el-form-item>\r\n\r\n          <el-form-item v-if=\"activeData['allow-half'] !== undefined\" label=\"鍏佽鍗婇€塡">\r\n            <el-switch v-model=\"activeData['allow-half']\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['show-text'] !== undefined\" label=\"杈呭姪鏂囧瓧\">\r\n            <el-switch v-model=\"activeData['show-text']\" @change=\"rateTextChange\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['show-score'] !== undefined\" label=\"鏄剧ず鍒嗘暟\">\r\n            <el-switch v-model=\"activeData['show-score']\" @change=\"rateScoreChange\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['show-stops'] !== undefined\" label=\"鏄剧ず闂存柇鐐筡">\r\n            <el-switch v-model=\"activeData['show-stops']\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.range !== undefined\" label=\"鑼冨洿閫夋嫨\">\r\n            <el-switch v-model=\"activeData.range\" @change=\"rangeChange\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.border !== undefined && activeData.optionType === 'default'\" label=\"鏄惁甯﹁竟妗哱">\r\n            <el-switch v-model=\"activeData.border\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-color-picker'\" label=\"棰滆壊鏍煎紡\">\r\n            <el-select v-model=\"activeData['color-format']\" placeholder=\"璇烽€夋嫨棰滆壊鏍煎紡\" :style=\"{ width: '100%' }\"\r\n              @change=\"colorFormatChange\">\r\n              <el-option v-for=\"(item, index) in colorFormatOptions\" :key=\"index\" :label=\"item.label\"\r\n                :value=\"item.value\" />\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.size !== undefined &&\r\n            (activeData.optionType === 'button' ||\r\n              activeData.border ||\r\n              activeData.tag === 'el-color-picker')\" label=\"閫夐」灏哄\">\r\n            <el-radio-group v-model=\"activeData.size\">\r\n              <el-radio-button label=\"large\">\r\n                杈冨ぇ\r\n              </el-radio-button>\r\n              <el-radio-button label=\"default\">\r\n                榛樿\r\n              </el-radio-button>\r\n              <el-radio-button label=\"small\">\r\n                杈冨皬\r\n              </el-radio-button>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['show-word-limit'] !== undefined\" label=\"杈撳叆缁熻\">\r\n            <el-switch v-model=\"activeData['show-word-limit']\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-input-number'\" label=\"涓ユ牸姝ユ暟\">\r\n            <el-switch v-model=\"activeData['step-strictly']\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-cascader'\" label=\"鏄惁澶氶€塡">\r\n            <el-switch v-model=\"activeData.props.props.multiple\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-cascader'\" label=\"灞曠ず鍏ㄨ矾寰刓">\r\n            <el-switch v-model=\"activeData['show-all-levels']\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-cascader'\" label=\"鍙惁绛涢€塡">\r\n            <el-switch v-model=\"activeData.filterable\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.clearable !== undefined\" label=\"鑳藉惁娓呯┖\">\r\n            <el-switch v-model=\"activeData.clearable\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.showTip !== undefined\" label=\"鏄剧ず鎻愮ず\">\r\n            <el-switch v-model=\"activeData.showTip\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.multiple !== undefined\" label=\"澶氶€夋枃浠禱">\r\n            <el-switch v-model=\"activeData.multiple\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData['auto-upload'] !== undefined\" label=\"鑷姩涓婁紶\">\r\n            <el-switch v-model=\"activeData['auto-upload']\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.readonly !== undefined\" label=\"鏄惁鍙\">\r\n            <el-switch v-model=\"activeData.readonly\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.disabled !== undefined\" label=\"鏄惁绂佺敤\">\r\n            <el-switch v-model=\"activeData.disabled\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-select'\" label=\"鏄惁鍙悳绱">\r\n            <el-switch v-model=\"activeData.filterable\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.tag === 'el-select'\" label=\"鏄惁澶氶€塡">\r\n            <el-switch v-model=\"activeData.multiple\" @change=\"multipleChange\" />\r\n          </el-form-item>\r\n          <el-form-item v-if=\"activeData.required !== undefined\" label=\"鏄惁蹇呭～\">\r\n            <el-switch v-model=\"activeData.required\" />\r\n          </el-form-item>\r\n\r\n          <template v-if=\"activeData.layoutTree\">\r\n            <el-divider>甯冨眬缁撴瀯鏍?/el-divider>\r\n            <el-tree :data=\"[activeData]\" :props=\"layoutTreeProps\" node-key=\"renderKey\" default-expand-all draggable>\r\n              <template #default=\"{ node, data }\">\r\n                <span class=\"node-label\">\r\n                  <svg-icon class=\"node-icon\" :icon-class=\"data.tagIcon\" style=\"margin-right: 5px;\" />\r\n                  {{ node.label }}\r\n                </span>\r\n              </template>\r\n            </el-tree>\r\n          </template>\r\n\r\n          <template v-if=\"activeData.layout === 'colFormItem'\">\r\n            <el-divider>姝ｅ垯鏍￠獙</el-divider>\r\n            <div v-for=\"(item, index) in activeData.regList\" :key=\"index\" class=\"reg-item\">\r\n              <span class=\"close-btn\" @click=\"activeData.regList.splice(index, 1)\">\r\n                <el-icon>\r\n                  <Close />\r\n                </el-icon>\r\n              </span>\r\n              <el-form-item label=\"琛ㄨ揪寮廫">\r\n                <el-input v-model=\"item.pattern\" placeholder=\"璇疯緭鍏ユ鍒橽" />\r\n              </el-form-item>\r\n              <el-form-item label=\"閿欒鎻愮ず\" style=\"margin-bottom:0\">\r\n                <el-input v-model=\"item.message\" placeholder=\"璇疯緭鍏ラ敊璇彁绀篭" />\r\n              </el-form-item>\r\n            </div>\r\n            <div>\r\n              <el-button icon=\"CirclePlus\" style=\"margin-left: 0; margin-top: 10px;\" type=\"primary\" text bg\r\n                @click=\"addReg\">\r\n                娣诲姞瑙勫垯\r\n              </el-button>\r\n            </div>\r\n          </template>\r\n        </el-form>\r\n        <!-- 琛ㄥ崟灞炴€?-->\r\n        <el-form v-show=\"currentTab === 'form'\" label-width=\"90px\" label-position=\"top\">\r\n          <el-form-item label=\"琛ㄥ崟鍚峔">\r\n            <el-input v-model=\"formConf.formRef\" placeholder=\"璇疯緭鍏ヨ〃鍗曞悕锛坮ef锛塡" />\r\n          </el-form-item>\r\n          <el-form-item label=\"琛ㄥ崟妯″瀷\">\r\n            <el-input v-model=\"formConf.formModel\" placeholder=\"璇疯緭鍏ユ暟鎹ā鍨媆" />\r\n          </el-form-item>\r\n          <el-form-item label=\"鏍￠獙妯″瀷\">\r\n            <el-input v-model=\"formConf.formRules\" placeholder=\"璇疯緭鍏ユ牎楠屾ā鍨媆" />\r\n          </el-form-item>\r\n          <el-form-item label=\"琛ㄥ崟灏哄\">\r\n            <el-radio-group v-model=\"formConf.size\">\r\n              <el-radio-button label=\"large\" value=\"杈冨ぇ\" />\r\n              <el-radio-button label=\"default\" value=\"榛樿\" />\r\n              <el-radio-button label=\"small\" value=\"杈冨皬\" />\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"鏍囩瀵归綈\">\r\n            <el-radio-group v-model=\"formConf.labelPosition\">\r\n              <el-radio-button label=\"left\" value=\"宸﹀榻怽" />\r\n              <el-radio-button label=\"right\" value=\"鍙冲榻怽" />\r\n              <el-radio-button label=\"top\" value=\"椤堕儴瀵归綈\" />\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item label=\"鏍囩瀹藉害\">\r\n            <el-input-number v-model=\"formConf.labelWidth\" placeholder=\"鏍囩瀹藉害\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"鏍呮牸闂撮殧\">\r\n            <el-input-number v-model=\"formConf.gutter\" :min=\"0\" placeholder=\"鏍呮牸闂撮殧\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"绂佺敤琛ㄥ崟\">\r\n            <el-switch v-model=\"formConf.disabled\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"琛ㄥ崟鎸夐挳\">\r\n            <el-switch v-model=\"formConf.formBtns\" />\r\n          </el-form-item>\r\n          <el-form-item label=\"鏄剧ず鏈€変腑缁勪欢杈规\">\r\n            <el-switch v-model=\"formConf.unFocusedComponentBorder\" />\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-scrollbar>\r\n    </div>\r\n    <icons-dialog v-model=\"iconsVisible\" :current=\"activeData[currentIconModel]\" @select=\"setIcon\" />\r\n    <treeNode-dialog v-model=\"dialogVisible\" @commit=\"addNode\" />\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport draggable from \"vuedraggable/dist/vuedraggable.common\"\r\nimport { isNumberStr } from '@/utils/index'\r\nimport IconsDialog from './IconsDialog'\r\nimport TreeNodeDialog from './TreeNodeDialog'\r\nimport { inputComponents, selectComponents } from '@/utils/generator/config'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst dateTimeFormat = {\r\n  date: 'YYYY-MM-DD',\r\n  week: 'YYYY 绗?ww 鍛?,\r\n  month: 'YYYY-MM',\r\n  year: 'YYYY',\r\n  datetime: 'YYYY-MM-DD HH:mm:ss',\r\n  daterange: 'YYYY-MM-DD',\r\n  monthrange: 'YYYY-MM',\r\n  datetimerange: 'YYYY-MM-DD HH:mm:ss'\r\n}\r\nconst props = defineProps({\r\n  showField: Boolean,\r\n  activeData: Object,\r\n  formConf: Object\r\n})\r\n\r\nconst data = reactive({\r\n  currentTab: 'field',\r\n  currentNode: null,\r\n  dialogVisible: false,\r\n  iconsVisible: false,\r\n  currentIconModel: null,\r\n  dateTypeOptions: [\r\n    {\r\n      label: '鏃?date)',\r\n      value: 'date'\r\n    },\r\n    {\r\n      label: '鍛?week)',\r\n      value: 'week'\r\n    },\r\n    {\r\n      label: '鏈?month)',\r\n      value: 'month'\r\n    },\r\n    {\r\n      label: '骞?year)',\r\n      value: 'year'\r\n    },\r\n    {\r\n      label: '鏃ユ湡鏃堕棿(datetime)',\r\n      value: 'datetime'\r\n    }\r\n  ],\r\n  dateRangeTypeOptions: [\r\n    {\r\n      label: '鏃ユ湡鑼冨洿(daterange)',\r\n      value: 'daterange'\r\n    },\r\n    {\r\n      label: '鏈堣寖鍥?monthrange)',\r\n      value: 'monthrange'\r\n    },\r\n    {\r\n      label: '鏃ユ湡鏃堕棿鑼冨洿(datetimerange)',\r\n      value: 'datetimerange'\r\n    }\r\n  ],\r\n  colorFormatOptions: [\r\n    {\r\n      label: 'hex',\r\n      value: 'hex'\r\n    },\r\n    {\r\n      label: 'rgb',\r\n      value: 'rgb'\r\n    },\r\n    {\r\n      label: 'rgba',\r\n      value: 'rgba'\r\n    },\r\n    {\r\n      label: 'hsv',\r\n      value: 'hsv'\r\n    },\r\n    {\r\n      label: 'hsl',\r\n      value: 'hsl'\r\n    }\r\n  ],\r\n  justifyOptions: [\r\n    {\r\n      label: 'start',\r\n      value: 'start'\r\n    },\r\n    {\r\n      label: 'end',\r\n      value: 'end'\r\n    },\r\n    {\r\n      label: 'center',\r\n      value: 'center'\r\n    },\r\n    {\r\n      label: 'space-around',\r\n      value: 'space-around'\r\n    },\r\n    {\r\n      label: 'space-between',\r\n      value: 'space-between'\r\n    }\r\n  ],\r\n  layoutTreeProps: {\r\n    label(data, node) {\r\n      return data.componentName || `${data.label}: ${data.vModel}`\r\n    }\r\n  }\r\n})\r\n\r\nconst { currentTab, currentNode, dialogVisible, iconsVisible, currentIconModel, dateTypeOptions, dateRangeTypeOptions, colorFormatOptions, justifyOptions, layoutTreeProps } = toRefs(data)\r\n\r\nconst documentLink = computed(() => props.activeData.document || 'https://element-plus.org/zh-CN/guide/installation')\r\n\r\nconst dateOptions = computed(() => {\r\n  if (props.activeData.type !== undefined && props.activeData.tag === 'el-date-picker') {\r\n    if (props.activeData['start-placeholder'] === undefined) {\r\n      return dateTypeOptions.value\r\n    }\r\n    return dateRangeTypeOptions.value\r\n  }\r\n  return []\r\n})\r\n\r\nconst tagList = ref([\r\n  {\r\n    label: '杈撳叆鍨嬬粍浠?,\r\n    options: inputComponents\r\n  },\r\n  {\r\n    label: '閫夋嫨鍨嬬粍浠?,\r\n    options: selectComponents\r\n  }\r\n])\r\n\r\nconst emit = defineEmits(['tag-change'])\r\n\r\nfunction addReg() {\r\n  props.activeData.regList.push({\r\n    pattern: '',\r\n    message: ''\r\n  })\r\n}\r\nfunction addSelectItem() {\r\n  props.activeData.options.push({\r\n    label: '',\r\n    value: ''\r\n  })\r\n}\r\n\r\nfunction addTreeItem() {\r\n  ++proxy.idGlobal\r\n  dialogVisible.value = true\r\n  currentNode.value = props.activeData.options\r\n}\r\n\r\nfunction renderContent(h, { node, data, store }) {\r\n  return h('div', {\r\n    class: \"custom-tree-node\"\r\n  }, [\r\n    h('span', node.label),\r\n    h('span', {\r\n      class: \"node-operation\"\r\n    }, [\r\n      h(resolveComponent('el-link'), {\r\n        type: \"primary\",\r\n        icon: \"Plus\",\r\n        underline: false,\r\n        onClick: () => {\r\n          append(data)\r\n\r\n        }\r\n      }),\r\n      h(resolveComponent('el-link'), {\r\n        type: \"danger\",\r\n        icon: \"Delete\",\r\n        underline: false,\r\n        style: \"margin-left: 5px;\",\r\n        onClick: () => {\r\n          remove(node, data)\r\n        }\r\n      })\r\n    ])\r\n  ])\r\n}\r\nfunction append(data) {\r\n  if (!data.children) {\r\n    data.children = []\r\n  }\r\n  dialogVisible.value = true\r\n  currentNode.value = data.children\r\n}\r\nfunction remove(node, data) {\r\n  const { parent } = node\r\n  const children = parent.data.children || parent.data\r\n  const index = children.findIndex(d => d.id === data.id)\r\n  children.splice(index, 1)\r\n}\r\nfunction addNode(data) {\r\n  currentNode.value.push(data)\r\n}\r\n\r\nfunction setOptionValue(item, val) {\r\n  item.value = isNumberStr(val) ? +val : val\r\n}\r\nfunction setDefaultValue(val) {\r\n  if (Array.isArray(val)) {\r\n    return val.join(',')\r\n  }\r\n  if (['string', 'number'].indexOf(val) > -1) {\r\n    return val\r\n  }\r\n  if (typeof val === 'boolean') {\r\n    return `${val}`\r\n  }\r\n  return val\r\n}\r\n\r\nfunction onDefaultValueInput(str) {\r\n  if (Array.isArray(props.activeData.defaultValue)) {\r\n    // 鏁扮粍\r\n    props.activeData.defaultValue = str.split(',').map(val => (isNumberStr(val) ? +val : val))\r\n  } else if (['true', 'false'].indexOf(str) > -1) {\r\n    // 甯冨皵\r\n    props.activeData.defaultValue = JSON.parse(str)\r\n  } else {\r\n    // 瀛楃涓插拰鏁板瓧\r\n    props.activeData.defaultValue = isNumberStr(str) ? +str : str\r\n  }\r\n}\r\n\r\nfunction onSwitchValueInput(val, name) {\r\n  if (['true', 'false'].indexOf(val) > -1) {\r\n    props.activeData[name] = JSON.parse(val)\r\n  } else {\r\n    props.activeData[name] = isNumberStr(val) ? +val : val\r\n  }\r\n}\r\n\r\nfunction setTimeValue(val, type) {\r\n  const valueFormat = type === 'week' ? dateTimeFormat.date : val\r\n  props.activeData.defaultValue = null\r\n  props.activeData['value-format'] = valueFormat\r\n  props.activeData.format = val\r\n}\r\n\r\nfunction spanChange(val) {\r\n  props.formConf.span = val\r\n}\r\n\r\nfunction multipleChange(val) {\r\n  props.activeData.defaultValue = val ? [] : ''\r\n}\r\n\r\nfunction dateTypeChange(val) {\r\n  setTimeValue(dateTimeFormat[val], val)\r\n}\r\n\r\nfunction rangeChange(val) {\r\n  props.activeData.defaultValue = val ? [props.activeData.min, props.activeData.max] : props.activeData.min\r\n}\r\n\r\nfunction rateTextChange(val) {\r\n  if (val) props.activeData['show-score'] = false\r\n}\r\n\r\nfunction rateScoreChange(val) {\r\n  if (val) props.activeData['show-text'] = false\r\n}\r\n\r\nfunction colorFormatChange(val) {\r\n  props.activeData.defaultValue = null\r\n  props.activeData['show-alpha'] = val.indexOf('a') > -1\r\n  props.activeData.renderKey = +new Date() // 鏇存柊renderKey,閲嶆柊娓叉煋璇ョ粍浠禱r\n}\r\n\r\nfunction openIconsDialog(model) {\r\n  iconsVisible.value = true\r\n  currentIconModel.value = model\r\n}\r\n\r\nfunction setIcon(val) {\r\n  props.activeData[currentIconModel.value] = val\r\n}\r\n\r\nfunction tagChange(tagIcon) {\r\n  let target = inputComponents.find(item => item.tagIcon === tagIcon)\r\n  if (!target) target = selectComponents.find(item => item.tagIcon === tagIcon)\r\n  emit('tag-change', target)\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.right-board {\r\n  width: 350px;\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  padding-top: 3px;\r\n\r\n  &:deep() {\r\n    .el-tabs__header {\r\n      margin: 0;\r\n    }\r\n\r\n    .el-input-group__append .el-button {\r\n      display: inline-flex;\r\n    }\r\n  }\r\n\r\n  .field-box {\r\n    position: relative;\r\n    height: calc(100vh - 50px - 40px - 42px);\r\n    box-sizing: border-box;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .el-scrollbar {\r\n    height: 100%;\r\n\r\n    &:deep() {\r\n      .el-scrollbar__view {\r\n        padding: 30px 20px;\r\n      }\r\n\r\n    }\r\n  }\r\n}\r\n\r\n.reg-item {\r\n  padding: 12px 6px;\r\n  background: var(--el-border-color-extra-light);\r\n  position: relative;\r\n  border-radius: 4px;\r\n\r\n  .close-btn {\r\n    position: absolute;\r\n    right: -6px;\r\n    top: -6px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 16px;\r\n    height: 16px;\r\n    line-height: 16px;\r\n    background: rgba(0, 0, 0, .2);\r\n    border-radius: 50%;\r\n    color: #fff;\r\n    z-index: 1;\r\n    cursor: pointer;\r\n    font-size: 12px;\r\n  }\r\n}\r\n\r\n.select-item {\r\n  display: flex;\r\n  border: 1px dashed #fff;\r\n  box-sizing: border-box;\r\n\r\n  & .close-btn {\r\n    cursor: pointer;\r\n    color: #f56c6c;\r\n  }\r\n\r\n  & .el-input+.el-input {\r\n    margin-left: 4px;\r\n  }\r\n}\r\n\r\n.select-item+.select-item {\r\n  margin-top: 4px;\r\n}\r\n\r\n.select-item.sortable-chosen {\r\n  border: 1px dashed #409eff;\r\n}\r\n\r\n.select-line-icon {\r\n  line-height: 32px;\r\n  font-size: 22px;\r\n  padding: 0 4px;\r\n  color: #777;\r\n}\r\n\r\n.option-drag {\r\n  cursor: move;\r\n}\r\n\r\n.time-range {\r\n  .el-date-editor {\r\n    width: 227px;\r\n  }\r\n\r\n  :deep() {\r\n    .el-icon-time {\r\n      display: none;\r\n    }\r\n  }\r\n}\r\n\r\n.document-link {\r\n  position: absolute;\r\n  display: flex;\r\n  width: 26px;\r\n  height: 26px;\r\n  top: 0;\r\n  left: 0;\r\n  cursor: pointer;\r\n  background: #409eff;\r\n  z-index: 1;\r\n  border-radius: 0 0 6px 0;\r\n  justify-content: center;\r\n  align-items: center;\r\n  color: #fff;\r\n  font-size: 18px;\r\n}\r\n\r\n.node-label {\r\n  font-size: 14px;\r\n}\r\n\r\n.node-icon {\r\n  color: #bebfc3;\r\n}\r\n\r\n.custom-tree-node {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  font-size: 14px;\r\n  padding-right: 8px;\r\n}\r\n</style>","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\build\\TreeNodeDialog.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\build\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'a' is defined but never used. Allowed unused args must match /^_/u.","line":152,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":152,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":267,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":267,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'trigger' is defined but never used. Allowed unused args must match /^_/u.","line":297,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":297,"endColumn":18},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used. Allowed unused args must match /^_/u.","line":303,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":303,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"container\">\r\n    <div class=\"left-board\">\r\n      <div class=\"logo-wrapper\">\r\n        <div class=\"logo\">\r\n          <img :src=\"logo\" alt=\"logo\"> Form Generator\r\n        </div>\r\n      </div>\r\n      <el-scrollbar class=\"left-scrollbar\">\r\n        <div class=\"components-list\">\r\n          <div class=\"components-title\">\r\n            <svg-icon icon-class=\"component\" />杈撳叆鍨嬬粍浠禱r\n          </div>\r\n          <draggable class=\"components-draggable\" :list=\"inputComponents\"\r\n            :group=\"{ name: 'componentsGroup', pull: 'clone', put: false }\" :clone=\"cloneComponent\"\r\n            draggable=\".components-item\" :sort=\"false\" @end=\"onEnd\" item-key=\"label\">\r\n            <template #item=\"{ element, index }\">\r\n              <div :key=\"index\" class=\"components-item\" @click=\"addComponent(element)\">\r\n                <div class=\"components-body\">\r\n                  <svg-icon :icon-class=\"element.tagIcon\" />\r\n                  {{ element.label }}\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </draggable>\r\n          <div class=\"components-title\">\r\n            <svg-icon icon-class=\"component\" />閫夋嫨鍨嬬粍浠禱r\n          </div>\r\n          <draggable class=\"components-draggable\" :list=\"selectComponents\"\r\n            :group=\"{ name: 'componentsGroup', pull: 'clone', put: false }\" :clone=\"cloneComponent\"\r\n            draggable=\".components-item\" :sort=\"false\" @end=\"onEnd\" item-key=\"label\">\r\n            <template #item=\"{ element, index }\">\r\n              <div :key=\"index\" class=\"components-item\" @click=\"addComponent(element)\">\r\n                <div class=\"components-body\">\r\n                  <svg-icon :icon-class=\"element.tagIcon\" />\r\n                  {{ element.label }}\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </draggable>\r\n          <div class=\"components-title\">\r\n            <svg-icon icon-class=\"component\" /> 甯冨眬鍨嬬粍浠禱r\n          </div>\r\n          <draggable class=\"components-draggable\" :list=\"layoutComponents\"\r\n            :group=\"{ name: 'componentsGroup', pull: 'clone', put: false }\" :clone=\"cloneComponent\"\r\n            draggable=\".components-item\" :sort=\"false\" @end=\"onEnd\" item-key=\"label\">\r\n            <template #item=\"{ element, index }\">\r\n              <div :key=\"index\" class=\"components-item\" @click=\"addComponent(element)\">\r\n                <div class=\"components-body\">\r\n                  <svg-icon :icon-class=\"element.tagIcon\" />\r\n                  {{ element.label }}\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </draggable>\r\n        </div>\r\n      </el-scrollbar>\r\n    </div>\r\n    <div class=\"center-board\">\r\n      <div class=\"action-bar\">\r\n        <el-button icon=\"Download\" type=\"primary\" text @click=\"download\">\r\n          瀵煎嚭vue鏂囦欢\r\n        </el-button>\r\n        <el-button class=\"copy-btn-main\" icon=\"DocumentCopy\" type=\"primary\" text @click=\"copy\">\r\n          澶嶅埗浠ｇ爜\r\n        </el-button>\r\n        <el-button class=\"delete-btn\" icon=\"Delete\" text @click=\"empty\" type=\"danger\">\r\n          娓呯┖\r\n        </el-button>\r\n      </div>\r\n      <el-scrollbar class=\"center-scrollbar\">\r\n        <el-row class=\"center-board-row\" :gutter=\"formConf.gutter\">\r\n          <el-form :size=\"formConf.size\" :label-position=\"formConf.labelPosition\" :disabled=\"formConf.disabled\"\r\n            :label-width=\"formConf.labelWidth + 'px'\">\r\n            <draggable class=\"drawing-board\" :list=\"drawingList\" :animation=\"340\" group=\"componentsGroup\"\r\n              item-key=\"label\">\r\n              <template #item=\"{ element, index }\">\r\n                <draggable-item :key=\"element.renderKey\" :drawing-list=\"drawingList\" :element=\"element\" :index=\"index\"\r\n                  :active-id=\"activeId\" :form-conf=\"formConf\" @activeItem=\"activeFormItem\" @copyItem=\"drawingItemCopy\"\r\n                  @deleteItem=\"drawingItemDelete\" />\r\n              </template>\r\n            </draggable>\r\n            <div v-show=\"!drawingList.length\" class=\"empty-info\">\r\n              浠庡乏渚ф嫋鍏ユ垨鐐归€夌粍浠惰繘琛岃〃鍗曡璁r\n            </div>\r\n          </el-form>\r\n        </el-row>\r\n      </el-scrollbar>\r\n    </div>\r\n    <right-panel :active-data=\"activeData\" :form-conf=\"formConf\" :show-field=\"!!drawingList.length\"\r\n      @tag-change=\"tagChange\" />\r\n\r\n    <code-type-dialog v-model=\"dialogVisible\" title=\"閫夋嫨鐢熸垚绫诲瀷\" :showFileName=\"showFileName\" @confirm=\"generate\" />\r\n    <input id=\"copyNode\" type=\"hidden\">\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport draggable from \"vuedraggable/dist/vuedraggable.common\"\r\nimport ClipboardJS from 'clipboard'\r\nimport beautifier from 'js-beautify'\r\nimport logo from '@/assets/logo/logo.png'\r\nimport { inputComponents, selectComponents, layoutComponents, formConf as formConfData } from '@/utils/generator/config'\r\nimport { beautifierConf } from '@/utils/index'\r\nimport drawingDefalut from '@/utils/generator/drawingDefalut'\r\nimport { makeUpHtml, vueTemplate, vueScript, cssStyle } from '@/utils/generator/html'\r\nimport { makeUpJs } from '@/utils/generator/js'\r\nimport { makeUpCss } from '@/utils/generator/css'\r\nimport Download from '@/plugins/download'\r\nimport { ElNotification } from 'element-plus'\r\nimport DraggableItem from './DraggableItem'\r\nimport RightPanel from './RightPanel'\r\nimport CodeTypeDialog from './CodeTypeDialog'\r\nimport { onMounted, watch } from 'vue'\r\n\r\nconst drawingList = ref(drawingDefalut)\r\nconst { proxy } = getCurrentInstance()\r\nconst dialogVisible = ref(false)\r\nconst showFileName = ref(false)\r\nconst operationType = ref('')\r\nconst idGlobal = ref(100)\r\nconst activeData = ref(drawingDefalut[0])\r\nconst activeId = ref(drawingDefalut[0].formId)\r\nconst generateConf = ref(null)\r\nconst formData = ref({})\r\nconst formConf = ref(formConfData)\r\nlet oldActiveId\r\nlet tempActiveData\r\n\r\nfunction activeFormItem(element) {\r\n  activeData.value = element\r\n  activeId.value = element.formId\r\n}\r\nfunction copy() {\r\n  dialogVisible.value = true\r\n  showFileName.value = false\r\n  operationType.value = 'copy'\r\n}\r\nfunction download() {\r\n  dialogVisible.value = true\r\n  showFileName.value = true\r\n  operationType.value = 'download'\r\n}\r\nfunction empty() {\r\n  proxy.$modal.confirm('纭畾瑕佹竻绌烘墍鏈夌粍浠跺悧锛?, '鎻愮ず', { type: 'warning' }).then(() => {\r\n      idGlobal.value = 100\r\n      drawingList.value = []\r\n    }\r\n  )\r\n}\r\n\r\nfunction onEnd(obj, a) {\r\n  if (obj.from !== obj.to) {\r\n    activeData.value = tempActiveData\r\n    activeId.value = idGlobal.value\r\n  }\r\n}\r\n\r\nfunction addComponent(item) {\r\n  const clone = cloneComponent(item)\r\n  drawingList.value.push(clone)\r\n  activeFormItem(clone)\r\n}\r\n\r\nfunction cloneComponent(origin) {\r\n  const clone = JSON.parse(JSON.stringify(origin))\r\n  clone.formId = ++idGlobal.value\r\n  clone.span = formConf.value.span\r\n  clone.renderKey = +new Date() // 鏀瑰彉renderKey鍚庡彲浠ュ疄鐜板己鍒舵洿鏂扮粍浠禱r\n  if (!clone.layout) clone.layout = 'colFormItem'\r\n  if (clone.layout === 'colFormItem') {\r\n    clone.vModel = `field${idGlobal.value}`\r\n    clone.placeholder !== undefined && (clone.placeholder += clone.label)\r\n    tempActiveData = clone\r\n  } else if (clone.layout === 'rowFormItem') {\r\n    delete clone.label\r\n    clone.componentName = `row${idGlobal.value}`\r\n    clone.gutter = formConf.value.gutter\r\n    tempActiveData = clone\r\n  }\r\n  return tempActiveData\r\n}\r\n\r\nfunction drawingItemCopy(item, parent) {\r\n  let clone = JSON.parse(JSON.stringify(item))\r\n  clone = createIdAndKey(clone)\r\n  parent.push(clone)\r\n  activeFormItem(clone)\r\n}\r\n\r\n\r\nfunction createIdAndKey(item) {\r\n  item.formId = ++idGlobal.value\r\n  item.renderKey = +new Date()\r\n  if (item.layout === 'colFormItem') {\r\n    item.vModel = `field${idGlobal.value}`\r\n  } else if (item.layout === 'rowFormItem') {\r\n    item.componentName = `row${idGlobal.value}`\r\n  }\r\n  if (Array.isArray(item.children)) {\r\n    item.children = item.children.map(childItem => createIdAndKey(childItem))\r\n  }\r\n  return item\r\n}\r\n\r\nfunction drawingItemDelete(index, parent) {\r\n  parent.splice(index, 1)\r\n  nextTick(() => {\r\n    const len = drawingList.value.length\r\n    if (len) {\r\n      activeFormItem(drawingList.value[len - 1])\r\n    }\r\n  })\r\n}\r\n\r\nfunction tagChange(newTag) {\r\n  newTag = cloneComponent(newTag)\r\n  newTag.vModel = activeData.value.vModel\r\n  newTag.formId = activeId.value\r\n  newTag.span = activeData.value.span\r\n  delete activeData.value.tag\r\n  delete activeData.value.tagIcon\r\n  delete activeData.value.document\r\n  Object.keys(newTag).forEach(key => {\r\n    if (activeData.value[key] !== undefined\r\n      && typeof activeData.value[key] === typeof newTag[key]) {\r\n      newTag[key] = activeData.value[key]\r\n    }\r\n  })\r\n  activeData.value = newTag\r\n  updateDrawingList(newTag, drawingList.value)\r\n}\r\n\r\n\r\nfunction updateDrawingList(newTag, list) {\r\n  const index = list.findIndex(item => item.formId === activeId.value)\r\n  if (index > -1) {\r\n    list.splice(index, 1, newTag)\r\n  } else {\r\n    list.forEach(item => {\r\n      if (Array.isArray(item.children)) updateDrawingList(newTag, item.children)\r\n    })\r\n  }\r\n}\r\nfunction generate(data) {\r\n  generateConf.value = data\r\n  nextTick(() => {\r\n    switch (operationType.value) {\r\n      case 'copy':\r\n        execCopy(data)\r\n        break\r\n      case 'download':\r\n        execDownload(data)\r\n        break\r\n      default:\r\n        break\r\n    }\r\n  })\r\n}\r\n\r\nfunction execDownload(data) {\r\n  const codeStr = generateCode()\r\n  const blob = new Blob([codeStr], { type: 'text/plain;charset=utf-8' })\r\n  Download.saveAs(blob, data.fileName)\r\n}\r\n\r\nfunction execCopy(data) {\r\n  document.getElementById('copyNode').click()\r\n}\r\nfunction AssembleFormData() {\r\n  formData.value = { fields: JSON.parse(JSON.stringify(drawingList.value)), ...formConf.value }\r\n}\r\nfunction generateCode() {\r\n  const { type } = generateConf.value\r\n  AssembleFormData()\r\n  const script = vueScript(makeUpJs(formData.value, type))\r\n  const html = vueTemplate(makeUpHtml(formData.value, type))\r\n  const css = cssStyle(makeUpCss(formData.value))\r\n  return beautifier.html(html + script + css, beautifierConf.html)\r\n}\r\nwatch(() => activeData.value.label, (val, oldVal) => {\r\n  if (\r\n    activeData.value.placeholder === undefined\r\n    || !activeData.value.tag\r\n    || oldActiveId !== activeId.value\r\n  ) {\r\n    return\r\n  }\r\n  activeData.value.placeholder = activeData.value.placeholder.replace(oldVal, '') + val\r\n})\r\nwatch(activeId, (val) => {\r\n  oldActiveId = val\r\n}, { immediate: true })\r\n\r\nonMounted(() => {\r\n  const clipboard = new ClipboardJS('#copyNode', {\r\n    text: trigger => {\r\n      const codeStr = generateCode()\r\n      ElNotification({ title: '鎴愬姛', message: '浠ｇ爜宸插鍒跺埌鍓垏鏉匡紝鍙矘璐淬€?, type: 'success' })\r\n      return codeStr\r\n    }\r\n  })\r\n  clipboard.on('error', e => {\r\n    proxy.$modal.msgError('浠ｇ爜澶嶅埗澶辫触')\r\n  })\r\n})\r\n</script>\r\n\r\n<style lang='scss'>\r\n$lighterBlue: #409EFF;\r\n\r\n.container {\r\n  position: relative;\r\n  width: 100%;\r\n  background-color: var(--el-bg-color-overlay);\r\n  height: calc(100vh - 50px - 40px);\r\n  overflow: hidden;\r\n\r\n  .left-board {\r\n    width: 260px;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    height: calc(100vh - 50px - 40px);\r\n\r\n    .logo-wrapper {\r\n      position: relative;\r\n      height: 42px;\r\n      border-bottom: 1px solid var(--el-border-color-extra-light);\r\n      box-sizing: border-box;\r\n\r\n      .logo {\r\n        position: absolute;\r\n        left: 12px;\r\n        top: 6px;\r\n        line-height: 30px;\r\n        color: #00afff;\r\n        font-weight: 600;\r\n        font-size: 17px;\r\n        white-space: nowrap;\r\n\r\n        >img {\r\n          width: 30px;\r\n          height: 30px;\r\n          vertical-align: top;\r\n        }\r\n\r\n        .github {\r\n          display: inline-block;\r\n          vertical-align: sub;\r\n          margin-left: 15px;\r\n\r\n          >img {\r\n            height: 22px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    .left-scrollbar {\r\n      .el-scrollbar__wrap {\r\n        box-sizing: border-box;\r\n        overflow-x: hidden !important;\r\n        margin-bottom: 0 !important;\r\n\r\n        .components-list {\r\n          padding: 8px;\r\n          box-sizing: border-box;\r\n          height: 100%;\r\n\r\n          .components-title {\r\n            font-size: 14px;\r\n            // color: #222;\r\n            margin: 6px 2px;\r\n\r\n            .svg-icon {\r\n              // color: #666;\r\n              font-size: 18px;\r\n              margin-right: 5px;\r\n            }\r\n          }\r\n\r\n          .components-draggable {\r\n            padding-bottom: 20px;\r\n\r\n            .components-item {\r\n              display: inline-block;\r\n              width: 48%;\r\n              margin: 1%;\r\n              transition: transform 0ms !important;\r\n\r\n              .components-body {\r\n                padding: 8px 10px;\r\n                background: var(--el-border-color-extra-light);\r\n                font-size: 12px;\r\n                cursor: move;\r\n                border: 1px dashed var(--el-border-color-extra-light);\r\n                border-radius: 3px;\r\n\r\n                .svg-icon {\r\n                  // color: #777;\r\n                  font-size: 15px;\r\n                  margin-right: 5px;\r\n                }\r\n\r\n                &:hover {\r\n                  border: 1px dashed #787be8;\r\n                  color: #787be8;\r\n\r\n                  .svg-icon {\r\n                    color: #787be8;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .center-board {\r\n    height: calc(100vh - 50px - 40px);\r\n    width: auto;\r\n    margin: 0 350px 0 260px;\r\n    box-sizing: border-box;\r\n\r\n    .action-bar {\r\n      position: relative;\r\n      height: 42px;\r\n      padding: 0 15px;\r\n      box-sizing: border-box;\r\n      ;\r\n      border: 1px solid var(--el-border-color-extra-light);\r\n      border-top: none;\r\n      border-left: none;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: flex-end;\r\n\r\n      u .delete-btn {\r\n        color: #F56C6C;\r\n      }\r\n    }\r\n\r\n    .center-scrollbar {\r\n      height: calc(100vh - 50px - 40px - 42px);\r\n      overflow: hidden;\r\n      border-left: 1px solid var(--el-border-color-extra-light);\r\n      border-right: 1px solid var(--el-border-color-extra-light);\r\n      box-sizing: border-box;\r\n\r\n      .el-scrollbar__view {\r\n        overflow-x: hidden;\r\n      }\r\n\r\n      .center-board-row {\r\n        padding: 12px 12px 15px 12px;\r\n        box-sizing: border-box;\r\n\r\n        &>.el-form {\r\n          // 69 = 12+15+42\r\n          height: calc(100vh - 50px - 40px - 69px);\r\n          flex: 1;\r\n\r\n          .drawing-board {\r\n            height: 100%;\r\n            position: relative;\r\n\r\n            .components-body {\r\n              padding: 0;\r\n              margin: 0;\r\n              font-size: 0;\r\n            }\r\n\r\n            .sortable-ghost {\r\n              position: relative;\r\n              display: block;\r\n              overflow: hidden;\r\n\r\n              &::before {\r\n                content: \" \";\r\n                position: absolute;\r\n                left: 0;\r\n                right: 0;\r\n                top: 0;\r\n                height: 3px;\r\n                background: rgb(89, 89, 223);\r\n                z-index: 2;\r\n              }\r\n            }\r\n\r\n            .components-item.sortable-ghost {\r\n              width: 100%;\r\n              height: 60px;\r\n              background: var(--el-border-color-extra-light);\r\n            }\r\n\r\n            .active-from-item {\r\n              &>.el-form-item {\r\n                background: var(--el-border-color-extra-light);\r\n                border-radius: 6px;\r\n              }\r\n\r\n              &>.drawing-item-copy,\r\n              &>.drawing-item-delete {\r\n                display: initial;\r\n              }\r\n\r\n              &>.component-name {\r\n                color: $lighterBlue;\r\n              }\r\n\r\n              .el-input__wrapper {\r\n                box-shadow: 0 0 0 1px var(--el-input-hover-border-color) inset;\r\n              }\r\n            }\r\n\r\n            .el-form-item {\r\n              margin-bottom: 15px;\r\n            }\r\n          }\r\n\r\n          .drawing-item {\r\n            position: relative;\r\n            cursor: move;\r\n\r\n            &.unfocus-bordered:not(.activeFromItem)>div:first-child {\r\n              border: 1px dashed #ccc;\r\n            }\r\n\r\n            .el-form-item {\r\n              padding: 12px 10px;\r\n            }\r\n          }\r\n\r\n          .drawing-row-item {\r\n            position: relative;\r\n            cursor: move;\r\n            box-sizing: border-box;\r\n            border: 1px dashed #ccc;\r\n            border-radius: 3px;\r\n            padding: 0 2px;\r\n            margin-bottom: 15px;\r\n\r\n            .drawing-row-item {\r\n              margin-bottom: 2px;\r\n            }\r\n\r\n            .el-col {\r\n              margin-top: 22px;\r\n            }\r\n\r\n            .el-form-item {\r\n              margin-bottom: 0;\r\n            }\r\n\r\n            .drag-wrapper {\r\n              min-height: 80px;\r\n              flex: 1;\r\n              display: flex;\r\n              flex-wrap: wrap;\r\n            }\r\n\r\n            &.active-from-item {\r\n              border: 1px dashed $lighterBlue;\r\n            }\r\n\r\n            .component-name {\r\n              position: absolute;\r\n              top: 0;\r\n              left: 0;\r\n              font-size: 12px;\r\n              color: #bbb;\r\n              display: inline-block;\r\n              padding: 0 6px;\r\n            }\r\n          }\r\n\r\n          .drawing-item,\r\n          .drawing-row-item {\r\n            &:hover {\r\n              &>.el-form-item {\r\n                background: var(--el-border-color-extra-light);\r\n                border-radius: 6px;\r\n              }\r\n\r\n              &>.drawing-item-copy,\r\n              &>.drawing-item-delete {\r\n                display: initial;\r\n              }\r\n            }\r\n\r\n            &>.drawing-item-copy,\r\n            &>.drawing-item-delete {\r\n              display: none;\r\n              position: absolute;\r\n              top: -10px;\r\n              width: 22px;\r\n              height: 22px;\r\n              line-height: 22px;\r\n              text-align: center;\r\n              border-radius: 50%;\r\n              font-size: 12px;\r\n              border: 1px solid;\r\n              cursor: pointer;\r\n              z-index: 1;\r\n            }\r\n\r\n            &>.drawing-item-copy {\r\n              right: 56px;\r\n              border-color: $lighterBlue;\r\n              color: $lighterBlue;\r\n              background: #fff;\r\n\r\n              &:hover {\r\n                background: $lighterBlue;\r\n                color: #fff;\r\n              }\r\n            }\r\n\r\n            &>.drawing-item-delete {\r\n              right: 24px;\r\n              border-color: #F56C6C;\r\n              color: #F56C6C;\r\n              background: #fff;\r\n\r\n              &:hover {\r\n                background: #F56C6C;\r\n                color: #fff;\r\n              }\r\n            }\r\n          }\r\n\r\n          .empty-info {\r\n            position: absolute;\r\n            top: 46%;\r\n            left: 0;\r\n            right: 0;\r\n            text-align: center;\r\n            font-size: 18px;\r\n            color: #ccb1ea;\r\n            letter-spacing: 4px;\r\n          }\r\n\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\gen\\basicInfoForm.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\gen\\createTable.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\gen\\editTable.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\gen\\genInfoForm.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":264,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":264,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <el-form ref=\"genInfoForm\" :model=\"info\" :rules=\"rules\" label-width=\"150px\">\r\n    <el-row>\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"tplCategory\">\r\n          <template #label>鐢熸垚妯℃澘</template>\r\n          <el-select v-model=\"info.tplCategory\" @change=\"tplSelectChange\">\r\n            <el-option label=\"鍗曡〃锛堝鍒犳敼鏌ワ級\" value=\"crud\" />\r\n            <el-option label=\"鏍戣〃锛堝鍒犳敼鏌ワ級\" value=\"tree\" />\r\n            <el-option label=\"涓诲瓙琛紙澧炲垹鏀规煡锛塡" value=\"sub\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"tplWebType\">\r\n          <template #label>鍓嶇绫诲瀷</template>\r\n          <el-select v-model=\"info.tplWebType\">\r\n            <el-option label=\"Vue2 Element UI 妯＄増\" value=\"element-ui\" />\r\n            <el-option label=\"Vue3 Element Plus 妯＄増\" value=\"element-plus\" />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"packageName\">\r\n          <template #label>\r\n            鐢熸垚鍖呰矾寰刓r\n            <el-tooltip content=\"鐢熸垚鍦ㄥ摢涓猨ava鍖呬笅锛屼緥濡?com.ruoyi.system\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.packageName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"moduleName\">\r\n          <template #label>\r\n            鐢熸垚妯″潡鍚峔r\n            <el-tooltip content=\"鍙悊瑙ｄ负瀛愮郴缁熷悕锛屼緥濡?system\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.moduleName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"businessName\">\r\n          <template #label>\r\n            鐢熸垚涓氬姟鍚峔r\n            <el-tooltip content=\"鍙悊瑙ｄ负鍔熻兘鑻辨枃鍚嶏紝渚嬪 user\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.businessName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"functionName\">\r\n          <template #label>\r\n            鐢熸垚鍔熻兘鍚峔r\n            <el-tooltip content=\"鐢ㄤ綔绫绘弿杩帮紝渚嬪 鐢ㄦ埛\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.functionName\" />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item prop=\"genType\">\r\n          <template #label>\r\n            鐢熸垚浠ｇ爜鏂瑰紡\r\n            <el-tooltip content=\"榛樿涓簔ip鍘嬬缉鍖呬笅杞斤紝涔熷彲浠ヨ嚜瀹氫箟鐢熸垚璺緞\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-radio v-model=\"info.genType\" value=\"0\">zip鍘嬬缉鍖?/el-radio>\r\n          <el-radio v-model=\"info.genType\" value=\"1\">鑷畾涔夎矾寰?/el-radio>\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"12\">\r\n        <el-form-item>\r\n          <template #label>\r\n            涓婄骇鑿滃崟\r\n            <el-tooltip content=\"鍒嗛厤鍒版寚瀹氳彍鍗曚笅锛屼緥濡?绯荤粺绠＄悊\" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-tree-select\r\n            v-model=\"info.parentMenuId\"\r\n            :data=\"menuOptions\"\r\n            :props=\"{ value: 'menuId', label: 'menuName', children: 'children' }\"\r\n            value-key=\"menuId\"\r\n            placeholder=\"璇烽€夋嫨绯荤粺鑿滃崟\"\r\n            check-strictly\r\n          />\r\n        </el-form-item>\r\n      </el-col>\r\n\r\n      <el-col :span=\"24\" v-if=\"info.genType == '1'\">\r\n        <el-form-item prop=\"genPath\">\r\n          <template #label>\r\n            鑷畾涔夎矾寰刓r\n            <el-tooltip content=\"濉啓纾佺洏缁濆璺緞锛岃嫢涓嶅～鍐欙紝鍒欑敓鎴愬埌褰撳墠Web椤圭洰涓媆" placement=\"top\">\r\n              <el-icon><question-filled /></el-icon>\r\n            </el-tooltip>\r\n          </template>\r\n          <el-input v-model=\"info.genPath\">\r\n            <template #append>\r\n              <el-dropdown>\r\n                <el-button type=\"primary\">\r\n                  鏈€杩戣矾寰勫揩閫熼€夋嫨\r\n                  <i class=\"el-icon-arrow-down el-icon--right\"></i>\r\n                </el-button>\r\n                <template #dropdown>\r\n                  <el-dropdown-menu>\r\n                    <el-dropdown-item @click=\"info.genPath = '/'\">鎭㈠榛樿鐨勭敓鎴愬熀纭€璺緞</el-dropdown-item>\r\n                  </el-dropdown-menu>\r\n                </template>\r\n              </el-dropdown>\r\n            </template>\r\n          </el-input>\r\n        </el-form-item>\r\n      </el-col>\r\n    </el-row>\r\n    \r\n    <template v-if=\"info.tplCategory == 'tree'\">\r\n      <h4 class=\"form-header\">鍏朵粬淇℃伅</h4>\r\n      <el-row v-show=\"info.tplCategory == 'tree'\">\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              鏍戠紪鐮佸瓧娈礬r\n              <el-tooltip content=\"鏍戞樉绀虹殑缂栫爜瀛楁鍚嶏紝 濡傦細dept_id\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.treeCode\" placeholder=\"璇烽€夋嫨\">\r\n              <el-option\r\n                v-for=\"(column, index) in info.columns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '锛? + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              鏍戠埗缂栫爜瀛楁\r\n              <el-tooltip content=\"鏍戞樉绀虹殑鐖剁紪鐮佸瓧娈靛悕锛?濡傦細parent_Id\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.treeParentCode\" placeholder=\"璇烽€夋嫨\">\r\n              <el-option\r\n                v-for=\"(column, index) in info.columns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '锛? + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              鏍戝悕绉板瓧娈礬r\n              <el-tooltip content=\"鏍戣妭鐐圭殑鏄剧ず鍚嶇О瀛楁鍚嶏紝 濡傦細dept_name\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.treeName\" placeholder=\"璇烽€夋嫨\">\r\n              <el-option\r\n                v-for=\"(column, index) in info.columns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '锛? + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </template>\r\n\r\n    <template v-if=\"info.tplCategory == 'sub'\">\r\n      <h4 class=\"form-header\">鍏宠仈淇℃伅</h4>\r\n      <el-row>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              鍏宠仈瀛愯〃鐨勮〃鍚峔r\n              <el-tooltip content=\"鍏宠仈瀛愯〃鐨勮〃鍚嶏紝 濡傦細sys_user\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.subTableName\" placeholder=\"璇烽€夋嫨\" @change=\"subSelectChange\">\r\n              <el-option\r\n                v-for=\"(table, index) in tables\"\r\n                :key=\"index\"\r\n                :label=\"table.tableName + '锛? + table.tableComment\"\r\n                :value=\"table.tableName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"12\">\r\n          <el-form-item>\r\n            <template #label>\r\n              瀛愯〃鍏宠仈鐨勫閿悕\r\n              <el-tooltip content=\"瀛愯〃鍏宠仈鐨勫閿悕锛?濡傦細user_id\" placement=\"top\">\r\n                <el-icon><question-filled /></el-icon>\r\n              </el-tooltip>\r\n            </template>\r\n            <el-select v-model=\"info.subTableFkName\" placeholder=\"璇烽€夋嫨\">\r\n              <el-option\r\n                v-for=\"(column, index) in subColumns\"\r\n                :key=\"index\"\r\n                :label=\"column.columnName + '锛? + column.columnComment\"\r\n                :value=\"column.columnName\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </template>\r\n\r\n  </el-form>\r\n</template>\r\n\r\n<script setup>\r\nimport { listMenu } from \"@/api/system/menu\"\r\n\r\nconst subColumns = ref([])\r\nconst menuOptions = ref([])\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst props = defineProps({\r\n  info: {\r\n    type: Object,\r\n    default: null\r\n  },\r\n  tables: {\r\n    type: Array,\r\n    default: null\r\n  }\r\n})\r\n\r\n// 琛ㄥ崟鏍￠獙\r\nconst rules = ref({\r\n  tplCategory: [{ required: true, message: \"璇烽€夋嫨鐢熸垚妯℃澘\", trigger: \"blur\" }],\r\n  packageName: [{ required: true, message: \"璇疯緭鍏ョ敓鎴愬寘璺緞\", trigger: \"blur\" }],\r\n  moduleName: [{ required: true, message: \"璇疯緭鍏ョ敓鎴愭ā鍧楀悕\", trigger: \"blur\" }],\r\n  businessName: [{ required: true, message: \"璇疯緭鍏ョ敓鎴愪笟鍔″悕\", trigger: \"blur\" }],\r\n  functionName: [{ required: true, message: \"璇疯緭鍏ョ敓鎴愬姛鑳藉悕\", trigger: \"blur\" }]\r\n})\r\n\r\nfunction subSelectChange(value) {\r\n  props.info.subTableFkName = \"\"\r\n}\r\n\r\nfunction tplSelectChange(value) {\r\n  if (value !== \"sub\") {\r\n    props.info.subTableName = \"\"\r\n    props.info.subTableFkName = \"\"\r\n  }\r\n}\r\n\r\nfunction setSubTableColumns(value) {\r\n  for (var item in props.tables) {\r\n    const name = props.tables[item].tableName\r\n    if (value === name) {\r\n      subColumns.value = props.tables[item].columns\r\n      break\r\n    }\r\n  }\r\n}\r\n\r\n/** 鏌ヨ鑿滃崟涓嬫媺鏍戠粨鏋?*/\r\nfunction getMenuTreeselect() {\r\n  listMenu().then(response => {\r\n    menuOptions.value = proxy.handleTree(response.data, \"menuId\")\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  getMenuTreeselect()\r\n})\r\n\r\nwatch(() => props.info.subTableName, val => {\r\n  setSubTableColumns(val)\r\n})\r\n\r\nwatch(() => props.info.tplWebType, val => {\r\n  if (val === '') {\r\n    props.info.tplWebType = \"element-plus\"\r\n  }\r\n})\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\gen\\importTable.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\gen\\index.vue","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'router' is defined but never used. Allowed unused vars must match /^_/u.","line":150,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":150,"endColumn":14},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is defined but never used. Allowed unused args must match /^_/u.","line":223,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":223,"endColumn":41},{"ruleId":"no-unused-vars","severity":1,"message":"'prop' is defined but never used. Allowed unused args must match /^_/u.","line":282,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":282,"endColumn":39},{"ruleId":"no-unused-vars","severity":1,"message":"'order' is defined but never used. Allowed unused args must match /^_/u.","line":282,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":282,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"<template>\r\n  <div class=\"app-container\">\r\n    <el-form :model=\"queryParams\" ref=\"queryRef\" :inline=\"true\" v-show=\"showSearch\">\r\n      <el-form-item label=\"琛ㄥ悕绉癨" prop=\"tableName\">\r\n        <el-input\r\n          v-model=\"queryParams.tableName\"\r\n          placeholder=\"璇疯緭鍏ヨ〃鍚嶇О\"\r\n          clearable\r\n          style=\"width: 200px\"\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"琛ㄦ弿杩癨" prop=\"tableComment\">\r\n        <el-input\r\n          v-model=\"queryParams.tableComment\"\r\n          placeholder=\"璇疯緭鍏ヨ〃鎻忚堪\"\r\n          clearable\r\n          style=\"width: 200px\"\r\n          @keyup.enter=\"handleQuery\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"鍒涘缓鏃堕棿\" style=\"width: 308px\">\r\n        <el-date-picker\r\n          v-model=\"dateRange\"\r\n          value-format=\"YYYY-MM-DD\"\r\n          type=\"daterange\"\r\n          range-separator=\"-\"\r\n          start-placeholder=\"寮€濮嬫棩鏈焅"\r\n          end-placeholder=\"缁撴潫鏃ユ湡\"\r\n        ></el-date-picker>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"Search\" @click=\"handleQuery\">鎼滅储</el-button>\r\n        <el-button icon=\"Refresh\" @click=\"resetQuery\">閲嶇疆</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Download\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleGenTable\"\r\n          v-hasPermi=\"['tool:gen:code']\"\r\n        >鐢熸垚</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"primary\"\r\n          plain\r\n          icon=\"Plus\"\r\n          @click=\"openCreateTable\"\r\n          v-hasRole=\"['admin']\"\r\n        >鍒涘缓</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"info\"\r\n          plain\r\n          icon=\"Upload\"\r\n          @click=\"openImportTable\"\r\n          v-hasPermi=\"['tool:gen:import']\"\r\n        >瀵煎叆</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"success\"\r\n          plain\r\n          icon=\"Edit\"\r\n          :disabled=\"single\"\r\n          @click=\"handleEditTable\"\r\n          v-hasPermi=\"['tool:gen:edit']\"\r\n        >淇敼</el-button>\r\n      </el-col>\r\n      <el-col :span=\"1.5\">\r\n        <el-button\r\n          type=\"danger\"\r\n          plain\r\n          icon=\"Delete\"\r\n          :disabled=\"multiple\"\r\n          @click=\"handleDelete\"\r\n          v-hasPermi=\"['tool:gen:remove']\"\r\n        >鍒犻櫎</el-button>\r\n      </el-col>\r\n      <right-toolbar v-model:showSearch=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\r\n    </el-row>\r\n\r\n    <el-table ref=\"genRef\" v-loading=\"loading\" :data=\"tableList\" @selection-change=\"handleSelectionChange\" :default-sort=\"defaultSort\" @sort-change=\"handleSortChange\">\r\n      <el-table-column type=\"selection\" align=\"center\" width=\"55\"></el-table-column>\r\n      <el-table-column label=\"搴忓彿\" type=\"index\" width=\"50\" align=\"center\">\r\n        <template #default=\"scope\">\r\n          <span>{{(queryParams.pageNum - 1) * queryParams.pageSize + scope.$index + 1}}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"琛ㄥ悕绉癨" align=\"center\" prop=\"tableName\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"琛ㄦ弿杩癨" align=\"center\" prop=\"tableComment\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"瀹炰綋\" align=\"center\" prop=\"className\" :show-overflow-tooltip=\"true\" />\r\n      <el-table-column label=\"鍒涘缓鏃堕棿\" align=\"center\" prop=\"createTime\" width=\"160\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\" />\r\n      <el-table-column label=\"鏇存柊鏃堕棿\" align=\"center\" prop=\"updateTime\" width=\"160\" sortable=\"custom\" :sort-orders=\"['descending', 'ascending']\" />\r\n      <el-table-column label=\"鎿嶄綔\" align=\"center\" width=\"330\" class-name=\"small-padding fixed-width\">\r\n        <template #default=\"scope\">\r\n          <el-tooltip content=\"棰勮\" placement=\"top\">\r\n            <el-button link type=\"primary\" icon=\"View\" @click=\"handlePreview(scope.row)\" v-hasPermi=\"['tool:gen:preview']\"></el-button>\r\n          </el-tooltip>\r\n          <el-tooltip content=\"缂栬緫\" placement=\"top\">\r\n            <el-button link type=\"primary\" icon=\"Edit\" @click=\"handleEditTable(scope.row)\" v-hasPermi=\"['tool:gen:edit']\"></el-button>\r\n          </el-tooltip>\r\n          <el-tooltip content=\"鍒犻櫎\" placement=\"top\">\r\n            <el-button link type=\"primary\" icon=\"Delete\" @click=\"handleDelete(scope.row)\" v-hasPermi=\"['tool:gen:remove']\"></el-button>\r\n          </el-tooltip>\r\n          <el-tooltip content=\"鍚屾\" placement=\"top\">\r\n            <el-button link type=\"primary\" icon=\"Refresh\" @click=\"handleSynchDb(scope.row)\" v-hasPermi=\"['tool:gen:edit']\"></el-button>\r\n          </el-tooltip>\r\n          <el-tooltip content=\"鐢熸垚浠ｇ爜\" placement=\"top\">\r\n            <el-button link type=\"primary\" icon=\"Download\" @click=\"handleGenTable(scope.row)\" v-hasPermi=\"['tool:gen:code']\"></el-button>\r\n          </el-tooltip>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <pagination\r\n      v-show=\"total>0\"\r\n      :total=\"total\"\r\n      v-model:page=\"queryParams.pageNum\"\r\n      v-model:limit=\"queryParams.pageSize\"\r\n      @pagination=\"getList\"\r\n    />\r\n    <!-- 棰勮鐣岄潰 -->\r\n    <el-dialog :title=\"preview.title\" v-model=\"preview.open\" width=\"80%\" top=\"5vh\" append-to-body class=\"scrollbar\">\r\n      <el-tabs v-model=\"preview.activeName\">\r\n        <el-tab-pane\r\n          v-for=\"(value, key) in preview.data\"\r\n          :label=\"key.substring(key.lastIndexOf('/')+1,key.indexOf('.vm'))\"\r\n          :name=\"key.substring(key.lastIndexOf('/')+1,key.indexOf('.vm'))\"\r\n          :key=\"value\"\r\n        >\r\n          <el-link :underline=\"false\" icon=\"DocumentCopy\" v-copyText=\"value\" v-copyText:callback=\"copyTextSuccess\" style=\"float:right\">&nbsp;澶嶅埗</el-link>\r\n          <pre>{{ value }}</pre>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n    </el-dialog>\r\n    <import-table ref=\"importRef\" @ok=\"handleQuery\" />\r\n    <create-table ref=\"createRef\" @ok=\"handleQuery\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup name=\"Gen\">\r\nimport { listTable, previewTable, delTable, genCode, synchDb } from \"@/api/tool/gen\"\r\nimport router from \"@/router\"\r\nimport importTable from \"./importTable\"\r\nimport createTable from \"./createTable\"\r\n\r\nconst route = useRoute()\r\nconst { proxy } = getCurrentInstance()\r\n\r\nconst tableList = ref([])\r\nconst loading = ref(true)\r\nconst showSearch = ref(true)\r\nconst ids = ref([])\r\nconst single = ref(true)\r\nconst multiple = ref(true)\r\nconst total = ref(0)\r\nconst tableNames = ref([])\r\nconst dateRange = ref([])\r\nconst uniqueId = ref(\"\")\r\nconst defaultSort = ref({ prop: \"createTime\", order: \"descending\" })\r\n\r\nconst data = reactive({\r\n  queryParams: {\r\n    pageNum: 1,\r\n    pageSize: 10,\r\n    tableName: undefined,\r\n    tableComment: undefined,\r\n    orderByColumn: defaultSort.value.prop,\r\n    isAsc: defaultSort.value.order\r\n  },\r\n  preview: {\r\n    open: false,\r\n    title: \"浠ｇ爜棰勮\",\r\n    data: {},\r\n    activeName: \"domain.java\"\r\n  }\r\n})\r\n\r\nconst { queryParams, preview } = toRefs(data)\r\n\r\nonActivated(() => {\r\n  const time = route.query.t\r\n  if (time != null && time != uniqueId.value) {\r\n    uniqueId.value = time\r\n    queryParams.value.pageNum = Number(route.query.pageNum)\r\n    dateRange.value = []\r\n    proxy.resetForm(\"queryForm\")\r\n    getList()\r\n  }\r\n})\r\n\r\n/** 鏌ヨ琛ㄩ泦鍚?*/\r\nfunction getList() {\r\n  loading.value = true\r\n  listTable(proxy.addDateRange(queryParams.value, dateRange.value)).then(response => {\r\n    tableList.value = response.rows\r\n    total.value = response.total\r\n    loading.value = false\r\n  })\r\n}\r\n\r\n/** 鎼滅储鎸夐挳鎿嶄綔 */\r\nfunction handleQuery() {\r\n  queryParams.value.pageNum = 1\r\n  getList()\r\n}\r\n\r\n/** 鐢熸垚浠ｇ爜鎿嶄綔 */\r\nfunction handleGenTable(row) {\r\n  const tbNames = row.tableName || tableNames.value\r\n  if (tbNames == \"\") {\r\n    proxy.$modal.msgError(\"璇烽€夋嫨瑕佺敓鎴愮殑鏁版嵁\")\r\n    return\r\n  }\r\n  if (row.genType === \"1\") {\r\n    genCode(row.tableName).then(response => {\r\n      proxy.$modal.msgSuccess(\"鎴愬姛鐢熸垚鍒拌嚜瀹氫箟璺緞锛歕" + row.genPath)\r\n    })\r\n  } else {\r\n    proxy.$download.zip(\"/tool/gen/batchGenCode?tables=\" + tbNames, \"ruoyi.zip\")\r\n  }\r\n}\r\n\r\n/** 鍚屾鏁版嵁搴撴搷浣?*/\r\nfunction handleSynchDb(row) {\r\n  const tableName = row.tableName\r\n  proxy.$modal.confirm('纭瑕佸己鍒跺悓姝"' + tableName + '\"琛ㄧ粨鏋勫悧锛?).then(function () {\r\n    return synchDb(tableName)\r\n  }).then(() => {\r\n    proxy.$modal.msgSuccess(\"鍚屾鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\n/** 鎵撳紑瀵煎叆琛ㄥ脊绐?*/\r\nfunction openImportTable() {\r\n  proxy.$refs[\"importRef\"].show()\r\n}\r\n\r\n/** 鎵撳紑鍒涘缓琛ㄥ脊绐?*/\r\nfunction openCreateTable() {\r\n  proxy.$refs[\"createRef\"].show()\r\n}\r\n\r\n/** 閲嶇疆鎸夐挳鎿嶄綔 */\r\nfunction resetQuery() {\r\n  dateRange.value = []\r\n  proxy.resetForm(\"queryRef\")\r\n  queryParams.value.pageNum = 1\r\n  proxy.$refs[\"genRef\"].sort(defaultSort.value.prop, defaultSort.value.order)\r\n}\r\n\r\n/** 棰勮鎸夐挳 */\r\nfunction handlePreview(row) {\r\n  previewTable(row.tableId).then(response => {\r\n    preview.value.data = response.data\r\n    preview.value.open = true\r\n    preview.value.activeName = \"domain.java\"\r\n  })\r\n}\r\n\r\n/** 澶嶅埗浠ｇ爜鎴愬姛 */\r\nfunction copyTextSuccess() {\r\n  proxy.$modal.msgSuccess(\"澶嶅埗鎴愬姛\")\r\n}\r\n\r\n// 澶氶€夋閫変腑鏁版嵁\r\nfunction handleSelectionChange(selection) {\r\n  ids.value = selection.map(item => item.tableId)\r\n  tableNames.value = selection.map(item => item.tableName)\r\n  single.value = selection.length != 1\r\n  multiple.value = !selection.length\r\n}\r\n\r\n/** 鎺掑簭瑙﹀彂浜嬩欢 */\r\nfunction handleSortChange(column, prop, order) {\r\n  queryParams.value.orderByColumn = column.prop\r\n  queryParams.value.isAsc = column.order\r\n  getList()\r\n}\r\n\r\n/** 淇敼鎸夐挳鎿嶄綔 */\r\nfunction handleEditTable(row) {\r\n  const tableId = row.tableId || ids.value[0]\r\n  const tableName = row.tableName || tableNames.value[0]\r\n  const params = { pageNum: queryParams.value.pageNum }\r\n  proxy.$tab.openPage(\"淇敼[\" + tableName + \"]鐢熸垚閰嶇疆\", '/tool/gen-edit/index/' + tableId, params)\r\n}\r\n\r\n/** 鍒犻櫎鎸夐挳鎿嶄綔 */\r\nfunction handleDelete(row) {\r\n  const tableIds = row.tableId || ids.value\r\n  proxy.$modal.confirm('鏄惁纭鍒犻櫎琛ㄧ紪鍙蜂负\"' + tableIds + '\"鐨勬暟鎹」锛?).then(function () {\r\n    return delTable(tableIds)\r\n  }).then(() => {\r\n    getList()\r\n    proxy.$modal.msgSuccess(\"鍒犻櫎鎴愬姛\")\r\n  }).catch(() => {})\r\n}\r\n\r\ngetList()\r\n</script>\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\1\\Downloads\\IDC-Management-System\\IDC-Management-System\\frontend\\src\\views\\tool\\swagger\\index.vue","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
